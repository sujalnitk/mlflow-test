{"version":3,"file":"static/js/873.651d59cb.chunk.js","mappings":"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","sources":["common/forms/validations.ts","common/utils/StringUtils.ts","experiment-tracking/components/modals/CreateExperimentForm.tsx","experiment-tracking/components/modals/CreateExperimentModal.tsx","experiment-tracking/components/modals/DeleteExperimentModal.tsx","experiment-tracking/components/modals/RenameExperimentModal.tsx","experiment-tracking/components/ExperimentListView.tsx","experiment-tracking/components/experiment-page/contexts/GetExperimentsContext.tsx","common/static/permission-denied-lock.svg","experiment-tracking/components/PermissionDeniedView.tsx","shared/building_blocks/CopyBox.tsx","experiment-tracking/components/modals/GetLinkModal.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentGetShareLinkModal.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentViewHeaderShareButton.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentViewHeaderCompare.tsx","experiment-tracking/components/modals/RestoreRunModal.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunModals.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsControlsActions.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRefreshButton.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentViewLocalStore.ts","experiment-tracking/components/experiment-page/components/runs/RunsSearchTooltipContent.tsx","experiment-tracking/components/experiment-page/components/runs/RunsSearchAutoComplete.utils.tsx","experiment-tracking/components/experiment-page/components/runs/RunsSearchAutoComplete.tsx","experiment-tracking/components/evaluation-artifacts-compare/CreateNotebookRunModal.tsx","experiment-tracking/utils/LLMGatewayUtils.ts","experiment-tracking/sdk/ModelGatewayService.ts","experiment-tracking/components/evaluation-artifacts-compare/hooks/usePromptEvaluationParameters.tsx","experiment-tracking/components/evaluation-artifacts-compare/EvaluationCreatePromptParameters.tsx","experiment-tracking/components/evaluation-artifacts-compare/hooks/usePromptEvaluationPromptTemplateValue.ts","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationCreateRunPromptTemplateErrors.tsx","experiment-tracking/components/evaluation-artifacts-compare/utils/PromptExamples.ts","experiment-tracking/components/evaluation-artifacts-compare/EvaluationCreatePromptRunModalExamples.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationCreatePromptRunOutput.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentPageViewMode.tsx","experiment-tracking/actions/ModelGatewayActions.ts","experiment-tracking/actions/PromptEngineeringActions.ts","experiment-tracking/components/evaluation-artifacts-compare/utils/PromptEngineeringErrorUtils.ts","experiment-tracking/components/evaluation-artifacts-compare/EvaluationCreatePromptRunModal.tsx","experiment-tracking/components/evaluation-artifacts-compare/hooks/usePromptEvaluationInputValues.tsx","experiment-tracking/components/experiment-page/hooks/useCreateNewRun.tsx","experiment-tracking/components/experiment-page/models/ExperimentPageSearchFacetsState.tsx","experiment-tracking/components/experiment-page/utils/persistSearchFacets.serializers.ts","experiment-tracking/components/experiment-page/hooks/useExperimentPageSearchFacets.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsControlsFilters.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsSortSelector.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsColumnSelector.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsModeSwitch.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsGroupBySelector.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsSortSelectorV2.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsControls.tsx","experiment-tracking/components/experiment-page/hooks/useRunSortOptions.ts","common/components/ag-grid/AgGridLoader.tsx","experiment-tracking/components/experiment-page/utils/experimentPage.fetch-utils.ts","experiment-tracking/components/experiment-page/components/runs/cells/ColumnHeaderCell.tsx","experiment-tracking/components/experiment-page/components/runs/cells/DateCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/ExperimentNameCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/ModelsCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/SourceCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/VersionCellRenderer.tsx","common/static/icon-visible-fill.svg","experiment-tracking/components/experiment-page/components/runs/cells/RowActionsCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableHeaderContext.tsx","experiment-tracking/components/experiment-page/components/runs/cells/RowActionsHeaderCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/GroupParentCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/RunNameCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/LoadMoreRowRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/DatasetsCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/AggregateMetricValueCell.tsx","experiment-tracking/components/experiment-page/utils/experimentPage.column-utils.ts","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsEmptyTable.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableCollapse.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableAddColumnCTA.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableStatusBar.tsx","common/components/PreviewSidebar.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentTableSelectRowHandler.tsx","experiment-tracking/components/experiment-page/hooks/useToggleRowVisibilityCallback.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTable.tsx","experiment-tracking/components/experiment-page/models/ExperimentPageViewState.ts","experiment-tracking/components/experiment-page/hooks/useFetchedRunsNotification.tsx","experiment-tracking/components/evaluation-artifacts-compare/hooks/useEvaluateAllRows.tsx","experiment-tracking/components/evaluation-artifacts-compare/contexts/PromptEngineeringContext.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationRunHeaderModelIndicator.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationRunHeaderDatasetIndicator.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationTableHeader.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationRunHeaderCellRenderer.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationCellEvaluateButton.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationTextCellRenderer.tsx","experiment-tracking/components/evaluation-artifacts-compare/EvaluationArtifactCompare.utils.ts","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationGroupByHeaderCellRenderer.tsx","experiment-tracking/components/evaluation-artifacts-compare/hooks/useEvaluationAddNewInputsModal.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationTableActionsColumnRenderer.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationTableActionsCellRenderer.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationImageCellRenderer.tsx","experiment-tracking/components/evaluation-artifacts-compare/components/EvaluationArtifactCompareTable.tsx","experiment-tracking/components/evaluation-artifacts-compare/hooks/useEvaluationArtifactTableData.ts","common/hooks/useBrowserKeyShortcutListener.ts","experiment-tracking/components/evaluation-artifacts-compare/hooks/useEvaluationArtifactWriteBack.tsx","experiment-tracking/components/evaluation-artifacts-compare/EvaluationArtifactViewEmptyState.tsx","experiment-tracking/components/evaluation-artifacts-compare/EvaluationArtifactCompareView.tsx","experiment-tracking/components/evaluation-artifacts-compare/hooks/useEvaluationArtifactViewState.tsx","experiment-tracking/components/evaluation-artifacts-compare/hooks/useEvaluationArtifactTables.ts","experiment-tracking/components/evaluation-artifacts-compare/hooks/useEvaluationArtifactColumns.ts","experiment-tracking/components/runs-compare/RunsCompare.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableResizer.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRuns.tsx","experiment-tracking/components/experiment-page/hooks/useFetchExperiments.ts","experiment-tracking/components/experiment-page/utils/persistSearchFacets.ts","experiment-tracking/components/experiment-page/hooks/usePersistExperimentPageViewState.tsx","experiment-tracking/components/experiment-page/utils/experimentRuns.selector.ts","experiment-tracking/components/experiment-page/hooks/useExperimentRunsAutoRefresh.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentRuns.tsx","experiment-tracking/components/experiment-page/hooks/useInitializeUIState.ts","experiment-tracking/components/experiment-page/utils/expandedRunsViewStateInitializer.ts","experiment-tracking/components/experiment-page/components/ExperimentViewDescriptionNotes.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentViewCopyTitle.tsx","experiment-tracking/components/experiment-page/components/ExperimentViewArtifactLocation.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentViewCopyExperimentId.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentViewCopyArtifactLocation.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentViewHeader.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentPageFeedbackUrl.ts","experiment-tracking/components/experiment-page/ExperimentView.tsx","experiment-tracking/components/experiment-page/hooks/useExperiments.ts","common/utils/useElementHeight.ts","experiment-tracking/components/experiment-page/hooks/useSharedExperimentViewState.ts","common/static/no-experiments.svg","experiment-tracking/components/NoExperimentView.tsx","experiment-tracking/components/HomePage.tsx"],"sourcesContent":["/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport { MlflowService } from '../../experiment-tracking/sdk/MlflowService';\nimport { Services as ModelRegistryService } from '../../model-registry/services';\n\nexport const getExperimentNameValidator = (getExistingExperimentNames: any) => {\n  return (rule: any, value: any, callback: any) => {\n    if (!value) {\n      // no need to execute below validations when no value is entered\n      // eslint-disable-next-line callback-return\n      callback(undefined);\n    } else if (getExistingExperimentNames().includes(value)) {\n      // getExistingExperimentNames returns the names of all active experiments\n      // check whether the passed value is part of the list\n      // eslint-disable-next-line callback-return\n      callback(`Experiment \"${value}\" already exists.`);\n    } else {\n      // on-demand validation whether experiment already exists in deleted state\n      MlflowService.getExperimentByName({ experiment_name: value })\n        .then((res) =>\n          callback(`Experiment \"${value}\" already exists in deleted state.\n                                 You can restore the experiment, or permanently delete the\n                                 experiment from the .trash folder (under tracking server's\n                                 root folder) in order to use this experiment name again.`),\n        )\n        .catch((e) => callback(undefined)); // no experiment returned\n    }\n  };\n};\n\nexport const modelNameValidator = (rule: any, name: any, callback: any) => {\n  if (!name) {\n    callback(undefined);\n    return;\n  }\n\n  ModelRegistryService.getRegisteredModel({ name: name })\n    .then(() => callback(`Model \"${name}\" already exists.`))\n    .catch((e) => callback(undefined));\n};\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport _ from 'lodash';\n\nexport const truncateToFirstLineWithMaxLength = (str: any, maxLength: any) => {\n  const truncated = _.truncate(str, {\n    length: maxLength,\n  });\n  return _.takeWhile(truncated, (char) => char !== '\\n').join('');\n};\n\nexport const capitalizeFirstChar = (str: any) => {\n  if (!str || typeof str !== 'string' || str.length < 1) {\n    return str;\n  }\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n};\n\nexport const middleTruncateStr = (str: any, maxLen: any) => {\n  if (str.length > maxLen) {\n    const firstPartLen = Math.floor((maxLen - 3) / 2);\n    const lastPartLen = maxLen - 3 - firstPartLen;\n    return str.substring(0, firstPartLen) + '...' + str.substring(str.length - lastPartLen, str.length);\n  } else {\n    return str;\n  }\n};\n\nexport const capitalizeFirstLetter = (string: any) => {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n};\n\nconst _keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\n/* eslint-disable no-bitwise */\n/**\n * UTF-8 safe version of base64 encoder\n * Source: http://www.webtoolkit.info/javascript_base64.html\n *\n * @param {string} input - Text to encode\n */\nexport const btoaUtf8 = (input: any) => {\n  let output = '';\n  let i = 0;\n\n  const result = _utf8_encode(input);\n\n  while (i < result.length) {\n    const chr1 = result.charCodeAt(i++);\n    const chr2 = result.charCodeAt(i++);\n    const chr3 = result.charCodeAt(i++);\n\n    const enc1 = chr1 >> 2;\n    const enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n    let enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n    let enc4 = chr3 & 63;\n\n    if (isNaN(chr2)) {\n      enc3 = enc4 = 64;\n    } else if (isNaN(chr3)) {\n      enc4 = 64;\n    }\n\n    output = output + _keyStr.charAt(enc1) + _keyStr.charAt(enc2) + _keyStr.charAt(enc3) + _keyStr.charAt(enc4);\n  }\n\n  return output;\n};\n\n/**\n * UTF-8 safe version of base64 decoder\n * Source: http://www.webtoolkit.info/javascript_base64.html\n *\n * @param {string} input - Text to decode\n */\nexport const atobUtf8 = (input: any) => {\n  let output = '';\n  let i = 0;\n\n  const result = input?.replace(/[^A-Za-z0-9+/=]/g, '') || '';\n\n  while (i < result.length) {\n    const enc1 = _keyStr.indexOf(result.charAt(i++));\n    const enc2 = _keyStr.indexOf(result.charAt(i++));\n    const enc3 = _keyStr.indexOf(result.charAt(i++));\n    const enc4 = _keyStr.indexOf(result.charAt(i++));\n\n    const chr1 = (enc1 << 2) | (enc2 >> 4);\n    const chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n    const chr3 = ((enc3 & 3) << 6) | enc4;\n\n    output += String.fromCharCode(chr1);\n\n    if (enc3 !== 64) {\n      output += String.fromCharCode(chr2);\n    }\n\n    if (enc4 !== 64) {\n      output += String.fromCharCode(chr3);\n    }\n  }\n\n  return _utf8_decode(output);\n};\n\n/**\n * (private method) does a UTF-8 encoding\n *\n * @private\n * @param {string} string - Text to encode\n */\nconst _utf8_encode = (string = '') => {\n  const result = string.replace(/\\r\\n/g, '\\n');\n  let utftext = '';\n\n  for (let n = 0; n < result.length; n++) {\n    const c = result.charCodeAt(n);\n\n    if (c < 128) {\n      utftext += String.fromCharCode(c);\n    } else if (c > 127 && c < 2048) {\n      utftext += String.fromCharCode((c >> 6) | 192) + String.fromCharCode((c & 63) | 128);\n    } else {\n      utftext +=\n        String.fromCharCode((c >> 12) | 224) +\n        String.fromCharCode(((c >> 6) & 63) | 128) +\n        String.fromCharCode((c & 63) | 128);\n    }\n  }\n\n  return utftext;\n};\n\n/**\n * (private method) does a UTF-8 decoding\n *\n * @private\n * @param {string} utftext - UTF-8 text to dencode\n */\nconst _utf8_decode = (utftext = '') => {\n  let string = '';\n  let i = 0;\n\n  while (i < utftext.length) {\n    const c = utftext.charCodeAt(i);\n\n    if (c < 128) {\n      string += String.fromCharCode(c);\n      i++;\n    } else if (c > 191 && c < 224) {\n      const c2 = utftext.charCodeAt(i + 1);\n      string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n      i += 2;\n    } else {\n      const c2 = utftext.charCodeAt(i + 1);\n      const c3 = utftext.charCodeAt(i + 2);\n      string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n      i += 3;\n    }\n  }\n  return string;\n};\n/* eslint-enable no-bitwise */\n\n/**\n * Returns a SHA256 hash of the input string\n */\nexport const getStringSHA256 = (input: string) => {\n  return crypto.subtle.digest('SHA-256', new TextEncoder().encode(input)).then((arrayBuffer) => {\n    return Array.prototype.map.call(new Uint8Array(arrayBuffer), (x) => ('00' + x.toString(16)).slice(-2)).join('');\n  });\n};\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\n\nimport { injectIntl } from 'react-intl';\nimport { Input, Form } from '@databricks/design-system';\n\nexport const EXP_NAME_FIELD = 'experimentName';\nexport const ARTIFACT_LOCATION = 'artifactLocation';\n\ntype Props = {\n  validator?: (...args: any[]) => any;\n  intl: {\n    formatMessage: (...args: any[]) => any;\n  };\n  innerRef: any;\n};\n\n/**\n * Component that renders a form for creating a new experiment.\n */\nclass CreateExperimentFormComponent extends Component<Props> {\n  render() {\n    return (\n      // @ts-expect-error TS(2322): Type '{ children: Element[]; ref: any; layout: \"ve... Remove this comment to see the full error message\n      <Form ref={this.props.innerRef} layout=\"vertical\">\n        <Form.Item\n          label={this.props.intl.formatMessage({\n            defaultMessage: 'Experiment Name',\n            description: 'Label for create experiment modal to enter a valid experiment name',\n          })}\n          name={EXP_NAME_FIELD}\n          rules={[\n            {\n              required: true,\n              message: this.props.intl.formatMessage({\n                defaultMessage: 'Please input a new name for the new experiment.',\n                description: 'Error message for name requirement in create experiment for MLflow',\n              }),\n            },\n            {\n              validator: this.props.validator,\n            },\n          ]}\n        >\n          <Input\n            placeholder={this.props.intl.formatMessage({\n              defaultMessage: 'Input an experiment name',\n              description: 'Input placeholder to enter experiment name for create experiment',\n            })}\n            autoFocus\n          />\n        </Form.Item>\n        <Form.Item\n          name={ARTIFACT_LOCATION}\n          label={this.props.intl.formatMessage({\n            defaultMessage: 'Artifact Location',\n            description: 'Label for create experiment modal to enter a artifact location',\n          })}\n          rules={[\n            {\n              required: false,\n            },\n          ]}\n        >\n          <Input\n            placeholder={this.props.intl.formatMessage({\n              defaultMessage: 'Input an artifact location (optional)',\n              description: 'Input placeholder to enter artifact location for create experiment',\n            })}\n          />\n        </Form.Item>\n      </Form>\n    );\n  }\n}\n\n// @ts-expect-error TS(2769): No overload matches this call.\nexport const CreateExperimentForm = injectIntl(CreateExperimentFormComponent);\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport type { NavigateFunction } from '../../../common/utils/RoutingUtils';\nimport debounce from 'lodash/debounce';\n\nimport Routes from '../../routes';\nimport { GenericInputModal } from './GenericInputModal';\nimport { CreateExperimentForm, EXP_NAME_FIELD, ARTIFACT_LOCATION } from './CreateExperimentForm';\nimport { getExperimentNameValidator } from '../../../common/forms/validations';\n\nimport { createExperimentApi, searchExperimentsApi } from '../../actions';\nimport { getExperiments } from '../../reducers/Reducers';\nimport { withRouterNext } from '../../../common/utils/withRouterNext';\n\ntype CreateExperimentModalImplProps = {\n  isOpen?: boolean;\n  onClose: (...args: any[]) => any;\n  experimentNames: string[];\n  createExperimentApi: (...args: any[]) => any;\n  searchExperimentsApi: (...args: any[]) => any;\n  navigate: NavigateFunction;\n};\n\nexport class CreateExperimentModalImpl extends Component<CreateExperimentModalImplProps> {\n  handleCreateExperiment = async (values: any) => {\n    // get values of input fields\n    const experimentName = values[EXP_NAME_FIELD];\n    const artifactLocation = values[ARTIFACT_LOCATION];\n\n    // Both createExperimentApi and searchExperimentsApi calls need to be fulfilled sequentially\n    // before redirecting the user to the newly created experiment page (history.push())\n    const response = await this.props.createExperimentApi(experimentName, artifactLocation);\n    await this.props.searchExperimentsApi();\n\n    const {\n      value: { experiment_id: newExperimentId },\n    } = response;\n    if (newExperimentId) {\n      this.props.navigate(Routes.getExperimentPageRoute(newExperimentId));\n    }\n  };\n\n  debouncedExperimentNameValidator = debounce(\n    getExperimentNameValidator(() => this.props.experimentNames),\n    400,\n  );\n\n  render() {\n    const { isOpen } = this.props;\n    return (\n      <GenericInputModal\n        title=\"Create Experiment\"\n        okText=\"Create\"\n        isOpen={isOpen}\n        handleSubmit={this.handleCreateExperiment}\n        onClose={this.props.onClose}\n      >\n        {/* @ts-expect-error TS(2322): Type '{ validator: ((rule: any, value: any, callba... Remove this comment to see the full error message */}\n        <CreateExperimentForm validator={this.debouncedExperimentNameValidator} />\n      </GenericInputModal>\n    );\n  }\n}\n\nconst mapStateToProps = (state: any) => {\n  const experiments = getExperiments(state);\n  const experimentNames = experiments.map((e) => e.name);\n  return { experimentNames };\n};\n\nconst mapDispatchToProps = {\n  createExperimentApi,\n  searchExperimentsApi,\n};\n\nexport const CreateExperimentModal = withRouterNext(\n  connect(mapStateToProps, mapDispatchToProps)(CreateExperimentModalImpl),\n);\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { ConfirmModal } from './ConfirmModal';\nimport { deleteExperimentApi, searchExperimentsApi } from '../../actions';\nimport Routes from '../../routes';\nimport Utils from '../../../common/utils/Utils';\nimport { connect } from 'react-redux';\nimport { NavigateFunction } from '../../../common/utils/RoutingUtils';\nimport { getUUID } from '../../../common/utils/ActionUtils';\nimport { withRouterNext } from '../../../common/utils/withRouterNext';\n\ntype Props = {\n  isOpen: boolean;\n  onClose: (...args: any[]) => any;\n  activeExperimentIds?: string[];\n  experimentId: string;\n  experimentName: string;\n  deleteExperimentApi: (...args: any[]) => any;\n  searchExperimentsApi: (...args: any[]) => any;\n  navigate: NavigateFunction;\n};\n\nexport class DeleteExperimentModalImpl extends Component<Props> {\n  handleSubmit = () => {\n    const { experimentId, activeExperimentIds } = this.props;\n    const deleteExperimentRequestId = getUUID();\n\n    const deletePromise = this.props\n      .deleteExperimentApi(experimentId, deleteExperimentRequestId)\n      .then(() => {\n        // reload the page if an active experiment was deleted\n        if (activeExperimentIds?.includes(experimentId)) {\n          if (activeExperimentIds.length === 1) {\n            // send it to root\n            this.props.navigate(Routes.rootRoute);\n          } else {\n            const experimentIds = activeExperimentIds.filter((eid) => eid !== experimentId);\n            const route =\n              experimentIds.length === 1\n                ? Routes.getExperimentPageRoute(experimentIds[0])\n                : Routes.getCompareExperimentsPageRoute(experimentIds);\n            this.props.navigate(route);\n          }\n        }\n      })\n      .then(() => this.props.searchExperimentsApi(deleteExperimentRequestId))\n      .catch((e: any) => {\n        Utils.logErrorAndNotifyUser(e);\n      });\n\n    return deletePromise;\n  };\n\n  render() {\n    return (\n      <ConfirmModal\n        isOpen={this.props.isOpen}\n        onClose={this.props.onClose}\n        handleSubmit={this.handleSubmit}\n        title={`Delete Experiment \"${this.props.experimentName}\"`}\n        helpText={\n          <div>\n            <p>\n              <b>\n                Experiment \"{this.props.experimentName}\" (Experiment ID: {this.props.experimentId}) will be deleted.\n              </b>\n            </p>\n            {/* @ts-expect-error TS(4111): Property 'SHOW_GDPR_PURGING_MESSAGES' comes from a... Remove this comment to see the full error message */}\n            {process.env.SHOW_GDPR_PURGING_MESSAGES === 'true' ? (\n              <p>\n                Deleted experiments are restorable for 30 days, after which they are purged along with their associated\n                runs, including metrics, params, tags, and artifacts.\n              </p>\n            ) : (\n              ''\n            )}\n          </div>\n        }\n        confirmButtonText=\"Delete\"\n      />\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  deleteExperimentApi,\n  searchExperimentsApi,\n};\n\nexport const DeleteExperimentModal = withRouterNext(connect(undefined, mapDispatchToProps)(DeleteExperimentModalImpl));\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport debounce from 'lodash/debounce';\n\nimport { GenericInputModal } from './GenericInputModal';\nimport { RenameForm, NEW_NAME_FIELD } from './RenameForm';\nimport { getExperimentNameValidator } from '../../../common/forms/validations';\n\nimport { updateExperimentApi, getExperimentApi } from '../../actions';\nimport { getExperiments } from '../../reducers/Reducers';\n\ntype RenameExperimentModalImplProps = {\n  isOpen?: boolean;\n  experimentId?: string;\n  experimentName?: string;\n  experimentNames: string[];\n  onClose: (...args: any[]) => any;\n  updateExperimentApi: (...args: any[]) => any;\n  getExperimentApi: (...args: any[]) => any;\n};\n\nexport class RenameExperimentModalImpl extends Component<RenameExperimentModalImplProps> {\n  handleRenameExperiment = (values: any) => {\n    // get value of input field\n    const newExperimentName = values[NEW_NAME_FIELD];\n    const updateExperimentPromise = this.props\n      .updateExperimentApi(this.props.experimentId, newExperimentName)\n      .then(() => this.props.getExperimentApi(this.props.experimentId));\n\n    return updateExperimentPromise;\n  };\n\n  debouncedExperimentNameValidator = debounce(\n    getExperimentNameValidator(() => this.props.experimentNames),\n    400,\n  );\n\n  render() {\n    const { isOpen, experimentName } = this.props;\n    return (\n      <GenericInputModal\n        title=\"Rename Experiment\"\n        okText=\"Save\"\n        isOpen={isOpen}\n        handleSubmit={this.handleRenameExperiment}\n        onClose={this.props.onClose}\n      >\n        {/* @ts-expect-error TS(2769): No overload matches this call. */}\n        <RenameForm\n          type=\"experiment\"\n          name={experimentName}\n          visible={isOpen}\n          validator={this.debouncedExperimentNameValidator}\n        />\n      </GenericInputModal>\n    );\n  }\n}\n\nconst mapStateToProps = (state: any) => {\n  const experiments = getExperiments(state);\n  const experimentNames = experiments.map((e) => e.name);\n  return { experimentNames };\n};\n\nconst mapDispatchToProps = {\n  updateExperimentApi,\n  getExperimentApi,\n};\n\nexport const RenameExperimentModal = connect(mapStateToProps, mapDispatchToProps)(RenameExperimentModalImpl);\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { css, Theme } from '@emotion/react';\nimport {\n  Checkbox,\n  CaretDownSquareIcon,\n  PlusCircleIcon,\n  Input,\n  PencilIcon,\n  Typography,\n  WithDesignSystemThemeHoc,\n  DesignSystemHocProps,\n} from '@databricks/design-system';\nimport { List } from 'antd';\nimport { List as VList, AutoSizer } from 'react-virtualized';\nimport 'react-virtualized/styles.css';\nimport { Link, NavigateFunction } from '../../common/utils/RoutingUtils';\nimport Routes from '../routes';\nimport { CreateExperimentModal } from './modals/CreateExperimentModal';\nimport { DeleteExperimentModal } from './modals/DeleteExperimentModal';\nimport { RenameExperimentModal } from './modals/RenameExperimentModal';\nimport { IconButton } from '../../common/components/IconButton';\nimport { withRouterNext } from '../../common/utils/withRouterNext';\nimport { ExperimentEntity } from '../types';\n\ntype Props = {\n  activeExperimentIds: string[];\n  experiments: ExperimentEntity[];\n  navigate: NavigateFunction;\n} & DesignSystemHocProps;\n\ntype State = any;\n\nexport class ExperimentListView extends Component<Props, State> {\n  list: any;\n\n  state = {\n    checkedKeys: this.props.activeExperimentIds,\n    hidden: false,\n    searchInput: '',\n    showCreateExperimentModal: false,\n    showDeleteExperimentModal: false,\n    showRenameExperimentModal: false,\n    selectedExperimentId: '0',\n    selectedExperimentName: '',\n  };\n\n  bindListRef = (ref: any) => {\n    this.list = ref;\n  };\n\n  componentDidUpdate = () => {\n    // Ensure the filter is applied\n    if (this.list) {\n      this.list.forceUpdateGrid();\n    }\n  };\n\n  filterExperiments = (searchInput: any) => {\n    const { experiments } = this.props;\n    const lowerCasedSearchInput = searchInput.toLowerCase();\n    return lowerCasedSearchInput === ''\n      ? this.props.experiments\n      : experiments.filter(({ name }) => name.toLowerCase().includes(lowerCasedSearchInput));\n  };\n\n  handleSearchInputChange = (event: any) => {\n    this.setState({\n      searchInput: event.target.value,\n    });\n  };\n\n  updateSelectedExperiment = (experimentId: any, experimentName: any) => {\n    this.setState({\n      selectedExperimentId: experimentId,\n      selectedExperimentName: experimentName,\n    });\n  };\n\n  handleCreateExperiment = () => {\n    this.setState({\n      showCreateExperimentModal: true,\n    });\n  };\n\n  handleDeleteExperiment = (experimentId: any, experimentName: any) => () => {\n    this.setState({\n      showDeleteExperimentModal: true,\n    });\n    this.updateSelectedExperiment(experimentId, experimentName);\n  };\n\n  handleRenameExperiment = (experimentId: any, experimentName: any) => () => {\n    this.setState({\n      showRenameExperimentModal: true,\n    });\n    this.updateSelectedExperiment(experimentId, experimentName);\n  };\n\n  handleCloseCreateExperimentModal = () => {\n    this.setState({\n      showCreateExperimentModal: false,\n    });\n  };\n\n  handleCloseDeleteExperimentModal = () => {\n    this.setState({\n      showDeleteExperimentModal: false,\n    });\n    // reset\n    this.updateSelectedExperiment('0', '');\n  };\n\n  handleCloseRenameExperimentModal = () => {\n    this.setState({\n      showRenameExperimentModal: false,\n    });\n    // reset\n    this.updateSelectedExperiment('0', '');\n  };\n\n  // Add a key if it does not exist, remove it if it does\n  // Always keep at least one experiment checked if it is only the active one.\n  handleCheck = (isChecked: any, key: any) => {\n    this.setState((prevState: any, props: any) => {\n      let { checkedKeys } = prevState;\n      if (isChecked === true && !props.activeExperimentIds.includes(key)) {\n        checkedKeys = [key, ...props.activeExperimentIds];\n      }\n      if (isChecked === false && props.activeExperimentIds.length !== 1) {\n        checkedKeys = props.activeExperimentIds.filter((i: any) => i !== key);\n      }\n      return { checkedKeys: checkedKeys };\n    }, this.pushExperimentRoute);\n  };\n\n  pushExperimentRoute = () => {\n    if (this.state.checkedKeys.length > 0) {\n      const route =\n        this.state.checkedKeys.length === 1\n          ? Routes.getExperimentPageRoute(this.state.checkedKeys[0])\n          : Routes.getCompareExperimentsPageRoute(this.state.checkedKeys);\n      this.props.navigate(route);\n    }\n  };\n\n  // Avoid calling emotion for every list item\n  activeExperimentListItem = classNames.getExperimentListItemContainer(true, this.props.designSystemThemeApi.theme);\n  inactiveExperimentListItem = classNames.getExperimentListItemContainer(false, this.props.designSystemThemeApi.theme);\n\n  renderListItem = ({ index, key, style, isScrolling, parent }: any) => {\n    // Use the parents props to index.\n    const item = parent.props.data[index];\n    const { activeExperimentIds } = this.props;\n    const isActive = activeExperimentIds.includes(item.experimentId);\n    const dataTestId = isActive ? 'active-experiment-list-item' : 'experiment-list-item';\n    // Clicking the link removes all checks and marks other experiments\n    // as not active.\n    return (\n      <div\n        css={isActive ? this.activeExperimentListItem : this.inactiveExperimentListItem}\n        data-testid={dataTestId}\n        key={key}\n        style={style}\n      >\n        <List.Item\n          key={item.experimentId}\n          // @ts-expect-error TS(2322): Type '{ key: any; bordered: string; prefixCls: str... Remove this comment to see the full error message\n          bordered=\"false\"\n          prefixCls=\"experiment-list-meta\"\n          css={classNames.experimentListItem}\n          actions={[\n            <Checkbox\n              id={item.experimentId}\n              key={item.experimentId}\n              onChange={(isChecked) => this.handleCheck(isChecked, item.experimentId)}\n              isChecked={isActive}\n              data-testid={`${dataTestId}-check-box`}\n            ></Checkbox>,\n            <Link\n              className=\"experiment-link\"\n              to={Routes.getExperimentPageRoute(item.experimentId)}\n              onClick={() => this.setState({ checkedKeys: [item.experimentId] })}\n              title={item.name}\n              data-testid={`${dataTestId}-link`}\n            >\n              {item.name}\n            </Link>,\n            <IconButton\n              icon={<PencilIcon />}\n              // @ts-expect-error TS(2322): Type '{ icon: Element; onClick: () => void; \"data-... Remove this comment to see the full error message\n              onClick={this.handleRenameExperiment(item.experimentId, item.name)}\n              data-testid=\"rename-experiment-button\"\n              css={classNames.renameExperiment}\n            />,\n            <IconButton\n              icon={<i className=\"far fa-trash-o\" />}\n              // @ts-expect-error TS(2322): Type '{ icon: Element; onClick: () => void; css: {... Remove this comment to see the full error message\n              onClick={this.handleDeleteExperiment(item.experimentId, item.name)}\n              css={classNames.deleteExperiment}\n              data-testid=\"delete-experiment-button\"\n            />,\n          ]}\n        ></List.Item>\n      </div>\n    );\n  };\n\n  isRowLoaded = ({ index }: any) => {\n    return !!this.props.experiments[index];\n  };\n\n  unHide = () => this.setState({ hidden: false });\n  hide = () => this.setState({ hidden: true });\n\n  render() {\n    const { hidden } = this.state;\n    const { activeExperimentIds, designSystemThemeApi } = this.props;\n    const { theme } = designSystemThemeApi;\n\n    if (hidden) {\n      return (\n        <CaretDownSquareIcon\n          rotate={-90}\n          onClick={this.unHide}\n          css={classNames.icon(theme)}\n          title=\"Show experiment list\"\n        />\n      );\n    }\n\n    const { searchInput } = this.state;\n    const filteredExperiments = this.filterExperiments(searchInput);\n\n    return (\n      <div id=\"experiment-list-outer-container\" css={classNames.experimentListOuterContainer}>\n        <CreateExperimentModal\n          isOpen={this.state.showCreateExperimentModal}\n          onClose={this.handleCloseCreateExperimentModal}\n        />\n        <DeleteExperimentModal\n          isOpen={this.state.showDeleteExperimentModal}\n          onClose={this.handleCloseDeleteExperimentModal}\n          activeExperimentIds={activeExperimentIds}\n          experimentId={this.state.selectedExperimentId}\n          experimentName={this.state.selectedExperimentName}\n        />\n        <RenameExperimentModal\n          isOpen={this.state.showRenameExperimentModal}\n          onClose={this.handleCloseRenameExperimentModal}\n          experimentId={this.state.selectedExperimentId}\n          experimentName={this.state.selectedExperimentName}\n        />\n        <div css={classNames.experimentTitleContainer}>\n          <Typography.Title level={2} style={{ margin: 0 }}>\n            Experiments\n          </Typography.Title>\n          <div>\n            <PlusCircleIcon\n              onClick={this.handleCreateExperiment}\n              css={classNames.icon(theme)}\n              title=\"New Experiment\"\n              data-testid=\"create-experiment-button\"\n            />\n            <CaretDownSquareIcon\n              onClick={this.hide}\n              rotate={90}\n              css={classNames.icon(theme)}\n              title=\"Hide experiment list\"\n            />\n          </div>\n        </div>\n        <Input\n          placeholder=\"Search Experiments\"\n          aria-label=\"search experiments\"\n          value={searchInput}\n          onChange={this.handleSearchInputChange}\n          data-testid=\"search-experiment-input\"\n        />\n        <div>\n          <AutoSizer>\n            {({ width, height }) => (\n              <VList\n                rowRenderer={this.renderListItem}\n                data={filteredExperiments}\n                ref={this.bindListRef}\n                rowHeight={32}\n                overscanRowCount={10}\n                height={height}\n                width={width}\n                rowCount={filteredExperiments.length}\n              />\n            )}\n          </AutoSizer>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst classNames = {\n  experimentListOuterContainer: css({\n    boxSizing: 'border-box',\n    height: '100%',\n    marginLeft: '24px',\n    marginRight: '8px',\n    paddingRight: '16px',\n    width: '100%',\n    // Ensure it displays experiment names for smaller screens, but don't\n    // take more than 20% of the screen.\n    minWidth: 'max(280px, 20vw)',\n    maxWidth: '20vw',\n    display: 'grid',\n    gridTemplateRows: 'auto auto 1fr',\n  }),\n  experimentTitleContainer: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: '8px',\n  },\n  experimentTitle: {\n    margin: 0,\n  },\n  experimentSearchContainer: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: '2px',\n  },\n  experimentSearchInput: {\n    margin: 0,\n    flex: '6 1 0',\n  },\n  experimentSearchIcon: {\n    fontSize: '24px',\n    marginLeft: 'auto',\n    flex: '1 1 0',\n  },\n  experimentListContainer: {\n    marginTop: '12px',\n  },\n  getExperimentListItemContainer: (isActive: any, theme: any) =>\n    css({\n      display: 'flex',\n      marginRight: '8px',\n      paddingRight: '5px',\n      borderLeft: isActive ? `solid ${theme.colors.primary}` : 'solid transparent',\n      borderLeftWidth: 4,\n      backgroundColor: isActive ? theme.colors.actionDefaultBackgroundPress : 'transparent',\n    }),\n  experimentListItem: css({\n    display: 'grid',\n    // Make the items line up\n    width: '100%',\n    '.experiment-list-meta-item-action': {\n      display: 'grid',\n      gridTemplateColumns: 'auto 1fr auto auto',\n      paddingLeft: '0px',\n      marginBottom: '4px',\n      marginTop: '4px',\n      li: {\n        paddingRight: '4px',\n        paddingLeft: '4px',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n        textAlign: 'left',\n        fontSize: '13px',\n      },\n    },\n  }),\n  renameExperiment: {\n    justifySelf: 'end',\n  },\n  // Use a larger margin to avoid overlapping the vertical scrollbar\n  deleteExperiment: {\n    justifySelf: 'end',\n    marginRight: '10px',\n  },\n  icon: (theme: Theme) => ({\n    color: theme.colors.actionDefaultTextDefault,\n    fontSize: theme.general.iconSize,\n    marginLeft: theme.spacing.xs,\n  }),\n};\n\nexport default withRouterNext(WithDesignSystemThemeHoc(ExperimentListView));\n","import { isEqual } from 'lodash';\nimport React, { createContext, useCallback, useMemo, useState } from 'react';\nimport { ErrorWrapper } from '../../../../common/utils/ErrorWrapper';\nimport RequestStateWrapper from '../../../../common/components/RequestStateWrapper';\nimport Utils from '../../../../common/utils/Utils';\nimport type { getExperimentApi, setCompareExperiments, setExperimentTagApi } from '../../../actions';\nimport { useDispatch } from 'react-redux';\nimport { ThunkDispatch } from '../../../../redux-types';\n\nexport interface GetExperimentsContextActions {\n  setExperimentTagApi: typeof setExperimentTagApi;\n  getExperimentApi: typeof getExperimentApi;\n  setCompareExperiments: typeof setCompareExperiments;\n}\n\nexport interface GetExperimentsContextType {\n  /**\n   * Function used to (re)fetch experiments using their IDs.\n   */\n  fetchExperiments: (experimentIds: string[]) => void;\n\n  /**\n   * Indicates if experiments are being loaded at the moment\n   */\n  isLoadingExperiment: boolean;\n\n  /**\n   * Contains error descriptor if fetching runs failed\n   */\n  requestError: ErrorWrapper | null;\n\n  /**\n   * All experiment-related actions creators\n   */\n  actions: GetExperimentsContextActions;\n}\n\n/**\n * Wrapper context that aggregates concrete redux actions necessary to fetch experiments.\n */\nexport const GetExperimentsContext = createContext<GetExperimentsContextType | null>(null);\n\n/**\n * Provider component for GetExperimentsContext.\n * Accepts concrete redux actions for searching experiments.\n */\nexport const GetExperimentsContextProvider = ({\n  children,\n  actions,\n}: React.PropsWithChildren<{\n  actions: GetExperimentsContextActions;\n}>) => {\n  const [fetchExperimentsRequestIds, setFetchExperimentsRequestIds] = useState<string[]>([]);\n  const [isLoadingExperiment, setIsLoadingExperiment] = useState(false);\n\n  const [requestError, setRequestError] = useState<any>(null);\n\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const fetchExperiments = useCallback(\n    (experimentIds: string[]) => {\n      const fetchFn = () => {\n        const newRequestIds = experimentIds.map((experimentId) => {\n          const requestAction = actions.getExperimentApi(experimentId);\n          dispatch(requestAction).catch((e) => {\n            Utils.logErrorAndNotifyUser(e);\n          });\n          return requestAction.meta.id;\n        });\n        setFetchExperimentsRequestIds((requestIds) =>\n          isEqual(newRequestIds, requestIds) ? requestIds : newRequestIds,\n        );\n      };\n\n      setRequestError(null);\n      fetchFn();\n    },\n    [actions, dispatch],\n  );\n\n  const contextValue = useMemo(\n    () => ({\n      fetchExperiments,\n      isLoadingExperiment,\n      requestError: requestError,\n      actions,\n    }),\n    [actions, fetchExperiments, isLoadingExperiment, requestError],\n  );\n\n  const renderFn = (_isLoading: false, _renderError: any, requests: any[]) => {\n    /**\n     * TODO:\n     * Defer setting this state because currently it might happen inside\n     * RequestStateWrapper's render function which causes React to act up.\n     * Either rebuild RequestStateWrapper or introduce some workaround.\n     */\n    setIsLoadingExperiment(requests.some((r) => fetchExperimentsRequestIds.includes(r.id) && r.active));\n\n    if (!requestError) {\n      requests.forEach((request) => {\n        if (request.error) {\n          setRequestError(request.error);\n        }\n      });\n    }\n\n    return children;\n  };\n\n  return (\n    <GetExperimentsContext.Provider value={contextValue}>\n      <RequestStateWrapper\n        shouldOptimisticallyRender\n        // eslint-disable-next-line no-trailing-spaces\n        requestIds={fetchExperimentsRequestIds}\n      >\n        {renderFn}\n      </RequestStateWrapper>\n    </GetExperimentsContext.Provider>\n  );\n};\n","var _desc, _g;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgPermissionDeniedLock(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"58px\",\n    height: \"75px\",\n    viewBox: \"0 0 58 75\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Privacy_Lock\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _desc || (_desc = /*#__PURE__*/React.createElement(\"desc\", null, \"Created with Sketch.\")), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"EmptyState\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"ErrorPage-noPermission\",\n    transform: \"translate(-691.000000, -194.000000)\",\n    fill: \"#43C8EC\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Privacy_Lock\",\n    transform: \"translate(691.000000, 194.250000)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M45.8,24.31 L45.8,17.16 C45.8,7.84295627 38.2470437,0.29 28.93,0.29 C19.6129563,0.29 12.06,7.84295627 12.06,17.16 L12.06,24.3 L0.14,24.3 L0.14,74.64 L57.71,74.64 L57.71,24.31 L45.8,24.31 Z M14.05,17.16 C14.05,8.94752577 20.7075258,2.29 28.92,2.29 C37.1324742,2.29 43.79,8.94752577 43.79,17.16 L43.79,24.3 L14.05,24.3 L14.05,17.16 Z M55.71,72.64 L2.14,72.64 L2.14,26.31 L55.71,26.31 L55.71,72.64 Z\",\n    id: \"Shape\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M28.93,37.33 C26.5550177,37.3567611 24.5749652,39.154747 24.319954,41.5161505 C24.0649429,43.8775541 25.6154871,46.0568139 27.93,46.59 L27.93,62.54 L29.93,62.54 L29.93,46.6 C32.2445129,46.0668139 33.7950571,43.8875541 33.540046,41.5261505 C33.2850348,39.164747 31.3049823,37.3667611 28.93,37.34 L28.93,37.33 Z\",\n    id: \"Path\"\n  }))))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgPermissionDeniedLock);\nexport default __webpack_public_path__ + \"static/media/permission-denied-lock.16036747d57cd663d7df223781a447b2.svg\";\nexport { ForwardRef as ReactComponent };","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React from 'react';\nimport permissionDeniedLock from '../../common/static/permission-denied-lock.svg';\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nconst defaultMessage = 'The current user does not have permission to view this page.';\n\ntype Props = {\n  errorMessage?: string;\n};\n\nexport function PermissionDeniedView({ errorMessage }: Props) {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div className=\"center\">\n      <img style={{ height: 300, marginTop: 80 }} src={permissionDeniedLock} alt=\"permission denied\" />\n      <h1 style={{ paddingTop: 10 }}>Permission Denied</h1>\n      <h2 data-testid=\"error-message\" css={{ color: theme.colors.textSecondary }}>\n        {errorMessage || defaultMessage}\n      </h2>\n    </div>\n  );\n}\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React from 'react';\nimport { Input } from '@databricks/design-system';\nimport { CopyButton } from './CopyButton';\n\ntype Props = {\n  copyText: string;\n};\n\nexport const CopyBox = ({ copyText }: Props) => (\n  <div css={{ display: 'flex', gap: 4 }}>\n    <Input readOnly value={copyText} data-test-id=\"copy-box\" />\n    <CopyButton copyText={copyText} />\n  </div>\n);\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Modal } from '@databricks/design-system';\nimport { CopyBox } from '../../../shared/building_blocks/CopyBox';\n\ntype Props = {\n  visible: boolean;\n  onCancel: (...args: any[]) => any;\n  link: string;\n};\n\nexport const GetLinkModal = ({ visible, onCancel, link }: Props) => {\n  return (\n    <Modal\n      title={<FormattedMessage defaultMessage=\"Get Link\" description=\"Title text for get-link modal\" />}\n      visible={visible}\n      onCancel={onCancel}\n    >\n      <CopyBox copyText={link} />\n    </Modal>\n  );\n};\n","import { useCallback, useEffect, useMemo, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { GenericSkeleton, Input, Modal } from '@databricks/design-system';\nimport { useDispatch } from 'react-redux';\nimport { ThunkDispatch } from '../../../../../redux-types';\nimport { setExperimentTagApi } from '../../../../actions';\nimport Routes from '../../../../routes';\nimport { CopyButton } from '../../../../../shared/building_blocks/CopyButton';\nimport { ExperimentPageSearchFacetsState } from '../../models/ExperimentPageSearchFacetsState';\nimport { ExperimentPageUIState } from '../../models/ExperimentPageUIState';\nimport { getStringSHA256 } from '../../../../../common/utils/StringUtils';\nimport Utils from '../../../../../common/utils/Utils';\nimport { EXPERIMENT_PAGE_VIEW_STATE_SHARE_TAG_PREFIX } from '../../../../constants';\n\ntype GetShareLinkModalProps = {\n  onCancel: () => void;\n  visible: boolean;\n  experimentIds: string[];\n  searchFacetsState: ExperimentPageSearchFacetsState;\n  uiState: ExperimentPageUIState;\n};\n\ntype ShareableViewState = ExperimentPageSearchFacetsState & ExperimentPageUIState;\n\n/**\n * Modal that displays shareable link for the experiment page.\n * The shareable state is created by serializing the search facets and UI state and storing\n * it as a tag on the experiment.\n */\nexport const ExperimentGetShareLinkModal = ({\n  onCancel,\n  visible,\n  experimentIds,\n  searchFacetsState,\n  uiState,\n}: GetShareLinkModalProps) => {\n  const [sharedStateUrl, setSharedStateUrl] = useState<string>('');\n  const [linkInProgress, setLinkInProgress] = useState(true);\n  const [generatedState, setGeneratedState] = useState<ShareableViewState | null>(null);\n\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const stateToSerialize = useMemo(() => ({ ...searchFacetsState, ...uiState }), [searchFacetsState, uiState]);\n\n  const createSerializedState = useCallback(\n    async (state: ShareableViewState) => {\n      if (experimentIds.length > 1) {\n        setLinkInProgress(false);\n        setGeneratedState(state);\n        setSharedStateUrl(window.location.href);\n        return;\n      }\n      setLinkInProgress(true);\n      const [experimentId] = experimentIds;\n      const data = JSON.stringify(state);\n      const hash = await getStringSHA256(data);\n\n      const tagName = `${EXPERIMENT_PAGE_VIEW_STATE_SHARE_TAG_PREFIX}${hash}`;\n\n      dispatch(setExperimentTagApi(experimentId, tagName, data))\n        .then(() => {\n          setLinkInProgress(false);\n          setGeneratedState(state);\n          const pageRoute = Routes.getExperimentPageRoute(experimentId, false, hash);\n          const shareURL = `${window.location.origin}${window.location.pathname}#${pageRoute}`;\n          setSharedStateUrl(shareURL);\n        })\n        .catch((e) => {\n          Utils.logErrorAndNotifyUser('Failed to create shareable link for experiment');\n          throw e;\n        });\n    },\n    [dispatch, experimentIds],\n  );\n\n  useEffect(() => {\n    if (!visible || generatedState === stateToSerialize) {\n      return;\n    }\n    createSerializedState(stateToSerialize);\n  }, [visible, createSerializedState, generatedState, stateToSerialize]);\n\n  return (\n    <Modal\n      title={\n        <FormattedMessage\n          defaultMessage=\"Get shareable link\"\n          description={'Title text for the experiment \"Get link\" modal'}\n        />\n      }\n      visible={visible}\n      onCancel={onCancel}\n    >\n      <div css={{ display: 'flex', gap: 8 }}>\n        {linkInProgress ? (\n          <GenericSkeleton css={{ flex: 1 }} />\n        ) : (\n          <Input placeholder=\"Click button on the right to create shareable state\" value={sharedStateUrl} readOnly />\n        )}\n        <CopyButton loading={linkInProgress} copyText={sharedStateUrl} />\n      </div>\n    </Modal>\n  );\n};\n","import { Button } from '@databricks/design-system';\nimport { useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { GetLinkModal } from '../../../modals/GetLinkModal';\nimport { ExperimentPageSearchFacetsState } from '../../models/ExperimentPageSearchFacetsState';\nimport { ExperimentPageUIState } from '../../models/ExperimentPageUIState';\nimport { ExperimentGetShareLinkModal } from './ExperimentGetShareLinkModal';\n\n/**\n * Experiment page header part responsible for displaying button\n * that displays modal for sharing the link\n */\nexport const ExperimentViewHeaderShareButton = ({\n  searchFacetsState,\n  uiState,\n  experimentIds,\n}: {\n  searchFacetsState?: ExperimentPageSearchFacetsState;\n  uiState?: ExperimentPageUIState;\n  experimentIds?: string[];\n}) => {\n  const [showGetLinkModal, setShowGetLinkModal] = useState(false);\n\n  return (\n    <>\n      {searchFacetsState && uiState && experimentIds ? (\n        <ExperimentGetShareLinkModal\n          searchFacetsState={searchFacetsState}\n          uiState={uiState}\n          visible={showGetLinkModal}\n          onCancel={() => setShowGetLinkModal(false)}\n          experimentIds={experimentIds}\n        />\n      ) : (\n        <GetLinkModal\n          link={window.location.href}\n          visible={showGetLinkModal}\n          onCancel={() => setShowGetLinkModal(false)}\n        />\n      )}\n      {/* TODO: ensure that E2E tests are working after refactor is complete */}\n      <Button\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_header_experimentviewheadersharebutton.tsx_44\"\n        type=\"primary\"\n        onClick={() => setShowGetLinkModal(true)}\n        data-test-id=\"share-button\"\n      >\n        <FormattedMessage defaultMessage=\"Share\" description=\"Text for share button on experiment view page header\" />\n      </Button>\n    </>\n  );\n};\n","import React, { useMemo } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { PageHeader } from '../../../../../shared/building_blocks/PageHeader';\nimport { ExperimentViewHeaderShareButton } from './ExperimentViewHeaderShareButton';\nimport { ExperimentEntity } from '../../../../types';\n\n/**\n * Header for experiment compare page. Displays title and breadcrumbs.\n */\nexport const ExperimentViewHeaderCompare = React.memo(({ experiments }: { experiments: ExperimentEntity[] }) => {\n  const pageTitle = useMemo(\n    () => (\n      <FormattedMessage\n        defaultMessage=\"Displaying Runs from {numExperiments} Experiments\"\n        description=\"Message shown when displaying runs from multiple experiments\"\n        values={{\n          numExperiments: experiments.length,\n        }}\n      />\n    ),\n    [experiments.length],\n  );\n\n  // eslint-disable-next-line prefer-const\n  let breadcrumbs: React.ReactNode[] = [];\n\n  return (\n    <PageHeader title={pageTitle} breadcrumbs={breadcrumbs}>\n      <ExperimentViewHeaderShareButton />\n    </PageHeader>\n  );\n});\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { ConfirmModal } from './ConfirmModal';\nimport { connect } from 'react-redux';\nimport { openErrorModal, restoreRunApi } from '../../actions';\nimport Utils from '../../../common/utils/Utils';\n\ntype Props = {\n  isOpen: boolean;\n  onClose: (...args: any[]) => any;\n  selectedRunIds: string[];\n  openErrorModal: (...args: any[]) => any;\n  restoreRunApi: (...args: any[]) => any;\n  onSuccess?: () => void;\n};\n\nexport class RestoreRunModalImpl extends Component<Props> {\n  constructor(props: Props) {\n    super(props);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleSubmit() {\n    const restorePromises: any = [];\n    this.props.selectedRunIds.forEach((runId) => {\n      restorePromises.push(this.props.restoreRunApi(runId));\n    });\n    return Promise.all(restorePromises)\n      .catch((e) => {\n        let errorMessage = 'While restoring an experiment run, an error occurred.';\n        if (e.textJson && e.textJson.error_code === 'RESOURCE_LIMIT_EXCEEDED') {\n          errorMessage = errorMessage + ' ' + e.textJson.message;\n        }\n        this.props.openErrorModal(errorMessage);\n      })\n      .then(() => {\n        this.props.onSuccess?.();\n      });\n  }\n\n  render() {\n    const number = this.props.selectedRunIds.length;\n    return (\n      <ConfirmModal\n        isOpen={this.props.isOpen}\n        onClose={this.props.onClose}\n        handleSubmit={this.handleSubmit}\n        title={`Restore Experiment ${Utils.pluralize('Run', number)}`}\n        helpText={`${number} experiment ${Utils.pluralize('run', number)} will be restored.`}\n        confirmButtonText=\"Restore\"\n      />\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  restoreRunApi,\n  openErrorModal,\n};\n\nexport default connect(null, mapDispatchToProps)(RestoreRunModalImpl);\n","import { useCallback } from 'react';\nimport DeleteRunModal from '../../../modals/DeleteRunModal';\nimport { RenameRunModal } from '../../../modals/RenameRunModal';\nimport RestoreRunModal from '../../../modals/RestoreRunModal';\n\nexport interface ExperimentViewModalsProps {\n  showDeleteRunModal: boolean;\n  showRestoreRunModal: boolean;\n  showRenameRunModal: boolean;\n  runsSelected: Record<string, boolean>;\n  onCloseDeleteRunModal: () => void;\n  onCloseRestoreRunModal: () => void;\n  onCloseRenameRunModal: () => void;\n  renamedRunName: string;\n  refreshRuns: () => void;\n}\n\n/**\n * A component that contains modals required for the run\n * management, i.e. delete and restore actions.\n */\nexport const ExperimentViewRunModals = ({\n  showDeleteRunModal,\n  showRestoreRunModal,\n  showRenameRunModal,\n  runsSelected,\n  onCloseDeleteRunModal,\n  onCloseRestoreRunModal,\n  onCloseRenameRunModal,\n  renamedRunName,\n  refreshRuns,\n}: ExperimentViewModalsProps) => {\n  const selectedRunIds = Object.entries(runsSelected)\n    .filter(([, selected]) => selected)\n    .map(([key]) => key);\n\n  return (\n    <>\n      <DeleteRunModal\n        isOpen={showDeleteRunModal}\n        onClose={onCloseDeleteRunModal}\n        selectedRunIds={selectedRunIds}\n        onSuccess={() => {\n          refreshRuns();\n        }}\n      />\n      <RestoreRunModal\n        isOpen={showRestoreRunModal}\n        onClose={onCloseRestoreRunModal}\n        selectedRunIds={selectedRunIds}\n        onSuccess={() => {\n          refreshRuns();\n        }}\n      />\n      <RenameRunModal\n        runUuid={selectedRunIds[0]}\n        onClose={onCloseRenameRunModal}\n        runName={renamedRunName}\n        isOpen={showRenameRunModal}\n        onSuccess={() => {\n          refreshRuns();\n        }}\n      />\n    </>\n  );\n};\n","import { Button } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { useCallback, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { useNavigate } from '../../../../../common/utils/RoutingUtils';\nimport { Tooltip } from '@databricks/design-system';\nimport { LIFECYCLE_FILTER } from '../../../../constants';\nimport Routes from '../../../../routes';\nimport { ExperimentPageViewState } from '../../models/ExperimentPageViewState';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRunModals } from './ExperimentViewRunModals';\nimport { ExperimentPageSearchFacetsState } from '../../models/ExperimentPageSearchFacetsState';\nimport { RunInfoEntity } from '../../../../types';\n\nexport type ExperimentViewRunsControlsActionsProps = {\n  viewState: ExperimentPageViewState;\n  searchFacetsState: ExperimentPageSearchFacetsState;\n  runsData: ExperimentRunsSelectorResult;\n  refreshRuns: () => void;\n};\n\nconst CompareRunsButtonWrapper: React.FC = ({ children }) => <>{children}</>;\n\nexport const ExperimentViewRunsControlsActions = React.memo(\n  ({ viewState, runsData, searchFacetsState, refreshRuns }: ExperimentViewRunsControlsActionsProps) => {\n    const { runsSelected } = viewState;\n    const { runInfos } = runsData;\n    const { lifecycleFilter } = searchFacetsState;\n\n    const navigate = useNavigate();\n\n    const [showDeleteRunModal, setShowDeleteRunModal] = useState(false);\n    const [showRestoreRunModal, setShowRestoreRunModal] = useState(false);\n    const [showRenameRunModal, setShowRenameRunModal] = useState(false);\n    const [renamedRunName, setRenamedRunName] = useState('');\n\n    const renameButtonClicked = useCallback(() => {\n      const runsSelectedList = Object.keys(runsSelected);\n      const selectedRun = runInfos.find((info) => info.runUuid === runsSelectedList[0]);\n      if (selectedRun) {\n        setRenamedRunName(selectedRun.runName);\n        setShowRenameRunModal(true);\n      }\n    }, [runInfos, runsSelected]);\n\n    const compareButtonClicked = useCallback(() => {\n      const runsSelectedList = Object.keys(runsSelected);\n      const experimentIds = runInfos\n        .filter(({ runUuid }: RunInfoEntity) => runsSelectedList.includes(runUuid))\n        .map(({ experimentId }: any) => experimentId);\n\n      navigate(Routes.getCompareRunPageRoute(runsSelectedList, [...new Set(experimentIds)].sort()));\n    }, [navigate, runInfos, runsSelected]);\n\n    const onDeleteRun = useCallback(() => setShowDeleteRunModal(true), []);\n    const onRestoreRun = useCallback(() => setShowRestoreRunModal(true), []);\n    const onCloseDeleteRunModal = useCallback(() => setShowDeleteRunModal(false), []);\n    const onCloseRestoreRunModal = useCallback(() => setShowRestoreRunModal(false), []);\n    const onCloseRenameRunModal = useCallback(() => setShowRenameRunModal(false), []);\n\n    const selectedRunsCount = Object.values(viewState.runsSelected).filter(Boolean).length;\n    const canRestoreRuns = selectedRunsCount > 0;\n    const canRenameRuns = selectedRunsCount === 1;\n    const canCompareRuns = selectedRunsCount > 1;\n    const showActionButtons = canCompareRuns || canRenameRuns || canRestoreRuns;\n\n    return (\n      <>\n        <div css={styles.controlBar}>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactions.tsx_110\"\n            data-testid=\"run-rename-button\"\n            onClick={renameButtonClicked}\n            disabled={!canRenameRuns}\n          >\n            <FormattedMessage\n              defaultMessage=\"Rename\"\n              description=\"Label for the rename run button above the experiment runs table\"\n            />\n          </Button>\n          {lifecycleFilter === LIFECYCLE_FILTER.ACTIVE ? (\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactions.tsx_117\"\n              data-testid=\"runs-delete-button\"\n              disabled={!canRestoreRuns}\n              onClick={onDeleteRun}\n              danger\n            >\n              <FormattedMessage\n                defaultMessage=\"Delete\"\n                // eslint-disable-next-line max-len\n                description=\"String for the delete button to delete a particular experiment run\"\n              />\n            </Button>\n          ) : null}\n          {lifecycleFilter === LIFECYCLE_FILTER.DELETED ? (\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactions.tsx_126\"\n              data-testid=\"runs-restore-button\"\n              disabled={!canRestoreRuns}\n              onClick={onRestoreRun}\n            >\n              <FormattedMessage\n                defaultMessage=\"Restore\"\n                // eslint-disable-next-line max-len\n                description=\"String for the restore button to undo the experiments that were deleted\"\n              />\n            </Button>\n          ) : null}\n          <div css={styles.buttonSeparator} />\n          <CompareRunsButtonWrapper>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactions.tsx_136\"\n              data-testid=\"runs-compare-button\"\n              disabled={!canCompareRuns}\n              onClick={compareButtonClicked}\n            >\n              <FormattedMessage\n                defaultMessage=\"Compare\"\n                // eslint-disable-next-line max-len\n                description=\"String for the compare button to compare experiment runs to find an ideal model\"\n              />\n            </Button>\n          </CompareRunsButtonWrapper>\n        </div>\n        <ExperimentViewRunModals\n          runsSelected={runsSelected}\n          onCloseRenameRunModal={onCloseRenameRunModal}\n          onCloseDeleteRunModal={onCloseDeleteRunModal}\n          onCloseRestoreRunModal={onCloseRestoreRunModal}\n          showDeleteRunModal={showDeleteRunModal}\n          showRestoreRunModal={showRestoreRunModal}\n          showRenameRunModal={showRenameRunModal}\n          renamedRunName={renamedRunName}\n          refreshRuns={refreshRuns}\n        />\n      </>\n    );\n  },\n);\n\nconst styles = {\n  buttonSeparator: (theme: Theme) => ({\n    borderLeft: `1px solid ${theme.colors.border}`,\n    marginLeft: theme.spacing.xs,\n    marginRight: theme.spacing.xs,\n    height: '100%',\n  }),\n  controlBar: (theme: Theme) => ({\n    display: 'flex',\n    gap: theme.spacing.sm,\n    alignItems: 'center',\n  }),\n};\n","import { Button, SyncIcon, Tooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useEffect, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { connect } from 'react-redux';\nimport { MAX_DETECT_NEW_RUNS_RESULTS, POLL_INTERVAL } from '../../../../constants';\nimport { ExperimentStoreEntities } from '../../../../types';\nimport { useExperimentIds } from '../../hooks/useExperimentIds';\nimport { searchRunsPayload } from '../../../../actions';\n\nexport interface ExperimentViewRefreshButtonProps {\n  runInfos: ExperimentStoreEntities['runInfosByUuid'];\n  refreshRuns?: () => void;\n}\n\n/**\n * A component that displays \"refresh runs\" button with the relevant number\n * of the new runs and handles the refresh action.\n */\nexport const ExperimentViewRefreshButtonImpl = React.memo(\n  (props: React.PropsWithChildren<ExperimentViewRefreshButtonProps>) => {\n    const { runInfos } = props;\n    const { theme } = useDesignSystemTheme();\n\n    const { refreshRuns } = props;\n\n    const experimentIds = useExperimentIds();\n\n    // Keeps the time of the last runs fetch\n    const [lastFetchTime, setLastFetchTime] = useState(0);\n\n    // Keeps the number of available new runs\n    const [newRunsCount, setNewRunsCount] = useState(0);\n\n    // We're resetting number of new runs and the fetch date\n    // every time when the runs payload has changed\n    useEffect(() => {\n      setNewRunsCount(0);\n      setLastFetchTime(() => Date.now());\n    }, [runInfos]);\n\n    useEffect(\n      () => {\n        if (!lastFetchTime) {\n          return undefined;\n        }\n        const interval = setInterval(() => {\n          // Let's query for new runs that have started after a certain time\n          const searchPayloadData: any = {\n            experimentIds,\n            filter: `attributes.start_time > ${lastFetchTime}`,\n            // We're not interested in more than 26 new runs\n            maxResults: MAX_DETECT_NEW_RUNS_RESULTS,\n          };\n          searchRunsPayload(searchPayloadData).then((result) => {\n            const newRuns = result.runs?.length || 0;\n            setNewRunsCount(newRuns);\n          });\n        }, POLL_INTERVAL);\n        return () => clearInterval(interval);\n      },\n      // We're resetting the interval each time the reference time or experiment IDs have changed\n      [lastFetchTime, experimentIds],\n    );\n\n    return (\n      <div css={{ position: 'relative' }}>\n        {/* Replace this bespoke Badge item with Dubois component if it ever becomes available. */}\n        {newRunsCount > 0 && (\n          <div\n            title={\n              MAX_DETECT_NEW_RUNS_RESULTS > newRunsCount ? `${newRunsCount}` : `${MAX_DETECT_NEW_RUNS_RESULTS - 1}+`\n            }\n            css={{\n              position: 'absolute',\n              top: 0,\n              right: 0,\n              transform: 'translate(50%, -50%)',\n              display: 'flex',\n              justifyContent: 'center',\n              alignItems: 'center',\n              width: newRunsCount > 9 ? 28 : 20, // Makes the badge wider when count is more than 2 digits\n              height: 20,\n              borderRadius: 10,\n              border: `1px solid ${theme.colors.white}`,\n              backgroundColor: theme.colors.lime, // Why lime?\n              color: theme.colors.white,\n              fontSize: 10,\n              fontWeight: 'bold',\n              userSelect: 'none',\n              zIndex: 1,\n            }}\n          >\n            {MAX_DETECT_NEW_RUNS_RESULTS > newRunsCount ? newRunsCount : `${MAX_DETECT_NEW_RUNS_RESULTS - 1}+`}\n          </div>\n        )}\n        <Tooltip\n          title={\n            <FormattedMessage\n              defaultMessage=\"Refresh\"\n              description=\"refresh button text to refresh the experiment runs\"\n            />\n          }\n          useAsLabel\n        >\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrefreshbutton.tsx_123\"\n            onClick={refreshRuns}\n            data-testid=\"runs-refresh-button\"\n            icon={<SyncIcon />}\n          />\n        </Tooltip>\n      </div>\n    );\n  },\n);\n\n/**\n * The only thing that we're interested in the store is the current set of runInfos.\n * We're going to monitor it so we will know when new runs are fetched.\n */\nconst mapStateToProps = (state: { entities: ExperimentStoreEntities }) => {\n  return { runInfos: state.entities.runInfosByUuid };\n};\n\nexport const ExperimentViewRefreshButton = connect(mapStateToProps, undefined, undefined, {\n  // We're interested only in \"entities\" sub-tree so we won't\n  // re-render on other state changes (e.g. API request IDs)\n  areStatesEqual: (nextState, prevState) => nextState.entities.runInfosByUuid === prevState.entities.runInfosByUuid,\n})(ExperimentViewRefreshButtonImpl);\n","import { useMemo } from 'react';\nimport LocalStorageUtils from '../../../../common/utils/LocalStorageUtils';\n\n/**\n * This hook returns a memoized version of persistable store namespaced for the ExperimentView.\n * It can serve as a store for persisting state for a particular experiment - in this case,\n * the experiment id should be provided as a `identifier` parameter. It can also serve as a store for some\n * general purpose - e.g. you can provide \"onboarding\" as a identifier to get a store specific\n * for the onboarding section of the experiment view.\n *\n * @param storeIdentifier a unique identifier of created store - can be an experiment id or a general purpose name\n */\nexport const useExperimentViewLocalStore = (storeIdentifier: string) =>\n  useMemo(() => LocalStorageUtils.getStoreForComponent('ExperimentView', storeIdentifier), [storeIdentifier]);\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentSearchSyntaxDocUrl } from '../../../../../common/constants';\n\nexport const RunsSearchTooltipContent = () => {\n  return (\n    <div className=\"search-input-tooltip-content\">\n      <FormattedMessage\n        defaultMessage=\"Search runs using a simplified version of the SQL {whereBold} clause.\"\n        description=\"Tooltip string to explain how to search runs from the experiments table\"\n        values={{ whereBold: <b>WHERE</b> }}\n      />{' '}\n      <FormattedMessage\n        defaultMessage=\"<link>Learn more</link>\"\n        description=\"Learn more tooltip link to learn more on how to search in an experiments run table\"\n        values={{\n          link: (chunks: any) => (\n            <a href={ExperimentSearchSyntaxDocUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              {chunks}\n            </a>\n          ),\n        }}\n      />\n      <br />\n      <FormattedMessage defaultMessage=\"Examples:\" description=\"Text header for examples of mlflow search syntax\" />\n      <br />\n      {' metrics.rmse >= 0.8'}\n      <br />\n      {' metrics.`f1 score` < 1'}\n      <br />\n       params.model = 'tree'\n      <br />\n       attributes.run_name = 'my run'\n      <br />\n       tags.`mlflow.user` = 'myUser'\n      <br />\n      {\" metric.f1_score > 0.9 AND params.model = 'tree'\"}\n      <br />\n       dataset.name IN ('dataset1', 'dataset2')\n      <br />\n       attributes.run_id IN ('a1b2c3d4', 'e5f6g7h8')\n      <br /> tags.model_class LIKE 'sklearn.linear_model%'\n    </div>\n  );\n};\n","import React from 'react';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\n\nexport type Option = {\n  label?: string | React.ReactNode;\n  value: string;\n};\n\nexport type OptionGroup = {\n  label: string;\n  options: Option[];\n};\n\nexport type Entity = {\n  name: string;\n  startIndex: number;\n  endIndex: number;\n};\n\nexport type Clause = {\n  clause: string;\n  startIndex: number;\n};\n\nexport type EntityNameGroup = {\n  metricNames: string[];\n  paramNames: string[];\n  tagNames: string[];\n};\n\nexport const ATTRIBUTE_OPTIONS = [\n  'run_id',\n  'run_name',\n  'status',\n  'artifact_uri',\n  'user_id',\n  'start_time',\n  'end_time',\n  'created',\n].map((s) => ({ value: `attributes.${s}` }));\n\nexport const getEntityNamesFromRunsData = (\n  newRunsData: ExperimentRunsSelectorResult,\n  existingNames: EntityNameGroup,\n): EntityNameGroup => {\n  const mergeDedup = (list1: any[], list2: any[]) => [...new Set([...list1, ...list2])];\n  const getTagNames = (tagsList: any[]) => tagsList.flatMap((tagRecord) => Object.keys(tagRecord));\n\n  const metricNames = mergeDedup(existingNames.metricNames, newRunsData.metricKeyList);\n  const paramNames = mergeDedup(existingNames.paramNames, newRunsData.paramKeyList);\n  const tagNames = mergeDedup(getTagNames(existingNames.tagNames), getTagNames(newRunsData.tagsList));\n  // Filter out internal tag names and wrap names that include control characters in backticks.\n  const tagNamesCleaned = tagNames\n    .filter((s: string) => !s.startsWith('mlflow.'))\n    .map((s: string) => {\n      if (s.includes('\"') || s.includes(' ') || s.includes('.')) {\n        return `\\`${s}\\``;\n      } else if (s.includes('`')) {\n        return `\"${s}\"`;\n      } else return s;\n    });\n  return {\n    metricNames,\n    paramNames,\n    tagNames: tagNamesCleaned,\n  };\n};\n\nexport const getOptionsFromEntityNames = (entityNames: EntityNameGroup): OptionGroup[] => [\n  {\n    label: 'Metrics',\n    options: entityNames.metricNames.map((m) => ({ value: `metrics.${m}` })),\n  },\n  {\n    label: 'Parameters',\n    options: entityNames.paramNames.map((p) => ({ value: `params.${p}` })),\n  },\n  {\n    label: 'Tags',\n    options: entityNames.tagNames.map((t) => ({ value: `tags.${t}` })),\n  },\n  {\n    label: 'Attributes',\n    options: ATTRIBUTE_OPTIONS,\n  },\n];\n\n// Bolds a specified segment of `wholeText`.\nconst boldedText = (wholeText: string, shouldBeBold: string) => {\n  const textArray = wholeText.split(RegExp(shouldBeBold.replace('.', '\\\\.'), 'ig'));\n  const match = wholeText.match(RegExp(shouldBeBold.replace('.', '\\\\.'), 'ig'));\n\n  return (\n    // Autocomplete sets font weight to 600 on full match resulting in double bolding.\n    // Override this here\n    <span css={{ fontWeight: 'normal' }} data-test-id={wholeText}>\n      {textArray.map((item, index) => (\n        <React.Fragment key={index}>\n          {item}\n          {index !== textArray.length - 1 && match && <b>{match[index]}</b>}\n        </React.Fragment>\n      ))}\n    </span>\n  );\n};\n\n/**\n * Given an input string, returns a list of Clause objects\n * containing the clauses in the input and the indices of their\n * starting positions in the overall string.\n */\nconst getClausesAndStartIndex = (str: string) => {\n  const re = /and[\\s]+/gi;\n  const results: Clause[] = [];\n  let match, position;\n  while (((position = re.lastIndex), (match = re.exec(str)))) {\n    results.push({ clause: str.substring(position, match.index), startIndex: position });\n  }\n  results.push({ clause: str.substring(position), startIndex: position });\n  return results;\n};\n\n/**\n * Given an input string, returns a list of Entity objects\n * containing the search entities in the input and their\n * start and end indices in the whole string.\n */\n\nexport const getEntitiesAndIndices = (str: string) => {\n  const re = />|<|>=|<=|=|!=|like|ilike/gi;\n  const clauses = getClausesAndStartIndex(str);\n  const results: Entity[] = [];\n  clauses.forEach((clauseObj) => {\n    const clauseText = clauseObj.clause;\n    const entity = clauseText.split(re)[0];\n    const { startIndex } = clauseObj;\n    results.push({\n      name: entity,\n      startIndex: 0 + startIndex,\n      endIndex: entity.length + startIndex,\n    });\n  });\n  return results;\n};\n\nexport const getFilteredOptionsFromEntityName = (\n  baseOptions: OptionGroup[],\n  entityBeingEdited: Entity,\n  suggestionLimits: any,\n): OptionGroup[] => {\n  return baseOptions\n    .map((group) => {\n      const newOptions = group.options\n        .filter((option) => option.value.toLowerCase().includes(entityBeingEdited.name.toLowerCase().trim()))\n        .map((match) => ({\n          value: match.value,\n          label: boldedText(match.value, entityBeingEdited.name.trim()),\n        }));\n      const limitForGroup = (suggestionLimits as any)[group.label];\n      const ellipsized = [\n        ...newOptions.slice(0, limitForGroup),\n        ...(newOptions.length > limitForGroup ? [{ label: '...', value: `..._${group.label}` }] : []),\n      ];\n      return {\n        label: group.label,\n        options: ellipsized,\n      };\n    })\n    .filter((group) => group.options.length > 0);\n};\n","import { isEqual } from 'lodash';\nimport React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport {\n  AutoComplete,\n  Input,\n  SearchIcon,\n  Tooltip,\n  InfoIcon,\n  Button,\n  CloseIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ErrorWrapper } from '../../../../../common/utils/ErrorWrapper';\nimport { useExperimentViewLocalStore } from '../../hooks/useExperimentViewLocalStore';\nimport { RunsSearchTooltipContent } from './RunsSearchTooltipContent';\nimport {\n  Entity,\n  EntityNameGroup,\n  getEntitiesAndIndices,\n  getEntityNamesFromRunsData,\n  getFilteredOptionsFromEntityName,\n  getOptionsFromEntityNames,\n  OptionGroup,\n} from './RunsSearchAutoComplete.utils';\n\n// A default placeholder for the search box\nconst SEARCH_BOX_PLACEHOLDER = 'metrics.rmse < 1 and params.model = \"tree\"';\nconst TOOLTIP_COOKIE_KEY = 'tooltipLastPopup';\nconst WEEK_IN_SECONDS = 604800;\n\nexport type RunsSearchAutoCompleteProps = {\n  runsData: ExperimentRunsSelectorResult;\n  searchFilter: string;\n  onSearchFilterChange: (newValue: string) => void;\n  onClear: () => void;\n  requestError: ErrorWrapper | null;\n};\n\n/**\n * Autocomplete component that provides suggestions for MLflow search entity names.\n */\nexport const RunsSearchAutoComplete = (props: RunsSearchAutoCompleteProps) => {\n  const { runsData, searchFilter, requestError, onSearchFilterChange, onClear } = props;\n  const { theme } = useDesignSystemTheme();\n\n  const [text, setText] = useState<string>('');\n  const [autocompleteEnabled, setAutocompleteEnabled] = useState<boolean | undefined>(undefined);\n  const [focused, setFocused] = useState(false);\n  const onFocus = () => setFocused(true);\n  const onBlur = () => setFocused(false);\n  // Determines whether the text was changed by making a selection in the autocomplete\n  // dialog, as opposed to by typing.\n  const [lastSetBySelection, setLastSetBySelection] = useState(false);\n  const existingEntityNamesRef = useRef<EntityNameGroup>({\n    metricNames: [],\n    paramNames: [],\n    tagNames: [],\n  });\n  // How many suggestions should be shown per entity group before the group is ellipsized.\n  const [suggestionLimits, setSuggestionLimits] = useState({\n    Metrics: 10,\n    Parameters: 10,\n    Tags: 10,\n  });\n  // List of entities parsed from `text`.\n  const currentEntitiesRef = useRef<Entity[]>([]);\n  const [entityBeingEdited, setEntityBeingEdited] = useState<Entity | undefined>(undefined);\n\n  // Each time we're setting search filter externally, update it here as well\n  useEffect(() => {\n    setText(searchFilter);\n  }, [searchFilter]);\n\n  const baseOptions = useMemo<OptionGroup[]>(() => {\n    const existingEntityNames = existingEntityNamesRef.current;\n    const mergedEntityNames = getEntityNamesFromRunsData(runsData, existingEntityNames);\n    existingEntityNamesRef.current = mergedEntityNames;\n    return getOptionsFromEntityNames(mergedEntityNames);\n    // existingEntityNamesRef is only set here. Omit from dependencies to avoid infinite loop\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [runsData]);\n\n  useEffect(() => {\n    const previousEntities = currentEntitiesRef.current;\n    const newEntities = getEntitiesAndIndices(text);\n    currentEntitiesRef.current = newEntities;\n\n    if (lastSetBySelection) {\n      setLastSetBySelection(false);\n      return;\n    }\n    const currentEntitiesNames = newEntities.map((e) => e.name);\n    const previousEntitiesNames = previousEntities.map((e) => e.name);\n    if (!isEqual(currentEntitiesNames, previousEntitiesNames) && newEntities.length >= previousEntities.length) {\n      let i = 0;\n      while (i < newEntities.length) {\n        if (i >= previousEntities.length || newEntities[i].name.trim() !== previousEntities[i].name.trim()) {\n          setAutocompleteEnabled(true);\n          setEntityBeingEdited(newEntities[i]);\n          return;\n        }\n        i++;\n      }\n    }\n    // If here, no entity is being edited\n    setAutocompleteEnabled(false);\n    // currentEntitiesRef is not used anywhere else and state setters are safe to\n    // omit from hook dependencies as per react docs\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [text]);\n\n  const filteredOptions = useMemo(() => {\n    if (!entityBeingEdited) {\n      return [];\n    }\n    return getFilteredOptionsFromEntityName(baseOptions, entityBeingEdited, suggestionLimits);\n  }, [baseOptions, entityBeingEdited, suggestionLimits]);\n\n  /**\n   * Called when an option is picked from the autocomplete dropdown, either by hitting enter\n   * when selected, or clicking on it\n   * @param value\n   */\n  const onSelect = useCallback(\n    (value: string, option: any) => {\n      if (!entityBeingEdited) {\n        return;\n      }\n      if (value.startsWith('...')) {\n        // Keep the dialog open as this is not a real selection\n        setAutocompleteEnabled(true);\n        const groupName = option.value.split('_')[1];\n        setSuggestionLimits((prevSuggestionLimits) => ({\n          ...prevSuggestionLimits,\n          [groupName]: (prevSuggestionLimits as any)[groupName] + 10,\n        }));\n      } else {\n        const prefix = text.substring(0, entityBeingEdited.startIndex);\n        const suffix = text.substring(entityBeingEdited.endIndex);\n        setText(prefix + value + ' ' + suffix);\n        setLastSetBySelection(true);\n        setAutocompleteEnabled(false);\n      }\n    },\n    [text, setText, entityBeingEdited, setAutocompleteEnabled],\n  );\n\n  const localStorageInstance = useExperimentViewLocalStore(TOOLTIP_COOKIE_KEY);\n\n  const [showTooltipOnError, setShowTooltipOnError] = useState(() => {\n    const currentTimeSecs = Math.floor(Date.now() / 1000);\n    const storedItem = localStorageInstance.getItem(TOOLTIP_COOKIE_KEY);\n    // Show tooltip again if it was last shown 1 week ago or older\n    return !storedItem || parseInt(storedItem, 10) < currentTimeSecs - WEEK_IN_SECONDS;\n  });\n  const tooltipIcon = React.useRef<HTMLButtonElement>(null);\n\n  // If requestError has changed and there is an error, pop up the tooltip\n  useEffect(() => {\n    if (requestError && showTooltipOnError) {\n      const currentTimeSecs = Math.floor(Date.now() / 1000);\n      localStorageInstance.setItem(TOOLTIP_COOKIE_KEY, currentTimeSecs);\n      setShowTooltipOnError(false);\n      tooltipIcon.current?.click();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [requestError]);\n\n  const noMatches = filteredOptions.flatMap((o) => o.options).length === 0;\n  const open = autocompleteEnabled && focused && !noMatches;\n\n  // Callback fired when search filter is being used\n  const triggerSearch: React.KeyboardEventHandler<HTMLInputElement> = useCallback(\n    (e) => {\n      if (e.key === 'Enter') {\n        // If the autocomplete dialog is open, use the enter key to make a selection\n        // rather than initiate search.\n        if (open) {\n          setAutocompleteEnabled(false);\n        } else {\n          onSearchFilterChange(text);\n        }\n      }\n      if (e.key === 'Escape') {\n        e.preventDefault();\n        if (open) {\n          setAutocompleteEnabled(false);\n        }\n      }\n    },\n    [open, text, onSearchFilterChange],\n  );\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        gap: theme.spacing.sm,\n        width: 430,\n        [theme.responsive.mediaQueries.xs]: {\n          width: 'auto',\n        },\n      }}\n    >\n      <AutoComplete\n        dropdownMatchSelectWidth={560}\n        css={{\n          width: 560,\n          [theme.responsive.mediaQueries.xs]: {\n            width: 'auto',\n          },\n        }}\n        defaultOpen={false}\n        defaultActiveFirstOption\n        open={open}\n        options={filteredOptions}\n        onSelect={onSelect}\n        value={text}\n        data-test-id=\"runs-search-autocomplete\"\n        dropdownRender={(menu) => (\n          <div\n            css={{\n              '.du-bois-light-select-item-option-active:not(.du-bois-light-select-item-option-disabled)': {\n                // TODO: ask the design team about the color existing in the palette\n                backgroundColor: '#e6f1f5',\n              },\n            }}\n          >\n            {menu}\n          </div>\n        )}\n      >\n        <Input\n          value={text}\n          prefix={\n            <SearchIcon\n              css={{\n                svg: { width: 16, height: 16, color: theme.colors.textSecondary },\n              }}\n            />\n          }\n          onKeyDown={triggerSearch}\n          onClick={onFocus}\n          onBlur={onBlur}\n          onChange={(e) => setText(e.target.value)}\n          placeholder={SEARCH_BOX_PLACEHOLDER}\n          data-test-id=\"search-box\"\n          suffix={\n            <div css={{ display: 'flex', gap: 4, alignItems: 'center' }}>\n              {text && (\n                <Button\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_runssearchautocomplete.tsx_212\"\n                  onClick={onClear}\n                  type=\"link\"\n                  data-test-id=\"clear-button\"\n                >\n                  <CloseIcon />\n                </Button>\n              )}\n              <Tooltip\n                title={<RunsSearchTooltipContent />}\n                placement=\"right\"\n                dangerouslySetAntdProps={{\n                  overlayInnerStyle: { width: '150%' },\n                  trigger: ['focus', 'click'],\n                }}\n              >\n                <Button\n                  size=\"small\"\n                  ref={tooltipIcon}\n                  componentId=\"mlflow.experiment_page.search_filter.tooltip\"\n                  type=\"link\"\n                  icon={\n                    <InfoIcon\n                      css={{\n                        svg: { width: 16, height: 16, color: theme.colors.textSecondary },\n                      }}\n                    />\n                  }\n                />\n              </Tooltip>\n            </div>\n          }\n        />\n      </AutoComplete>\n    </div>\n  );\n};\n","import {\n  Button,\n  CopyIcon,\n  Input,\n  Modal,\n  TabPane,\n  Tabs,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { CopyButton } from '../../../shared/building_blocks/CopyButton';\n\ntype Props = {\n  isOpen: boolean;\n  closeModal: () => void;\n  experimentId: string;\n};\n\nconst SNIPPET_LINE_HEIGHT = 18;\n\nexport const CreateNotebookRunModal = ({ isOpen, closeModal, experimentId }: Props): JSX.Element => {\n  const { theme } = useDesignSystemTheme();\n\n  const classical_ml_text = `\nimport mlflow\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.datasets import load_diabetes\nfrom sklearn.ensemble import RandomForestRegressor\n\n# set the experiment id\nmlflow.set_experiment(experiment_id=\"${experimentId}\")\n\nmlflow.autolog()\ndb = load_diabetes()\n\nX_train, X_test, y_train, y_test = train_test_split(db.data, db.target)\n\n# Create and train models.\nrf = RandomForestRegressor(n_estimators=100, max_depth=6, max_features=3)\nrf.fit(X_train, y_train)\n\n# Use the model to make predictions on the test dataset.\npredictions = rf.predict(X_test)\n`.trimStart();\n\n  const llm_text = `\nimport mlflow\nimport openai\n\n# you must set the OPENAI_API_KEY environment variable\nassert (\n  \"OPENAI_API_KEY\" in os.environ\n), \"Please set the OPENAI_API_KEY environment variable.\"\n\n# set the experiment id\nmlflow.set_experiment(experiment_id=\"${experimentId}\")\n\nsystem_prompt = (\n  \"The following is a conversation with an AI assistant.\"\n  + \"The assistant is helpful and very friendly.\"\n)\n\n# start a run\nmlflow.start_run()\nmlflow.log_param(\"system_prompt\", system_prompt)\n\n# Create a question answering model using prompt engineering\n# with OpenAI. Log the model to MLflow Tracking\nlogged_model = mlflow.openai.log_model(\n    model=\"gpt-3.5-turbo\",\n    task=openai.ChatCompletion,\n    artifact_path=\"model\",\n    messages=[\n        {\"role\": \"system\", \"content\": system_prompt},\n        {\"role\": \"user\", \"content\": \"{question}\"},\n    ],\n)\n\n# Evaluate the model on some example questions\nquestions = pd.DataFrame(\n    {\n        \"question\": [\n            \"How do you create a run with MLflow?\",\n            \"How do you log a model with MLflow?\",\n            \"What is the capital of France?\",\n        ]\n    }\n)\nmlflow.evaluate(\n    model=logged_model.model_uri,\n    model_type=\"question-answering\",\n    data=questions,\n)\nmlflow.end_run()\n`.trimStart();\n\n  const codeSnippetMessage = () => {\n    return 'Run this code snippet in a notebook or locally, to create an experiment run';\n  };\n\n  // Calculate stable height for the code snippet UI area, based on the line count of the shortest one\n  const snippetHeight =\n    (Math.min(...[classical_ml_text, llm_text].map((text) => text.split('\\n').length)) + 1) * SNIPPET_LINE_HEIGHT;\n\n  return (\n    <Modal\n      visible={isOpen}\n      onCancel={closeModal}\n      onOk={closeModal}\n      footer={\n        <div css={{ display: 'flex', gap: theme.spacing.sm, justifyContent: 'flex-end' }}>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_createnotebookrunmodal.tsx_117\"\n            onClick={closeModal}\n            type=\"primary\"\n          >\n            <FormattedMessage\n              defaultMessage=\"Okay\"\n              description=\"Experiment page > new notebook run modal > okay button label\"\n            />\n          </Button>\n        </div>\n      }\n      title={\n        <div>\n          <Typography.Title level={2} css={{ marginTop: theme.spacing.sm, marginBottom: theme.spacing.xs }}>\n            <FormattedMessage\n              defaultMessage=\"New run using notebook\"\n              description=\"Experiment page > new notebook run modal > modal title\"\n            />\n          </Typography.Title>\n          <Typography.Hint css={{ marginTop: 0, fontWeight: 'normal' }}>{codeSnippetMessage()}</Typography.Hint>\n        </div>\n      }\n    >\n      <Tabs>\n        <TabPane\n          tab={<FormattedMessage defaultMessage=\"Classical ML\" description=\"Example text snippet for classical ML\" />}\n          key=\"classical-ml\"\n        >\n          <CodeSnippet\n            style={{ padding: '5px', height: snippetHeight }}\n            language=\"python\"\n            actions={\n              <div\n                style={{\n                  marginTop: theme.spacing.sm,\n                  marginRight: theme.spacing.md,\n                }}\n              >\n                <CopyButton copyText={classical_ml_text} showLabel={false} icon={<CopyIcon />} />\n              </div>\n            }\n          >\n            {classical_ml_text}\n          </CodeSnippet>\n        </TabPane>\n        <TabPane tab={<FormattedMessage defaultMessage=\"LLM\" description=\"Example text snippet for LLM\" />} key=\"llm\">\n          <CodeSnippet\n            style={{ padding: '5px', height: snippetHeight }}\n            language=\"python\"\n            actions={\n              <div\n                style={{\n                  marginTop: theme.spacing.sm,\n                  marginRight: theme.spacing.md,\n                }}\n              >\n                <CopyButton copyText={llm_text} showLabel={false} icon={<CopyIcon />} />\n              </div>\n            }\n          >\n            {llm_text}\n          </CodeSnippet>\n        </TabPane>\n      </Tabs>\n    </Modal>\n  );\n};\n\nconst styles = {\n  formItem: { marginBottom: 16 },\n};\n","import { ErrorWrapper } from '../../common/utils/ErrorWrapper';\nimport { ModelGatewayRouteTask } from '../sdk/MlflowEnums';\nimport type {\n  EndpointModelChatResponseType,\n  EndpointModelCompletionsResponseType,\n  EndpointModelGatewayResponseType,\n  ModelGatewayChatResponseType,\n  ModelGatewayCompletionsResponseType,\n  ModelGatewayResponseType,\n  ModelGatewayRoute,\n} from '../sdk/ModelGatewayService';\n\nexport class GatewayErrorWrapper extends ErrorWrapper {\n  getGatewayErrorMessage() {\n    return this.textJson?.error?.message || this.textJson?.message || this.textJson?.toString() || this.text;\n  }\n}\nexport const parseEndpointEvaluationResponse = (\n  response: EndpointModelGatewayResponseType,\n  task: ModelGatewayRouteTask,\n) => {\n  // We're supporting completions and chat responses for the time being\n  if (task === ModelGatewayRouteTask.LLM_V1_COMPLETIONS) {\n    const completionsResponse = response as EndpointModelCompletionsResponseType;\n    const text = completionsResponse.choices?.[0]?.text;\n    const { usage } = completionsResponse;\n    if (text && usage) {\n      return {\n        text,\n        metadata: {\n          total_tokens: usage.total_tokens,\n          output_tokens: usage.completion_tokens,\n          input_tokens: usage.prompt_tokens,\n        },\n      };\n    }\n  }\n  if (task === ModelGatewayRouteTask.LLM_V1_CHAT) {\n    const chatResponse = response as EndpointModelChatResponseType;\n    const text = chatResponse.choices?.[0]?.message?.content;\n    const { usage } = chatResponse;\n    if (text && usage) {\n      return {\n        text,\n        metadata: {\n          total_tokens: usage.total_tokens,\n          output_tokens: usage.completion_tokens,\n          input_tokens: usage.prompt_tokens,\n        },\n      };\n    }\n  }\n  // Should not happen since we shouldn't call other route types for now\n  throw new Error(`Unrecognizable AI gateway response metadata \"${response.usage}\"!`);\n};\nexport const parseEvaluationResponse = (\n  response: ModelGatewayResponseType | EndpointModelGatewayResponseType,\n  gatewayRoute: ModelGatewayRoute,\n) => {\n  if (gatewayRoute.type === 'mlflow_deployment_endpoint') {\n    // TODO\n    return parseEndpointEvaluationResponse(response as EndpointModelGatewayResponseType, gatewayRoute.task);\n  }\n  throw new Error(`Unrecognizable served LLM model route type \"${gatewayRoute.type}\"!`);\n};\n","import invariant from 'invariant';\nimport { getJson } from '../../common/utils/FetchUtils';\nimport { MlflowService } from './MlflowService';\nimport { ModelGatewayRouteTask } from './MlflowEnums';\nimport { GatewayErrorWrapper } from '../utils/LLMGatewayUtils';\nimport { fetchEndpoint, HTTPMethods } from '../../common/utils/FetchUtils';\nimport { parseEndpointEvaluationResponse } from '../utils/LLMGatewayUtils';\nexport const DATABRICKS_API_CLIENT_PROMPTLAB = 'PromptLab';\n\nexport interface ModelGatewayQueryPayload {\n  inputText: string;\n  parameters: {\n    temperature?: number;\n    max_tokens?: number;\n    stop?: string[];\n  };\n}\n\nexport interface ModelGatewayResponseMetadata<T extends ModelGatewayRouteTask> {\n  mode: string;\n  route_type: T;\n  total_tokens: number;\n  output_tokens: number;\n  input_tokens: number;\n}\n\nexport interface ModelGatewayCompletionsResponseType {\n  candidates: {\n    text: string;\n    metadata: {\n      finish_reason: string;\n    };\n  }[];\n\n  metadata: ModelGatewayResponseMetadata<ModelGatewayRouteTask.LLM_V1_COMPLETIONS>;\n}\n\nexport interface ModelGatewayChatResponseType {\n  candidates: {\n    message: { role: string; content: string };\n    metadata: {\n      finish_reason: string;\n    };\n  }[];\n\n  metadata: ModelGatewayResponseMetadata<ModelGatewayRouteTask.LLM_V1_CHAT>;\n}\n\nexport type ModelGatewayResponseType = ModelGatewayCompletionsResponseType | ModelGatewayChatResponseType;\n\nexport interface EndpointModelCompletionsResponseType {\n  choices: {\n    text: string;\n    finish_reason: string;\n  }[];\n\n  usage: {\n    completion_tokens: number;\n    prompt_tokens: number;\n    total_tokens: number;\n  };\n}\n\nexport interface EndpointModelChatResponseType {\n  choices: {\n    message: {\n      role: string;\n      content: string;\n    };\n    finish_reason: string;\n  }[];\n\n  usage: {\n    completion_tokens: number;\n    prompt_tokens: number;\n    total_tokens: number;\n  };\n}\n\nexport type EndpointModelGatewayResponseType = EndpointModelCompletionsResponseType | EndpointModelChatResponseType;\n\nexport interface ModelGatewayModelInfo {\n  /**\n   * \"Original\" name of the model (e.g. \"gpt-3.5-turbo\")\n   */\n  name: string;\n  /**\n   * Name of the model provider (e.g. \"OpenAI\")\n   */\n  provider: string;\n}\n\n/**\n * Response object for routes. Does not include model credentials.\n */\nexport interface ModelGatewayRouteLegacy {\n  /**\n   * User-defined name of the model route\n   */\n  name: string;\n  /**\n   * Type of route (e.g., embedding, text generation, etc.)\n   */\n  route_type: ModelGatewayRouteTask;\n  /**\n   * Underlying ML model that can be accessed via this route. Could add other types of resources in the future.\n   */\n  model: ModelGatewayModelInfo;\n}\n\nexport interface MlflowDeploymentsEndpoint {\n  name: string;\n  endpoint_type: ModelGatewayRouteTask;\n  endpoint_url: string;\n  model: ModelGatewayModelInfo;\n}\n\nexport type ModelGatewayRouteType = 'mlflow_deployment_endpoint';\n\nexport interface ModelGatewayRoute {\n  type: ModelGatewayRouteType;\n  /**\n   * Key of the route, the type is always prefix\n   */\n  key: `${ModelGatewayRouteType}:${string}`;\n\n  name: string;\n  /**\n   * Type of route (e.g., embedding, text generation, etc.)\n   */\n  task: ModelGatewayRouteTask;\n  /**\n   * MLflow deployments URL of the endpoint\n   */\n  mlflowDeployment?: MlflowDeploymentsEndpoint;\n}\n\nexport interface SearchMlflowDeploymentsModelRoutesResponse {\n  endpoints: MlflowDeploymentsEndpoint[];\n}\n\nconst gatewayErrorHandler = ({\n  reject,\n  response,\n  err,\n}: {\n  reject: (reason?: any) => void;\n  response: Response;\n  err: Error;\n}) => {\n  if (response) {\n    response.text().then((text: any) => reject(new GatewayErrorWrapper(text, response.status)));\n  } else if (err) {\n    reject(new GatewayErrorWrapper(err, 500));\n  }\n};\n\nexport class ModelGatewayService {\n  static createEvaluationTextPayload(inputText: string, task: ModelGatewayRouteTask) {\n    switch (task) {\n      case ModelGatewayRouteTask.LLM_V1_COMPLETIONS: {\n        return { prompt: inputText };\n      }\n      case ModelGatewayRouteTask.LLM_V1_CHAT: {\n        return { messages: [{ content: inputText, role: 'user' }] };\n      }\n      case ModelGatewayRouteTask.LLM_V1_EMBEDDINGS: {\n        // Should never happen\n        throw new Error(`Unsupported served LLM model task \"${task}\"!`);\n      }\n      default:\n        throw new Error(`Unknown served LLM model task \"${task}\"!`);\n    }\n  }\n\n  static queryMLflowDeploymentEndpointRoute = async (\n    route: ModelGatewayRoute,\n    data: ModelGatewayQueryPayload,\n  ): Promise<any> => {\n    invariant(route.mlflowDeployment, 'Trying to call a MLflow deployment route without a deployment_url');\n    const { inputText } = data;\n    const textPayload = ModelGatewayService.createEvaluationTextPayload(inputText, route.task);\n    const processed_data = {\n      ...textPayload,\n      ...data.parameters,\n    };\n\n    return MlflowService.gatewayProxyPost({\n      gateway_path: route.mlflowDeployment.endpoint_url.substring(1),\n      json_data: processed_data,\n    }) as Promise<ModelGatewayResponseType>;\n  };\n\n  static queryModelGatewayRoute = async (route: ModelGatewayRoute, payload: ModelGatewayQueryPayload) => {\n    if (route.type === 'mlflow_deployment_endpoint') {\n      invariant(route.mlflowDeployment, 'Trying to call a serving endpoint route without an endpoint');\n      const result = await this.queryMLflowDeploymentEndpointRoute(route, payload);\n      return parseEndpointEvaluationResponse(result, route.task);\n    }\n\n    throw new Error('Unknown route type');\n  };\n}\n","import { useCallback, useState } from 'react';\nimport { MessageDescriptor, defineMessage } from 'react-intl';\n\n// Hardcoded model parameter definitions\nconst parameterDefinitions: {\n  name: 'temperature' | 'max_tokens' | 'stop';\n  type: 'slider' | 'input' | 'list';\n  string: MessageDescriptor;\n  helpString: MessageDescriptor;\n  max?: number;\n  min?: number;\n  step?: number;\n}[] = [\n  {\n    type: 'slider',\n    name: 'temperature',\n    string: defineMessage({\n      defaultMessage: 'Temperature',\n      description: 'Experiment page > prompt lab > temperature parameter label',\n    }),\n    helpString: defineMessage({\n      defaultMessage: 'Increase or decrease the confidence level of the language model.',\n      description: 'Experiment page > prompt lab > temperature parameter help text',\n    }),\n    max: 1,\n    min: 0,\n    step: 0.01,\n  },\n  {\n    type: 'input',\n    name: 'max_tokens',\n    string: defineMessage({\n      defaultMessage: 'Max tokens',\n      description: 'Experiment page > prompt lab > max tokens parameter label',\n    }),\n    helpString: defineMessage({\n      defaultMessage: 'Maximum number of language tokens returned from evaluation.',\n      description: 'Experiment page > prompt lab > max tokens parameter help text',\n    }),\n    max: 64 * 1024,\n    min: 1,\n    step: 1,\n  },\n  {\n    type: 'list',\n    name: 'stop',\n    string: defineMessage({\n      defaultMessage: 'Stop Sequences',\n      description: 'Experiment page > prompt lab > stop parameter label',\n    }),\n    helpString: defineMessage({\n      defaultMessage: 'Specify sequences that signal the model to stop generating text.',\n      description: 'Experiment page > prompt lab > stop parameter help text',\n    }),\n  },\n];\n\n// TODO: Fetch better values for default parameters\nconst DEFAULT_PARAMETER_VALUES = {\n  temperature: 0.01,\n  max_tokens: 100,\n};\n\nexport const usePromptEvaluationParameters = () => {\n  const [parameters, updateParameters] = useState<{\n    temperature: number;\n    max_tokens: number;\n    stop?: string[] | undefined;\n  }>(DEFAULT_PARAMETER_VALUES);\n\n  const updateParameter = useCallback((name: string, value: number | string[]) => {\n    updateParameters((currentParameters) => ({ ...currentParameters, [name]: value }));\n  }, []);\n\n  return {\n    parameterDefinitions,\n    parameters,\n    updateParameter,\n  };\n};\n","import { FormUI, InfoIcon, Input, Tooltip, LegacySelect, useDesignSystemTheme } from '@databricks/design-system';\nimport { usePromptEvaluationParameters } from './hooks/usePromptEvaluationParameters';\nimport { FormattedMessage } from 'react-intl';\nimport { LineSmoothSlider } from '../LineSmoothSlider';\n\nexport const EvaluationCreatePromptParameters = ({\n  disabled = false,\n  parameters,\n  updateParameter,\n}: {\n  disabled?: boolean;\n  parameters: {\n    temperature: number;\n    max_tokens: number;\n    stop?: string[] | undefined;\n  };\n  updateParameter: (name: string, value: number | string[]) => void;\n}) => {\n  const { parameterDefinitions } = usePromptEvaluationParameters();\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div css={{ marginBottom: theme.spacing.lg }}>\n      <FormUI.Label css={{ marginBottom: theme.spacing.md }}>\n        <FormattedMessage\n          defaultMessage=\"Model parameters\"\n          description=\"Experiment page > new run modal > served LLM model parameters label\"\n        />\n      </FormUI.Label>\n      {parameterDefinitions.map((parameterDef) => (\n        <div key={parameterDef.name} css={{ marginBottom: theme.spacing.md }}>\n          <>\n            <FormUI.Label htmlFor={parameterDef.name} css={{ span: { fontWeight: 'normal' } }}>\n              <FormattedMessage {...parameterDef.string} />\n              <Tooltip title={<FormattedMessage {...parameterDef.helpString} />} placement=\"right\">\n                <InfoIcon\n                  css={{\n                    marginLeft: theme.spacing.sm,\n                    verticalAlign: 'text-top',\n                    color: theme.colors.textSecondary,\n                  }}\n                />\n              </Tooltip>\n            </FormUI.Label>\n            <FormUI.Hint></FormUI.Hint>\n            {parameterDef.name === 'temperature' && (\n              <LineSmoothSlider\n                data-testid={parameterDef.name}\n                disabled={disabled}\n                max={parameterDef.max}\n                min={parameterDef.min}\n                step={parameterDef.step}\n                defaultValue={parameters[parameterDef.name] || 0}\n                onChange={(value) => updateParameter(parameterDef.name, value)}\n              />\n            )}\n            {parameterDef.type === 'input' && (\n              <Input\n                data-testid={parameterDef.name}\n                type=\"number\"\n                disabled={disabled}\n                max={parameterDef.max}\n                min={parameterDef.min}\n                step={parameterDef.step}\n                value={parameters[parameterDef.name] || 0}\n                onChange={(e) => updateParameter(parameterDef.name, parseInt(e.target.value, 10))}\n              />\n            )}\n            {parameterDef.type === 'list' && (\n              <LegacySelect\n                allowClear\n                mode=\"tags\"\n                style={{ width: '100%' }}\n                open={false}\n                disabled={disabled}\n                onChange={(e) => updateParameter(parameterDef.name, e)}\n                value={parameters[parameterDef.name] || []}\n                dangerouslySetAntdProps={{ suffixIcon: null }}\n              />\n            )}\n          </>\n        </div>\n      ))}\n    </div>\n  );\n};\n","import React, { useCallback, useRef, useState } from 'react';\n\nimport type { TextAreaRef } from 'antd/lib/input/TextArea';\nimport {\n  DEFAULT_PROMPTLAB_NEW_TEMPLATE_VALUE,\n  extractPromptInputVariables,\n} from '../../prompt-engineering/PromptEngineering.utils';\nimport { max } from 'lodash';\n\nconst newVariableStartSegment = ' {{ ';\nconst newVariableEndSegment = ' }}';\nconst newDefaultVariableName = 'new_variable';\n\nconst getNewVariableName = (alreadyExistingVariableNames: string[] = []) => {\n  if (!alreadyExistingVariableNames.includes(newDefaultVariableName)) {\n    return newDefaultVariableName;\n  }\n\n  const maximumVariableNameIndex =\n    max(alreadyExistingVariableNames.map((name) => parseInt(name.match(/new_variable_(\\d+)/)?.[1] || '1', 10))) || 1;\n\n  return `${newDefaultVariableName}_${maximumVariableNameIndex + 1}`;\n};\n\n/**\n * Keeps track of the current prompt value and exports method for adding + autoselecting new variables\n */\nexport const usePromptEvaluationPromptTemplateValue = () => {\n  const [promptTemplate, updatePromptTemplate] = useState(DEFAULT_PROMPTLAB_NEW_TEMPLATE_VALUE);\n\n  const promptTemplateRef = useRef<HTMLTextAreaElement>();\n\n  const handleAddVariableToTemplate = useCallback(() => {\n    updatePromptTemplate((template) => {\n      const newVariableName = getNewVariableName(extractPromptInputVariables(template));\n      const newValue = `${template}${newVariableStartSegment}${newVariableName}${newVariableEndSegment}`;\n\n      // Wait until the next execution frame\n      requestAnimationFrame(() => {\n        const textAreaElement = promptTemplateRef.current;\n        if (!textAreaElement) {\n          return;\n        }\n        // Focus the element and set the newly added variable name\n        textAreaElement.focus();\n        textAreaElement.setSelectionRange(\n          newValue.length - newVariableName.length - newVariableEndSegment.length,\n          newValue.length - newVariableEndSegment.length,\n        );\n      });\n      return newValue;\n    });\n  }, [updatePromptTemplate]);\n\n  const savePromptTemplateInputRef = useCallback((ref: TextAreaRef) => {\n    promptTemplateRef.current = ref?.resizableTextArea?.textArea;\n  }, []);\n\n  return {\n    savePromptTemplateInputRef,\n    handleAddVariableToTemplate,\n    promptTemplate,\n    updatePromptTemplate,\n  };\n};\n","import { Typography } from '@databricks/design-system';\nimport { getPromptInputVariableNameViolations } from '../../prompt-engineering/PromptEngineering.utils';\nimport { FormattedMessage, defineMessage, useIntl } from 'react-intl';\n\nconst whitespaceViolationMessage = defineMessage({\n  defaultMessage: 'The following variable names contain spaces which is disallowed: {invalidNames}',\n  description: 'Experiment page > new run modal > variable name validation > including spaces error',\n});\n\nexport const EvaluationCreateRunPromptTemplateErrors = ({\n  violations,\n}: {\n  violations: ReturnType<typeof getPromptInputVariableNameViolations>;\n}) => {\n  const { namesWithSpaces } = violations;\n  const { formatMessage } = useIntl();\n  return (\n    <>\n      {namesWithSpaces.length > 0 && (\n        <Typography.Text\n          color=\"warning\"\n          size=\"sm\"\n          aria-label={formatMessage(whitespaceViolationMessage, {\n            invalidNames: namesWithSpaces.join(', '),\n          })}\n        >\n          <FormattedMessage\n            {...whitespaceViolationMessage}\n            values={{\n              invalidNames: (\n                <>\n                  {namesWithSpaces.map((nameWithSpace) => (\n                    <code key={nameWithSpace}>{nameWithSpace}</code>\n                  ))}\n                </>\n              ),\n            }}\n          />\n        </Typography.Text>\n      )}\n    </>\n  );\n};\n","export const PROMPT_TEMPLATE_EXAMPLES = [\n  {\n    prompt: [\n      'You are a marketing consultant for a technology company. Develop a marketing strategy report for {{ company_name }} aiming to {{ company_goal }}',\n    ],\n    variables: [\n      {\n        name: 'company_name',\n        value: 'XYZ Company',\n      },\n      {\n        name: 'company_goal',\n        value: 'Increase top-line revenue',\n      },\n    ],\n  },\n  {\n    prompt: [\n      'You are a helpful and friendly customer support chatbot. Answer the users question \"{{ user_question }}\" clearly, based on the following documentation: {{ documentation }}',\n    ],\n    variables: [\n      {\n        name: 'user_question',\n        value: 'Is MLflow open source?',\n      },\n      {\n        name: 'documentation',\n        value: 'MLflow is an open source platform for managing the end-to-end machine learning lifecycle.',\n      },\n    ],\n  },\n  {\n    prompt: [\n      'Summarize the given text \"{{ text }}\" into a concise and coherent summary, capturing the main ideas and key points. Make sure that the summary does not exceed {{ word_count }} words.',\n    ],\n    variables: [\n      {\n        name: 'text',\n        value:\n          'Although C. septempunctata larvae and adults mainly eat aphids, they also feed on Thysanoptera, Aleyrodidae, on the larvae of Psyllidae and Cicadellidae, and on eggs and larvae of some beetles and butterflies. There are one or two generations per year. Adults overwinter in ground litter in parks, gardens and forest edges and under tree bark and rocks. C. septempunctata has a broad ecological range, generally living wherever there are aphids for it to eat. This includes, amongst other biotopes, meadows, fields, PonticCaspian steppe, parkland, gardens, Western European broadleaf forests and mixed forests. In the United Kingdom, there are fears that the seven-spot ladybird is being outcompeted for food by the harlequin ladybird. An adult seven-spot ladybird may reach a body length of 7.612.7 mm (0.30.5 in). Their distinctive spots and conspicuous colours warn of their toxicity, making them unappealing to predators. The species can secrete a fluid from joints in their legs which gives them a foul taste. A threatened ladybird may both play dead and secrete the unappetising substance to protect itself. The seven-spot ladybird synthesizes the toxic alkaloids, N-oxide coccinelline and its free base precoccinelline; depending on sex and diet, the spot size and coloration can provide some indication of how toxic the individual insect is to potential predators.',\n      },\n      {\n        name: 'word_count',\n        value: '75',\n      },\n    ],\n  },\n  {\n    prompt: [\n      'Generate a list of ten titles for my book. The book is about {{ topic }}. Each title should be between {{ word_range }} words long.',\n      '### Examples of great titles ###',\n      '{{ examples }}',\n    ],\n    variables: [\n      {\n        name: 'topic',\n        value:\n          'my journey as an adventurer who has lived an unconventional life, meeting many different personalities and finally finding peace in gardening.',\n      },\n      {\n        name: 'word_range',\n        value: 'two to five',\n      },\n      {\n        name: 'examples',\n        value: '\"Long walk to freedom\", \"Wishful drinking\", \"I know why the caged bird sings\"',\n      },\n    ],\n  },\n  {\n    prompt: [\n      'Generate a SQL query from a users question, using the information from the table.',\n      'Question: {{ user_question }}',\n      'Table Information: {{ table_information }}',\n    ],\n    variables: [\n      {\n        name: 'user_question',\n        value: 'Which product generated the most sales this month?',\n      },\n      {\n        name: 'table_information',\n        value:\n          'CREATE TABLE Sales (SaleID INT PRIMARY KEY, ProductID INT, SaleDate DATE, CustomerID INT, QuantitySold INT, UnitPrice DECIMAL(10, 2));',\n      },\n    ],\n  },\n];\n","import {\n  ArrowLeftIcon,\n  Button,\n  Modal,\n  Spacer,\n  Input,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { Divider } from 'antd';\nimport { FormattedMessage } from 'react-intl';\nimport { PROMPT_TEMPLATE_EXAMPLES } from 'experiment-tracking/components/evaluation-artifacts-compare/utils/PromptExamples';\n\nconst { TextArea } = Input;\ntype Props = {\n  isOpen: boolean;\n  closeExamples: () => void;\n  closeModal: () => void;\n  updatePromptTemplate: (prompt: string) => void;\n  updateInputVariableValue: (name: string, value: string) => void;\n};\n\nexport const EvaluationCreatePromptRunModalExamples = ({\n  isOpen,\n  closeExamples,\n  closeModal,\n  updatePromptTemplate,\n  updateInputVariableValue,\n}: Props): JSX.Element => {\n  const { theme } = useDesignSystemTheme();\n\n  const tryPromptTemplate = (promptTemplate: { prompt: string[]; variables: { name: string; value: string }[] }) => {\n    updatePromptTemplate(promptTemplate.prompt.join('\\n'));\n    promptTemplate.variables.forEach(({ name, value }) => {\n      updateInputVariableValue(name, value);\n    });\n    closeExamples();\n  };\n\n  return (\n    <Modal\n      verticalSizing=\"maxed_out\"\n      visible={isOpen}\n      onCancel={closeModal}\n      title={\n        <div>\n          <Typography.Title level={2} css={{ marginTop: theme.spacing.sm, marginBottom: theme.spacing.xs }}>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodalexamples.tsx_48\"\n              css={{ marginRight: theme.spacing.sm, marginBottom: theme.spacing.sm }}\n              icon={<ArrowLeftIcon />}\n              onClick={closeExamples}\n            />\n            <FormattedMessage\n              defaultMessage=\"Prompt template examples\"\n              description=\"Experiment page > new run modal > prompt examples > modal title\"\n            />\n          </Typography.Title>\n        </div>\n      }\n      dangerouslySetAntdProps={{ width: 1200 }}\n    >\n      {PROMPT_TEMPLATE_EXAMPLES.map((promptTemplate) => (\n        <div\n          key={promptTemplate.prompt.join('\\n')}\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: theme.spacing.md,\n          }}\n        >\n          <div\n            css={{\n              boxSizing: 'border-box',\n              border: `1px solid ${theme.colors.actionDefaultBorderDefault}`,\n              borderRadius: theme.borders.borderRadiusMd,\n              background: theme.colors.backgroundPrimary,\n              padding: theme.spacing.md,\n              margin: 0,\n              overflow: 'hidden',\n              display: 'flex',\n              flexDirection: 'column',\n              gap: `${theme.spacing.xs}px`,\n            }}\n          >\n            <Typography.Title level={4}>\n              <FormattedMessage\n                defaultMessage=\"Prompt Template\"\n                description=\"Experiment page > new run modal > prompt examples > prompt template title\"\n              />\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodalexamples.tsx_90\"\n                type=\"tertiary\"\n                size=\"small\"\n                style={{ float: 'right' }}\n                onClick={() => tryPromptTemplate(promptTemplate)}\n              >\n                <FormattedMessage\n                  defaultMessage=\"Try this template\"\n                  description=\"Experiment page > new run modal > prompt examples > try template button\"\n                />\n              </Button>\n            </Typography.Title>\n            {promptTemplate.prompt.map((line) => (\n              <Typography.Paragraph key={line}>{line}</Typography.Paragraph>\n            ))}\n            <Divider css={{ marginTop: theme.spacing.xs, marginBottom: theme.spacing.xs }} />\n            {promptTemplate.variables.map(({ name, value }) => (\n              <div key={name}>\n                <Typography.Title level={4}>{name}</Typography.Title>\n                <Typography.Paragraph>{value}</Typography.Paragraph>\n              </div>\n            ))}\n          </div>\n          <Spacer />\n        </div>\n      ))}\n    </Modal>\n  );\n};\n","import {\n  Alert,\n  Button,\n  FormUI,\n  Input,\n  PlayIcon,\n  StopIcon,\n  TableSkeleton,\n  Tooltip,\n  Typography,\n  WarningIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport {\n  PROMPTLAB_METADATA_COLUMN_LATENCY,\n  PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS,\n} from '../../prompt-engineering/PromptEngineering.utils';\nimport { useMemo } from 'react';\nimport { type ModelGatewayResponseType } from '../../../sdk/ModelGatewayService';\n\nconst { TextArea } = Input;\n\ninterface EvaluationCreatePromptRunOutputProps {\n  evaluationMetadata: Partial<ModelGatewayResponseType['metadata']>;\n  isEvaluating?: boolean;\n  isOutputDirty?: boolean;\n  evaluationOutput: string;\n  evaluationError: string | null;\n  evaluateButtonTooltip: string | null;\n  onEvaluateClick?: () => void;\n  onCancelClick?: () => void;\n  disabled?: boolean;\n}\n\n/**\n * Part of EvaluationCreatePromptRunModal, houses evaluate/cancel buttons\n * and evaluation output with the metadata\n */\nexport const EvaluationCreatePromptRunOutput = ({\n  evaluationMetadata,\n  isEvaluating,\n  isOutputDirty,\n  evaluationOutput,\n  evaluationError,\n  evaluateButtonTooltip,\n  disabled,\n  onEvaluateClick,\n  onCancelClick,\n}: EvaluationCreatePromptRunOutputProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const metadataOutput = useMemo(() => {\n    if (!evaluationMetadata) {\n      return null;\n    }\n    if (isEvaluating) {\n      return null;\n    }\n    return (\n      <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n        {PROMPTLAB_METADATA_COLUMN_LATENCY in evaluationMetadata && (\n          <Typography.Hint size=\"sm\">\n            {Math.round(Number(evaluationMetadata[PROMPTLAB_METADATA_COLUMN_LATENCY]))} ms\n            {'MLFLOW_total_tokens' in evaluationMetadata ? ',' : ''}\n          </Typography.Hint>\n        )}\n        {PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS in evaluationMetadata && (\n          <Typography.Hint size=\"sm\">\n            <FormattedMessage\n              defaultMessage=\"{totalTokens} total tokens\"\n              description=\"Experiment page > artifact compare view > results table > total number of evaluated tokens\"\n              values={{ totalTokens: evaluationMetadata[PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS] }}\n            />\n          </Typography.Hint>\n        )}\n      </div>\n    );\n  }, [evaluationMetadata, isEvaluating, theme]);\n\n  return (\n    <>\n      <div css={{ marginBottom: theme.spacing.md }}>\n        <Tooltip title={evaluateButtonTooltip}>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationcreatepromptrunoutput.tsx_85\"\n            data-testid=\"button-evaluate\"\n            icon={<PlayIcon />}\n            onClick={onEvaluateClick}\n            disabled={disabled}\n            loading={isEvaluating}\n          >\n            <FormattedMessage\n              defaultMessage=\"Evaluate\"\n              description='Experiment page > new run modal > \"evaluate\" button label'\n            />\n          </Button>\n        </Tooltip>\n        {isEvaluating && (\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationcreatepromptrunoutput.tsx_99\"\n            data-testid=\"button-cancel\"\n            icon={<StopIcon />}\n            onClick={onCancelClick}\n            css={{ marginLeft: theme.spacing.sm }}\n          >\n            <FormattedMessage\n              defaultMessage=\"Cancel\"\n              description='Experiment page > new run modal > \"cancel\" button label'\n            />\n          </Button>\n        )}\n      </div>\n      <FormUI.Label>\n        <FormattedMessage\n          defaultMessage=\"Output\"\n          description=\"Experiment page > new run modal > evaluation output field label\"\n        />\n        {isOutputDirty && (\n          <Tooltip\n            title={\n              <FormattedMessage\n                defaultMessage=\"Model, input data or prompt have changed since last evaluation of the output\"\n                description=\"Experiment page > new run modal > dirty output (out of sync with new data)\"\n              />\n            }\n          >\n            <WarningIcon css={{ marginLeft: theme.spacing.xs }} />\n          </Tooltip>\n        )}\n      </FormUI.Label>\n      <FormUI.Hint>\n        <FormattedMessage\n          defaultMessage=\"This is the output generated by the LLM using the prompt template and input values defined above.\"\n          description=\"Experiment page > new run modal > evaluation output field hint\"\n        />\n      </FormUI.Hint>\n      {!evaluationError && isEvaluating && (\n        <div css={{ marginTop: theme.spacing.sm }}>\n          <TableSkeleton lines={5} />\n        </div>\n      )}\n      {!isEvaluating && (\n        <TextArea rows={5} css={{ cursor: 'default' }} data-testid=\"prompt-output\" value={evaluationOutput} readOnly />\n      )}\n      {!isEvaluating && evaluationError && <FormUI.Message message={evaluationError} type=\"error\" />}\n      <div css={{ marginTop: theme.spacing.sm }}>{metadataOutput}</div>\n    </>\n  );\n};\n","import { shouldUseExperimentPageChartViewAsDefault } from '../../../../common/utils/FeatureUtils';\nimport { useSearchParams } from '../../../../common/utils/RoutingUtils';\nimport { type ExperimentViewRunsCompareMode } from '../../../types';\n\nconst EXPERIMENT_PAGE_VIEW_MODE_QUERY_PARAM_KEY = 'compareRunsMode';\n\nexport const getExperimentPageDefaultViewMode = (): ExperimentViewRunsCompareMode =>\n  shouldUseExperimentPageChartViewAsDefault() ? 'CHART' : 'TABLE';\n\n/**\n * Hook using search params to retrieve and update the current experiment page runs view mode.\n */\nexport const useExperimentPageViewMode = (): [\n  ExperimentViewRunsCompareMode,\n  (newCompareRunsMode: ExperimentViewRunsCompareMode) => void,\n] => {\n  const [params, setParams] = useSearchParams();\n\n  const mode =\n    (params.get(EXPERIMENT_PAGE_VIEW_MODE_QUERY_PARAM_KEY) as ExperimentViewRunsCompareMode) ||\n    getExperimentPageDefaultViewMode();\n  const setMode = (newCompareRunsMode: ExperimentViewRunsCompareMode) => {\n    setParams(\n      (currentParams) => {\n        currentParams.set(EXPERIMENT_PAGE_VIEW_MODE_QUERY_PARAM_KEY, newCompareRunsMode || '');\n        return currentParams;\n      },\n      { replace: false },\n    );\n  };\n\n  return [mode, setMode];\n};\n","import { MlflowService } from 'experiment-tracking/sdk/MlflowService';\nimport { getUUID } from '../../common/utils/ActionUtils';\nimport type { AsyncAction } from '../../redux-types';\nimport {\n  ModelGatewayQueryPayload,\n  ModelGatewayRoute,\n  ModelGatewayRouteLegacy,\n  ModelGatewayService,\n  SearchMlflowDeploymentsModelRoutesResponse,\n} from '../sdk/ModelGatewayService';\n\nexport const SEARCH_MLFLOW_DEPLOYMENTS_MODEL_ROUTES = 'SEARCH_MLFLOW_DEPLOYMENTS_MODEL_ROUTES';\n\nexport interface SearchMlflowDeploymentsModelRoutesAction\n  extends AsyncAction<SearchMlflowDeploymentsModelRoutesResponse> {\n  type: 'SEARCH_MLFLOW_DEPLOYMENTS_MODEL_ROUTES';\n}\n\nexport const searchMlflowDeploymentsRoutesApi = (filter?: string): SearchMlflowDeploymentsModelRoutesAction => ({\n  type: SEARCH_MLFLOW_DEPLOYMENTS_MODEL_ROUTES,\n  payload: MlflowService.gatewayProxyGet({\n    gateway_path: 'api/2.0/endpoints/',\n  }) as Promise<SearchMlflowDeploymentsModelRoutesResponse>,\n  meta: { id: getUUID() },\n});\nexport const QUERY_MLFLOW_DEPLOYMENTS_ROUTE_API = 'QUERY_MLFLOW_DEPLOYMENTS_ROUTE_API';\nexport const queryMlflowDeploymentsRouteApi = (route: ModelGatewayRoute, data: ModelGatewayQueryPayload) => {\n  return {\n    type: QUERY_MLFLOW_DEPLOYMENTS_ROUTE_API,\n    payload: ModelGatewayService.queryMLflowDeploymentEndpointRoute(route, data),\n    meta: { id: getUUID(), startTime: performance.now() },\n  };\n};\n","import { cloneDeep, fromPairs } from 'lodash';\nimport { Action } from 'redux';\nimport Utils from '../../common/utils/Utils';\nimport { AsyncAction, ReduxState, ThunkDispatch } from '../../redux-types';\nimport { uploadArtifactApi } from '../actions';\nimport { RunRowType } from '../components/experiment-page/utils/experimentPage.row-types';\nimport { MLFLOW_PROMPT_ENGINEERING_ARTIFACT_NAME } from '../constants';\nimport { RawEvaluationArtifact, parseEvaluationTableArtifact } from '../sdk/EvaluationArtifactService';\nimport {\n  ModelGatewayQueryPayload,\n  ModelGatewayRouteType,\n  ModelGatewayRoute,\n  ModelGatewayService,\n} from '../sdk/ModelGatewayService';\nimport { EvaluationArtifactTable } from '../types';\nimport { searchMlflowDeploymentsRoutesApi } from './ModelGatewayActions';\nimport {\n  PROMPTLAB_METADATA_COLUMN_LATENCY,\n  PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS,\n} from '../components/prompt-engineering/PromptEngineering.utils';\n\nexport const EVALUATE_PROMPT_TABLE_VALUE = 'EVALUATE_PROMPT_TABLE_VALUE';\nexport interface EvaluatePromptTableValueAction\n  extends AsyncAction<\n    { metadata: any; text: string },\n    {\n      inputValues: Record<string, string>;\n      run: RunRowType;\n      compiledPrompt: string;\n      rowKey: string;\n      startTime: number;\n      gatewayRoute: ModelGatewayRoute;\n    }\n  > {\n  type: 'EVALUATE_PROMPT_TABLE_VALUE';\n}\nconst evaluatePromptTableValueUnified =\n  ({\n    routeName,\n    routeType,\n    compiledPrompt,\n    inputValues,\n    parameters,\n    outputColumn,\n    rowKey,\n    run,\n  }: {\n    routeName: string;\n    routeType: ModelGatewayRouteType;\n    compiledPrompt: string;\n    inputValues: Record<string, string>;\n    parameters: ModelGatewayQueryPayload['parameters'];\n    outputColumn: string;\n    rowKey: string;\n    run: RunRowType;\n  }) =>\n  async (dispatch: ThunkDispatch, getState: () => ReduxState) => {\n    // Check if model gateway routes have been fetched. If not, fetch them first.\n    const { modelGateway } = getState();\n    if (!modelGateway.modelGatewayRoutesLoading.loading && Object.keys(modelGateway.modelGatewayRoutes).length === 0) {\n      await dispatch(searchAllPromptLabAvailableEndpoints());\n    }\n    // If the gateway is not present in the store, it means that it was deleted\n    // recently. Display relevant error in this scenario.\n    const gatewayRoute = getState().modelGateway.modelGatewayRoutes[`${routeType}:${routeName}`];\n    if (!gatewayRoute) {\n      const errorMessage = `MLflow deployment endpoint ${routeName} does not exist anymore!`;\n      Utils.logErrorAndNotifyUser(errorMessage);\n      throw new Error(errorMessage);\n    }\n    const modelGatewayRequestPayload: ModelGatewayQueryPayload = {\n      inputText: compiledPrompt,\n      parameters,\n    };\n\n    const action = {\n      type: EVALUATE_PROMPT_TABLE_VALUE,\n      payload: ModelGatewayService.queryModelGatewayRoute(gatewayRoute, modelGatewayRequestPayload),\n      meta: {\n        inputValues,\n        run,\n        compiledPrompt,\n        rowKey,\n        startTime: performance.now(),\n      },\n    };\n    return dispatch(action);\n  };\n\nexport const DISCARD_PENDING_EVALUATION_DATA = 'DISCARD_PENDING_EVALUATION_DATA';\nexport type DiscardPendingEvaluationDataAction = Action<'DISCARD_PENDING_EVALUATION_DATA'>;\nexport const discardPendingEvaluationData = () => ({\n  type: DISCARD_PENDING_EVALUATION_DATA,\n});\n\nexport const WRITE_BACK_EVALUATION_ARTIFACTS = 'WRITE_BACK_EVALUATION_ARTIFACTS';\n\nexport interface WriteBackEvaluationArtifactsAction\n  extends AsyncAction<\n    { runUuid: string; newEvaluationTable: EvaluationArtifactTable }[],\n    { runUuidsToUpdate: string[]; artifactPath: string }\n  > {\n  type: 'WRITE_BACK_EVALUATION_ARTIFACTS';\n}\n\nexport const writeBackEvaluationArtifactsAction = () => async (dispatch: ThunkDispatch, getState: () => ReduxState) => {\n  const { evaluationPendingDataByRunUuid, evaluationArtifactsByRunUuid } = getState().evaluationData;\n  const runUuidsToUpdate = Object.keys(evaluationPendingDataByRunUuid);\n  const originalRunArtifacts = fromPairs(\n    Object.entries(evaluationArtifactsByRunUuid)\n      .filter(\n        ([runUuid, artifactTableRecords]) =>\n          runUuidsToUpdate.includes(runUuid) && artifactTableRecords[MLFLOW_PROMPT_ENGINEERING_ARTIFACT_NAME],\n      )\n      .map(([runUuid, artifactTableRecords]) => [\n        runUuid,\n        artifactTableRecords[MLFLOW_PROMPT_ENGINEERING_ARTIFACT_NAME],\n      ]),\n  );\n\n  const updatedArtifactFiles = runUuidsToUpdate.map((runUuid) => {\n    const originalTableRecord = originalRunArtifacts[runUuid];\n\n    if (!originalTableRecord) {\n      throw new Error(`Cannot find existing prompt engineering artifact for run ${runUuid}`);\n    }\n\n    const transformedEntries = evaluationPendingDataByRunUuid[runUuid].map(\n      ({ entryData, evaluationTime, totalTokens }) => {\n        return originalTableRecord.columns.map((columnName) => {\n          if (columnName === PROMPTLAB_METADATA_COLUMN_LATENCY) {\n            return evaluationTime.toString();\n          } else if (columnName === PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS && totalTokens) {\n            return totalTokens.toString();\n          } else {\n            return entryData[columnName] || '';\n          }\n        });\n      },\n    );\n\n    const updatedArtifactFile = cloneDeep(originalRunArtifacts[runUuid].rawArtifactFile) as RawEvaluationArtifact;\n    updatedArtifactFile?.data.unshift(...transformedEntries);\n\n    return { runUuid, updatedArtifactFile };\n  });\n\n  const promises = updatedArtifactFiles.map(({ runUuid, updatedArtifactFile }) =>\n    dispatch(uploadArtifactApi(runUuid, MLFLOW_PROMPT_ENGINEERING_ARTIFACT_NAME, updatedArtifactFile)).then(() => {\n      const newEvaluationTable = parseEvaluationTableArtifact(\n        MLFLOW_PROMPT_ENGINEERING_ARTIFACT_NAME,\n        updatedArtifactFile,\n      );\n      return { runUuid, newEvaluationTable };\n    }),\n  );\n\n  return dispatch({\n    type: 'WRITE_BACK_EVALUATION_ARTIFACTS',\n    payload: Promise.all(promises),\n    meta: { runUuidsToUpdate, artifactPath: MLFLOW_PROMPT_ENGINEERING_ARTIFACT_NAME },\n  });\n};\nexport const EVALUATE_ADD_INPUT_VALUES = 'EVALUATE_ADD_INPUT_VALUES';\nexport interface EvaluateAddInputValues extends Action<'EVALUATE_ADD_INPUT_VALUES'> {\n  payload: Record<string, string>;\n}\nexport const evaluateAddInputValues = (inputValues: Record<string, string>) => ({\n  type: EVALUATE_ADD_INPUT_VALUES,\n  payload: inputValues,\n  meta: {},\n});\n\nexport const evaluatePromptTableValue = ({\n  routeName,\n  routeType,\n  compiledPrompt,\n  inputValues,\n  parameters,\n  outputColumn,\n  rowKey,\n  run,\n}: {\n  routeName: string;\n  routeType: ModelGatewayRouteType;\n  compiledPrompt: string;\n  inputValues: Record<string, string>;\n  parameters: ModelGatewayQueryPayload['parameters'];\n  outputColumn: string;\n  rowKey: string;\n  run: RunRowType;\n}) => {\n  const evaluateParams = {\n    routeName,\n    compiledPrompt,\n    inputValues,\n    parameters,\n    outputColumn,\n    rowKey,\n    run,\n  };\n\n  return evaluatePromptTableValueUnified({\n    ...evaluateParams,\n    routeType,\n  });\n};\n\nexport const searchAllPromptLabAvailableEndpoints = () => async (dispatch: ThunkDispatch) => {\n  return dispatch(searchMlflowDeploymentsRoutesApi());\n};\n","import { ErrorWrapper } from '../../../../common/utils/ErrorWrapper';\nimport { GatewayErrorWrapper } from '../../../utils/LLMGatewayUtils';\n\n/**\n * Due to multiple invocation methods, there are multiple error types that can be thrown.\n * This function extracts the proper error message from the error object.\n */\nexport const getPromptEngineeringErrorMessage = (e: GatewayErrorWrapper | ErrorWrapper | Error) => {\n  const errorMessage =\n    e instanceof GatewayErrorWrapper\n      ? e.getGatewayErrorMessage()\n      : e instanceof ErrorWrapper\n      ? e.getMessageField()\n      : e.message;\n\n  return errorMessage;\n};\n","import {\n  Button,\n  DialogCombobox,\n  DialogComboboxContent,\n  DialogComboboxHintRow,\n  DialogComboboxOptionList,\n  DialogComboboxOptionListSearch,\n  DialogComboboxOptionListSelectItem,\n  DialogComboboxTrigger,\n  FormUI,\n  InfoIcon,\n  Input,\n  Modal,\n  PlusIcon,\n  Spinner,\n  Tooltip,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { sortBy, compact } from 'lodash';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Utils from '../../../common/utils/Utils';\nimport { ThunkDispatch } from '../../../redux-types';\nimport { createPromptLabRunApi } from '../../actions';\nimport { ModelGatewayReduxState } from '../../reducers/ModelGatewayReducer';\nimport { ModelGatewayResponseType, ModelGatewayService } from '../../sdk/ModelGatewayService';\nimport { ModelGatewayRouteTask } from '../../sdk/MlflowEnums';\nimport { generateRandomRunName, getDuplicatedRunName } from '../../utils/RunNameUtils';\nimport { useExperimentIds } from '../experiment-page/hooks/useExperimentIds';\nimport {\n  compilePromptInputText,\n  extractEvaluationPrerequisitesForRun,\n  extractRequiredInputParamsForRun,\n} from '../prompt-engineering/PromptEngineering.utils';\nimport { EvaluationCreatePromptParameters } from './EvaluationCreatePromptParameters';\nimport { usePromptEvaluationInputValues } from './hooks/usePromptEvaluationInputValues';\nimport { usePromptEvaluationParameters } from './hooks/usePromptEvaluationParameters';\nimport { usePromptEvaluationPromptTemplateValue } from './hooks/usePromptEvaluationPromptTemplateValue';\nimport { EvaluationCreateRunPromptTemplateErrors } from './components/EvaluationCreateRunPromptTemplateErrors';\nimport type { RunRowType } from '../experiment-page/utils/experimentPage.row-types';\nimport { EvaluationCreatePromptRunModalExamples } from './EvaluationCreatePromptRunModalExamples';\nimport { EvaluationCreatePromptRunOutput } from './components/EvaluationCreatePromptRunOutput';\nimport { useExperimentPageViewMode } from '../experiment-page/hooks/useExperimentPageViewMode';\nimport { searchAllPromptLabAvailableEndpoints } from '../../actions/PromptEngineeringActions';\nimport { getPromptEngineeringErrorMessage } from './utils/PromptEngineeringErrorUtils';\n\nconst { TextArea } = Input;\ntype Props = {\n  isOpen: boolean;\n  closeModal: () => void;\n  runBeingDuplicated: RunRowType | null;\n  visibleRuns?: RunRowType[];\n  refreshRuns: (() => Promise<never[]>) | (() => Promise<any> | null) | (() => void);\n};\n\nexport const EvaluationCreatePromptRunModal = ({\n  isOpen,\n  closeModal,\n  runBeingDuplicated,\n  visibleRuns = [],\n  refreshRuns,\n}: Props): JSX.Element => {\n  const [experimentId] = useExperimentIds();\n  const { theme } = useDesignSystemTheme();\n  const { parameters, updateParameter } = usePromptEvaluationParameters();\n  const [, setViewMode] = useExperimentPageViewMode();\n\n  const [selectedModel, updateSelectedModel] = useState('');\n  const [newRunName, setNewRunName] = useState('');\n  const [isCreatingRun, setIsCreatingRun] = useState(false);\n  const [isEvaluating, setIsEvaluating] = useState(false);\n  const [lastEvaluationError, setLastEvaluationError] = useState<string | null>(null);\n  const [evaluationOutput, setEvaluationOutput] = useState('');\n  const [evaluationMetadata, setEvaluationMetadata] = useState<Partial<ModelGatewayResponseType['metadata']>>({});\n  const [outputDirty, setOutputDirty] = useState(false);\n  const [isViewExamplesModalOpen, setViewExamplesModalOpen] = useState(false);\n  const cancelTokenRef = useRef<string | null>(null);\n\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  useEffect(() => {\n    dispatch(searchAllPromptLabAvailableEndpoints()).catch((e) => {\n      Utils.logErrorAndNotifyUser(e?.message || e);\n    });\n  }, [dispatch]);\n\n  const intl = useIntl();\n\n  const {\n    updateInputVariables,\n    inputVariables,\n    inputVariableValues,\n    updateInputVariableValue,\n    inputVariableNameViolations,\n    clearInputVariableValues,\n  } = usePromptEvaluationInputValues();\n\n  const { handleAddVariableToTemplate, savePromptTemplateInputRef, promptTemplate, updatePromptTemplate } =\n    usePromptEvaluationPromptTemplateValue();\n\n  useEffect(() => {\n    if (isOpen && !runBeingDuplicated) {\n      setNewRunName(generateRandomRunName());\n    }\n  }, [isOpen, runBeingDuplicated]);\n\n  useEffect(() => {\n    updateInputVariables(promptTemplate);\n  }, [promptTemplate, updateInputVariables]);\n\n  /**\n   * If a run duplication is detected, pre-fill the values\n   */\n  useEffect(() => {\n    if (runBeingDuplicated) {\n      const {\n        promptTemplate: duplicatedPromptTemplate,\n        routeName: duplicatedRouteName,\n        parameters: duplicatedParameters,\n      } = extractEvaluationPrerequisitesForRun(runBeingDuplicated);\n\n      extractRequiredInputParamsForRun(runBeingDuplicated);\n      if (duplicatedPromptTemplate) {\n        updatePromptTemplate(duplicatedPromptTemplate);\n      }\n      if (duplicatedParameters.temperature) {\n        updateParameter('temperature', duplicatedParameters.temperature);\n      }\n      if (duplicatedParameters.max_tokens) {\n        updateParameter('max_tokens', duplicatedParameters.max_tokens);\n      }\n      if (duplicatedRouteName) {\n        updateSelectedModel(duplicatedRouteName);\n      }\n      setEvaluationOutput('');\n      setOutputDirty(false);\n      const duplicatedRunName = getDuplicatedRunName(\n        runBeingDuplicated.runName,\n        compact(visibleRuns.map(({ runName }) => runName)),\n      );\n      setNewRunName(duplicatedRunName);\n      clearInputVariableValues();\n    }\n  }, [runBeingDuplicated, clearInputVariableValues, updateParameter, updatePromptTemplate, visibleRuns]);\n\n  const modelRoutesUnified = useSelector(\n    ({ modelGateway }: { modelGateway: ModelGatewayReduxState }) => modelGateway.modelGatewayRoutes,\n  );\n\n  // In the next version, routes are already filtered\n  const supportedModelRouteListUnified = useMemo(\n    () => sortBy(Object.values(modelRoutesUnified), 'name'),\n    // .filter(\n    //   (x) => x.name.includes('ann-chat') || x.name.includes('bedrock-ai21labs'),\n    // )\n    [modelRoutesUnified],\n  );\n\n  // Determines if model gateway routes are being loaded\n  const modelRoutesLoading = useSelector(\n    ({ modelGateway }: { modelGateway: ModelGatewayReduxState }) => modelGateway.modelGatewayRoutesLoading.loading,\n  );\n  useEffect(() => {\n    if (evaluationOutput) {\n      setOutputDirty(true);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [inputVariableValues, promptTemplate, parameters, selectedModel]);\n\n  const onHandleSubmit = () => {\n    setIsCreatingRun(true);\n    const modelRouteName = modelRoutesUnified[selectedModel]?.name;\n    const modelParameters = { ...parameters, route_type: modelRoutesUnified[selectedModel]?.type };\n\n    const modelInput = compilePromptInputText(promptTemplate, inputVariableValues);\n    dispatch(\n      createPromptLabRunApi({\n        experimentId,\n        promptTemplate,\n        modelInput,\n        modelParameters,\n        modelRouteName,\n        promptParameters: inputVariableValues,\n        modelOutput: evaluationOutput,\n        runName: newRunName,\n        modelOutputParameters: evaluationMetadata,\n      }),\n    )\n      .then(() => {\n        refreshRuns();\n        closeModal();\n        setIsCreatingRun(false);\n        setViewMode('ARTIFACT');\n      })\n      .catch((e) => {\n        Utils.logErrorAndNotifyUser(e?.message || e);\n        // NB: Not using .finally() due to issues with promise implementation in the Jest\n        setIsCreatingRun(false);\n      });\n  };\n\n  const handleEvaluate = useCallback(() => {\n    const modelRoute = modelRoutesUnified[selectedModel];\n    const cancelToken = Math.random().toString(36);\n    cancelTokenRef.current = cancelToken;\n    if (!modelRoute) {\n      // Should never happen if the model is selected\n      throw new Error('No model route found!');\n    }\n    setLastEvaluationError(null);\n    setIsEvaluating(true);\n    const inputText = compilePromptInputText(promptTemplate, inputVariableValues);\n    const startTime = performance.now();\n    ModelGatewayService.queryModelGatewayRoute(modelRoute, {\n      inputText,\n      parameters,\n    })\n      .then((value) => {\n        if (cancelTokenRef.current === cancelToken) {\n          const { text, metadata } = value;\n\n          // TODO: Consider calculating actual model call latency on the backend side\n          const latency = performance.now() - startTime;\n\n          setEvaluationOutput(text);\n          const metadataWithEvaluationTime = { ...metadata, latency };\n\n          // Prefix the metadata keys with \"MLFLOW_\"\n          const prefixedMetadata = Object.entries(metadataWithEvaluationTime).reduce(\n            (acc, [metadata_key, metadata_value]) => ({\n              ...acc,\n              [`MLFLOW_${metadata_key}`]: metadata_value,\n            }),\n            {},\n          );\n\n          setEvaluationMetadata(prefixedMetadata);\n          setOutputDirty(false);\n          setIsEvaluating(false);\n          // NB: Not using .finally() due to issues with promise implementation in the Jest\n          if (cancelTokenRef.current === cancelToken) {\n            cancelTokenRef.current = null;\n          }\n        }\n      })\n      .catch((e) => {\n        const errorMessage = getPromptEngineeringErrorMessage(e);\n        const wrappedMessage = intl.formatMessage(\n          {\n            defaultMessage: 'MLflow deployment returned the following error: \"{errorMessage}\"',\n            description: 'Experiment page > MLflow deployment error message',\n          },\n          {\n            errorMessage,\n          },\n        );\n        Utils.logErrorAndNotifyUser(wrappedMessage);\n        setIsEvaluating(false);\n        setLastEvaluationError(wrappedMessage);\n        // NB: Not using .finally() due to issues with promise implementation in the Jest\n        if (cancelTokenRef.current === cancelToken) {\n          cancelTokenRef.current = null;\n        }\n      });\n  }, [inputVariableValues, modelRoutesUnified, parameters, promptTemplate, selectedModel, intl]);\n\n  const getEvaluateButtonHandler = () => {\n    return handleEvaluate;\n  };\n\n  // create a handleCancel function to terminate the evaluation if it is in progress\n  const handleCancel = useCallback(() => {\n    if (cancelTokenRef.current) {\n      setIsEvaluating(false);\n      cancelTokenRef.current = null;\n    }\n  }, [setIsEvaluating]);\n\n  const selectModelLabel = intl.formatMessage({\n    defaultMessage: 'Served LLM model',\n    description: 'Experiment page > new run modal > served LLM model endpoint label',\n  });\n  const selectModelPlaceholder = intl.formatMessage({\n    defaultMessage: 'Select LLM model endpoint',\n    description: 'Experiment page > new run modal > served LLM model endpoint placeholder',\n  });\n\n  const promptTemplateProvided = promptTemplate.trim().length > 0;\n  const allInputValuesProvided = useMemo(\n    () => inputVariables.every((variable) => inputVariableValues[variable]?.trim()),\n    [inputVariables, inputVariableValues],\n  );\n\n  const runNameProvided = newRunName.trim().length > 0;\n\n  // We can evaluate if we have selected model, prompt template and all input values.\n  // It should be possible to evaluate without input variables for the purpose of playing around.\n  const evaluateButtonEnabled = selectedModel && promptTemplateProvided && allInputValuesProvided;\n\n  // We can log the run if we have: selected model, prompt template, all input values,\n  // output that is present and up-to-date. Also, in order to log the run, we should have at least\n  // one input variable defined (otherwise prompt engineering won't make sense).\n  const createRunButtonEnabled = Boolean(\n    selectedModel &&\n      promptTemplateProvided &&\n      allInputValuesProvided &&\n      evaluationOutput &&\n      !outputDirty &&\n      inputVariables.length > 0 &&\n      runNameProvided &&\n      !lastEvaluationError,\n  );\n\n  // Let's prepare a proper tooltip content for every scenario\n  const createRunButtonTooltip = useMemo(() => {\n    if (!selectedModel) {\n      return intl.formatMessage({\n        defaultMessage: 'You need to select a served model endpoint using dropdown first',\n        description: 'Experiment page > new run modal > invalid state - no model endpoint selected',\n      });\n    }\n    if (!promptTemplateProvided) {\n      return intl.formatMessage({\n        defaultMessage: 'You need to provide a prompt template',\n        description: 'Experiment page > new run modal > invalid state - no prompt template provided',\n      });\n    }\n    if (!allInputValuesProvided) {\n      return intl.formatMessage({\n        defaultMessage: 'You need to provide values for all defined inputs',\n        description: 'Experiment page > new run modal > invalid state - no prompt inputs provided',\n      });\n    }\n    if (!evaluationOutput) {\n      return intl.formatMessage({\n        defaultMessage: 'You need to evaluate the resulting output first',\n        description: 'Experiment page > new run modal > invalid state - result not evaluated',\n      });\n    }\n    if (outputDirty) {\n      return intl.formatMessage({\n        defaultMessage: 'Input data or prompt template have changed since last evaluation of the output',\n        description: 'Experiment page > new run modal > dirty output (out of sync with new data)',\n      });\n    }\n    if (inputVariables.length === 0) {\n      return intl.formatMessage({\n        defaultMessage: 'You need to define at least one input variable',\n        description: 'Experiment page > new run modal > invalid state - no input variables defined',\n      });\n    }\n    if (!runNameProvided) {\n      return intl.formatMessage({\n        defaultMessage: 'Please provide run name',\n        description: 'Experiment page > new run modal > invalid state - no run name provided',\n      });\n    }\n    return null;\n  }, [\n    allInputValuesProvided,\n    inputVariables.length,\n    intl,\n    outputDirty,\n    evaluationOutput,\n    promptTemplateProvided,\n    selectedModel,\n    runNameProvided,\n  ]);\n\n  // Let's prepare a proper tooltip content for every scenario\n  const evaluateButtonTooltip = useMemo(() => {\n    if (!selectedModel) {\n      return intl.formatMessage({\n        defaultMessage: 'You need to select a served model endpoint using dropdown first',\n        description: 'Experiment page > new run modal > invalid state - no model endpoint selected',\n      });\n    }\n    if (!promptTemplateProvided) {\n      return intl.formatMessage({\n        defaultMessage: 'You need to provide a prompt template',\n        description: 'Experiment page > new run modal > invalid state - no prompt template provided',\n      });\n    }\n    if (!allInputValuesProvided) {\n      return intl.formatMessage({\n        defaultMessage: 'You need to provide values for all defined inputs',\n        description: 'Experiment page > new run modal > invalid state - no prompt inputs provided',\n      });\n    }\n    return null;\n  }, [allInputValuesProvided, intl, promptTemplateProvided, selectedModel]);\n\n  if (isOpen && isViewExamplesModalOpen) {\n    return (\n      <EvaluationCreatePromptRunModalExamples\n        isOpen={isOpen && isViewExamplesModalOpen}\n        closeExamples={() => setViewExamplesModalOpen(false)}\n        closeModal={closeModal}\n        updatePromptTemplate={updatePromptTemplate}\n        updateInputVariableValue={updateInputVariableValue}\n      />\n    );\n  }\n\n  const formatVisibleRouteName = (selectedRouteName: string) => {\n    if (selectedRouteName.includes(':')) {\n      return selectedRouteName.split(':')[1];\n    }\n    return selectedRouteName;\n  };\n\n  const getRouteOptionList = () => {\n    return supportedModelRouteListUnified.map((modelRoute) => (\n      <DialogComboboxOptionListSelectItem\n        value={modelRoute.key}\n        key={modelRoute.key}\n        onChange={(value) => {\n          updateSelectedModel(value);\n        }}\n        checked={selectedModel === modelRoute.key}\n      >\n        {modelRoute.name}\n        {modelRoute.mlflowDeployment && (\n          <DialogComboboxHintRow>{modelRoute.mlflowDeployment.model.name}</DialogComboboxHintRow>\n        )}\n      </DialogComboboxOptionListSelectItem>\n    ));\n  };\n\n  return (\n    <Modal\n      verticalSizing=\"maxed_out\"\n      visible={isOpen}\n      onCancel={closeModal}\n      onOk={closeModal}\n      footer={\n        <div css={{ display: 'flex', gap: theme.spacing.sm, justifyContent: 'flex-end' }}>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_589\"\n            onClick={closeModal}\n          >\n            <FormattedMessage\n              defaultMessage=\"Cancel\"\n              description=\"Experiment page > new run modal > cancel button label\"\n            />\n          </Button>\n          <Tooltip title={createRunButtonTooltip}>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_596\"\n              onClick={onHandleSubmit}\n              data-testid=\"button-create-run\"\n              type=\"primary\"\n              disabled={!createRunButtonEnabled}\n            >\n              <FormattedMessage\n                defaultMessage=\"Create run\"\n                description='Experiment page > new run modal > \"Create run\" confirm button label'\n              />\n            </Button>\n          </Tooltip>\n        </div>\n      }\n      title={\n        <div>\n          <Typography.Title level={2} css={{ marginTop: theme.spacing.sm, marginBottom: theme.spacing.xs }}>\n            <FormattedMessage defaultMessage=\"New run\" description=\"Experiment page > new run modal > modal title\" />\n          </Typography.Title>\n          <Typography.Hint css={{ marginTop: 0, fontWeight: 'normal' }}>\n            Create a new run using a large-language model by giving it a prompt template and model parameters\n          </Typography.Hint>\n        </div>\n      }\n      dangerouslySetAntdProps={{ width: 1200 }}\n    >\n      <div\n        css={{\n          display: 'grid',\n          gridTemplateColumns: '300px 1fr',\n          gap: 48,\n        }}\n      >\n        <div>\n          <FormUI.Label htmlFor=\"selected_model\" css={{ marginBottom: theme.spacing.sm }}>\n            {selectModelLabel}\n          </FormUI.Label>\n          <div css={{ marginBottom: theme.spacing.lg, display: 'flex', alignItems: 'center' }}>\n            <DialogCombobox\n              label={selectModelLabel}\n              modal={false}\n              value={selectedModel ? [formatVisibleRouteName(selectedModel)] : undefined}\n            >\n              <DialogComboboxTrigger\n                id=\"selected_model\"\n                css={{ width: '100%' }}\n                allowClear={false}\n                placeholder={selectModelPlaceholder}\n                withInlineLabel={false}\n              />\n              <DialogComboboxContent loading={modelRoutesLoading} maxHeight={400} matchTriggerWidth>\n                {!modelRoutesLoading && (\n                  <DialogComboboxOptionList>\n                    <DialogComboboxOptionListSearch autoFocus>{getRouteOptionList()}</DialogComboboxOptionListSearch>\n                  </DialogComboboxOptionList>\n                )}\n              </DialogComboboxContent>\n            </DialogCombobox>\n          </div>\n          {selectedModel && (\n            <EvaluationCreatePromptParameters parameters={parameters} updateParameter={updateParameter} />\n          )}\n          <div css={styles.formItem}>\n            <>\n              <FormUI.Label htmlFor=\"new_run_name\">\n                <FormattedMessage\n                  defaultMessage=\"New run name\"\n                  description=\"Experiment page > new run modal > run name input label\"\n                />\n                {!newRunName.trim() && (\n                  <FormUI.Message\n                    type=\"error\"\n                    message={intl.formatMessage({\n                      defaultMessage: 'Please provide run name',\n                      description: 'Experiment page > new run modal > invalid state - no run name provided',\n                    })}\n                  />\n                )}\n              </FormUI.Label>\n              <Input\n                id=\"new_run_name\"\n                data-testid=\"run-name-input\"\n                required\n                value={newRunName}\n                onChange={(e) => setNewRunName(e.target.value)}\n              />\n            </>\n          </div>\n        </div>\n        <div>\n          <div css={styles.formItem}>\n            <>\n              <div css={{ display: 'flex', justifyContent: 'space-between' }}>\n                <FormUI.Label htmlFor=\"prompt_template\">\n                  <FormattedMessage\n                    defaultMessage=\"Prompt Template\"\n                    description=\"Experiment page > new run modal > prompt template input label\"\n                  />\n                </FormUI.Label>\n                <Button\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_695\"\n                  onClick={() => setViewExamplesModalOpen(true)}\n                  style={{ marginLeft: 'auto' }}\n                  size=\"small\"\n                >\n                  <FormattedMessage\n                    defaultMessage=\"View Examples\"\n                    description=\"Experiment page > new run modal > prompt examples button\"\n                  />\n                </Button>\n              </div>\n              <FormUI.Hint>\n                <FormattedMessage\n                  defaultMessage={`Give instructions to the model. Use '{{ }}' or the \"Add new variable\" button to add variables to your prompt.`}\n                  description=\"Experiment page > new run modal > prompt template input hint\"\n                />\n              </FormUI.Hint>\n            </>\n\n            <TextArea\n              id=\"prompt_template\"\n              autoSize={{ minRows: 3 }}\n              data-testid=\"prompt-template-input\"\n              value={promptTemplate}\n              onChange={(e) => updatePromptTemplate(e.target.value)}\n              ref={savePromptTemplateInputRef}\n            />\n            <EvaluationCreateRunPromptTemplateErrors violations={inputVariableNameViolations} />\n          </div>\n          {inputVariables.map((inputVariable) => (\n            <div css={styles.formItem} key={inputVariable}>\n              <>\n                <FormUI.Label htmlFor={inputVariable}>\n                  <span>{inputVariable}</span>\n                </FormUI.Label>\n                <TextArea\n                  id={inputVariable}\n                  autoSize\n                  value={inputVariableValues[inputVariable] ? inputVariableValues[inputVariable] : ''}\n                  onChange={(e) => updateInputVariableValue(inputVariable, e.target.value)}\n                />\n              </>\n            </div>\n          ))}\n          <div css={{ marginBottom: 2 * theme.spacing.md }}>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_736\"\n              icon={<PlusIcon />}\n              onClick={handleAddVariableToTemplate}\n            >\n              <FormattedMessage\n                defaultMessage=\"Add new variable\"\n                description='Experiment page > new run modal > \"add new variable\" button label'\n              />\n            </Button>\n          </div>\n          <EvaluationCreatePromptRunOutput\n            evaluateButtonTooltip={evaluateButtonTooltip}\n            evaluationMetadata={evaluationMetadata}\n            evaluationOutput={evaluationOutput}\n            disabled={!evaluateButtonEnabled}\n            isEvaluating={isEvaluating}\n            isOutputDirty={outputDirty}\n            onCancelClick={handleCancel}\n            onEvaluateClick={getEvaluateButtonHandler()}\n            evaluationError={lastEvaluationError}\n          />\n        </div>\n      </div>\n      {isCreatingRun && (\n        // Scrim overlay\n        <div\n          css={{\n            inset: 0,\n            backgroundColor: theme.colors.overlayOverlay,\n            position: 'absolute',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            zIndex: 1,\n          }}\n        >\n          <Spinner />\n        </div>\n      )}\n    </Modal>\n  );\n};\n\nconst styles = {\n  formItem: { marginBottom: 16 },\n};\n","import { useCallback, useEffect, useMemo, useState } from 'react';\nimport { debounce, fromPairs, isEqual } from 'lodash';\nimport {\n  DEFAULT_PROMPTLAB_INPUT_VALUES,\n  extractPromptInputVariables,\n  getPromptInputVariableNameViolations,\n} from '../../prompt-engineering/PromptEngineering.utils';\n\nexport const usePromptEvaluationInputValues = () => {\n  const [inputVariables, updateInputVariablesDirect] = useState<string[]>(extractPromptInputVariables(''));\n\n  const [inputVariableNameViolations, setInputVariableNameViolations] = useState<\n    ReturnType<typeof getPromptInputVariableNameViolations>\n  >({ namesWithSpaces: [] });\n\n  const [inputVariableValues, updateInputVariableValues] =\n    useState<Record<string, string>>(DEFAULT_PROMPTLAB_INPUT_VALUES);\n\n  const clearInputVariableValues = useCallback(() => updateInputVariableValues({}), []);\n\n  const updateInputVariables = useMemo(\n    () =>\n      // Prevent calculating new input variable set on every keystroke of a template,\n      // let's debounce it by 250ms\n      debounce((promptTemplate: string) => {\n        updateInputVariablesDirect((currentInputVariables) => {\n          const newInputVariables = extractPromptInputVariables(promptTemplate);\n          if (!isEqual(newInputVariables, currentInputVariables)) {\n            return newInputVariables;\n          }\n          return currentInputVariables;\n        });\n        setInputVariableNameViolations(getPromptInputVariableNameViolations(promptTemplate));\n      }, 250),\n    [],\n  );\n\n  const updateInputVariableValue = useCallback((name: string, value: string) => {\n    updateInputVariableValues((values) => ({ ...values, [name]: value }));\n  }, []);\n\n  // Sanitize the variable dictionary so only actually used variables\n  // will be returned (discard leftovers from previous prompt templates)\n  const sanitizedInputVariableValues = useMemo(\n    () => fromPairs(Object.entries(inputVariableValues).filter(([key]) => inputVariables.includes(key))),\n    [inputVariableValues, inputVariables],\n  );\n\n  return {\n    updateInputVariables,\n    inputVariables,\n    inputVariableValues: sanitizedInputVariableValues,\n    updateInputVariableValue,\n    inputVariableNameViolations,\n    clearInputVariableValues,\n  };\n};\n","import React, { useCallback, useContext, useMemo, useState } from 'react';\nimport { RunRowType } from '../utils/experimentPage.row-types';\nimport { EvaluationCreatePromptRunModal } from '../../evaluation-artifacts-compare/EvaluationCreatePromptRunModal';\nimport { shouldEnablePromptLab } from '../../../../common/utils/FeatureUtils';\n\nconst CreateNewRunContext = React.createContext<{\n  createNewRun: (runToDuplicate?: RunRowType) => void;\n}>({\n  createNewRun: () => {},\n});\n\n/**\n * A thin context wrapper dedicated to invoke \"create run\" modal in various areas of the experiment runs page UI\n */\nexport const CreateNewRunContextProvider = ({\n  children,\n  visibleRuns,\n  refreshRuns,\n}: {\n  children: React.ReactNode;\n  visibleRuns: RunRowType[];\n  refreshRuns: (() => Promise<never[]>) | (() => Promise<any> | null) | (() => void);\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [runBeingDuplicated, setRunBeingDuplicated] = useState<RunRowType | null>(null);\n\n  const contextValue = useMemo(\n    () => ({\n      createNewRun: (runToDuplicate?: RunRowType) => {\n        setIsOpen(true);\n        setRunBeingDuplicated(runToDuplicate || null);\n      },\n    }),\n    [],\n  );\n\n  return (\n    <CreateNewRunContext.Provider value={contextValue}>\n      {children}\n      {shouldEnablePromptLab() && (\n        <EvaluationCreatePromptRunModal\n          visibleRuns={visibleRuns}\n          isOpen={isOpen}\n          closeModal={() => setIsOpen(false)}\n          runBeingDuplicated={runBeingDuplicated}\n          refreshRuns={refreshRuns}\n        />\n      )}\n    </CreateNewRunContext.Provider>\n  );\n};\n\nexport const useCreateNewRun = () => useContext(CreateNewRunContext);\n","import {\n  DEFAULT_LIFECYCLE_FILTER,\n  DEFAULT_MODEL_VERSION_FILTER,\n  DEFAULT_ORDER_BY_ASC,\n  DEFAULT_ORDER_BY_KEY,\n  DEFAULT_START_TIME,\n} from '../../../constants';\nimport type { DatasetSummary, LIFECYCLE_FILTER, MODEL_VERSION_FILTER } from '../../../types';\n\n/**\n * Defines persistable model representing sort and filter values\n * used by runs table and controls\n */\nexport interface ExperimentPageSearchFacetsState {\n  /**\n   * SQL-like query string used to filter runs, e.g. \"params.alpha = '0.5'\"\n   */\n  searchFilter: string;\n\n  /**\n   * Canonical order_by key like \"params.`alpha`\". May be null to indicate the table\n   * should use the natural row ordering provided by the server.\n   */\n  orderByKey: string;\n\n  /**\n   * Whether the order imposed by orderByKey should be ascending or descending.\n   */\n  orderByAsc: boolean;\n\n  /**\n   * Filter key to show results based on start time\n   */\n  startTime: string;\n\n  /**\n   * Lifecycle filter of runs to display\n   */\n  lifecycleFilter: LIFECYCLE_FILTER;\n\n  /**\n   * Datasets filter of runs to display\n   */\n  datasetsFilter: DatasetSummary[];\n\n  /**\n   * Filter of model versions to display\n   */\n  modelVersionFilter: MODEL_VERSION_FILTER;\n}\n\n/**\n * Defines default experiment page search facets state.\n */\nexport const createExperimentPageSearchFacetsState = (): ExperimentPageSearchFacetsState => ({\n  searchFilter: '',\n  orderByKey: DEFAULT_ORDER_BY_KEY,\n  orderByAsc: DEFAULT_ORDER_BY_ASC,\n  startTime: DEFAULT_START_TIME,\n  lifecycleFilter: DEFAULT_LIFECYCLE_FILTER,\n  datasetsFilter: [],\n  modelVersionFilter: DEFAULT_MODEL_VERSION_FILTER,\n});\n","import { isArray } from 'lodash';\nimport { atobUtf8, btoaUtf8 } from '../../../../common/utils/StringUtils';\nimport { ExperimentPageSearchFacetsState } from '../models/ExperimentPageSearchFacetsState';\nimport { ExperimentPageUIState } from '../models/ExperimentPageUIState';\n\ntype PersistSearchSerializeFunctions<Serialized = any, Unserialized = any> = {\n  serializeLocalStorage?(input: Unserialized): Serialized;\n  serializeQueryString?(input: Unserialized): Serialized;\n  deserializeLocalStorage?(input: Serialized): Unserialized;\n  deserializeQueryString?(input: Serialized): Unserialized;\n};\n\n/**\n * \"Flattens\" the strings array, i.e. merges it into a single value\n */\nconst flattenString = (input: string | string[]) => (isArray(input) ? input.join() : input);\n\n/**\n * All known field serialization and deserialization mechanisms used in search facets state persisting mechanism.\n */\nconst persistSearchStateFieldSerializers: Record<string, PersistSearchSerializeFunctions> = {\n  /**\n   * In rare cases, search filter might contain commas that interfere with `querystring` library\n   * parsing causing it to return array instead of string. Since it's difficult to selectively\n   * change `querystring`'s parsing action, we are making sure that the parsed values are always strings.\n   */\n  searchFilter: {\n    deserializeLocalStorage: flattenString,\n    deserializeQueryString: flattenString,\n  },\n  orderByAsc: {\n    serializeQueryString(input: boolean) {\n      return input.toString();\n    },\n    deserializeQueryString(input: string) {\n      return input === 'true';\n    },\n  },\n  datasetsFilter: {\n    serializeQueryString(inputs: ExperimentPageSearchFacetsState['datasetsFilter']) {\n      const inputsWithoutExperimentId = inputs.map(({ name, digest, context }) => ({\n        name,\n        digest,\n        context,\n      }));\n      return btoaUtf8(JSON.stringify(inputsWithoutExperimentId));\n    },\n    deserializeQueryString(input: string): ExperimentPageSearchFacetsState['datasetsFilter'] {\n      try {\n        // Process the URL defensively against intended and unintended malformation\n        const parsedResult = JSON.parse(atobUtf8(input));\n        if (!Array.isArray(parsedResult)) {\n          return [];\n        }\n        return parsedResult;\n      } catch {\n        return [];\n      }\n    },\n  },\n  /**\n   * Array of visible configured charts are serialized into base64-encoded JSON when put into query string\n   */\n  compareRunCharts: {\n    serializeQueryString(input: ExperimentPageUIState['compareRunCharts']) {\n      return btoaUtf8(JSON.stringify(input));\n    },\n    deserializeQueryString(input: string): ExperimentPageUIState['compareRunCharts'] {\n      try {\n        // Process the URL defensively against intended and unintended malformation\n        const parsedResult = JSON.parse(atobUtf8(input));\n        if (!Array.isArray(parsedResult)) {\n          return undefined;\n        }\n        return parsedResult;\n      } catch {\n        return undefined;\n      }\n    },\n  },\n  /**\n   * For \"compareRunsMode\", we will always save \"undefined\" value to local storage so users will\n   * get back to default view after visiting the view once more.\n   */\n  compareRunsMode: {\n    serializeLocalStorage() {\n      return undefined;\n    },\n  },\n};\n\ntype StateKey = keyof Partial<ExperimentPageSearchFacetsState>;\n\n/**\n * Consumes an object with persistable search facets and transforms relevant fields\n * with the registered serialization functions specific to query string.\n * Example scenario: serializing an array of visible configured charts into base64-encoded JSON.\n */\nexport const serializeFieldsToQueryString = (input: Partial<ExperimentPageSearchFacetsState>) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const serializeFn = persistSearchStateFieldSerializers[field]?.serializeQueryString;\n    if (serializeFn) {\n      resultObject[field] = serializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with search facets extracted from query string and transforms relevant fields\n * with the registered deserialization functions. Example scenario: deserializing an array of\n * visible configured charts from base64-encoded JSON.\n */\nexport const deserializeFieldsFromQueryString = (\n  input: Partial<ExperimentPageSearchFacetsState> | Record<string, any>,\n) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const deserializeFn = persistSearchStateFieldSerializers[field]?.deserializeQueryString;\n    if (deserializeFn) {\n      resultObject[field] = deserializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with persistable search facets and transforms relevant fields\n * with the registered serialization functions specific to local storage.\n * Example scenario: serializing an array of visible configured charts into base64-encoded JSON.\n */\nexport const serializeFieldsToLocalStorage = (input: Partial<ExperimentPageSearchFacetsState>) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const serializeFn = persistSearchStateFieldSerializers[field]?.serializeLocalStorage;\n    if (serializeFn) {\n      resultObject[field] = serializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with search facets extracted from local storage and transforms relevant fields\n * with the registered deserialization functions. Example scenario: deserializing an array of\n * visible configured charts from base64-encoded JSON.\n */\nexport const deserializeFieldsFromLocalStorage = (\n  input: Partial<ExperimentPageSearchFacetsState> | Record<string, any>,\n) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const deserializeFn = persistSearchStateFieldSerializers[field]?.deserializeLocalStorage;\n    if (deserializeFn) {\n      resultObject[field] = deserializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n","import { assign, entries, isNil, keys, omitBy, pick } from 'lodash';\nimport { useMemo } from 'react';\nimport { NavigateOptions, useParams, useSearchParams } from '../../../../common/utils/RoutingUtils';\nimport {\n  ExperimentPageSearchFacetsState,\n  createExperimentPageSearchFacetsState,\n} from '../models/ExperimentPageSearchFacetsState';\nimport {\n  deserializeFieldsFromQueryString,\n  serializeFieldsToQueryString,\n} from '../utils/persistSearchFacets.serializers';\n\nexport const EXPERIMENT_PAGE_QUERY_PARAM_KEYS = [\n  'searchFilter',\n  'orderByKey',\n  'orderByAsc',\n  'startTime',\n  'lifecycleFilter',\n  'modelVersionFilter',\n  'datasetsFilter',\n];\n\nexport type ExperimentPageQueryParams = any;\n\nexport type ExperimentQueryParamsSearchFacets = ExperimentPageSearchFacetsState & {\n  experimentIds?: string[];\n};\n\nconst getComparedExperimentIds = (comparedExperimentIds: string): string[] => {\n  try {\n    return comparedExperimentIds ? JSON.parse(comparedExperimentIds) : [];\n  } catch {\n    return [];\n  }\n};\n\nexport const useExperimentPageSearchFacets = (): [ExperimentQueryParamsSearchFacets | null, string[]] => {\n  const [queryParams] = useSearchParams();\n\n  // Pick only the keys we care about\n  const pickedValues = useMemo(\n    () => pick(Object.fromEntries(queryParams.entries()), EXPERIMENT_PAGE_QUERY_PARAM_KEYS),\n    [queryParams],\n  );\n\n  // Destructure to get raw values\n  const { searchFilter, orderByKey, orderByAsc, startTime, lifecycleFilter, modelVersionFilter, datasetsFilter } =\n    pickedValues;\n\n  const areValuesEmpty = keys(pickedValues).length < 1;\n\n  const { experimentId } = useParams<{ experimentId: string }>();\n  const queryParamsExperimentIds = queryParams.get('experiments');\n\n  // Calculate experiment IDs\n  const experimentIds = useMemo(() => {\n    if (experimentId) {\n      return [experimentId];\n    }\n    if (queryParamsExperimentIds) {\n      return getComparedExperimentIds(queryParamsExperimentIds);\n    }\n    return [];\n  }, [experimentId, queryParamsExperimentIds]);\n\n  // Calculate and memoize search facets\n  const searchFacets = useMemo(() => {\n    if (areValuesEmpty) {\n      return null;\n    }\n    const deserializedFields = deserializeFieldsFromQueryString(\n      omitBy(\n        {\n          searchFilter,\n          orderByKey,\n          orderByAsc,\n          startTime,\n          lifecycleFilter,\n          modelVersionFilter,\n          datasetsFilter,\n        },\n        isNil,\n      ),\n    ) as ExperimentPageSearchFacetsState;\n\n    // If not all fields are provided, fill the gaps with default values\n    return assign(createExperimentPageSearchFacetsState(), deserializedFields);\n  }, [\n    // Use exact values to avoid unnecessary re-renders\n    searchFilter,\n    orderByKey,\n    orderByAsc,\n    startTime,\n    lifecycleFilter,\n    modelVersionFilter,\n    datasetsFilter,\n    areValuesEmpty,\n  ]);\n\n  return [searchFacets, experimentIds];\n};\n\nexport const useUpdateExperimentPageSearchFacets = () => {\n  const [, setParams] = useSearchParams();\n\n  return (partialFacets: Partial<ExperimentPageSearchFacetsState>, options?: NavigateOptions) => {\n    const newParams = serializeFieldsToQueryString(partialFacets);\n    setParams((currentParams) => {\n      entries(newParams).forEach(([key, value]) => {\n        currentParams.set(key, value);\n      });\n      return currentParams;\n    }, options);\n  };\n};\n","import {\n  Button,\n  Tag,\n  DialogCombobox,\n  DialogComboboxContent,\n  DialogComboboxOptionList,\n  DialogComboboxOptionListCheckboxItem,\n  DialogComboboxOptionListSelectItem,\n  DialogComboboxOptionListSearch,\n  DialogComboboxTrigger,\n  DownloadIcon,\n  ClipboardIcon,\n  FullscreenExitIcon,\n  FullscreenIcon,\n  OverflowIcon,\n  PlusIcon,\n  SidebarIcon,\n  Tooltip,\n  useDesignSystemTheme,\n  DropdownMenu,\n  ToggleButton,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\n\nimport { shouldEnableExperimentPageAutoRefresh, shouldEnablePromptLab } from 'common/utils/FeatureUtils';\nimport React, { useMemo, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { ToggleIconButton } from '../../../../../common/components/ToggleIconButton';\nimport { ErrorWrapper } from '../../../../../common/utils/ErrorWrapper';\nimport { LIFECYCLE_FILTER } from '../../../../constants';\nimport { UpdateExperimentViewStateFn } from '../../../../types';\nimport { useExperimentIds } from '../../hooks/useExperimentIds';\nimport { ExperimentPageViewState } from '../../models/ExperimentPageViewState';\nimport { getStartTimeColumnDisplayName } from '../../utils/experimentPage.common-utils';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRefreshButton } from './ExperimentViewRefreshButton';\nimport { RunsSearchAutoComplete } from './RunsSearchAutoComplete';\nimport type { ExperimentStoreEntities, DatasetSummary } from '../../../../types';\nimport { datasetSummariesEqual } from '../../../../utils/DatasetUtils';\nimport { CreateNotebookRunModal } from 'experiment-tracking/components/evaluation-artifacts-compare/CreateNotebookRunModal';\nimport { PreviewBadge } from 'shared/building_blocks/PreviewBadge';\nimport { useCreateNewRun } from '../../hooks/useCreateNewRun';\nimport { useExperimentPageViewMode } from '../../hooks/useExperimentPageViewMode';\nimport { useUpdateExperimentPageSearchFacets } from '../../hooks/useExperimentPageSearchFacets';\nimport {\n  ExperimentPageSearchFacetsState,\n  createExperimentPageSearchFacetsState,\n} from '../../models/ExperimentPageSearchFacetsState';\nimport { useUpdateExperimentViewUIState } from '../../contexts/ExperimentPageUIStateContext';\n\nexport type ExperimentViewRunsControlsFiltersProps = {\n  searchFacetsState: ExperimentPageSearchFacetsState;\n  experimentId: string;\n  viewState: ExperimentPageViewState;\n  updateViewState: UpdateExperimentViewStateFn;\n  runsData: ExperimentRunsSelectorResult;\n  onDownloadCsv: () => void;\n  requestError: ErrorWrapper | null;\n  additionalControls?: React.ReactNode;\n  refreshRuns: () => void;\n  viewMaximized: boolean;\n  autoRefreshEnabled?: boolean;\n};\n\nexport const ExperimentViewRunsControlsFilters = React.memo(\n  ({\n    searchFacetsState,\n    experimentId,\n    runsData,\n    viewState,\n    updateViewState,\n    onDownloadCsv,\n    requestError,\n    additionalControls,\n    refreshRuns,\n    viewMaximized,\n    autoRefreshEnabled = false,\n  }: ExperimentViewRunsControlsFiltersProps) => {\n    const setUrlSearchFacets = useUpdateExperimentPageSearchFacets();\n\n    const [pageViewMode] = useExperimentPageViewMode();\n    const updateUIState = useUpdateExperimentViewUIState();\n\n    const isComparingExperiments = useExperimentIds().length > 1;\n    const { startTime, lifecycleFilter, datasetsFilter, searchFilter } = searchFacetsState;\n\n    // Use modernized view mode value getter if flag is set\n    const compareRunsMode = pageViewMode;\n\n    const intl = useIntl();\n    const { createNewRun } = useCreateNewRun();\n    const [isCreateRunWithNotebookModalOpen, setCreateRunWithNotebookModalOpenValue] = useState(false);\n    const { theme } = useDesignSystemTheme();\n\n    // List of labels for \"start time\" filter\n    const startTimeColumnLabels: Record<string, string> = useMemo(() => getStartTimeColumnDisplayName(intl), [intl]);\n\n    const currentLifecycleFilterValue =\n      lifecycleFilter === LIFECYCLE_FILTER.ACTIVE\n        ? intl.formatMessage({\n            defaultMessage: 'Active',\n            description: 'Linked model dropdown option to show active experiment runs',\n          })\n        : intl.formatMessage({\n            defaultMessage: 'Deleted',\n            description: 'Linked model dropdown option to show deleted experiment runs',\n          });\n\n    const currentStartTimeFilterLabel = intl.formatMessage({\n      defaultMessage: 'Time created',\n      description: 'Label for the start time select dropdown for experiment runs view',\n    });\n\n    // Show preview sidebar only on table view and artifact view\n    const displaySidebarToggleButton = compareRunsMode === undefined || compareRunsMode === 'ARTIFACT';\n\n    const datasetSummaries: DatasetSummary[] = useSelector(\n      (state: { entities: ExperimentStoreEntities }) => state.entities.datasetsByExperimentId[experimentId],\n    );\n\n    const updateDatasetsFilter = (summary: DatasetSummary) => {\n      const newDatasetsFilter = datasetsFilter.some((item) => datasetSummariesEqual(item, summary))\n        ? datasetsFilter.filter((item) => !datasetSummariesEqual(item, summary))\n        : [...datasetsFilter, summary];\n\n      setUrlSearchFacets({\n        datasetsFilter: newDatasetsFilter,\n      });\n    };\n\n    const hasDatasets = datasetSummaries !== undefined;\n\n    const searchFilterChange = (newSearchFilter: string) => {\n      setUrlSearchFacets({ searchFilter: newSearchFilter });\n    };\n\n    return (\n      <div\n        css={{\n          display: 'flex',\n          gap: theme.spacing.sm,\n          justifyContent: 'space-between',\n          [theme.responsive.mediaQueries.xs]: {\n            flexDirection: 'column',\n          },\n        }}\n      >\n        <div\n          css={{\n            display: 'flex',\n            gap: theme.spacing.sm,\n            alignItems: 'center',\n            flexWrap: 'wrap' as const,\n          }}\n        >\n          <RunsSearchAutoComplete\n            runsData={runsData}\n            searchFilter={searchFilter}\n            onSearchFilterChange={searchFilterChange}\n            onClear={() => {\n              setUrlSearchFacets(createExperimentPageSearchFacetsState());\n            }}\n            requestError={requestError}\n          />\n\n          <DialogCombobox\n            label={currentStartTimeFilterLabel}\n            value={startTime !== 'ALL' ? [startTimeColumnLabels[startTime]] : []}\n          >\n            <DialogComboboxTrigger\n              allowClear={startTime !== 'ALL'}\n              onClear={() => {\n                setUrlSearchFacets({ startTime: 'ALL' });\n              }}\n              data-test-id=\"start-time-select-dropdown\"\n            />\n            <DialogComboboxContent>\n              <DialogComboboxOptionList>\n                {Object.keys(startTimeColumnLabels).map((startTimeKey) => (\n                  <DialogComboboxOptionListSelectItem\n                    key={startTimeKey}\n                    checked={startTimeKey === startTime}\n                    title={startTimeColumnLabels[startTimeKey]}\n                    data-test-id={`start-time-select-${startTimeKey}`}\n                    value={startTimeKey}\n                    onChange={() => {\n                      setUrlSearchFacets({ startTime: startTimeKey });\n                    }}\n                  >\n                    {startTimeColumnLabels[startTimeKey]}\n                  </DialogComboboxOptionListSelectItem>\n                ))}\n              </DialogComboboxOptionList>\n            </DialogComboboxContent>\n          </DialogCombobox>\n\n          <DialogCombobox\n            label={intl.formatMessage({\n              defaultMessage: 'State',\n              description: 'Filtering label to filter experiments based on state of active or deleted',\n            })}\n            value={[currentLifecycleFilterValue]}\n          >\n            <DialogComboboxTrigger allowClear={false} data-testid=\"lifecycle-filter\" />\n            <DialogComboboxContent>\n              <DialogComboboxOptionList>\n                <DialogComboboxOptionListSelectItem\n                  checked={lifecycleFilter === LIFECYCLE_FILTER.ACTIVE}\n                  key={LIFECYCLE_FILTER.ACTIVE}\n                  data-testid=\"active-runs-menu-item\"\n                  value={LIFECYCLE_FILTER.ACTIVE}\n                  onChange={() => {\n                    setUrlSearchFacets({ lifecycleFilter: LIFECYCLE_FILTER.ACTIVE });\n                  }}\n                >\n                  <FormattedMessage\n                    defaultMessage=\"Active\"\n                    description=\"Linked model dropdown option to show active experiment runs\"\n                  />\n                </DialogComboboxOptionListSelectItem>\n                <DialogComboboxOptionListSelectItem\n                  checked={lifecycleFilter === LIFECYCLE_FILTER.DELETED}\n                  key={LIFECYCLE_FILTER.DELETED}\n                  data-testid=\"deleted-runs-menu-item\"\n                  value={LIFECYCLE_FILTER.DELETED}\n                  onChange={() => {\n                    setUrlSearchFacets({ lifecycleFilter: LIFECYCLE_FILTER.DELETED });\n                  }}\n                >\n                  <FormattedMessage\n                    defaultMessage=\"Deleted\"\n                    description=\"Linked model dropdown option to show deleted experiment runs\"\n                  />\n                </DialogComboboxOptionListSelectItem>\n              </DialogComboboxOptionList>\n            </DialogComboboxContent>\n          </DialogCombobox>\n          <DialogCombobox\n            label={intl.formatMessage({\n              defaultMessage: 'Datasets',\n              description: 'Filtering label to filter runs based on datasets used',\n            })}\n            value={datasetsFilter.map((datasetSummary) => datasetSummary.name)}\n            multiSelect\n          >\n            <Tooltip\n              title={\n                !hasDatasets && (\n                  <FormattedMessage\n                    defaultMessage=\"No datasets were recorded for this experiment's runs.\"\n                    description=\"Message to indicate that no datasets were recorded for this experiment's runs.\"\n                  />\n                )\n              }\n            >\n              <DialogComboboxTrigger\n                allowClear\n                onClear={() => setUrlSearchFacets({ datasetsFilter: [] })}\n                data-test-id=\"datasets-select-dropdown\"\n                showTagAfterValueCount={1}\n                disabled={!hasDatasets}\n              />\n              {hasDatasets && (\n                <DialogComboboxContent maxHeight={600}>\n                  <DialogComboboxOptionList>\n                    <DialogComboboxOptionListSearch>\n                      {datasetSummaries.map((summary: DatasetSummary) => (\n                        <DialogComboboxOptionListCheckboxItem\n                          key={summary.name + summary.digest + summary.context}\n                          checked={datasetsFilter.some((item) => datasetSummariesEqual(item, summary))}\n                          title={summary.name}\n                          data-test-id={`dataset-dropdown-${summary.name}`}\n                          value={summary.name}\n                          onChange={() => updateDatasetsFilter(summary)}\n                        >\n                          {summary.name} ({summary.digest}){' '}\n                          {summary.context && (\n                            <Tag css={{ textTransform: 'capitalize', marginRight: theme.spacing.xs }}>\n                              {summary.context}\n                            </Tag>\n                          )}\n                        </DialogComboboxOptionListCheckboxItem>\n                      ))}\n                    </DialogComboboxOptionListSearch>\n                  </DialogComboboxOptionList>\n                </DialogComboboxContent>\n              )}\n            </Tooltip>\n          </DialogCombobox>\n          {additionalControls}\n        </div>\n        <div\n          css={{\n            display: 'flex',\n            gap: theme.spacing.sm,\n            alignItems: 'flex-start',\n          }}\n        >\n          <DropdownMenu.Root>\n            <DropdownMenu.Trigger asChild>\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_338\"\n                icon={<OverflowIcon />}\n                aria-label={intl.formatMessage({\n                  defaultMessage: 'More options',\n                  description: 'Experiment page > control bar > more options button accessible label',\n                })}\n              />\n            </DropdownMenu.Trigger>\n            <DropdownMenu.Content>\n              <DropdownMenu.Item className=\"csv-button\" onClick={onDownloadCsv}>\n                <DropdownMenu.IconWrapper>\n                  <DownloadIcon />\n                </DropdownMenu.IconWrapper>\n                {`Download ${runsData.runInfos.length} runs`}\n              </DropdownMenu.Item>\n              {shouldEnableExperimentPageAutoRefresh() && (\n                <>\n                  <DropdownMenu.Separator />\n                  <DropdownMenu.CheckboxItem\n                    checked={autoRefreshEnabled}\n                    onClick={() =>\n                      updateUIState((state) => ({\n                        ...state,\n                        autoRefreshEnabled: !state.autoRefreshEnabled,\n                      }))\n                    }\n                  >\n                    <DropdownMenu.ItemIndicator />\n                    <FormattedMessage\n                      defaultMessage=\"Auto-refresh\"\n                      description=\"String for the auto-refresh button that refreshes the runs list automatically\"\n                    />\n                  </DropdownMenu.CheckboxItem>\n                </>\n              )}\n            </DropdownMenu.Content>\n          </DropdownMenu.Root>\n\n          <CreateNotebookRunModal\n            isOpen={isCreateRunWithNotebookModalOpen}\n            closeModal={() => setCreateRunWithNotebookModalOpenValue(false)}\n            experimentId={experimentId}\n          />\n\n          {displaySidebarToggleButton && (\n            <Tooltip\n              title={intl.formatMessage({\n                defaultMessage: 'Toggle the preview sidepane',\n                description: 'Experiment page > control bar > expanded view toggle button tooltip',\n              })}\n              useAsLabel\n            >\n              <ToggleIconButton\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_403\"\n                pressed={viewState.previewPaneVisible}\n                icon={<SidebarIcon />}\n                onClick={() => updateViewState({ previewPaneVisible: !viewState.previewPaneVisible })}\n              />\n            </Tooltip>\n          )}\n          {!shouldEnableExperimentPageAutoRefresh() && <ExperimentViewRefreshButton refreshRuns={refreshRuns} />}\n          {/* TODO: Add tooltip to guide users to this button */}\n          {shouldEnablePromptLab() && !isComparingExperiments && (\n            <DropdownMenu.Root>\n              <DropdownMenu.Trigger asChild>\n                <Button\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_415\"\n                  type=\"primary\"\n                  icon={<PlusIcon />}\n                >\n                  <FormattedMessage\n                    defaultMessage=\"New run\"\n                    description=\"Button used to pop up a modal to create a new run\"\n                  />\n                </Button>\n              </DropdownMenu.Trigger>\n              <DropdownMenu.Content>\n                <DropdownMenu.Item onSelect={() => createNewRun()}>\n                  {' '}\n                  <FormattedMessage\n                    defaultMessage=\"using Prompt Engineering\"\n                    description=\"String for creating a new run with prompt engineering modal\"\n                  />\n                  <PreviewBadge />\n                </DropdownMenu.Item>\n                <DropdownMenu.Item onSelect={() => setCreateRunWithNotebookModalOpenValue(true)}>\n                  {' '}\n                  <FormattedMessage\n                    defaultMessage=\"using Notebook\"\n                    description=\"String for creating a new run from a notebook\"\n                  />\n                </DropdownMenu.Item>\n              </DropdownMenu.Content>\n            </DropdownMenu.Root>\n          )}\n        </div>\n      </div>\n    );\n  },\n);\n","import {\n  DialogCombobox,\n  DialogComboboxContent,\n  DialogComboboxOptionList,\n  DialogComboboxOptionListSearch,\n  DialogComboboxOptionListSelectItem,\n  DialogComboboxTrigger,\n  ArrowDownIcon,\n  ArrowUpIcon,\n  SortAscendingIcon,\n  SortDescendingIcon,\n} from '@databricks/design-system';\nimport React, { useMemo, useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { middleTruncateStr } from '../../../../../common/utils/StringUtils';\nimport { COLUMN_SORT_BY_ASC, COLUMN_SORT_BY_DESC, SORT_DELIMITER_SYMBOL } from '../../../../constants';\nimport { ExperimentRunSortOption } from '../../hooks/useRunSortOptions';\nimport { useUpdateExperimentPageSearchFacets } from '../../hooks/useExperimentPageSearchFacets';\nimport { useUpdateExperimentViewUIState } from '../../contexts/ExperimentPageUIStateContext';\n\nexport const ExperimentViewRunsSortSelector = React.memo(\n  (props: { orderByKey: string; orderByAsc: boolean; sortOptions: ExperimentRunSortOption[] }) => {\n    const setUrlSearchFacets = useUpdateExperimentPageSearchFacets();\n    const updateUIState = useUpdateExperimentViewUIState();\n    const intl = useIntl();\n\n    const { sortOptions } = props;\n    const { orderByKey, orderByAsc } = props;\n\n    const onSortKeyChanged = ({ value }: { value: string }) => {\n      const [newOrderBy, newOrderAscending] = value.split(SORT_DELIMITER_SYMBOL);\n\n      setUrlSearchFacets({\n        orderByAsc: newOrderAscending === COLUMN_SORT_BY_ASC,\n        orderByKey: newOrderBy,\n      });\n\n      updateUIState((currentUIState) => {\n        if (!currentUIState.selectedColumns.includes(newOrderBy)) {\n          return {\n            ...currentUIState,\n            selectedColumns: [...currentUIState.selectedColumns, newOrderBy],\n          };\n        }\n        return currentUIState;\n      });\n    };\n\n    // Currently used canonical \"sort by\" value in form of \"COLUMN_NAME***DIRECTION\", e.g. \"metrics.`metric`***DESCENDING\"\n    const currentSortSelectValue = useMemo(\n      () => `${orderByKey}${SORT_DELIMITER_SYMBOL}${orderByAsc ? COLUMN_SORT_BY_ASC : COLUMN_SORT_BY_DESC}`,\n      [orderByAsc, orderByKey],\n    );\n\n    /**\n     * Calculate and memoize a label displayed in the \"sort by\" select.\n     *\n     * If full metrics and params list is populated by runs from the API, use the\n     * value corresponding to the calculated sort option list.\n     *\n     * If the sort option list is incomplete (e.g. because fetched run set is empty) while the\n     * order key is given (e.g. because URL state says so), use it to extract the key name.\n     */\n    const currentSortSelectLabel = useMemo(() => {\n      // Search through all sort options generated basing on the fetched runs\n      const sortOption = sortOptions.find((option) => option.value === currentSortSelectValue);\n\n      let sortOptionLabel = sortOption?.label;\n\n      // If the actually chosen sort value is not found in the sort option list (e.g. because the list of fetched runs is empty),\n      // use it to generate the label\n      if (!sortOptionLabel) {\n        // The following regex extracts plain sort key name from its canonical form, i.e.\n        // metrics.`metric_key_name` => metric_key_name\n        const extractedKeyName = orderByKey.match(/^.+\\.`(.+)`$/);\n        if (extractedKeyName) {\n          // eslint-disable-next-line prefer-destructuring\n          sortOptionLabel = extractedKeyName[1];\n        }\n      }\n      return `${intl.formatMessage({\n        defaultMessage: 'Sort',\n        description: 'Sort by default option for sort by select dropdown for experiment runs',\n      })}: ${sortOptionLabel}`;\n    }, [currentSortSelectValue, orderByKey, sortOptions, intl]);\n\n    const sortLabelElement = useMemo(() => {\n      return (\n        <span css={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n          {orderByAsc ? <SortAscendingIcon /> : <SortDescendingIcon />} {currentSortSelectLabel}\n        </span>\n      );\n    }, [currentSortSelectLabel, orderByAsc]);\n\n    const handleChange = (updatedValue: string) => {\n      onSortKeyChanged({ value: updatedValue });\n      setOpen(false);\n    };\n\n    const handleClear = () => {\n      onSortKeyChanged({ value: '' });\n    };\n\n    const [open, setOpen] = useState(false);\n\n    return (\n      <DialogCombobox label={sortLabelElement} onOpenChange={setOpen} open={open}>\n        <DialogComboboxTrigger\n          onClear={handleClear}\n          data-test-id=\"sort-select-dropdown\"\n          aria-label={currentSortSelectLabel}\n        />\n        <DialogComboboxContent minWidth={250}>\n          <DialogComboboxOptionList>\n            <DialogComboboxOptionListSearch>\n              {sortOptions.map((sortOption) => (\n                <DialogComboboxOptionListSelectItem\n                  key={sortOption.value}\n                  value={sortOption.value}\n                  onChange={handleChange}\n                  checked={sortOption.value === currentSortSelectValue}\n                  data-test-id={`sort-select-${sortOption.label}-${sortOption.order}`}\n                >\n                  <span css={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n                    {sortOption.order === COLUMN_SORT_BY_ASC ? <ArrowUpIcon /> : <ArrowDownIcon />}\n                    {middleTruncateStr(sortOption.label, 50)}\n                  </span>\n                </DialogComboboxOptionListSelectItem>\n              ))}\n            </DialogComboboxOptionListSearch>\n          </DialogComboboxOptionList>\n        </DialogComboboxContent>\n      </DialogCombobox>\n    );\n  },\n);\n","import {\n  Button,\n  ChevronDownIcon,\n  ColumnsIcon,\n  Dropdown,\n  Input,\n  SearchIcon,\n  Tree,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport Utils from '../../../../../common/utils/Utils';\nimport { ATTRIBUTE_COLUMN_LABELS, COLUMN_TYPES } from '../../../../constants';\nimport { useUpdateExperimentViewUIState } from '../../contexts/ExperimentPageUIStateContext';\nimport { useExperimentIds } from '../../hooks/useExperimentIds';\nimport { ExperimentPageUIState } from '../../models/ExperimentPageUIState';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../utils/experimentPage.common-utils';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\n\n/**\n * We need to recreate antd's tree check callback signature since it's not importable\n */\ntype AntdTreeCheckCallback = { node: { key: string | number; checked: boolean } };\n\n/**\n * Function localizing antd tree inside a DOM element. Used to focusing by keyboard.\n */\nconst locateAntdTree = (parent: HTMLElement | null): HTMLElement | null =>\n  parent?.querySelector('[role=\"tree\"] input') || null;\n\nconst GROUP_KEY = 'GROUP';\n\nconst GROUP_KEY_ATTRIBUTES = makeCanonicalSortKey(GROUP_KEY, COLUMN_TYPES.ATTRIBUTES);\nconst GROUP_KEY_PARAMS = makeCanonicalSortKey(GROUP_KEY, COLUMN_TYPES.PARAMS);\nconst GROUP_KEY_METRICS = makeCanonicalSortKey(GROUP_KEY, COLUMN_TYPES.METRICS);\nconst GROUP_KEY_TAGS = makeCanonicalSortKey(GROUP_KEY, COLUMN_TYPES.TAGS);\n\n/**\n * Returns all usable attribute columns basing on view mode and enabled flagged features\n */\nconst getAttributeColumns = (isComparing: boolean) => {\n  const result = [\n    ATTRIBUTE_COLUMN_LABELS.USER,\n    ATTRIBUTE_COLUMN_LABELS.SOURCE,\n    ATTRIBUTE_COLUMN_LABELS.VERSION,\n    ATTRIBUTE_COLUMN_LABELS.MODELS,\n  ];\n\n  if (isComparing) {\n    result.unshift(ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME);\n  }\n\n  result.unshift(ATTRIBUTE_COLUMN_LABELS.DATASET);\n\n  return result;\n};\n\n/**\n * Function filters list of string by a given query string.\n */\nconst findMatching = (values: string[], filterQuery: string) =>\n  values.filter((v) => v.toLowerCase().includes(filterQuery.toLowerCase()));\n\n/**\n * Function dissects given string and wraps the\n * searched query with <strong>...</strong> if found. Used for highlighting search.\n */\nconst createHighlightedNode = (value: string, filterQuery: string) => {\n  if (!filterQuery) {\n    return value;\n  }\n  const index = value.toLowerCase().indexOf(filterQuery.toLowerCase());\n  const beforeStr = value.substring(0, index);\n  const matchStr = value.substring(index, index + filterQuery.length);\n  const afterStr = value.substring(index + filterQuery.length);\n\n  return index > -1 ? (\n    <span>\n      {beforeStr}\n      <strong>{matchStr}</strong>\n      {afterStr}\n    </span>\n  ) : (\n    value\n  );\n};\nexport interface ExperimentViewRunsColumnSelectorProps {\n  runsData: ExperimentRunsSelectorResult;\n  columnSelectorVisible: boolean;\n  onChangeColumnSelectorVisible: (value: boolean) => void;\n  selectedColumns: string[];\n}\n\n/**\n * A component displaying the searchable column list - implementation.\n */\nexport const ExperimentViewRunsColumnSelector = React.memo(\n  ({\n    runsData,\n    columnSelectorVisible,\n    onChangeColumnSelectorVisible,\n    selectedColumns,\n  }: ExperimentViewRunsColumnSelectorProps) => {\n    const updateUIState = useUpdateExperimentViewUIState();\n    const experimentIds = useExperimentIds();\n    const [filter, setFilter] = useState('');\n    const { theme } = useDesignSystemTheme();\n\n    const searchInputRef = useRef<any>(null);\n    const scrollableContainerRef = useRef<HTMLDivElement>(null);\n    const buttonRef = useRef<HTMLButtonElement>(null);\n\n    // Extract all attribute columns\n    const attributeColumnNames = useMemo(() => getAttributeColumns(experimentIds.length > 1), [experimentIds.length]);\n\n    const setCheckedColumns = useCallback(\n      (updateFn: (existingCheckedColumns: string[]) => string[]) =>\n        updateUIState((facets: ExperimentPageUIState) => {\n          const newColumns = updateFn(facets.selectedColumns);\n          const uniqueNewColumns = Array.from(new Set(newColumns));\n          return { ...facets, selectedColumns: uniqueNewColumns };\n        }),\n      [updateUIState],\n    );\n\n    // Extract unique list of tags\n    const tagsKeyList = useMemo(() => Utils.getVisibleTagKeyList(runsData.tagsList), [runsData]);\n\n    // Extract canonical key names for attributes, params, metrics and tags.\n    const canonicalKeyNames = useMemo(\n      () => ({\n        [COLUMN_TYPES.ATTRIBUTES]: attributeColumnNames.map((key) =>\n          makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, key),\n        ),\n        [COLUMN_TYPES.PARAMS]: runsData.paramKeyList.map((key) => makeCanonicalSortKey(COLUMN_TYPES.PARAMS, key)),\n        [COLUMN_TYPES.METRICS]: runsData.metricKeyList.map((key) => makeCanonicalSortKey(COLUMN_TYPES.METRICS, key)),\n        [COLUMN_TYPES.TAGS]: tagsKeyList.map((key) => makeCanonicalSortKey(COLUMN_TYPES.TAGS, key)),\n      }),\n      [runsData, attributeColumnNames, tagsKeyList],\n    );\n\n    // This memoized value holds the tree structure generated from\n    // attributes, params, metrics and tags. Displays only filtered values.\n    const treeData = useMemo(() => {\n      const result = [];\n\n      const filteredAttributes = findMatching(attributeColumnNames, filter);\n      const filteredParams = findMatching(runsData.paramKeyList, filter);\n      const filteredMetrics = findMatching(runsData.metricKeyList, filter);\n      const filteredTags = findMatching(tagsKeyList, filter);\n\n      if (filteredAttributes.length) {\n        result.push({\n          key: GROUP_KEY_ATTRIBUTES,\n          title: `Attributes`,\n          children: filteredAttributes.map((attributeKey) => ({\n            key: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, attributeKey),\n            title: createHighlightedNode(attributeKey, filter),\n          })),\n        });\n      }\n      if (filteredMetrics.length) {\n        result.push({\n          key: GROUP_KEY_METRICS,\n          title: `Metrics (${filteredMetrics.length})`,\n          children: filteredMetrics.map((metricKey) => ({\n            key: makeCanonicalSortKey(COLUMN_TYPES.METRICS, metricKey),\n            title: createHighlightedNode(metricKey, filter),\n          })),\n        });\n      }\n      if (filteredParams.length) {\n        result.push({\n          key: GROUP_KEY_PARAMS,\n          title: `Parameters (${filteredParams.length})`,\n          children: filteredParams.map((paramKey) => ({\n            key: makeCanonicalSortKey(COLUMN_TYPES.PARAMS, paramKey),\n            title: createHighlightedNode(paramKey, filter),\n          })),\n        });\n      }\n      if (filteredTags.length) {\n        result.push({\n          key: GROUP_KEY_TAGS,\n          title: `Tags (${filteredTags.length})`,\n          children: filteredTags.map((tagKey) => ({\n            key: makeCanonicalSortKey(COLUMN_TYPES.TAGS, tagKey),\n            title: tagKey,\n          })),\n        });\n      }\n\n      return result;\n    }, [attributeColumnNames, filter, runsData, tagsKeyList]);\n\n    // This callback toggles entire group of keys\n    const toggleGroup = useCallback(\n      (isChecked: boolean, keyList: string[]) => {\n        if (!isChecked) {\n          setCheckedColumns((checked) => [...checked, ...keyList]);\n        } else {\n          setCheckedColumns((checked) => checked.filter((k) => !keyList.includes(k)));\n        }\n      },\n      [setCheckedColumns],\n    );\n\n    // This callback is intended to select/deselect a single key\n    const toggleSingleKey = useCallback(\n      (key: string, isChecked: boolean) => {\n        if (!isChecked) {\n          setCheckedColumns((checked) => [...checked, key]);\n        } else {\n          setCheckedColumns((checked) => checked.filter((k) => k !== key));\n        }\n      },\n      [setCheckedColumns],\n    );\n\n    useEffect(() => {\n      if (columnSelectorVisible) {\n        setFilter('');\n\n        // Let's wait for the next execution frame, then:\n        // - restore the dropdown menu scroll position\n        // - focus the search input\n        // - bring the dropdown into the viewport using scrollIntoView()\n        requestAnimationFrame(() => {\n          scrollableContainerRef?.current?.scrollTo(0, 0);\n          searchInputRef.current?.focus({ preventScroll: true });\n\n          if (buttonRef.current) {\n            buttonRef.current.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n          }\n        });\n      }\n    }, [columnSelectorVisible]);\n\n    const onCheck = useCallback(\n      // We need to recreate antd's tree check callback signature\n      (_: any, { node: { key, checked } }: AntdTreeCheckCallback) => {\n        if (isCanonicalSortKeyOfType(key.toString(), GROUP_KEY)) {\n          const columnType = extractCanonicalSortKey(key.toString(), GROUP_KEY);\n          const canonicalKeysForGroup = canonicalKeyNames[columnType];\n          if (canonicalKeysForGroup) {\n            toggleGroup(checked, findMatching(canonicalKeysForGroup, filter));\n          }\n        } else {\n          toggleSingleKey(key.toString(), checked);\n        }\n      },\n      [canonicalKeyNames, toggleGroup, toggleSingleKey, filter],\n    );\n\n    // This callback moves focus to tree element if down arrow has been pressed\n    // when inside search input area.\n    const searchInputKeyDown = useCallback<React.KeyboardEventHandler<HTMLInputElement>>((e) => {\n      if (e.key === 'ArrowDown') {\n        const treeElement = locateAntdTree(scrollableContainerRef.current);\n\n        if (treeElement) {\n          treeElement.focus();\n        }\n      }\n    }, []);\n\n    // A JSX block containing the dropdown\n    const dropdownContent = (\n      <div\n        css={{\n          backgroundColor: theme.colors.backgroundPrimary,\n          width: 400,\n          border: `1px solid`,\n          borderColor: theme.colors.border,\n          [theme.responsive.mediaQueries.xs]: {\n            width: '100vw',\n          },\n        }}\n        onKeyDown={(e) => {\n          // Since we're controlling the visibility of the dropdown,\n          // we need to handle the escape key to close it.\n          if (e.key === 'Escape') {\n            onChangeColumnSelectorVisible(false);\n            buttonRef.current?.focus();\n          }\n        }}\n      >\n        <div css={(theme) => ({ padding: theme.spacing.md })}>\n          <Input\n            value={filter}\n            prefix={<SearchIcon />}\n            placeholder=\"Search columns\"\n            allowClear\n            ref={searchInputRef}\n            onChange={(e) => {\n              setFilter(e.target.value);\n            }}\n            onKeyDown={searchInputKeyDown}\n          />\n        </div>\n        <div\n          ref={scrollableContainerRef}\n          css={{\n            // Maximum height of 15 elements times 32 pixels as defined in\n            // design-system/src/design-system/Tree/Tree.tsx\n            maxHeight: 15 * 32,\n            overflowY: 'scroll',\n            overflowX: 'hidden',\n            paddingBottom: theme.spacing.md,\n            'span[title]': {\n              whiteSpace: 'nowrap',\n              textOverflow: 'ellipsis',\n              overflow: 'hidden',\n            },\n            [theme.responsive.mediaQueries.xs]: {\n              maxHeight: 'calc(100vh - 100px)',\n            },\n          }}\n        >\n          <Tree\n            data-testid=\"column-selector-tree\"\n            mode=\"checkable\"\n            dangerouslySetAntdProps={{\n              checkedKeys: selectedColumns,\n              onCheck,\n            }}\n            defaultExpandedKeys={[GROUP_KEY_ATTRIBUTES, GROUP_KEY_PARAMS, GROUP_KEY_METRICS, GROUP_KEY_TAGS]}\n            treeData={treeData}\n          />\n        </div>\n      </div>\n    );\n\n    return (\n      <Dropdown\n        overlay={dropdownContent}\n        placement=\"bottomLeft\"\n        trigger={['click']}\n        visible={columnSelectorVisible}\n        onVisibleChange={onChangeColumnSelectorVisible}\n      >\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscolumnselector.tsx_315\"\n          ref={buttonRef}\n          style={{ display: 'flex', alignItems: 'center' }}\n          data-testid=\"column-selection-dropdown\"\n          icon={<ColumnsIcon />}\n        >\n          <FormattedMessage\n            defaultMessage=\"Columns\"\n            description=\"Dropdown text to display columns names that could to be rendered for the experiment runs table\"\n          />{' '}\n          <ChevronDownIcon />\n        </Button>\n      </Dropdown>\n    );\n  },\n);\n","import { Button, Popover, Tabs, Tag, Tooltip, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentPageViewState } from '../../models/ExperimentPageViewState';\nimport { useExperimentViewLocalStore } from '../../hooks/useExperimentViewLocalStore';\nimport type { ExperimentViewRunsCompareMode } from '../../../../types';\nimport { PreviewBadge } from 'shared/building_blocks/PreviewBadge';\nimport { getExperimentPageDefaultViewMode, useExperimentPageViewMode } from '../../hooks/useExperimentPageViewMode';\n\nconst COMPARE_RUNS_TOOLTIP_STORAGE_KEY = 'compareRunsTooltip';\nconst COMPARE_RUNS_TOOLTIP_STORAGE_ITEM = 'seenBefore';\n\nexport interface ExperimentViewRunsModeSwitchProps {\n  viewState?: ExperimentPageViewState;\n  runsAreGrouped?: boolean;\n  hideBorder?: boolean;\n}\n\nconst ChartViewButtonTooltip: React.FC<{\n  isTableMode: boolean;\n  multipleRunsSelected: boolean;\n}> = ({ multipleRunsSelected, isTableMode }) => {\n  const seenTooltipStore = useExperimentViewLocalStore(COMPARE_RUNS_TOOLTIP_STORAGE_KEY);\n  const [isToolTipOpen, setToolTipOpen] = useState(\n    multipleRunsSelected && !seenTooltipStore.getItem(COMPARE_RUNS_TOOLTIP_STORAGE_ITEM),\n  );\n\n  useEffect(() => {\n    const hasSeenTooltipBefore = seenTooltipStore.getItem(COMPARE_RUNS_TOOLTIP_STORAGE_ITEM);\n    if (multipleRunsSelected && isTableMode && !hasSeenTooltipBefore) {\n      setToolTipOpen(true);\n    } else {\n      setToolTipOpen(false);\n    }\n  }, [multipleRunsSelected, isTableMode, seenTooltipStore]);\n\n  const updateIsTooltipOpen = useCallback(\n    (isOpen) => {\n      setToolTipOpen(isOpen);\n      seenTooltipStore.setItem(COMPARE_RUNS_TOOLTIP_STORAGE_ITEM, true);\n    },\n    [setToolTipOpen, seenTooltipStore],\n  );\n\n  return (\n    <>\n      <Popover.Root open={isToolTipOpen}>\n        <Popover.Trigger asChild>\n          <div css={{ position: 'absolute', inset: 0 }} />\n        </Popover.Trigger>\n        <Popover.Content align=\"start\">\n          <div css={{ maxWidth: '200px' }}>\n            <Typography.Paragraph>\n              <FormattedMessage\n                defaultMessage=\"You can now switch to the chart view to compare runs\"\n                description=\"Tooltip to push users to use the chart view instead of compare view\"\n              />\n            </Typography.Paragraph>\n            <div css={{ textAlign: 'right' }}>\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsmodeswitch.tsx_65\"\n                onClick={() => updateIsTooltipOpen(false)}\n                type=\"primary\"\n              >\n                <FormattedMessage defaultMessage=\"Got it\" description=\"Button action text for chart switcher tooltip\" />\n              </Button>\n            </div>\n          </div>\n          <Popover.Arrow />\n        </Popover.Content>\n      </Popover.Root>\n    </>\n  );\n};\n\n/**\n * Allows switching between \"table\", \"chart\", \"evaluation\" and \"traces\" modes of experiment view\n */\nexport const ExperimentViewRunsModeSwitch = ({\n  viewState,\n  runsAreGrouped,\n  hideBorder = true,\n}: ExperimentViewRunsModeSwitchProps) => {\n  const [viewMode, setViewModeInURL] = useExperimentPageViewMode();\n  const { classNamePrefix } = useDesignSystemTheme();\n  const activeTab = viewMode || getExperimentPageDefaultViewMode();\n\n  return (\n    <Tabs\n      dangerouslyAppendEmotionCSS={{\n        [`.${classNamePrefix}-tabs-nav`]: {\n          marginBottom: 0,\n          '::before': {\n            display: hideBorder ? 'none' : 'block',\n          },\n        },\n      }}\n      activeKey={activeTab}\n      onChange={(tabKey) => {\n        const newValue = tabKey as ExperimentViewRunsCompareMode;\n\n        if (activeTab === newValue) {\n          return;\n        }\n\n        setViewModeInURL(newValue);\n      }}\n    >\n      <Tabs.TabPane\n        tab={\n          <span data-testid=\"experiment-runs-mode-switch-list\">\n            <FormattedMessage\n              defaultMessage=\"Table\"\n              description=\"A button enabling table mode on the experiment page\"\n            />\n          </span>\n        }\n        key=\"TABLE\"\n      />\n      <Tabs.TabPane\n        tab={\n          <>\n            <span data-testid=\"experiment-runs-mode-switch-compare\">\n              <FormattedMessage\n                defaultMessage=\"Chart\"\n                description=\"A button enabling compare runs (chart) mode on the experiment page\"\n              />\n            </span>\n            <ChartViewButtonTooltip\n              isTableMode={viewMode === 'TABLE'}\n              multipleRunsSelected={viewState ? Object.keys(viewState.runsSelected).length > 1 : false}\n            />\n          </>\n        }\n        key=\"CHART\"\n      />\n\n      <Tabs.TabPane\n        disabled={runsAreGrouped}\n        tab={\n          <Tooltip\n            title={\n              runsAreGrouped ? (\n                <FormattedMessage\n                  defaultMessage=\"Unavailable when runs are grouped\"\n                  description=\"Experiment page > view mode switch > evaluation mode disabled tooltip\"\n                />\n              ) : undefined\n            }\n          >\n            <span data-testid=\"experiment-runs-mode-switch-evaluation\">\n              <FormattedMessage\n                defaultMessage=\"Evaluation\"\n                description=\"A button enabling compare runs (evaluation) mode on the experiment page\"\n              />\n              <PreviewBadge />\n            </span>\n          </Tooltip>\n        }\n        key=\"ARTIFACT\"\n      />\n    </Tabs>\n  );\n};\n","import { useIntl, defineMessages, FormattedMessage } from 'react-intl';\nimport {\n  Button,\n  ChevronDownIcon,\n  DropdownMenu,\n  GearIcon,\n  Input,\n  ListBorderIcon,\n  SearchIcon,\n  Spinner,\n  Tag,\n  Tooltip,\n  XCircleFillIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { compact, isEmpty, isString, keys, uniq, values } from 'lodash';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { MLFLOW_INTERNAL_PREFIX } from '../../../../../common/utils/TagUtils';\nimport {\n  RunsGroupByConfig,\n  createRunsGroupByKey,\n  normalizeRunsGroupByKey,\n} from '../../utils/experimentPage.group-row-utils';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { RunGroupingAggregateFunction, RunGroupingMode } from '../../utils/experimentPage.row-types';\n\nexport interface ExperimentViewRunsGroupBySelectorProps {\n  runsData: ExperimentRunsSelectorResult;\n  groupBy: RunsGroupByConfig | null | string;\n  onChange: (newGroupByConfig: RunsGroupByConfig | null) => void;\n}\n\nconst messages = defineMessages({\n  minimum: {\n    defaultMessage: 'Minimum',\n    description: 'Experiment page > group by runs control > minimum aggregate function',\n  },\n  maximum: {\n    defaultMessage: 'Maximum',\n    description: 'Experiment page > group by runs control > maximum aggregate function',\n  },\n  average: {\n    defaultMessage: 'Average',\n    description: 'Experiment page > group by runs control > average aggregate function',\n  },\n  attributes: {\n    defaultMessage: 'Attributes',\n    description: 'Experiment page > group by runs control > attributes section label',\n  },\n  tags: {\n    defaultMessage: 'Tags',\n    description: 'Experiment page > group by runs control > tags section label',\n  },\n  params: {\n    defaultMessage: 'Params',\n    description: 'Experiment page > group by runs control > params section label',\n  },\n  dataset: {\n    defaultMessage: 'Dataset',\n    description: 'Experiment page > group by runs control > group by dataset',\n  },\n  noParams: {\n    defaultMessage: 'No params',\n    description: 'Experiment page > group by runs control > no params to group by',\n  },\n  noTags: {\n    defaultMessage: 'No tags',\n    description: 'Experiment page > group by runs control > no tags to group by',\n  },\n  aggregationTooltip: {\n    defaultMessage: 'Aggregation: {value}',\n    description: 'Experiment page > group by runs control > current aggregation function tooltip',\n  },\n  noResults: {\n    defaultMessage: 'No results',\n    description: 'Experiment page > group by runs control > no results after filtering by search query',\n  },\n});\n\nconst GroupBySelectorBody = ({\n  runsData,\n  onChange,\n  groupBy,\n}: {\n  groupBy: RunsGroupByConfig;\n  onChange: (newGroupBy: RunsGroupByConfig | null) => void;\n  runsData: ExperimentRunsSelectorResult;\n}) => {\n  const intl = useIntl();\n  const attributeElementRef = useRef<HTMLDivElement>(null);\n  const tagElementRef = useRef<HTMLDivElement>(null);\n  const paramElementRef = useRef<HTMLDivElement>(null);\n  const inputElementRef = useRef<any>(null);\n\n  const minimumLabel = intl.formatMessage(messages.minimum);\n  const maximumLabel = intl.formatMessage(messages.maximum);\n  const averageLabel = intl.formatMessage(messages.average);\n  const datasetLabel = intl.formatMessage(messages.dataset);\n\n  const tagNames = useMemo(\n    () =>\n      uniq(\n        values(runsData.tagsList).flatMap((runTags) =>\n          keys(runTags).filter((tagKey) => !tagKey.startsWith(MLFLOW_INTERNAL_PREFIX)),\n        ),\n      ),\n    [runsData.tagsList],\n  );\n  const { aggregateFunction = RunGroupingAggregateFunction.Average, groupByKeys = [] } = groupBy || {};\n\n  const currentAggregateFunctionLabel = {\n    min: minimumLabel,\n    max: maximumLabel,\n    average: averageLabel,\n  }[aggregateFunction];\n\n  const { theme } = useDesignSystemTheme();\n  const [filter, setFilter] = useState('');\n\n  // Autofocus won't work everywhere so let's focus input everytime the dropdown is opened\n  useEffect(() => {\n    requestAnimationFrame(() => {\n      inputElementRef.current.focus();\n    });\n  }, []);\n\n  const filteredTagNames = tagNames.filter((tag) => tag.toLowerCase().includes(filter.toLowerCase()));\n  const filteredParamNames = runsData.paramKeyList.filter((param) =>\n    param.toLowerCase().includes(filter.toLowerCase()),\n  );\n  const containsDatasets = useMemo(() => !isEmpty(compact(runsData.datasetsList)), [runsData.datasetsList]);\n  const attributesMatchFilter = containsDatasets && datasetLabel.toLowerCase().includes(filter.toLowerCase());\n\n  const hasAnyResults = filteredTagNames.length > 0 || filteredParamNames.length > 0 || attributesMatchFilter;\n\n  const groupByToggle = useCallback(\n    (mode: RunGroupingMode, groupByData: string, checked: boolean) => {\n      if (checked) {\n        // Scenario #1: user selected new grouping key\n        const newGroupByKeys = [...groupByKeys];\n\n        // If the key is already present, we should not add it again\n        if (!newGroupByKeys.some((key) => key.mode === mode && key.groupByData === groupByData)) {\n          newGroupByKeys.push({ mode, groupByData });\n        }\n\n        onChange({\n          aggregateFunction,\n          groupByKeys: newGroupByKeys,\n        });\n      } else {\n        // Scenario #2: user deselected a grouping key\n        const newGroupByKeys = groupByKeys.filter((key) => !(key.mode === mode && key.groupByData === groupByData));\n\n        // If no keys are left, we should reset the group by and set it to null\n        if (!newGroupByKeys.length) {\n          onChange(null);\n          return;\n        }\n        onChange({\n          aggregateFunction,\n          groupByKeys: newGroupByKeys,\n        });\n      }\n    },\n    [aggregateFunction, groupByKeys, onChange],\n  );\n\n  const aggregateFunctionChanged = (aggregateFunctionString: string) => {\n    if (values<string>(RunGroupingAggregateFunction).includes(aggregateFunctionString)) {\n      const newFunction = aggregateFunctionString as RunGroupingAggregateFunction;\n      const newGroupBy: RunsGroupByConfig = { ...groupBy, aggregateFunction: newFunction };\n      onChange(newGroupBy);\n    }\n  };\n\n  const isGroupedBy = (mode: RunGroupingMode, groupByData: string) => {\n    return groupByKeys.some((key) => key.mode === mode && key.groupByData === groupByData);\n  };\n\n  return (\n    <>\n      <div css={{ display: 'flex', gap: theme.spacing.xs, padding: theme.spacing.sm }}>\n        <Input\n          value={filter}\n          onChange={(e) => setFilter(e.target.value)}\n          prefix={<SearchIcon />}\n          placeholder=\"Search\"\n          autoFocus\n          ref={inputElementRef}\n          onKeyDown={(e) => {\n            if (e.key === 'ArrowDown' || e.key === 'Tab') {\n              const firstItem = attributeElementRef.current || tagElementRef.current || paramElementRef.current;\n              firstItem?.focus();\n              return;\n            }\n            if (e.key !== 'Escape') {\n              e.stopPropagation();\n            }\n          }}\n        />\n        <DropdownMenu.Root>\n          <Tooltip\n            placement=\"right\"\n            title={\n              <FormattedMessage\n                {...messages.aggregationTooltip}\n                values={{\n                  value: currentAggregateFunctionLabel || aggregateFunction,\n                }}\n              />\n            }\n          >\n            <DropdownMenu.Trigger asChild>\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_168\"\n                icon={<GearIcon />}\n                css={{ minWidth: 32 }}\n                aria-label=\"Change aggregation function\"\n              />\n            </DropdownMenu.Trigger>\n          </Tooltip>\n          <DropdownMenu.Content align=\"start\" side=\"right\">\n            <DropdownMenu.RadioGroup value={aggregateFunction} onValueChange={aggregateFunctionChanged}>\n              <DropdownMenu.RadioItem\n                disabled={!groupByKeys.length}\n                value={RunGroupingAggregateFunction.Min}\n                key={RunGroupingAggregateFunction.Min}\n              >\n                <DropdownMenu.ItemIndicator />\n                {minimumLabel}\n              </DropdownMenu.RadioItem>\n              <DropdownMenu.RadioItem\n                disabled={!groupByKeys.length}\n                value={RunGroupingAggregateFunction.Max}\n                key={RunGroupingAggregateFunction.Max}\n              >\n                <DropdownMenu.ItemIndicator />\n                {maximumLabel}\n              </DropdownMenu.RadioItem>\n              <DropdownMenu.RadioItem\n                disabled={!groupByKeys.length}\n                value={RunGroupingAggregateFunction.Average}\n                key={RunGroupingAggregateFunction.Average}\n              >\n                <DropdownMenu.ItemIndicator />\n                {averageLabel}\n              </DropdownMenu.RadioItem>\n            </DropdownMenu.RadioGroup>\n          </DropdownMenu.Content>\n        </DropdownMenu.Root>\n      </div>\n      <DropdownMenu.Group css={{ maxHeight: 400, overflowY: 'scroll' }}>\n        {attributesMatchFilter && (\n          <>\n            <DropdownMenu.Label>\n              <FormattedMessage {...messages.attributes} />\n            </DropdownMenu.Label>\n            {datasetLabel.toLowerCase().includes(filter.toLowerCase()) && (\n              <DropdownMenu.CheckboxItem\n                checked={isGroupedBy(RunGroupingMode.Dataset, 'dataset')}\n                key={createRunsGroupByKey(RunGroupingMode.Dataset, 'dataset', aggregateFunction)}\n                ref={attributeElementRef}\n                onCheckedChange={(checked) => groupByToggle(RunGroupingMode.Dataset, 'dataset', checked)}\n              >\n                <DropdownMenu.ItemIndicator />\n                {datasetLabel}\n              </DropdownMenu.CheckboxItem>\n            )}\n            <DropdownMenu.Separator />\n          </>\n        )}\n        {filteredTagNames.length > 0 && (\n          <>\n            <DropdownMenu.Label>\n              <FormattedMessage {...messages.tags} />\n            </DropdownMenu.Label>\n\n            {filteredTagNames.map((tagName, index) => {\n              const groupByKey = createRunsGroupByKey(RunGroupingMode.Tag, tagName, aggregateFunction);\n              return (\n                <DropdownMenu.CheckboxItem\n                  checked={isGroupedBy(RunGroupingMode.Tag, tagName)}\n                  key={groupByKey}\n                  ref={index === 0 ? tagElementRef : undefined}\n                  onCheckedChange={(checked) => groupByToggle(RunGroupingMode.Tag, tagName, checked)}\n                >\n                  <DropdownMenu.ItemIndicator />\n                  {tagName}\n                </DropdownMenu.CheckboxItem>\n              );\n            })}\n            {!tagNames.length && (\n              <DropdownMenu.Item disabled>\n                <DropdownMenu.ItemIndicator /> <FormattedMessage {...messages.noTags} />\n              </DropdownMenu.Item>\n            )}\n            <DropdownMenu.Separator />\n          </>\n        )}\n        {filteredParamNames.length > 0 && (\n          <>\n            <DropdownMenu.Label>\n              <FormattedMessage {...messages.params} />\n            </DropdownMenu.Label>\n\n            {filteredParamNames.map((paramName, index) => {\n              const groupByKey = createRunsGroupByKey(RunGroupingMode.Param, paramName, aggregateFunction);\n              return (\n                <DropdownMenu.CheckboxItem\n                  checked={isGroupedBy(RunGroupingMode.Param, paramName)}\n                  key={groupByKey}\n                  ref={index === 0 ? paramElementRef : undefined}\n                  onCheckedChange={(checked) => groupByToggle(RunGroupingMode.Param, paramName, checked)}\n                >\n                  <DropdownMenu.ItemIndicator />\n                  {paramName}\n                </DropdownMenu.CheckboxItem>\n              );\n            })}\n            {!runsData.paramKeyList.length && (\n              <DropdownMenu.Item disabled>\n                <FormattedMessage {...messages.noParams} />\n              </DropdownMenu.Item>\n            )}\n          </>\n        )}\n        {!hasAnyResults && (\n          <DropdownMenu.Item disabled>\n            <FormattedMessage {...messages.noResults} />\n          </DropdownMenu.Item>\n        )}\n      </DropdownMenu.Group>\n    </>\n  );\n};\n\n/**\n * A component displaying searchable \"group by\" selector\n */\nexport const ExperimentViewRunsGroupBySelector = React.memo(\n  ({\n    runsData,\n    groupBy,\n    isLoading,\n    onChange,\n  }: ExperimentViewRunsGroupBySelectorProps & {\n    isLoading: boolean;\n  }) => {\n    const { theme } = useDesignSystemTheme();\n\n    // In case we encounter deprecated string-based group by descriptor\n    const normalizedGroupBy = normalizeRunsGroupByKey(groupBy) || {\n      aggregateFunction: RunGroupingAggregateFunction.Average,\n      groupByKeys: [],\n    };\n\n    const isGroupedBy = normalizedGroupBy && !isEmpty(normalizedGroupBy.groupByKeys);\n\n    return (\n      <DropdownMenu.Root modal={false}>\n        <DropdownMenu.Trigger asChild>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_306\"\n            icon={<ListBorderIcon />}\n            style={{ display: 'flex', alignItems: 'center' }}\n            data-testid=\"column-selection-dropdown\"\n            endIcon={<ChevronDownIcon />}\n          >\n            {isGroupedBy ? (\n              <FormattedMessage\n                defaultMessage=\"Group by: {value}\"\n                description=\"Experiment page > group by runs control > trigger button label > with value\"\n                values={{\n                  value: normalizedGroupBy.groupByKeys[0].groupByData,\n                  // value: mode === RunGroupingMode.Dataset ? intl.formatMessage(messages.dataset) : groupByData,\n                }}\n              />\n            ) : (\n              <FormattedMessage\n                defaultMessage=\"Group by\"\n                description=\"Experiment page > group by runs control > trigger button label > empty\"\n              />\n            )}\n            {normalizedGroupBy.groupByKeys.length > 1 && (\n              <Tag css={{ marginLeft: 4, marginRight: 0 }}>+{normalizedGroupBy.groupByKeys.length - 1}</Tag>\n            )}\n            {groupBy && (\n              <XCircleFillIcon\n                aria-hidden=\"false\"\n                css={{\n                  color: theme.colors.textPlaceholder,\n                  fontSize: theme.typography.fontSizeSm,\n                  marginLeft: theme.spacing.sm,\n\n                  ':hover': {\n                    color: theme.colors.actionTertiaryTextHover,\n                  },\n                }}\n                role=\"button\"\n                onClick={() => {\n                  onChange(null);\n                }}\n                onPointerDownCapture={(e) => {\n                  // Prevents the dropdown from opening when clearing\n                  e.stopPropagation();\n                }}\n              />\n            )}\n          </Button>\n        </DropdownMenu.Trigger>\n        <DropdownMenu.Content>\n          {isLoading ? (\n            <DropdownMenu.Item>\n              <Spinner />\n            </DropdownMenu.Item>\n          ) : (\n            <GroupBySelectorBody groupBy={normalizedGroupBy} onChange={onChange} runsData={runsData} />\n          )}\n        </DropdownMenu.Content>\n      </DropdownMenu.Root>\n    );\n  },\n);\n","import {\n  ArrowDownIcon,\n  ArrowUpIcon,\n  SortAscendingIcon,\n  SortDescendingIcon,\n  Input,\n  SearchIcon,\n  useDesignSystemTheme,\n  DropdownMenu,\n  Button,\n  ChevronDownIcon,\n} from '@databricks/design-system';\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { middleTruncateStr } from '../../../../../common/utils/StringUtils';\nimport { ATTRIBUTE_COLUMN_SORT_KEY, ATTRIBUTE_COLUMN_SORT_LABEL, COLUMN_TYPES } from '../../../../constants';\nimport { useUpdateExperimentPageSearchFacets } from '../../hooks/useExperimentPageSearchFacets';\nimport { useUpdateExperimentViewUIState } from '../../contexts/ExperimentPageUIStateContext';\nimport { ToggleIconButton } from '../../../../../common/components/ToggleIconButton';\nimport { makeCanonicalSortKey } from '../../utils/experimentPage.common-utils';\n\ntype SORT_KEY_TYPE = keyof (typeof ATTRIBUTE_COLUMN_SORT_KEY & typeof ATTRIBUTE_COLUMN_SORT_LABEL);\n\nconst ExperimentViewRunsSortSelectorV2Body = ({\n  sortOptions,\n  orderByKey,\n  orderByAsc,\n  onOptionSelected,\n}: {\n  sortOptions: {\n    label: string;\n    value: string;\n  }[];\n  orderByKey: string;\n  orderByAsc: boolean;\n  onOptionSelected: () => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const setUrlSearchFacets = useUpdateExperimentPageSearchFacets();\n  const updateUIState = useUpdateExperimentViewUIState();\n  const inputElementRef = useRef<React.ComponentRef<typeof Input>>(null);\n  const [filter, setFilter] = useState('');\n  const firstElementRef = useRef<HTMLDivElement>(null);\n\n  // Merge all sort options and filter them by the search query\n  const filteredSortOptions = useMemo(\n    () =>\n      sortOptions.filter((option) => {\n        return option.label.toLowerCase().includes(filter.toLowerCase());\n      }),\n    [sortOptions, filter],\n  );\n\n  const handleChange = (orderByKey: string) => {\n    setUrlSearchFacets({\n      orderByKey,\n    });\n\n    updateUIState((currentUIState) => {\n      if (!currentUIState.selectedColumns.includes(orderByKey)) {\n        return {\n          ...currentUIState,\n          selectedColumns: [...currentUIState.selectedColumns, orderByKey],\n        };\n      }\n      return currentUIState;\n    });\n\n    onOptionSelected();\n  };\n  const setOrder = (ascending: boolean) => {\n    setUrlSearchFacets({\n      orderByAsc: ascending,\n    });\n    onOptionSelected();\n  };\n\n  // Autofocus won't work everywhere so let's focus input everytime the dropdown is opened\n  useEffect(() => {\n    requestAnimationFrame(() => {\n      inputElementRef.current?.focus();\n    });\n  }, []);\n\n  return (\n    <>\n      <div\n        css={{\n          padding: `${theme.spacing.sm}px ${theme.spacing.lg / 2}px ${theme.spacing.sm}px`,\n          width: '100%',\n          display: 'flex',\n          gap: theme.spacing.xs,\n        }}\n      >\n        <Input\n          prefix={<SearchIcon />}\n          value={filter}\n          type=\"search\"\n          onChange={(e) => setFilter(e.target.value)}\n          placeholder=\"Search\"\n          autoFocus\n          ref={inputElementRef}\n          onKeyDown={(e) => {\n            if (e.key === 'ArrowDown' || e.key === 'Tab') {\n              firstElementRef.current?.focus();\n              return;\n            }\n            e.stopPropagation();\n          }}\n        />\n        <div\n          css={{\n            display: 'flex',\n            gap: theme.spacing.xs,\n          }}\n        >\n          <ToggleIconButton\n            pressed={!orderByAsc}\n            icon={<ArrowDownIcon />}\n            componentId=\"mlflow.experiment_page.sort_select_v2.sort_desc\"\n            onClick={() => setOrder(false)}\n            aria-label=\"Sort descending\"\n          />\n          <ToggleIconButton\n            pressed={orderByAsc}\n            icon={<ArrowUpIcon />}\n            componentId=\"mlflow.experiment_page.sort_select_v2.sort_asc\"\n            onClick={() => setOrder(true)}\n            aria-label=\"Sort ascending\"\n          />\n        </div>\n      </div>\n      <DropdownMenu.Group css={{ maxHeight: 400, overflowY: 'auto' }}>\n        {filteredSortOptions.map((sortOption, index) => (\n          <DropdownMenu.CheckboxItem\n            key={sortOption.value}\n            onClick={() => handleChange(sortOption.value)}\n            checked={sortOption.value === orderByKey}\n            data-test-id={`sort-select-${sortOption.label}`}\n            ref={index === 0 ? firstElementRef : undefined}\n          >\n            <DropdownMenu.ItemIndicator />\n            <span css={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n              {middleTruncateStr(sortOption.label, 50)}\n            </span>\n          </DropdownMenu.CheckboxItem>\n        ))}\n        {!filteredSortOptions.length && (\n          <DropdownMenu.Item disabled>\n            <FormattedMessage\n              defaultMessage=\"No results\"\n              description=\"Experiment page > sort selector > no results after filtering by search query\"\n            />\n          </DropdownMenu.Item>\n        )}\n      </DropdownMenu.Group>\n    </>\n  );\n};\n\nexport const ExperimentViewRunsSortSelectorV2 = React.memo(\n  ({\n    metricKeys,\n    paramKeys,\n    orderByAsc,\n    orderByKey,\n  }: {\n    orderByKey: string;\n    orderByAsc: boolean;\n    metricKeys: string[];\n    paramKeys: string[];\n  }) => {\n    const intl = useIntl();\n    const [open, setOpen] = useState(false);\n    const { theme } = useDesignSystemTheme();\n\n    // Get sort options for attributes (e.g. start time, run name, etc.)\n    const attributeSortOptions = useMemo(\n      () =>\n        Object.keys(ATTRIBUTE_COLUMN_SORT_LABEL).map((sortLabelKey) => ({\n          label: ATTRIBUTE_COLUMN_SORT_LABEL[sortLabelKey as SORT_KEY_TYPE],\n          value: ATTRIBUTE_COLUMN_SORT_KEY[sortLabelKey as SORT_KEY_TYPE],\n        })),\n      [],\n    );\n\n    // Get sort options for metrics\n    const metricsSortOptions = useMemo(\n      () =>\n        metricKeys.map((sortLabelKey) => ({\n          label: sortLabelKey,\n          value: `${makeCanonicalSortKey(COLUMN_TYPES.METRICS, sortLabelKey)}`,\n        })),\n      [metricKeys],\n    );\n\n    // Get sort options for params\n    const paramsSortOptions = useMemo(\n      () =>\n        paramKeys.map((sortLabelKey) => ({\n          label: sortLabelKey,\n          value: `${makeCanonicalSortKey(COLUMN_TYPES.PARAMS, sortLabelKey)}`,\n        })),\n      [paramKeys],\n    );\n\n    const sortOptions = useMemo(\n      () => [...attributeSortOptions, ...metricsSortOptions, ...paramsSortOptions],\n      [attributeSortOptions, metricsSortOptions, paramsSortOptions],\n    );\n\n    // Generate the label for the sort select dropdown\n    const currentSortSelectLabel = useMemo(() => {\n      // Search through all sort options generated basing on the fetched runs\n      const sortOption = sortOptions.find((option) => option.value === orderByKey);\n\n      let sortOptionLabel = sortOption?.label;\n\n      // If the actually chosen sort value is not found in the sort option list (e.g. because the list of fetched runs is empty),\n      // use it to generate the label\n      if (!sortOptionLabel) {\n        // The following regex extracts plain sort key name from its canonical form, i.e.\n        // metrics.`metric_key_name` => metric_key_name\n        const extractedKeyName = orderByKey.match(/^.+\\.`(.+)`$/);\n        if (extractedKeyName) {\n          // eslint-disable-next-line prefer-destructuring\n          sortOptionLabel = extractedKeyName[1];\n        }\n      }\n      return `${intl.formatMessage({\n        defaultMessage: 'Sort',\n        description: 'Experiment page > sort selector > label for the dropdown button',\n      })}: ${sortOptionLabel}`;\n    }, [sortOptions, intl, orderByKey]);\n\n    return (\n      <DropdownMenu.Root open={open} onOpenChange={setOpen} modal={false}>\n        <DropdownMenu.Trigger data-test-id=\"sort-select-dropdown\" asChild>\n          <Button\n            componentId=\"mlflow.experiment_page.sort_select_v2.toggle\"\n            icon={orderByAsc ? <SortAscendingIcon /> : <SortDescendingIcon />}\n            css={{ minWidth: 32 }}\n            aria-label={currentSortSelectLabel}\n            endIcon={<ChevronDownIcon />}\n          >\n            {currentSortSelectLabel}\n          </Button>\n        </DropdownMenu.Trigger>\n        <DropdownMenu.Content minWidth={250}>\n          <ExperimentViewRunsSortSelectorV2Body\n            sortOptions={sortOptions}\n            orderByKey={orderByKey}\n            orderByAsc={orderByAsc}\n            onOptionSelected={() => setOpen(false)}\n          />\n        </DropdownMenu.Content>\n      </DropdownMenu.Root>\n    );\n  },\n);\n","import React, { useCallback, useMemo } from 'react';\nimport { UpdateExperimentViewStateFn } from '../../../../types';\nimport { useRunSortOptions } from '../../hooks/useRunSortOptions';\nimport { ExperimentPageViewState } from '../../models/ExperimentPageViewState';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRunsControlsActions } from './ExperimentViewRunsControlsActions';\nimport { ExperimentViewRunsControlsFilters } from './ExperimentViewRunsControlsFilters';\nimport { ErrorWrapper } from '../../../../../common/utils/ErrorWrapper';\nimport { ToggleButton, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentViewRunsSortSelector } from './ExperimentViewRunsSortSelector';\nimport { ExperimentViewRunsColumnSelector } from './ExperimentViewRunsColumnSelector';\nimport { shouldUseNewExperimentPageSortSelector } from '../../../../../common/utils/FeatureUtils';\nimport { ExperimentViewRunsModeSwitch } from './ExperimentViewRunsModeSwitch';\nimport { useExperimentPageViewMode } from '../../hooks/useExperimentPageViewMode';\nimport Utils from '../../../../../common/utils/Utils';\nimport { downloadRunsCsv } from '../../utils/experimentPage.common-utils';\nimport { ExperimentPageUIState } from '../../models/ExperimentPageUIState';\nimport { ExperimentViewRunsGroupBySelector } from './ExperimentViewRunsGroupBySelector';\nimport { useUpdateExperimentViewUIState } from '../../contexts/ExperimentPageUIStateContext';\nimport { ExperimentPageSearchFacetsState } from '../../models/ExperimentPageSearchFacetsState';\nimport { ExperimentViewRunsSortSelectorV2 } from './ExperimentViewRunsSortSelectorV2';\n\ntype ExperimentViewRunsControlsProps = {\n  viewState: ExperimentPageViewState;\n  updateViewState: UpdateExperimentViewStateFn;\n\n  searchFacetsState: ExperimentPageSearchFacetsState;\n\n  experimentId: string;\n\n  runsData: ExperimentRunsSelectorResult;\n\n  expandRows: boolean;\n  updateExpandRows: (expandRows: boolean) => void;\n\n  requestError: ErrorWrapper | null;\n\n  refreshRuns: () => void;\n  uiState: ExperimentPageUIState;\n  isLoading: boolean;\n};\n\n/**\n * This component houses all controls related to searching runs: sort controls,\n * filters and run related actions (delete, restore, download CSV).\n */\nexport const ExperimentViewRunsControls = React.memo(\n  ({\n    runsData,\n    viewState,\n    updateViewState,\n    searchFacetsState,\n    experimentId,\n    requestError,\n    expandRows,\n    updateExpandRows,\n    refreshRuns,\n    uiState,\n    isLoading,\n  }: ExperimentViewRunsControlsProps) => {\n    const [compareRunsMode, setCompareRunsMode] = useExperimentPageViewMode();\n\n    const { paramKeyList, metricKeyList, tagsList } = runsData;\n    const { orderByAsc, orderByKey } = searchFacetsState;\n\n    const updateUIState = useUpdateExperimentViewUIState();\n\n    const isComparingRuns = compareRunsMode !== 'TABLE';\n    const isEvaluationMode = compareRunsMode === 'ARTIFACT';\n\n    const { theme } = useDesignSystemTheme();\n\n    const filteredParamKeys = paramKeyList;\n    const filteredMetricKeys = metricKeyList;\n    const filteredTagKeys = Utils.getVisibleTagKeyList(tagsList);\n\n    const onDownloadCsv = useCallback(\n      () => downloadRunsCsv(runsData, filteredTagKeys, filteredParamKeys, filteredMetricKeys),\n      [filteredMetricKeys, filteredParamKeys, filteredTagKeys, runsData],\n    );\n\n    const sortOptions = useRunSortOptions(filteredMetricKeys, filteredParamKeys);\n\n    const selectedRunsCount = Object.values(viewState.runsSelected).filter(Boolean).length;\n    const canRestoreRuns = selectedRunsCount > 0;\n    const canRenameRuns = selectedRunsCount === 1;\n    const canCompareRuns = selectedRunsCount > 1;\n    const showActionButtons = canCompareRuns || canRenameRuns || canRestoreRuns;\n\n    const showGroupBySelector = !isEvaluationMode;\n\n    // Shows or hides the column selector\n    const changeColumnSelectorVisible = useCallback(\n      (value: boolean) => updateViewState({ columnSelectorVisible: value }),\n      [updateViewState],\n    );\n\n    const toggleExpandedRows = useCallback(() => updateExpandRows(!expandRows), [expandRows, updateExpandRows]);\n\n    const multipleDatasetsArePresent = useMemo(\n      () => runsData.datasetsList.some((datasetsInRun) => datasetsInRun?.length > 1),\n      [runsData],\n    );\n\n    return (\n      <div\n        css={{\n          display: 'flex',\n          gap: theme.spacing.sm,\n          flexDirection: 'column' as const,\n          marginTop: uiState.viewMaximized ? undefined : theme.spacing.md,\n        }}\n      >\n        {showActionButtons && (\n          <ExperimentViewRunsControlsActions\n            runsData={runsData}\n            searchFacetsState={searchFacetsState}\n            viewState={viewState}\n            refreshRuns={refreshRuns}\n          />\n        )}\n\n        {!showActionButtons && (\n          <ExperimentViewRunsControlsFilters\n            onDownloadCsv={onDownloadCsv}\n            searchFacetsState={searchFacetsState}\n            experimentId={experimentId}\n            viewState={viewState}\n            updateViewState={updateViewState}\n            runsData={runsData}\n            requestError={requestError}\n            refreshRuns={refreshRuns}\n            viewMaximized={uiState.viewMaximized}\n            autoRefreshEnabled={uiState.autoRefreshEnabled}\n            additionalControls={\n              <>\n                {shouldUseNewExperimentPageSortSelector() ? (\n                  <ExperimentViewRunsSortSelectorV2\n                    orderByAsc={orderByAsc}\n                    orderByKey={orderByKey}\n                    metricKeys={filteredMetricKeys}\n                    paramKeys={filteredParamKeys}\n                  />\n                ) : (\n                  <ExperimentViewRunsSortSelector\n                    orderByAsc={orderByAsc}\n                    orderByKey={orderByKey}\n                    sortOptions={sortOptions}\n                  />\n                )}\n\n                {!isComparingRuns && (\n                  <ExperimentViewRunsColumnSelector\n                    columnSelectorVisible={viewState.columnSelectorVisible}\n                    onChangeColumnSelectorVisible={changeColumnSelectorVisible}\n                    runsData={runsData}\n                    selectedColumns={uiState.selectedColumns}\n                  />\n                )}\n\n                {!isComparingRuns && multipleDatasetsArePresent && (\n                  <ToggleButton onClick={toggleExpandedRows}>\n                    <FormattedMessage\n                      defaultMessage=\"Expand rows\"\n                      description=\"Label for the expand rows button above the experiment runs table\"\n                    />\n                  </ToggleButton>\n                )}\n                {showGroupBySelector && (\n                  <ExperimentViewRunsGroupBySelector\n                    groupBy={uiState.groupBy}\n                    onChange={(groupBy) => {\n                      updateUIState((state) => ({ ...state, groupBy }));\n                    }}\n                    runsData={runsData}\n                    isLoading={isLoading}\n                  />\n                )}\n              </>\n            }\n          />\n        )}\n        <div>\n          <ExperimentViewRunsModeSwitch viewState={viewState} runsAreGrouped={Boolean(uiState.groupBy)} />\n        </div>\n      </div>\n    );\n  },\n);\n","import { useMemo } from 'react';\nimport {\n  ATTRIBUTE_COLUMN_SORT_KEY,\n  ATTRIBUTE_COLUMN_SORT_LABEL,\n  COLUMN_SORT_BY_ASC,\n  COLUMN_SORT_BY_DESC,\n  COLUMN_TYPES,\n  SORT_DELIMITER_SYMBOL,\n} from '../../../constants';\nimport { makeCanonicalSortKey } from '../utils/experimentPage.common-utils';\n\nexport type ExperimentRunSortOption = {\n  label: string;\n  order: string;\n  value: string;\n};\n\ntype SORT_KEY_TYPE = keyof (typeof ATTRIBUTE_COLUMN_SORT_KEY & typeof ATTRIBUTE_COLUMN_SORT_LABEL);\n\n/**\n * This hook creates a set of run+sort options basing on currently selected\n * columns and the list of all metrics and keys.\n */\nexport const useRunSortOptions = (\n  filteredMetricKeys: string[],\n  filteredParamKeys: string[],\n): ExperimentRunSortOption[] =>\n  useMemo(() => {\n    let sortOptions = [];\n    const ColumnSortByOrder = [COLUMN_SORT_BY_ASC, COLUMN_SORT_BY_DESC];\n    const attributesSortBy = Object.keys(ATTRIBUTE_COLUMN_SORT_LABEL).reduce<any[]>((options, sortLabelKey) => {\n      const sortLabel = ATTRIBUTE_COLUMN_SORT_LABEL[sortLabelKey as SORT_KEY_TYPE];\n\n      ColumnSortByOrder.forEach((order) => {\n        options.push({\n          label: sortLabel,\n          value: ATTRIBUTE_COLUMN_SORT_KEY[sortLabelKey as SORT_KEY_TYPE] + SORT_DELIMITER_SYMBOL + order,\n          order,\n        });\n      });\n\n      return options;\n    }, []);\n    const metricsSortBy = filteredMetricKeys.reduce<any[]>((options, sortLabelKey) => {\n      ColumnSortByOrder.forEach((order) => {\n        options.push({\n          label: sortLabelKey,\n          value: `${makeCanonicalSortKey(COLUMN_TYPES.METRICS, sortLabelKey)}${SORT_DELIMITER_SYMBOL}${order}`,\n          order,\n        });\n      });\n\n      return options;\n    }, []);\n    const paramsSortBy = filteredParamKeys.reduce<any[]>((options, sortLabelKey) => {\n      ColumnSortByOrder.forEach((order) => {\n        options.push({\n          label: sortLabelKey,\n          value: `${makeCanonicalSortKey(COLUMN_TYPES.PARAMS, sortLabelKey)}${SORT_DELIMITER_SYMBOL}${order}`,\n          order,\n        });\n      });\n\n      return options;\n    }, []);\n    sortOptions = [...attributesSortBy, ...metricsSortBy, ...paramsSortBy];\n\n    return sortOptions;\n  }, [filteredMetricKeys, filteredParamKeys]);\n","import type { AgGridReactProps, AgReactUiProps } from '@ag-grid-community/react';\nimport { Spinner } from '@databricks/design-system';\nimport React from 'react';\n\nconst MLFlowAgGridImpl = React.lazy(() => import('./AgGrid'));\n\n/**\n * A simple loader that will lazily load MLflow's ag grid implementation.\n * Extracted to a separate module for testing purposes.\n */\nexport const MLFlowAgGridLoader = (props: AgGridReactProps | AgReactUiProps) => (\n  <React.Suspense\n    fallback={\n      <div\n        css={(cssTheme) => ({\n          display: 'flex',\n          justifyContent: 'center',\n          margin: cssTheme.spacing.md,\n        })}\n      >\n        <Spinner />\n      </div>\n    }\n  >\n    <MLFlowAgGridImpl {...props} />\n  </React.Suspense>\n);\n","import { chunk, isEqual } from 'lodash';\nimport { AnyAction } from 'redux';\nimport { searchModelVersionsApi } from '../../../../model-registry/actions';\nimport { MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER } from '../../../../model-registry/constants';\nimport {\n  ATTRIBUTE_COLUMN_SORT_KEY,\n  DEFAULT_LIFECYCLE_FILTER,\n  DEFAULT_MODEL_VERSION_FILTER,\n  DEFAULT_START_TIME,\n} from '../../../constants';\nimport { ViewType } from '../../../sdk/MlflowEnums';\nimport { KeyValueEntity, LIFECYCLE_FILTER } from '../../../types';\nimport { EXPERIMENT_LOG_MODEL_HISTORY_TAG } from './experimentPage.common-utils';\nimport { ThunkDispatch } from '../../../../redux-types';\nimport type { ExperimentPageSearchFacetsState } from '../models/ExperimentPageSearchFacetsState';\nimport { RUNS_SEARCH_MAX_RESULTS } from '../../../actions';\n\nconst START_TIME_COLUMN_OFFSET = {\n  ALL: null,\n  LAST_HOUR: 1 * 60 * 60 * 1000,\n  LAST_24_HOURS: 24 * 60 * 60 * 1000,\n  LAST_7_DAYS: 7 * 24 * 60 * 60 * 1000,\n  LAST_30_DAYS: 30 * 24 * 60 * 60 * 1000,\n  LAST_YEAR: 12 * 30 * 24 * 60 * 60 * 1000,\n};\n\nexport const RUNS_AUTO_REFRESH_INTERVAL = 30000;\n\n/**\n * This function checks if the sort+model state update has\n * been updated enough and if the change should invoke re-fetching\n * the runs from the back-end. This enables differentiation between\n * front-end and back-end filtering.\n */\nexport const shouldRefetchRuns = (\n  currentSearchFacetsState: ExperimentPageSearchFacetsState,\n  newSearchFacetsState: ExperimentPageSearchFacetsState,\n) =>\n  !isEqual(currentSearchFacetsState.searchFilter, newSearchFacetsState.searchFilter) ||\n  !isEqual(currentSearchFacetsState.orderByAsc, newSearchFacetsState.orderByAsc) ||\n  !isEqual(currentSearchFacetsState.orderByKey, newSearchFacetsState.orderByKey) ||\n  !isEqual(currentSearchFacetsState.lifecycleFilter, newSearchFacetsState.lifecycleFilter) ||\n  !isEqual(currentSearchFacetsState.startTime, newSearchFacetsState.startTime) ||\n  !isEqual(currentSearchFacetsState.datasetsFilter, newSearchFacetsState.datasetsFilter);\n\n/**\n * Creates \"order by\" SQL expression\n */\nconst createOrderByExpression = ({ orderByKey, orderByAsc }: ExperimentPageSearchFacetsState) => {\n  if (orderByKey) {\n    return orderByAsc ? [orderByKey + ' ASC'] : [orderByKey + ' DESC'];\n  }\n  return [];\n};\n\n/**\n * Creates SQL expression for filtering by run start time\n */\nconst createStartTimeExpression = ({ startTime }: ExperimentPageSearchFacetsState, referenceTime: number) => {\n  const offset = START_TIME_COLUMN_OFFSET[startTime as keyof typeof START_TIME_COLUMN_OFFSET];\n  if (!startTime || !offset || startTime === 'ALL') {\n    return null;\n  }\n  const startTimeOffset = referenceTime - offset;\n\n  return `attributes.start_time >= ${startTimeOffset}`;\n};\n\n/**\n * Creates SQL expression for filtering by selected datasets\n */\nconst createDatasetsFilterExpression = ({ datasetsFilter }: ExperimentPageSearchFacetsState) => {\n  if (datasetsFilter.length === 0) {\n    return null;\n  }\n  const datasetNames = datasetsFilter.map((dataset) => `'${dataset.name}'`).join(',');\n  const datasetDigests = datasetsFilter.map((dataset) => `'${dataset.digest}'`).join(',');\n\n  return `dataset.name IN (${datasetNames}) AND dataset.digest IN (${datasetDigests})`;\n};\n\n/**\n * Combines search filter and start time SQL expressions\n */\nconst createFilterExpression = (\n  { searchFilter }: ExperimentPageSearchFacetsState,\n  startTimeExpression: string | null,\n  datasetsFilterExpression: string | null,\n) => {\n  const activeFilters = [];\n  if (searchFilter) activeFilters.push(searchFilter);\n  if (startTimeExpression) activeFilters.push(startTimeExpression);\n  if (datasetsFilterExpression) activeFilters.push(datasetsFilterExpression);\n\n  if (activeFilters.length === 0) return undefined;\n  return activeFilters.join(' and ');\n};\n\n/**\n * If this function returns true, the ExperimentView should nest children underneath their parents\n * and fetch all root level parents of visible runs. If this function returns false, the views will\n * not nest children or fetch any additional parents. Will always return true if the orderByKey is\n * 'attributes.start_time'\n */\nconst shouldNestChildrenAndFetchParents = ({ orderByKey, searchFilter }: ExperimentPageSearchFacetsState) =>\n  (!orderByKey && !searchFilter) || orderByKey === ATTRIBUTE_COLUMN_SORT_KEY.DATE;\n\n/**\n *\n * Function creates API-compatible query object basing on the given criteria.\n * @param experimentIds IDs of experiments to be queries for runs\n * @param searchFacetsState the sort/filter model to use\n * @param referenceTime reference time to calculate startTime filter\n * @param pageToken next page token if fetching the next page\n */\nexport const createSearchRunsParams = (\n  experimentIds: string[],\n  searchFacetsState: ExperimentPageSearchFacetsState & { runsPinned: string[] },\n  referenceTime: number,\n  pageToken?: string,\n  maxResults?: number,\n) => {\n  const runViewType =\n    searchFacetsState.lifecycleFilter === LIFECYCLE_FILTER.ACTIVE ? ViewType.ACTIVE_ONLY : ViewType.DELETED_ONLY;\n\n  const { runsPinned = undefined } = searchFacetsState;\n\n  const orderBy = createOrderByExpression(searchFacetsState);\n  const startTimeExpression = createStartTimeExpression(searchFacetsState, referenceTime);\n  const datasetsFilterExpression = createDatasetsFilterExpression(searchFacetsState);\n  const filter = createFilterExpression(searchFacetsState, startTimeExpression, datasetsFilterExpression);\n  const shouldFetchParents = shouldNestChildrenAndFetchParents(searchFacetsState);\n\n  return {\n    // Experiment IDs\n    experimentIds,\n\n    // Filters and sort options\n    filter,\n    runViewType,\n    orderBy,\n    shouldFetchParents,\n\n    // Next page token for loading more runs\n    pageToken,\n    runsPinned,\n\n    maxResults: maxResults || RUNS_SEARCH_MAX_RESULTS,\n  };\n};\n/**\n * Function checks if given runs set contain info about log model history and if true,\n * fetches model versions for them\n *\n * @param runsPayload runs payload returned from the searchRuns API\n * @param actionCreator redux-thunk action creator that for search model versions action\n * @param dispatch redux-compatible dispatch function\n */\nexport const fetchModelVersionsForRuns = (\n  runsPayload: {\n    info: {\n      run_id: string;\n    };\n    data: {\n      tags: KeyValueEntity[];\n    };\n  }[],\n  actionCreator: typeof searchModelVersionsApi,\n  dispatch: ThunkDispatch,\n) => {\n  const runsWithLogModelHistory = runsPayload.filter((run) =>\n    run.data.tags.some((t) => t.key === EXPERIMENT_LOG_MODEL_HISTORY_TAG),\n  );\n\n  chunk(runsWithLogModelHistory, MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER).forEach((runsChunk) => {\n    const action = actionCreator({ run_id: runsChunk.map((run) => run.info.run_id) });\n    dispatch(action);\n  });\n};\n\n/**\n * Function consumes a search state facets object and returns `true`\n * if at least one filter-related facet is not-default meaning that runs\n * are currently filtered.\n */\nexport const isSearchFacetsFilterUsed = (currentSearchFacetsState: ExperimentPageSearchFacetsState) => {\n  const { lifecycleFilter, modelVersionFilter, datasetsFilter, searchFilter, startTime } = currentSearchFacetsState;\n  return Boolean(\n    lifecycleFilter !== DEFAULT_LIFECYCLE_FILTER ||\n      modelVersionFilter !== DEFAULT_MODEL_VERSION_FILTER ||\n      datasetsFilter.length !== 0 ||\n      searchFilter ||\n      startTime !== DEFAULT_START_TIME,\n  );\n};\n","import { SortAscendingIcon, SortDescendingIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { useUpdateExperimentPageSearchFacets } from '../../../hooks/useExperimentPageSearchFacets';\n\nexport interface ColumnHeaderCellProps {\n  enableSorting: boolean;\n  displayName: string;\n  canonicalSortKey: string;\n  context: {\n    orderByKey: string;\n    orderByAsc: boolean;\n  };\n}\n\nexport const ColumnHeaderCell = ({\n  enableSorting,\n  canonicalSortKey,\n  displayName,\n  context: tableContext,\n}: ColumnHeaderCellProps) => {\n  const { orderByKey, orderByAsc } = tableContext || {};\n  const updateSearchFacets = useUpdateExperimentPageSearchFacets();\n\n  const handleSortBy = () => {\n    let newOrderByAsc = !orderByAsc;\n\n    // If the new sortKey is not equal to the previous sortKey, reset the orderByAsc\n    if (canonicalSortKey !== orderByKey) {\n      newOrderByAsc = false;\n    }\n    updateSearchFacets({ orderByKey: canonicalSortKey, orderByAsc: newOrderByAsc });\n  };\n\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      role=\"columnheader\"\n      css={{\n        height: '100%',\n        width: '100%',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        padding: '0 12px',\n        gap: theme.spacing.sm,\n        svg: {\n          color: theme.colors.textSecondary,\n        },\n        '&:hover': {\n          color: enableSorting ? theme.colors.actionTertiaryTextHover : 'unset',\n          svg: {\n            color: theme.colors.actionTertiaryTextHover,\n          },\n        },\n      }}\n      className={canonicalSortKey === orderByKey ? 'is-ordered-by' : ''}\n      onClick={enableSorting ? () => handleSortBy() : undefined}\n    >\n      <span data-test-id={`sort-header-${displayName}`}>{displayName}</span>\n      {enableSorting && canonicalSortKey === orderByKey ? (\n        orderByAsc ? (\n          <SortAscendingIcon />\n        ) : (\n          <SortDescendingIcon />\n        )\n      ) : null}\n    </div>\n  );\n};\n","import { Theme } from '@emotion/react';\nimport React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowDateAndNestInfo } from '../../../utils/experimentPage.row-types';\nimport { RunStatusIcon } from '../../../../RunStatusIcon';\n\nexport interface DateCellRendererProps {\n  value: RunRowDateAndNestInfo;\n}\n\nexport const DateCellRenderer = React.memo(({ value }: DateCellRendererProps) => {\n  const { startTime, referenceTime, runStatus } = value || {};\n  if (!startTime) {\n    return <>-</>;\n  }\n  return (\n    <span css={styles.cellWrapper} title={Utils.formatTimestamp(startTime)}>\n      <RunStatusIcon status={runStatus} />\n      {Utils.timeSinceStr(startTime, referenceTime)}\n    </span>\n  );\n});\n\nconst styles = {\n  cellWrapper: (theme: Theme) => ({\n    display: 'flex',\n    alignItems: 'center',\n    gap: theme.spacing.sm,\n  }),\n};\n","import React from 'react';\nimport { Link } from '../../../../../../common/utils/RoutingUtils';\nimport Routes from '../../../../../routes';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\n\nexport interface ExperimentNameCellRendererProps {\n  value: {\n    name: string;\n    basename: string;\n  };\n  data: RunRowType;\n}\n\nexport const ExperimentNameCellRenderer = React.memo(({ data, value }: ExperimentNameCellRendererProps) =>\n  !data.experimentId ? null : (\n    <Link to={Routes.getExperimentPageRoute(data.experimentId)} title={value.name}>\n      {value.basename}\n    </Link>\n  ),\n);\n","import React from 'react';\nimport { ModelsIcon, Overflow, Tag, Tooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { ModelRegistryRoutes } from '../../../../../../model-registry/routes';\nimport Routes from '../../../../../routes';\nimport { RunRowModelsInfo } from '../../../utils/experimentPage.row-types';\nimport { Link } from '../../../../../../common/utils/RoutingUtils';\nimport { ReactComponent as RegisteredModelOkIcon } from '../../../../../../common/static/registered-model-grey-ok.svg';\nimport { FormattedMessage } from 'react-intl';\n\nconst EMPTY_CELL_PLACEHOLDER = '-';\n\nexport interface ModelsCellRendererProps {\n  value: RunRowModelsInfo;\n}\n\n/**\n * Backfill Typescript type for the value returned from Utils.mergeLoggedAndRegisteredModels\n */\ninterface CombinedModelType {\n  registeredModelName?: string;\n  isUc?: string;\n  registeredModelVersion?: string;\n  artifactPath?: string;\n  flavors?: string[];\n}\n\n/**\n * Icon, label and link for a single model\n */\nconst ModelLink = ({\n  model: { isUc, registeredModelName, registeredModelVersion, flavors, artifactPath } = {},\n  experimentId,\n  runUuid,\n}: {\n  model?: CombinedModelType;\n  experimentId: string;\n  runUuid: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  // Renders a model name based on whether it's a registered model or not\n  const renderModelName = () => {\n    const displayFullName = `${registeredModelName} v${registeredModelVersion}`;\n    if (registeredModelName) {\n      return (\n        <Tooltip title={displayFullName} placement=\"topLeft\">\n          <span css={{ verticalAlign: 'middle' }}>{registeredModelName}</span>{' '}\n          <Tag css={{ marginRight: 0, verticalAlign: 'middle' }}>v{registeredModelVersion}</Tag>\n        </Tooltip>\n      );\n    }\n\n    const firstFlavorName = flavors?.[0];\n\n    return (\n      firstFlavorName || (\n        <FormattedMessage\n          defaultMessage=\"Model\"\n          description=\"Experiment page > runs table > models column > default label for no specific model\"\n        />\n      )\n    );\n  };\n\n  // Renders a link to either the model registry or the run artifacts page\n  const renderModelLink = () => {\n    if (registeredModelName && registeredModelVersion) {\n      return ModelRegistryRoutes.getModelVersionPageRoute(registeredModelName, registeredModelVersion);\n    }\n    return Routes.getRunPageRoute(experimentId, runUuid, artifactPath);\n  };\n\n  // Renders an icon based on whether it's a registered model or not\n  const renderModelIcon = () => {\n    if (registeredModelName) {\n      return <RegisteredModelOkIcon css={{ color: theme.colors.actionPrimaryBackgroundDefault }} />;\n    }\n    return <ModelsIcon css={{ color: theme.colors.actionPrimaryBackgroundDefault }} />;\n  };\n\n  return (\n    <div css={{ display: 'flex', alignItems: 'center', gap: theme.spacing.xs, overflow: 'hidden' }}>\n      <div css={{ width: 20, display: 'flex', alignItems: 'center', justifyContent: 'flex-start', flexShrink: 0 }}>\n        {renderModelIcon()}\n      </div>\n      <Link\n        to={renderModelLink()}\n        target=\"_blank\"\n        css={{ textOverflow: 'ellipsis', overflow: 'hidden', cursor: 'pointer' }}\n      >\n        {renderModelName()}\n      </Link>\n    </div>\n  );\n};\n\nexport const ModelsCellRenderer = React.memo((props: ModelsCellRendererProps) => {\n  if (!props.value) {\n    return <>{EMPTY_CELL_PLACEHOLDER}</>;\n  }\n  const { registeredModels, loggedModels, experimentId, runUuid } = props.value;\n  const models: CombinedModelType[] = Utils.mergeLoggedAndRegisteredModels(loggedModels, registeredModels) as any[];\n\n  if (models && models.length) {\n    return (\n      // <Overflow /> component does not ideally fit within ag-grid cell so we need to override its styles a bit\n      <div css={{ width: '100%', '&>div': { maxWidth: '100%', display: 'flex' } }}>\n        <Overflow>\n          {models.map((model, index) => (\n            <ModelLink model={model} key={model.artifactPath || index} experimentId={experimentId} runUuid={runUuid} />\n          ))}\n        </Overflow>\n      </div>\n    );\n  }\n  return <>{EMPTY_CELL_PLACEHOLDER}</>;\n});\n","import React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { ExperimentSourceTypeIcon } from '../../../../ExperimentSourceTypeIcon';\n\nexport const SourceCellRenderer = React.memo(({ value: tags }: { value: RunRowType['tags'] }) => {\n  const { theme } = useDesignSystemTheme();\n  if (!tags) {\n    return <>-</>;\n  }\n  const sourceType = tags[Utils.sourceTypeTag]?.value || '';\n\n  const sourceLink = Utils.renderSource(tags || {}, undefined, undefined);\n  return sourceLink ? (\n    <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n      <ExperimentSourceTypeIcon sourceType={sourceType} css={{ color: theme.colors.textSecondary }} />\n      <span css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>{sourceLink}</span>\n    </div>\n  ) : (\n    <>-</>\n  );\n});\n","import React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowVersionInfo } from '../../../utils/experimentPage.row-types';\n\nexport const VersionCellRenderer = React.memo(({ value }: { value?: RunRowVersionInfo }) => {\n  if (!value) {\n    return <>-</>;\n  }\n  const {\n    // Run row version object parameters\n    version,\n    name,\n    type,\n  } = value;\n\n  return (\n    Utils.renderSourceVersion(\n      // Using function from utils to render the source link\n      version,\n      name,\n      type,\n    ) || <>-</>\n  );\n});\n","var _path, _circle;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgIconVisibleFill(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8 3C3.45 3 1.4375 6.33333 1 8C1.4375 9.66667 3.45 13 8 13C12.55 13 14.5625 9.66667 15 8C14.5625 6.33333 12.55 3 8 3Z\",\n    fill: \"currentColor\",\n    stroke: \"currentColor\"\n  })), _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 8,\n    cy: 8,\n    r: 2.25,\n    fill: \"currentColor\",\n    stroke: \"white\",\n    strokeWidth: 1.5\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgIconVisibleFill);\nexport default __webpack_public_path__ + \"static/media/icon-visible-fill.8d34cd35303828fdfc15154f5536e63b.svg\";\nexport { ForwardRef as ReactComponent };","import {\n  PinIcon,\n  PinFillIcon,\n  Tooltip,\n  VisibleIcon as VisibleHollowIcon,\n  VisibleOffIcon,\n  useDesignSystemTheme,\n  Icon,\n  visuallyHidden,\n} from '@databricks/design-system';\nimport type { SuppressKeyboardEventParams } from '@ag-grid-community/core';\n\n// TODO: Import this icon from design system when added\nimport { ReactComponent as VisibleFillIcon } from '../../../../../../common/static/icon-visible-fill.svg';\nimport { Theme } from '@emotion/react';\nimport React from 'react';\nimport { FormattedMessage, defineMessages } from 'react-intl';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../../common/utils/FeatureUtils';\nimport { useUpdateExperimentViewUIState } from '../../../contexts/ExperimentPageUIStateContext';\nimport { RUNS_VISIBILITY_MODE } from '../../../models/ExperimentPageUIState';\nimport { isRemainingRunsGroup } from '../../../utils/experimentPage.group-row-utils';\n\nconst labels = {\n  visibility: {\n    groups: defineMessages({\n      unhide: {\n        defaultMessage: 'Unhide group',\n        description: 'A tooltip for the visibility icon button in the runs table next to the hidden run group',\n      },\n      hide: {\n        defaultMessage: 'Hide group',\n        description: 'A tooltip for the visibility icon button in the runs table next to the visible run group',\n      },\n    }),\n    runs: defineMessages({\n      unhide: {\n        defaultMessage: 'Unhide run',\n        description: 'A tooltip for the visibility icon button in the runs table next to the hidden run',\n      },\n      hide: {\n        defaultMessage: 'Hide run',\n        description: 'A tooltip for the visibility icon button in the runs table next to the visible run',\n      },\n    }),\n  },\n  pinning: {\n    groups: defineMessages({\n      unpin: {\n        defaultMessage: 'Unpin group',\n        description: 'A tooltip for the pin icon button in the runs table next to the pinned run group',\n      },\n      pin: {\n        defaultMessage: 'Pin group',\n        description: 'A tooltip for the pin icon button in the runs table next to the not pinned run group',\n      },\n    }),\n    runs: defineMessages({\n      unpin: {\n        defaultMessage: 'Unpin run',\n        description: 'A tooltip for the pin icon button in the runs table next to the pinned run',\n      },\n      pin: {\n        defaultMessage: 'Pin run',\n        description: 'A tooltip for the pin icon button in the runs table next to the not pinned run',\n      },\n    }),\n  },\n};\n\nconst VisibleIcon = () =>\n  shouldUseNewRunRowsVisibilityModel() ? <Icon component={VisibleFillIcon} /> : <VisibleHollowIcon />;\n\n// Mouse enter/leave delays passed to tooltips are set to 0 so swift toggling/pinning runs is not hampered\nconst MOUSE_DELAYS = { mouseEnterDelay: 0, mouseLeaveDelay: 0 };\n\nexport const RowActionsCellRenderer = React.memo(\n  (props: {\n    data: RunRowType;\n    value: { pinned: boolean; hidden: boolean };\n    onTogglePin: (runUuid: string) => void;\n    onToggleVisibility: (runUuidOrToggle: string | RUNS_VISIBILITY_MODE, runUuid?: string) => void;\n  }) => {\n    const updateUIState = useUpdateExperimentViewUIState();\n    const { theme } = useDesignSystemTheme();\n\n    const { groupParentInfo } = props.data;\n    const isGroupRow = Boolean(groupParentInfo);\n    const { pinned, hidden } = props.value;\n    const { runUuid, rowUuid } = props.data;\n\n    // If a row is a run group, we use its rowUuid for setting visibility.\n    // If this is a run, use runUuid.\n    const runUuidToToggle = groupParentInfo ? rowUuid : runUuid;\n\n    const visibilityMessageDescriptor = isGroupRow\n      ? hidden\n        ? labels.visibility.groups.unhide\n        : labels.visibility.groups.hide\n      : hidden\n      ? labels.visibility.runs.unhide\n      : labels.visibility.runs.hide;\n\n    const pinningMessageDescriptor = isGroupRow\n      ? pinned\n        ? labels.pinning.groups.unpin\n        : labels.pinning.groups.pin\n      : pinned\n      ? labels.pinning.runs.unpin\n      : labels.pinning.runs.pin;\n\n    const displayVisibilityCheckbox =\n      !shouldUseNewRunRowsVisibilityModel() ||\n      (groupParentInfo && !isRemainingRunsGroup(groupParentInfo)) ||\n      (runUuid && !props.data.runDateAndNestInfo?.belongsToGroup);\n\n    return (\n      <div css={styles.actionsContainer}>\n        {/* Hide/show icon is part of compare runs UI */}\n        {!displayVisibilityCheckbox ? (\n          <div css={[styles.showOnlyInCompareMode, { width: theme.general.iconFontSize }]} />\n        ) : (\n          <Tooltip\n            dangerouslySetAntdProps={MOUSE_DELAYS}\n            placement=\"right\"\n            title={<FormattedMessage {...visibilityMessageDescriptor} />}\n          >\n            <label\n              css={[\n                styles.actionCheckbox(theme),\n                // We show this button only in the runs compare mode and only when the feature flag is set\n                shouldUseNewRunRowsVisibilityModel() && styles.showOnlyInCompareMode,\n              ]}\n              className=\"is-visibility-toggle\"\n            >\n              <span css={visuallyHidden}>\n                <FormattedMessage {...visibilityMessageDescriptor} />\n              </span>\n              <input\n                type=\"checkbox\"\n                className=\"is-visibility-toggle-checkbox\"\n                checked={!hidden}\n                onChange={() => {\n                  if (runUuidToToggle) {\n                    if (shouldUseNewRunRowsVisibilityModel()) {\n                      props.onToggleVisibility(RUNS_VISIBILITY_MODE.CUSTOM, runUuidToToggle);\n                    } else {\n                      props.onToggleVisibility(runUuidToToggle);\n                    }\n                  }\n                }}\n              />\n              {!hidden ? <VisibleIcon /> : <VisibleOffIcon />}\n            </label>\n          </Tooltip>\n        )}\n        {((props.data.pinnable && runUuid) || groupParentInfo) && (\n          <Tooltip\n            dangerouslySetAntdProps={MOUSE_DELAYS}\n            placement=\"right\"\n            // We have to force remount of the tooltip with every rerender, otherwise it will jump\n            // around when the row order changes.\n            key={Math.random()}\n            title={<FormattedMessage {...pinningMessageDescriptor} />}\n          >\n            <label css={styles.actionCheckbox(theme)} className=\"is-pin-toggle\" data-testid=\"column-pin-toggle\">\n              <span css={visuallyHidden}>\n                <FormattedMessage {...pinningMessageDescriptor} />\n              </span>\n              <input\n                type=\"checkbox\"\n                checked={pinned}\n                onChange={() => {\n                  const uuidToPin = groupParentInfo ? props.data.rowUuid : runUuid;\n                  updateUIState((existingState) => {\n                    if (uuidToPin) {\n                      return {\n                        ...existingState,\n                        runsPinned: !existingState.runsPinned.includes(uuidToPin)\n                          ? [...existingState.runsPinned, uuidToPin]\n                          : existingState.runsPinned.filter((r) => r !== uuidToPin),\n                      };\n                    }\n                    return existingState;\n                  });\n                }}\n              />\n              {pinned ? <PinFillIcon /> : <PinIcon />}\n            </label>\n          </Tooltip>\n        )}\n      </div>\n    );\n  },\n  (prevProps, nextProps) =>\n    prevProps.value.hidden === nextProps.value.hidden && prevProps.value.pinned === nextProps.value.pinned,\n);\n\n/**\n * A utility function that enables custom keyboard navigation for the row actions cell renderer by providing\n * conditional suppression of default events.\n */\nexport const RowActionsCellRendererSuppressKeyboardEvents = ({ event }: SuppressKeyboardEventParams) => {\n  if (\n    event.key === 'Tab' &&\n    event.target instanceof HTMLElement &&\n    // Let's suppress the default action if the focus is on cell or on visibility toggle checkbox, allowing\n    // tab to move to the next focusable element.\n    (event.target.classList.contains('ag-cell') || event.target.classList.contains('is-visibility-toggle-checkbox'))\n  ) {\n    return true;\n  }\n  return false;\n};\n\nconst styles = {\n  actionsContainer: {\n    display: 'flex',\n    gap: 18, // In design there's 20 px of gutter, it's minus 2 px due to pin icon's internal padding\n  },\n  showOnlyInCompareMode: {\n    display: 'none',\n    '.is-table-comparing-runs-mode &': {\n      display: 'flex',\n    },\n  },\n  actionCheckbox: (theme: Theme) => ({\n    input: { width: 0, appearance: 'none' as const },\n    cursor: 'pointer',\n    display: 'flex',\n    svg: {\n      width: theme.general.iconFontSize,\n      height: theme.general.iconFontSize,\n      cursor: 'pointer',\n    },\n    // Styling for the pin button - it's transparent when unpinned and not hovered\n    '&.is-pin-toggle svg': {\n      color: 'transparent',\n      '.ag-row:hover &': {\n        color: theme.colors.grey500,\n      },\n    },\n    // Styling for the show/hide button - it uses different color for active/inactive\n    '&.is-visibility-toggle svg': {\n      color: theme.colors.grey400,\n      '.ag-row:hover &': {\n        color: theme.colors.grey500,\n      },\n    },\n    '& input:checked + span svg': {\n      color: theme.colors.grey500,\n    },\n    '& input:focus-visible + span svg': {\n      color: theme.colors.grey500,\n    },\n  }),\n};\n","import React from 'react';\nimport { RUNS_VISIBILITY_MODE } from '../../models/ExperimentPageUIState';\n\nconst ExperimentViewRunsTableHeaderContext = React.createContext({\n  runsHiddenMode: RUNS_VISIBILITY_MODE.FIRST_10_RUNS,\n});\n\n/**\n * A tiny context that passes the current runs hidden mode to the header cell renderer.\n *\n * This is needed because ag-grid context is unreliable and does not always update when the\n * runs hidden mode changes. The solution below is way more performant than recreating column definitions\n * based on a new value.\n */\nexport const ExperimentViewRunsTableHeaderContextProvider = ({\n  children,\n  runsHiddenMode,\n}: {\n  children: React.ReactNode;\n  runsHiddenMode: RUNS_VISIBILITY_MODE;\n}) => (\n  <ExperimentViewRunsTableHeaderContext.Provider value={{ runsHiddenMode }}>\n    {children}\n  </ExperimentViewRunsTableHeaderContext.Provider>\n);\n\nexport const useExperimentViewRunsTableHeaderContext = () => React.useContext(ExperimentViewRunsTableHeaderContext);\n","import {\n  DropdownMenu,\n  Icon,\n  VisibleIcon as VisibleHollowIcon,\n  VisibleOffIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { useEffect } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { RUNS_VISIBILITY_MODE } from 'experiment-tracking/components/experiment-page/models/ExperimentPageUIState';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../../common/utils/FeatureUtils';\n// TODO: Import this icon from design system when added\nimport { ReactComponent as VisibleFillIcon } from '../../../../../../common/static/icon-visible-fill.svg';\nimport { useExperimentViewRunsTableHeaderContext } from '../ExperimentViewRunsTableHeaderContext';\n\nconst VisibleIcon = () =>\n  shouldUseNewRunRowsVisibilityModel() ? <Icon component={VisibleFillIcon} /> : <VisibleHollowIcon />;\n\nexport const RowActionsHeaderCellRendererV2 = React.memo(\n  ({\n    allRunsHidden,\n    onToggleVisibility,\n  }: {\n    allRunsHidden?: boolean;\n    onToggleVisibility: (mode: RUNS_VISIBILITY_MODE | string, runOrGroupUuid?: string) => void;\n  }) => {\n    const { theme } = useDesignSystemTheme();\n    const intl = useIntl();\n    const { runsHiddenMode } = useExperimentViewRunsTableHeaderContext();\n\n    return (\n      <DropdownMenu.Root modal={false}>\n        <DropdownMenu.Trigger asChild>\n          <button\n            css={[\n              styles.actionButton(theme),\n              // We show this button only in the runs compare mode and only when the feature flag is set\n              shouldUseNewRunRowsVisibilityModel() && styles.showOnlyInCompareMode,\n            ]}\n            data-testid=\"experiment-view-runs-visibility-column-header\"\n            aria-label={intl.formatMessage({\n              defaultMessage: 'Toggle visibility of runs',\n              description: 'Experiment page > runs table > toggle visibility of runs > accessible label',\n            })}\n          >\n            {runsHiddenMode === RUNS_VISIBILITY_MODE.HIDEALL || allRunsHidden ? <VisibleOffIcon /> : <VisibleIcon />}\n          </button>\n        </DropdownMenu.Trigger>\n\n        <DropdownMenu.Content>\n          <DropdownMenu.RadioGroup value={runsHiddenMode} onValueChange={(e) => onToggleVisibility(e)}>\n            <DropdownMenu.RadioItem value={RUNS_VISIBILITY_MODE.FIRST_10_RUNS}>\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show first 10\"\n                description=\"Menu option for showing only 10 first runs in the experiment view runs compare mode\"\n              />\n            </DropdownMenu.RadioItem>\n            <DropdownMenu.RadioItem value={RUNS_VISIBILITY_MODE.FIRST_20_RUNS}>\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show first 20\"\n                description=\"Menu option for showing only 10 first runs in the experiment view runs compare mode\"\n              />\n            </DropdownMenu.RadioItem>\n            <DropdownMenu.RadioItem value={RUNS_VISIBILITY_MODE.SHOWALL}>\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show all runs\"\n                description=\"Menu option for revealing all hidden runs in the experiment view runs compare mode\"\n              />\n            </DropdownMenu.RadioItem>\n            <DropdownMenu.RadioItem value={RUNS_VISIBILITY_MODE.HIDEALL}>\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Hide all runs\"\n                description=\"Menu option for revealing all hidden runs in the experiment view runs compare mode\"\n              />\n            </DropdownMenu.RadioItem>\n          </DropdownMenu.RadioGroup>\n        </DropdownMenu.Content>\n      </DropdownMenu.Root>\n    );\n  },\n);\n\n/**\n * A component used to render \"eye\" icon in the table header used to hide/show all runs\n */\nexport const RowActionsHeaderCellRenderer = React.memo(\n  (props: {\n    allRunsHidden?: boolean;\n    onToggleVisibility: (runUuidOrToggle: string) => void;\n    eGridHeader?: HTMLElement;\n  }) => {\n    const intl = useIntl();\n\n    // Since ag-grid does not add accessible labels to its checkboxes, we do it manually.\n    // This is executed once per table lifetime.\n    useEffect(() => {\n      // Find a checkbox in the header\n      const selectAllCheckbox = props.eGridHeader?.querySelector('input');\n\n      // If found, assign aria-label attribute\n      if (selectAllCheckbox) {\n        selectAllCheckbox.ariaLabel = intl.formatMessage({\n          defaultMessage: 'Select all runs',\n          description: 'Experiment page > runs table > select all rows > accessible label',\n        });\n      }\n    }, [props.eGridHeader, intl]);\n\n    return shouldUseNewRunRowsVisibilityModel() ? (\n      <RowActionsHeaderCellRendererV2 {...props} />\n    ) : (\n      <DropdownMenu.Root modal={false}>\n        <DropdownMenu.Trigger asChild>\n          <button css={[styles.actionButton]} data-testid=\"experiment-view-runs-visibility-column-header\">\n            {props.allRunsHidden ? <VisibleOffIcon /> : <VisibleIcon />}\n          </button>\n        </DropdownMenu.Trigger>\n\n        <DropdownMenu.Content>\n          <DropdownMenu.Item\n            onClick={() => props.onToggleVisibility(RUNS_VISIBILITY_MODE.HIDEALL)}\n            data-testid=\"experiment-view-runs-visibility-hide-all\"\n          >\n            <DropdownMenu.IconWrapper>\n              <VisibleOffIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Hide all runs\"\n              description=\"Menu option for hiding all runs in the experiment view runs compare mode\"\n            />\n          </DropdownMenu.Item>\n          <DropdownMenu.Item\n            onClick={() => props.onToggleVisibility(RUNS_VISIBILITY_MODE.SHOWALL)}\n            data-testid=\"experiment-view-runs-visibility-show-all\"\n          >\n            <DropdownMenu.IconWrapper>\n              <VisibleIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Show all runs\"\n              description=\"Menu option for revealing all hidden runs in the experiment view runs compare mode\"\n            />\n          </DropdownMenu.Item>\n        </DropdownMenu.Content>\n\n        {/*  */}\n      </DropdownMenu.Root>\n    );\n  },\n);\n\nconst styles = {\n  actionButton: (theme: Theme) => ({\n    background: 'transparent',\n    border: 'none',\n    cursor: 'pointer',\n    padding: '8px',\n    // When visibility icon is next to the ag-grid checkbox, remove the bonus padding\n    '.ag-checkbox:not(.ag-hidden) + &': { padding: '0 1px' },\n    svg: {\n      width: theme.general.iconFontSize,\n      height: theme.general.iconFontSize,\n      cursor: 'pointer',\n      color: theme.colors.grey500,\n    },\n  }),\n  showOnlyInCompareMode: {\n    display: 'none',\n    '.is-table-comparing-runs-mode &': {\n      display: 'flex',\n    },\n  },\n};\n","import { ICellRendererParams } from '@ag-grid-community/core';\nimport { RunGroupParentInfo, RunGroupingMode, RunRowType } from '../../../utils/experimentPage.row-types';\nimport {\n  Button,\n  ChevronDownIcon,\n  ChevronRightIcon,\n  TableIcon,\n  Tag,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { getRunGroupDisplayName, isRemainingRunsGroup } from '../../../utils/experimentPage.group-row-utils';\nimport { useUpdateExperimentViewUIState } from '../../../contexts/ExperimentPageUIStateContext';\nimport { useCallback } from 'react';\nimport { RunColorPill } from '../../RunColorPill';\nimport { isObject } from 'lodash';\nimport invariant from 'invariant';\nimport { FormattedMessage } from 'react-intl';\nimport { useGetExperimentRunColor, useSaveExperimentRunColor } from '../../../hooks/useExperimentRunColor';\n\nexport interface GroupParentCellRendererProps extends ICellRendererParams {\n  data: RunRowType;\n}\n\nexport const GroupParentCellRenderer = ({ data }: GroupParentCellRendererProps) => {\n  const groupParentInfo = data.groupParentInfo;\n  invariant(groupParentInfo, 'groupParentInfo should be defined');\n  const { theme } = useDesignSystemTheme();\n\n  const getRunColor = useGetExperimentRunColor();\n  const saveRunColor = useSaveExperimentRunColor();\n  const updateUIState = useUpdateExperimentViewUIState();\n  const onExpandToggle = useCallback(\n    (groupId: string, doOpen: boolean) => {\n      updateUIState((current) => {\n        const { groupsExpanded } = current;\n        return {\n          ...current,\n          groupsExpanded: { ...groupsExpanded, [groupId]: doOpen },\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  const groupName = getRunGroupDisplayName(groupParentInfo);\n\n  return (\n    <div css={{ display: 'flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n      {groupParentInfo.expanderOpen ? (\n        <ChevronDownIcon\n          role=\"button\"\n          onClick={() => {\n            onExpandToggle(groupParentInfo.groupId, false);\n          }}\n        />\n      ) : (\n        <ChevronRightIcon\n          role=\"button\"\n          onClick={() => {\n            onExpandToggle(groupParentInfo.groupId, true);\n          }}\n        />\n      )}\n      {/* Display color pill only for non-remaining runs groups */}\n      {!isRemainingRunsGroup(groupParentInfo) && (\n        <RunColorPill\n          color={getRunColor(groupParentInfo.groupId)}\n          onChangeColor={(colorValue) => {\n            saveRunColor({ groupUuid: groupParentInfo.groupId, colorValue });\n          }}\n        />\n      )}\n      <div\n        css={{\n          display: 'inline-flex',\n          gap: theme.spacing.sm,\n          alignItems: 'center',\n          overflow: 'hidden',\n          textOverflow: 'ellipsis',\n        }}\n      >\n        {isRemainingRunsGroup(groupParentInfo) ? (\n          <FormattedMessage\n            defaultMessage=\"Additional runs\"\n            description=\"Experiment page > grouped runs table > label for group with additional, ungrouped runs\"\n          />\n        ) : (\n          <span title={groupName} css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>\n            <FormattedMessage\n              defaultMessage=\"Group: {groupName}\"\n              description=\"Experiment page > grouped runs table > run group header label\"\n              values={{ groupName }}\n            />\n          </span>\n        )}\n        <Tag css={{ marginLeft: 0, marginRight: 0 }}>{groupParentInfo.runUuids.length}</Tag>\n      </div>\n    </div>\n  );\n};\n","import { ICellRendererParams } from '@ag-grid-community/core';\nimport { Button, MinusBoxIcon, PlusSquareIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React from 'react';\nimport { Link } from '../../../../../../common/utils/RoutingUtils';\nimport Routes from '../../../../../routes';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { GroupParentCellRenderer } from './GroupParentCellRenderer';\nimport invariant from 'invariant';\nimport { RunColorPill } from '../../RunColorPill';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../../common/utils/FeatureUtils';\nimport { useGetExperimentRunColor, useSaveExperimentRunColor } from '../../../hooks/useExperimentRunColor';\n\nexport interface RunNameCellRendererProps extends ICellRendererParams {\n  data: RunRowType;\n  isComparingRuns?: boolean;\n  onExpand: (runUuid: string, childrenIds?: string[]) => void;\n}\n\nexport const RunNameCellRenderer = React.memo((props: RunNameCellRendererProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const saveRunColor = useSaveExperimentRunColor();\n  const getRunColor = useGetExperimentRunColor();\n\n  // If we're rendering a group row, use relevant component\n  if (props.data.groupParentInfo) {\n    return <GroupParentCellRenderer {...props} />;\n  }\n  const { onExpand, data } = props;\n  const { runName, experimentId, runUuid, runDateAndNestInfo, hidden } = data;\n\n  // If we are not rendering a group, assert existence of necessary fields\n  invariant(experimentId, 'experimentId should be set for run rows');\n  invariant(runUuid, 'runUuid should be set for run rows');\n  invariant(runDateAndNestInfo, 'runDateAndNestInfo should be set for run rows');\n\n  const { hasExpander, expanderOpen, childrenIds, level, belongsToGroup } = runDateAndNestInfo;\n\n  const renderingAsParent = !isNaN(level) && hasExpander;\n\n  return (\n    <div css={styles.cellWrapper}>\n      <div css={styles.expanderWrapper}>\n        <div\n          css={styles.nestLevel(theme)}\n          style={{\n            width: (level + 1) * theme.spacing.lg,\n          }}\n        >\n          {renderingAsParent && (\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_runnamecellrenderer.tsx_46\"\n              css={styles.expanderButton}\n              size=\"small\"\n              onClick={() => {\n                onExpand(runUuid, childrenIds);\n              }}\n              key={'Expander-' + runUuid}\n              type=\"link\"\n              icon={expanderOpen ? <MinusBoxIcon /> : <PlusSquareIcon />}\n            />\n          )}\n        </div>\n      </div>\n      <div css={styles.runLink}>\n        {belongsToGroup ? (\n          // Render empty color pills for grouped runs\n          <div css={{ width: 12, height: 12, flexShrink: 0 }} />\n        ) : (\n          <RunColorPill\n            color={getRunColor(runUuid)}\n            hidden={shouldUseNewRunRowsVisibilityModel() && !belongsToGroup && props.isComparingRuns && hidden}\n            data-testid=\"experiment-view-table-run-color\"\n            onChangeColor={(colorValue) => saveRunColor({ runUuid, colorValue })}\n          />\n        )}\n        <Link to={Routes.getRunPageRoute(experimentId, runUuid)} css={styles.runLink} tabIndex={0}>\n          <span css={styles.runName}>{runName}</span>\n        </Link>\n      </div>\n    </div>\n  );\n});\n\nconst styles = {\n  link: (theme: Theme) => ({\n    display: 'inline-block',\n    minWidth: theme.typography.fontSizeBase,\n    minHeight: theme.typography.fontSizeBase,\n  }),\n  cellWrapper: {\n    display: 'flex',\n  },\n  expanderButton: {\n    svg: {\n      width: 12,\n      height: 12,\n    },\n  },\n  runLink: {\n    overflow: 'hidden',\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n    '&:focus-visible': {\n      textDecoration: 'underline',\n    },\n  },\n  runName: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  expanderWrapper: {\n    display: 'none',\n    '.ag-grid-expanders-visible &': {\n      display: 'block',\n    },\n  },\n  nestLevel: (theme: Theme) => ({\n    display: 'flex',\n    justifyContent: 'flex-end',\n    height: theme.spacing.lg,\n  }),\n};\n","import type { ICellRendererParams } from '@ag-grid-community/core';\nimport { Button } from '@databricks/design-system';\nimport { uniqueId } from 'lodash';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport const createLoadMoreRow = () => ({\n  runUuid: '',\n  rowUuid: uniqueId('load_more'),\n  isLoadMoreRow: true,\n});\n\n/**\n * A cell renderer for special type of full width rows housing \"Load more\"\n * button displayed at the bottom of the grid\n */\nexport const LoadMoreRowRenderer = React.memo(\n  ({ loadMoreRunsFunc }: ICellRendererParams & { loadMoreRunsFunc: () => void }) => (\n    <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: 32 }}>\n      <Button\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_loadmorerowrenderer.tsx_20\"\n        type=\"primary\"\n        onClick={loadMoreRunsFunc}\n        size=\"small\"\n      >\n        <FormattedMessage defaultMessage=\"Load more\" description=\"Load more button text to load more experiment runs\" />\n      </Button>\n    </div>\n  ),\n);\n","import { throttle } from 'lodash';\nimport { Button, Popover, TableIcon, Tag, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useRef, useEffect, useState, useMemo } from 'react';\nimport { MLFLOW_RUN_DATASET_CONTEXT_TAG } from '../../../../../constants';\nimport type { RunDatasetWithTags } from '../../../../../types';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { EXPERIMENT_RUNS_TABLE_ROW_HEIGHT } from '../../../utils/experimentPage.common-utils';\nimport type { SuppressKeyboardEventParams } from '@ag-grid-community/core';\nconst MAX_DATASETS_VISIBLE = 3;\n\n/**\n * Local component, used to render a single dataset within a cell\n * or a context menu\n */\nconst SingleDataset = ({\n  datasetWithTags,\n  onDatasetSelected,\n  appendComma = false,\n  inPopover = false,\n}: {\n  datasetWithTags: RunDatasetWithTags;\n  onDatasetSelected: () => void;\n  appendComma?: boolean;\n  inPopover?: boolean;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const { dataset, tags } = datasetWithTags;\n  if (!dataset) {\n    return null;\n  }\n  const contextTag = tags?.find(({ key }) => key === MLFLOW_RUN_DATASET_CONTEXT_TAG);\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexShrink: 0,\n        alignItems: 'center',\n        overflow: 'hidden',\n        marginRight: theme.spacing.xs,\n      }}\n    >\n      <TableIcon css={{ color: theme.colors.textSecondary, marginRight: theme.spacing.xs }} />{' '}\n      <span\n        css={{ minWidth: 32, marginRight: theme.spacing.xs, flexShrink: 0 }}\n        title={`${dataset.name} (${dataset.digest})`}\n      >\n        {inPopover ? (\n          <Popover.Close asChild>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_datasetscellrenderer.tsx_49\"\n              type=\"link\"\n              onClick={onDatasetSelected}\n              tabIndex={0}\n            >\n              <span css={{ fontSize: 12 }}>\n                {dataset.name} ({dataset.digest})\n              </span>\n            </Button>\n          </Popover.Close>\n        ) : (\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_datasetscellrenderer.tsx_56\"\n            type=\"link\"\n            onClick={onDatasetSelected}\n            data-testid=\"open-dataset-drawer\"\n            tabIndex={0}\n          >\n            <span>\n              {dataset.name} ({dataset.digest})\n            </span>\n          </Button>\n        )}\n      </span>\n      {contextTag && (\n        <Tag css={{ textTransform: 'capitalize', marginRight: theme.spacing.xs }}>\n          <span css={{ fontSize: 12 }}>{contextTag.value}</span>\n        </Tag>\n      )}\n      {appendComma && <>,</>}\n    </div>\n  );\n};\n\nexport interface DatasetsCellRendererProps {\n  value: RunDatasetWithTags[];\n  data: RunRowType;\n  onDatasetSelected: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n  expandRows: boolean;\n}\n\nexport const DatasetsCellRenderer = React.memo(\n  ({ value: datasets, data, onDatasetSelected, expandRows }: DatasetsCellRendererProps) => {\n    const containerElement = useRef<HTMLDivElement>(null);\n    const [datasetsVisible, setDatasetsVisible] = useState(0);\n    const [ellipsisVisible, setEllipsisVisible] = useState(false);\n    const clampedDatasets = useMemo(() => (datasets || []).slice(0, MAX_DATASETS_VISIBLE), [datasets]);\n    const { theme } = useDesignSystemTheme();\n\n    const datasetsLength = (datasets || []).length;\n\n    useEffect(() => {\n      if (!containerElement.current) {\n        return () => {};\n      }\n      const callback: ResizeObserverCallback = throttle(([entry]) => {\n        if (expandRows) {\n          const availableHeight = entry.contentRect.height;\n          let elementsFit = 0;\n          let stackedHeight = 0;\n          for (let i = 0; i < entry.target.children.length; i++) {\n            const item = entry.target.children.item(i) as Element;\n            if (stackedHeight + item.clientHeight > availableHeight) {\n              break;\n            }\n            stackedHeight += item.clientHeight;\n            elementsFit++;\n          }\n          setDatasetsVisible(elementsFit);\n          setEllipsisVisible(elementsFit < datasetsLength);\n        } else {\n          const availableWidth = entry.contentRect.width;\n          if (availableWidth === 0 && datasetsLength) {\n            setDatasetsVisible(0);\n            setEllipsisVisible(true);\n            return;\n          }\n          let elementsFit = 0;\n          let stackedWidth = 0;\n          for (let i = 0; i < entry.target.children.length; i++) {\n            const item = entry.target.children.item(i) as Element;\n            if (stackedWidth + item.clientWidth >= availableWidth) {\n              break;\n            }\n            stackedWidth += item.clientWidth;\n            elementsFit++;\n          }\n          const partiallyVisibleDatasets = Math.min(datasetsLength, elementsFit + 1);\n          setDatasetsVisible(partiallyVisibleDatasets);\n          setEllipsisVisible(elementsFit < datasetsLength);\n        }\n      }, 100);\n\n      const resizeObserver = new ResizeObserver(callback);\n\n      resizeObserver.observe(containerElement.current);\n      return () => resizeObserver.disconnect();\n    }, [expandRows, datasetsLength]);\n\n    const moreItemsToShow = datasetsLength - datasetsVisible;\n    if (!datasets || datasetsLength < 1) {\n      return <>-</>;\n    }\n\n    const datasetsToShow = expandRows ? clampedDatasets : datasets;\n\n    return (\n      <div css={{ display: 'flex' }}>\n        <div\n          css={{\n            overflow: 'hidden',\n            display: 'flex',\n            flexDirection: expandRows ? 'column' : 'row',\n          }}\n          ref={containerElement}\n        >\n          {datasetsToShow.map((datasetWithTags, index) => (\n            <SingleDataset\n              appendComma={expandRows ? false : index < datasetsToShow.length - 1}\n              key={`${datasetWithTags.dataset.name}-${datasetWithTags.dataset.digest}`}\n              datasetWithTags={datasetWithTags}\n              onDatasetSelected={() => onDatasetSelected?.(datasetWithTags, data)}\n            />\n          ))}\n        </div>\n        {(moreItemsToShow > 0 || ellipsisVisible) && (\n          <div css={{ display: 'flex', alignItems: 'flex-end' }}>\n            {!expandRows && ellipsisVisible && (\n              <span css={{ paddingLeft: 0, paddingRight: theme.spacing.xs }}>&hellip;</span>\n            )}\n            {moreItemsToShow > 0 && (\n              <Popover.Root modal={false}>\n                <Popover.Trigger asChild>\n                  <Button\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_cells_datasetscellrenderer.tsx_172\"\n                    size=\"small\"\n                    style={{ borderRadius: '8px', width: '40px' }}\n                    tabIndex={0}\n                  >\n                    <Typography.Text color=\"secondary\">+{moreItemsToShow}</Typography.Text>\n                  </Button>\n                </Popover.Trigger>\n                <Popover.Content align=\"start\" css={{ maxHeight: '400px', overflow: 'auto' }}>\n                  {datasets.slice(datasetsLength - moreItemsToShow).map((datasetWithTags) => (\n                    <div\n                      css={{\n                        height: theme.general.heightSm,\n                        display: 'flex',\n                        alignItems: 'center',\n                      }}\n                      key={`${datasetWithTags.dataset.name}-${datasetWithTags.dataset.digest}`}\n                    >\n                      <SingleDataset\n                        datasetWithTags={datasetWithTags}\n                        onDatasetSelected={() => onDatasetSelected?.(datasetWithTags, data)}\n                        inPopover\n                      />\n                    </div>\n                  ))}\n                </Popover.Content>\n              </Popover.Root>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  },\n);\n\nexport const getDatasetsCellHeight = (datasetColumnShown: boolean, row: { data: RunRowType }) => {\n  if (datasetColumnShown) {\n    const { data } = row;\n\n    // Display at least 1, but at most 5 text lines in the cell.\n    const datasetsCount = Math.min(data.datasets?.length || 1, MAX_DATASETS_VISIBLE);\n    return EXPERIMENT_RUNS_TABLE_ROW_HEIGHT * datasetsCount;\n  }\n  return EXPERIMENT_RUNS_TABLE_ROW_HEIGHT;\n};\n\n/**\n * A utility function that enables custom keyboard navigation for the datasets cell renderer by providing\n * conditional suppression of default events.\n *\n * This cell needs specific handling since it's the only one that displays multiple buttons simultaneously.\n */\nexport const DatasetsCellRendererSuppressKeyboardEvents = ({ event }: SuppressKeyboardEventParams) => {\n  return (\n    event.key === 'Tab' &&\n    event.target instanceof HTMLElement &&\n    // Let's suppress the default action if the focus is on cell or on the dataset button, allowing\n    // tab to move to the next focusable element.\n    (event.target.classList.contains('ag-cell') || event.target instanceof HTMLButtonElement)\n  );\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\n\nexport const AggregateMetricValueCell = ({ value, data }: { value: string; data: RunRowType }) => {\n  const { theme } = useDesignSystemTheme();\n  if (data.groupParentInfo?.aggregateFunction) {\n    return (\n      <Typography.Text>\n        {value} <span css={{ color: theme.colors.textSecondary }}>({data.groupParentInfo.aggregateFunction})</span>\n      </Typography.Text>\n    );\n  }\n  return value;\n};\n","import type {\n  CellClassParams,\n  ColDef,\n  ColGroupDef,\n  ColumnApi,\n  IsFullWidthRowParams,\n  SuppressKeyboardEventParams,\n} from '@ag-grid-community/core';\nimport { Spinner, SpinnerProps, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useEffect, useMemo, useRef } from 'react';\nimport { capitalize, isEqual } from 'lodash';\nimport Utils from '../../../../common/utils/Utils';\nimport { ATTRIBUTE_COLUMN_LABELS, ATTRIBUTE_COLUMN_SORT_KEY, COLUMN_TYPES } from '../../../constants';\nimport { ColumnHeaderCell } from '../components/runs/cells/ColumnHeaderCell';\nimport { DateCellRenderer } from '../components/runs/cells/DateCellRenderer';\nimport { ExperimentNameCellRenderer } from '../components/runs/cells/ExperimentNameCellRenderer';\nimport { ModelsCellRenderer } from '../components/runs/cells/ModelsCellRenderer';\nimport { SourceCellRenderer } from '../components/runs/cells/SourceCellRenderer';\nimport { VersionCellRenderer } from '../components/runs/cells/VersionCellRenderer';\nimport {\n  EXPERIMENT_FIELD_PREFIX_METRIC,\n  EXPERIMENT_FIELD_PREFIX_PARAM,\n  EXPERIMENT_FIELD_PREFIX_TAG,\n  getQualifiedEntityName,\n  makeCanonicalSortKey,\n} from './experimentPage.common-utils';\nimport { RunRowType } from './experimentPage.row-types';\nimport {\n  RowActionsCellRenderer,\n  RowActionsCellRendererSuppressKeyboardEvents,\n} from '../components/runs/cells/RowActionsCellRenderer';\nimport { RowActionsHeaderCellRenderer } from '../components/runs/cells/RowActionsHeaderCellRenderer';\nimport { RunNameCellRenderer } from '../components/runs/cells/RunNameCellRenderer';\nimport { LoadMoreRowRenderer } from '../components/runs/cells/LoadMoreRowRenderer';\nimport {\n  shouldEnableRunsTableRunNameColumnResize,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../common/utils/FeatureUtils';\nimport {\n  DatasetsCellRenderer,\n  DatasetsCellRendererSuppressKeyboardEvents,\n} from '../components/runs/cells/DatasetsCellRenderer';\nimport { RunDatasetWithTags } from '../../../types';\nimport { AggregateMetricValueCell } from '../components/runs/cells/AggregateMetricValueCell';\nimport { type RUNS_VISIBILITY_MODE } from '../models/ExperimentPageUIState';\nimport { useMediaQuery } from '@databricks/web-shared/hooks';\n\nconst cellClassIsOrderedBy = ({ colDef, context }: CellClassParams) =>\n  context.orderByKey === colDef.headerComponentParams?.canonicalSortKey;\n/**\n * Width for \"run name\" column.\n */\nconst RUN_NAME_COLUMN_WIDTH = 190;\n\n/**\n * Width for \"run actions\" column.\n */\nconst BASE_RUN_ACTIONS_COLUMN_WIDTH = 105;\nconst VISIBILITY_TOGGLE_WIDTH = 32;\n\n/**\n * Calculates width for \"actions\" column. \"compactMode\" should be set to true\n * for compare runs mode when checkboxes are hidden.\n */\nconst getActionsColumnWidth = (isComparingRuns?: boolean) => {\n  if (!shouldUseNewRunRowsVisibilityModel()) {\n    return BASE_RUN_ACTIONS_COLUMN_WIDTH;\n  }\n  return isComparingRuns ? BASE_RUN_ACTIONS_COLUMN_WIDTH : BASE_RUN_ACTIONS_COLUMN_WIDTH - VISIBILITY_TOGGLE_WIDTH;\n};\n\n/*\n * Functions used to generate grid field names for params, metrics and prefixes\n */\nexport const createParamFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_PARAM}-${key}`;\nconst createMetricFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_METRIC}-${key}`;\nconst createTagFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_TAG}-${key}`;\n\nconst UntrackedSpinner: React.FC<SpinnerProps> = ({ loading, ...props }) => {\n  return Spinner({ loading: false, ...props });\n};\n\n/**\n * A default listener that suppresses default agGrid keyboard events on the row actions cell renderer.\n * If the focus is on a cell, the tab key should be allowed to navigate to the next focusable element instead of a next cell.\n */\nconst defaultKeyboardNavigationSuppressor = ({ event }: SuppressKeyboardEventParams) =>\n  event.key === 'Tab' && event.target instanceof HTMLElement && event.target.classList.contains('ag-cell');\n\n/**\n * Functions returns all framework components to be used by agGrid\n */\nexport const getFrameworkComponents = () => ({\n  agColumnHeader: ColumnHeaderCell,\n\n  // A workaround for https://github.com/ag-grid/ag-grid/issues/7028.\n  // The page will add an interaction hold directly instead of relying on DuBois' Spinner\n  // to do it.\n  loadingOverlayComponent: UntrackedSpinner,\n\n  /**\n   * We're saving cell renderer component references, otherwise\n   * agGrid will unnecessarily flash cells' content (e.g. when changing sort order)\n   */\n  LoadMoreRowRenderer,\n  SourceCellRenderer,\n  ModelsCellRenderer,\n  VersionCellRenderer,\n  DateCellRenderer,\n  ExperimentNameCellRenderer,\n  RowActionsCellRenderer,\n  RowActionsHeaderCellRenderer,\n  RunNameCellRenderer,\n  DatasetsCellRenderer,\n  AggregateMetricValueCell,\n});\n\n/**\n * Certain columns are described as run attributes (opposed to metrics, params etc.), however\n * they actually source their data from the run tags. This objects maps tag names to column identifiers.\n */\nexport const TAGS_TO_COLUMNS_MAP = {\n  [ATTRIBUTE_COLUMN_SORT_KEY.USER]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'User'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Run Name'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.SOURCE]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Source'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.VERSION]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Version'),\n};\n\n/**\n * Function returns unique row ID to be used in runs table\n */\nexport const getRowId = ({ data }: { data: RunRowType }) => data.rowUuid;\n\n/**\n * Determines if a data row houses \"load more\" button\n */\nexport const getRowIsLoadMore = ({ rowNode }: IsFullWidthRowParams) => rowNode.data.isLoadMoreRow;\n\n/**\n * Parameters used by `useRunsColumnDefinitions()` hook\n */\nexport interface UseRunsColumnDefinitionsParams {\n  selectedColumns: string[];\n  onExpand: (parentUuid: string, childrenIds: string[]) => void;\n  onTogglePin: (runUuid: string) => void;\n  onToggleVisibility:\n    | ((runUuidOrToggle: string) => void)\n    | ((mode: RUNS_VISIBILITY_MODE, runOrGroupUuid: string) => void);\n  compareExperiments: boolean;\n  metricKeyList: string[];\n  paramKeyList: string[];\n  tagKeyList: string[];\n  columnApi?: ColumnApi;\n  isComparingRuns?: boolean;\n  onDatasetSelected?: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n  expandRows?: boolean;\n  allRunsHidden?: boolean;\n  runsHiddenMode?: RUNS_VISIBILITY_MODE;\n}\n\n/**\n * List of all attribute columns that can be shown/hidden by user\n * - when displaying a single experiment (ADJUSTABLE_ATTRIBUTE_COLUMNS_SINGLE_EXPERIMENT)\n * - when comparing experiments (ADJUSTABLE_ATTRIBUTE_COLUMNS)\n */\n\nexport const getAdjustableAttributeColumns = (isComparingExperiments = false) => {\n  const result = [\n    ATTRIBUTE_COLUMN_LABELS.USER,\n    ATTRIBUTE_COLUMN_LABELS.SOURCE,\n    ATTRIBUTE_COLUMN_LABELS.VERSION,\n    ATTRIBUTE_COLUMN_LABELS.MODELS,\n    ATTRIBUTE_COLUMN_LABELS.DATASET,\n  ];\n\n  if (isComparingExperiments) {\n    result.push(ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME);\n  }\n  return result;\n};\n\n/**\n * This internal hook passes through the list of all metric/param/tag keys.\n * The lists are memoized internally so if somehow a particular param/metric/tag key is not present\n * in the new runs set (e.g. due to reverse sorting), the relevant column will be still displayed.\n * This prevents weirdly disappearing columns on exotic run sets.\n */\nconst useCumulativeColumnKeys = ({\n  paramKeyList,\n  metricKeyList,\n  tagKeyList,\n}: Pick<UseRunsColumnDefinitionsParams, 'tagKeyList' | 'metricKeyList' | 'paramKeyList'>) => {\n  const cachedMetricKeys = useRef<Set<string>>(new Set());\n  const cachedParamKeys = useRef<Set<string>>(new Set());\n  const cachedTagKeys = useRef<Set<string>>(new Set());\n\n  const paramKeys = useMemo(() => {\n    paramKeyList.forEach((key) => cachedParamKeys.current.add(key));\n    return Array.from(cachedParamKeys.current);\n  }, [paramKeyList]);\n\n  const metricKeys = useMemo(() => {\n    metricKeyList.forEach((key) => cachedMetricKeys.current.add(key));\n    return Array.from(cachedMetricKeys.current);\n  }, [metricKeyList]);\n\n  const tagKeys = useMemo(() => {\n    tagKeyList.forEach((key) => cachedTagKeys.current.add(key));\n    return Array.from(cachedTagKeys.current);\n  }, [tagKeyList]);\n\n  const cumulativeColumns = useMemo(\n    () => ({\n      paramKeys,\n      metricKeys,\n      tagKeys,\n    }),\n    [metricKeys, paramKeys, tagKeys],\n  );\n\n  return cumulativeColumns;\n};\n\n/**\n * This hook creates a agGrid-compatible column set definition basing on currently\n * used sort-filter model and provided list of metrics, params and tags.\n *\n * Internally, it reacts to changes to `selectedColumns` and hides/shows relevant columns\n * if necessary.\n *\n * @param params see UseRunsColumnDefinitionsParams\n */\nexport const useRunsColumnDefinitions = ({\n  selectedColumns,\n  compareExperiments,\n  onTogglePin,\n  onToggleVisibility,\n  onExpand,\n  paramKeyList,\n  metricKeyList,\n  tagKeyList,\n  columnApi,\n  onDatasetSelected,\n  isComparingRuns,\n  expandRows,\n  allRunsHidden,\n  runsHiddenMode,\n}: UseRunsColumnDefinitionsParams) => {\n  const { theme } = useDesignSystemTheme();\n\n  const cumulativeColumns = useCumulativeColumnKeys({\n    metricKeyList,\n    tagKeyList,\n    paramKeyList,\n  });\n\n  // Generate columns differently on super small viewport sizes\n  const usingCompactViewport = useMediaQuery(`(max-width: ${theme.responsive.breakpoints.sm}px)`);\n\n  const columnSet = useMemo(() => {\n    const columns: (ColDef | ColGroupDef)[] = [];\n\n    // Checkbox selection column\n    columns.push({\n      valueGetter: ({ data: { pinned, hidden } }) => ({ pinned, hidden }),\n      checkboxSelection: true,\n      headerComponent: 'RowActionsHeaderCellRenderer',\n      headerComponentParams: { onToggleVisibility, allRunsHidden },\n      headerCheckboxSelection: true,\n      headerName: '',\n      cellClass: 'is-checkbox-cell',\n      cellRenderer: 'RowActionsCellRenderer',\n      cellRendererParams: { onTogglePin, onToggleVisibility },\n      pinned: usingCompactViewport ? undefined : 'left',\n      minWidth: getActionsColumnWidth(isComparingRuns),\n      width: getActionsColumnWidth(isComparingRuns),\n      maxWidth: getActionsColumnWidth(isComparingRuns),\n      resizable: false,\n      suppressKeyboardEvent: RowActionsCellRendererSuppressKeyboardEvents,\n    });\n\n    const isRunColumnDynamicSized = isComparingRuns && shouldEnableRunsTableRunNameColumnResize();\n\n    // Run name column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.RUN_NAME,\n      colId: isRunColumnDynamicSized ? undefined : TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME],\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME,\n      pinned: usingCompactViewport ? undefined : 'left',\n      sortable: true,\n      cellRenderer: 'RunNameCellRenderer',\n      cellRendererParams: { onExpand, isComparingRuns },\n      equals: (runA: RunRowType, runB: RunRowType) =>\n        runA?.rowUuid === runB?.rowUuid && runA?.groupParentInfo?.expanderOpen === runB?.groupParentInfo?.expanderOpen,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialWidth: isRunColumnDynamicSized ? undefined : RUN_NAME_COLUMN_WIDTH,\n      flex: isRunColumnDynamicSized ? 1 : undefined,\n      resizable: !isComparingRuns,\n      suppressKeyboardEvent: defaultKeyboardNavigationSuppressor,\n    });\n\n    // If we are only comparing runs, that's it - we cut off the list after the run name column.\n    // This behavior might be revisited and changed later.\n    if (isComparingRuns) {\n      return columns;\n    }\n\n    // Date and expander selection column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DATE,\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.DATE,\n      pinned: usingCompactViewport ? undefined : 'left',\n      sortable: true,\n      field: 'runDateAndNestInfo',\n      cellRenderer: 'DateCellRenderer',\n      cellRendererParams: { onExpand },\n      equals: (dateInfo1, dateInfo2) => isEqual(dateInfo1, dateInfo2),\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.DATE,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialWidth: 150,\n    });\n\n    // Datasets column - guarded by a feature flag\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DATASET,\n      colId: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.DATASET),\n      headerTooltip: ATTRIBUTE_COLUMN_LABELS.DATASET,\n      sortable: false,\n      field: 'datasets',\n      cellRenderer: 'DatasetsCellRenderer',\n      cellRendererParams: { onDatasetSelected, expandRows },\n      cellClass: 'is-multiline-cell',\n      initialWidth: 300,\n      suppressKeyboardEvent: DatasetsCellRendererSuppressKeyboardEvents,\n    });\n\n    // Duration column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DURATION,\n      field: 'duration',\n      initialWidth: 80,\n    });\n\n    // Experiment name column\n    if (compareExperiments) {\n      columns.push({\n        headerName: ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME,\n        colId: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME),\n        field: 'experimentName',\n        cellRenderer: 'ExperimentNameCellRenderer',\n        equals: (experimentName1, experimentName2) => isEqual(experimentName1, experimentName2),\n        initialWidth: 140,\n        initialHide: true,\n        suppressKeyboardEvent: defaultKeyboardNavigationSuppressor,\n      });\n    }\n\n    // User column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.USER,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.USER],\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.USER,\n      field: 'user',\n      sortable: true,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.USER,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialHide: true,\n    });\n\n    // Source column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.SOURCE,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.SOURCE],\n      field: 'tags',\n      cellRenderer: 'SourceCellRenderer',\n      equals: (tags1 = {}, tags2 = {}) => Utils.getSourceName(tags1) === Utils.getSourceName(tags2),\n      sortable: true,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.SOURCE,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialHide: true,\n      suppressKeyboardEvent: defaultKeyboardNavigationSuppressor,\n    });\n\n    // Version column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.VERSION,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.VERSION],\n      field: 'version',\n      cellRenderer: 'VersionCellRenderer',\n      equals: (version1 = {}, version2 = {}) => isEqual(version1, version2),\n      sortable: true,\n      headerComponentParams: {\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.VERSION,\n      },\n      cellClassRules: {\n        'is-ordered-by': cellClassIsOrderedBy,\n      },\n      initialHide: true,\n    });\n\n    // Models column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.MODELS,\n      colId: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.MODELS),\n      field: 'models',\n      cellRenderer: 'ModelsCellRenderer',\n      initialWidth: 200,\n      equals: (models1 = {}, models2 = {}) => isEqual(models1, models2),\n      initialHide: true,\n      suppressKeyboardEvent: defaultKeyboardNavigationSuppressor,\n    });\n\n    const { metricKeys, paramKeys, tagKeys } = cumulativeColumns;\n\n    // Metrics columns\n    if (metricKeys.length) {\n      columns.push({\n        headerName: 'Metrics',\n        groupId: COLUMN_TYPES.METRICS,\n        children: metricKeys.map((metricKey) => {\n          const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.METRICS, metricKey);\n          return {\n            headerName: metricKey,\n            colId: canonicalSortKey,\n            headerTooltip: getQualifiedEntityName(COLUMN_TYPES.METRICS, metricKey),\n            field: createMetricFieldName(metricKey),\n            tooltipField: createMetricFieldName(metricKey),\n            initialWidth: 100,\n            initialHide: true,\n            sortable: true,\n            headerComponentParams: {\n              canonicalSortKey,\n            },\n            cellRendererSelector: ({ data: { groupParentInfo } }) =>\n              groupParentInfo ? { component: 'AggregateMetricValueCell' } : undefined,\n            cellClassRules: {\n              'is-previewable-cell': () => true,\n              'is-ordered-by': cellClassIsOrderedBy,\n            },\n          };\n        }),\n      });\n    }\n\n    // Parameter columns\n    if (paramKeys.length) {\n      columns.push({\n        headerName: 'Parameters',\n        groupId: COLUMN_TYPES.PARAMS,\n        children: paramKeys.map((paramKey) => {\n          const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.PARAMS, paramKey);\n          return {\n            colId: canonicalSortKey,\n            headerName: paramKey,\n            headerTooltip: getQualifiedEntityName(COLUMN_TYPES.PARAMS, paramKey),\n            field: createParamFieldName(paramKey),\n            tooltipField: createParamFieldName(paramKey),\n            initialHide: true,\n            initialWidth: 100,\n            sortable: true,\n            headerComponentParams: {\n              canonicalSortKey,\n            },\n            cellClassRules: {\n              'is-previewable-cell': () => true,\n              'is-ordered-by': cellClassIsOrderedBy,\n            },\n          };\n        }),\n      });\n    }\n\n    // Tags columns\n    if (tagKeys.length) {\n      columns.push({\n        headerName: 'Tags',\n        colId: COLUMN_TYPES.TAGS,\n        children: tagKeys.map((tagKey) => {\n          const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.TAGS, tagKey);\n          return {\n            colId: canonicalSortKey,\n            headerName: tagKey,\n            initialHide: true,\n            initialWidth: 100,\n            headerTooltip: getQualifiedEntityName(COLUMN_TYPES.TAGS, tagKey),\n            field: createTagFieldName(tagKey),\n            tooltipField: createTagFieldName(tagKey),\n          };\n        }),\n      });\n    }\n\n    return columns;\n  }, [\n    onTogglePin,\n    onToggleVisibility,\n    onExpand,\n    compareExperiments,\n    cumulativeColumns,\n    isComparingRuns,\n    onDatasetSelected,\n    expandRows,\n    allRunsHidden,\n    usingCompactViewport,\n  ]);\n\n  const canonicalSortKeys = useMemo(\n    () => [\n      ...getAdjustableAttributeColumns(true).map((key) => makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, key)),\n      ...cumulativeColumns.paramKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.PARAMS, key)),\n      ...cumulativeColumns.metricKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.METRICS, key)),\n      ...cumulativeColumns.tagKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.TAGS, key)),\n    ],\n    [cumulativeColumns],\n  );\n\n  useEffect(() => {\n    if (!columnApi || isComparingRuns) {\n      return;\n    }\n    for (const canonicalKey of canonicalSortKeys) {\n      const visible = selectedColumns.includes(canonicalKey);\n      columnApi.setColumnVisible(canonicalKey, visible);\n    }\n  }, [selectedColumns, columnApi, canonicalSortKeys, isComparingRuns]);\n\n  return columnSet;\n};\n\nexport const EXPERIMENTS_DEFAULT_COLUMN_SETUP = {\n  initialWidth: 100,\n  autoSizePadding: 0,\n  headerComponentParams: { menuIcon: 'fa-bars' },\n  resizable: true,\n  filter: true,\n  suppressMenu: true,\n  suppressMovable: true,\n};\n","import { BeakerIcon, Button, Empty, FilterIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\nimport { LoggingRunsDocUrl } from '../../../../../common/constants';\n\n/**\n * This component displays information about no results being displayed in runs tample,\n * either due to no runs recorded in an experiment at all or due to currently used filters.\n */\nexport const ExperimentViewRunsEmptyTable = ({\n  isFiltered,\n  onClearFilters,\n}: {\n  onClearFilters: () => void;\n  isFiltered: boolean;\n}) => {\n  const getLearnMoreLinkUrl = () => LoggingRunsDocUrl;\n\n  return (\n    <div css={styles.noResultsWrapper}>\n      <div css={styles.noResults}>\n        {isFiltered ? (\n          <Empty\n            button={\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsemptytable.tsx_35\"\n                type=\"primary\"\n                onClick={onClearFilters}\n              >\n                <FormattedMessage\n                  defaultMessage=\"Clear filters\"\n                  description=\"Label for a button that clears all filters, visible on a experiment runs page next to a empty state when all runs have been filtered out\"\n                />\n              </Button>\n            }\n            description={\n              <FormattedMessage\n                defaultMessage=\"All runs in this experiment have been filtered. Change or clear filters to view runs.\"\n                description=\"Empty state description text for experiment runs page when all runs have been filtered out\"\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"All runs are filtered\"\n                description=\"Empty state title text for experiment runs page when all runs have been filtered out\"\n              />\n            }\n            image={<FilterIcon />}\n          />\n        ) : (\n          <Empty\n            description={\n              <FormattedMessage\n                defaultMessage=\"No runs have been logged yet. <link>Learn more</link> about how to create ML model training runs in this experiment.\"\n                description=\"Empty state description text for experiment runs page when no runs are logged in the experiment\"\n                values={{\n                  link: (chunks: any) => (\n                    <a target=\"_blank\" href={getLearnMoreLinkUrl()} rel=\"noreferrer\">\n                      {chunks}\n                    </a>\n                  ),\n                }}\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"No runs logged\"\n                description=\"Empty state title text for experiment runs page when no runs are logged in the experiment\"\n              />\n            }\n            image={<BeakerIcon />}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst styles = {\n  noResults: {\n    maxWidth: 360,\n  },\n  noResultsWrapper: (theme: Theme) => ({\n    marginTop: theme.spacing.lg,\n    inset: 0,\n    backgroundColor: theme.colors.backgroundPrimary,\n    position: 'absolute' as const,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  }),\n};\n","import { Button, ChevronLeftIcon, ChevronRightIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { UpdateExperimentViewStateFn } from '../../../../types';\nimport { ExperimentPageViewState } from '../../models/ExperimentPageViewState';\n\n/**\n * Component used to expand/collapse runs list (table) when in compare runs mode.\n */\nexport const ExperimentViewRunsTableCollapse = ({\n  updateRunListHidden,\n  runListHidden,\n}: {\n  updateRunListHidden: (newValue: boolean) => void;\n  runListHidden: boolean;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      css={{\n        position: 'absolute',\n        top: 0,\n        bottom: 0,\n        width: 2 * theme.spacing.md,\n        right: -theme.spacing.md,\n        zIndex: 10,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        backgroundColor: 'transparent',\n        '&:hover': {\n          opacity: 1,\n          '.bar': { opacity: 1 },\n          '.button': {\n            border: `2px solid ${theme.colors.primary}`,\n          },\n        },\n        opacity: runListHidden ? 1 : 0,\n        transition: 'opacity 0.2s',\n      }}\n    >\n      <div\n        className=\"bar\"\n        css={{\n          transition: 'opacity 0.2s',\n          opacity: 0,\n          position: 'absolute',\n          left: theme.spacing.md - 2,\n          top: 0,\n          backgroundColor: theme.colors.primary,\n          bottom: 0,\n          width: 3,\n          pointerEvents: 'none',\n        }}\n      />\n      <div\n        className=\"button\"\n        css={{\n          transition: 'border-color 0.2s',\n          position: 'relative',\n          width: theme.general.iconSize,\n          height: theme.general.iconSize,\n          backgroundColor: theme.colors.backgroundPrimary,\n          borderRadius: theme.general.iconSize,\n          overflow: 'hidden',\n          border: `1px solid ${theme.colors.border}`,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunstablecollapse.tsx_70\"\n          onClick={() => updateRunListHidden(!runListHidden)}\n          icon={runListHidden ? <ChevronRightIcon /> : <ChevronLeftIcon />}\n          size=\"small\"\n        />\n      </div>\n    </div>\n  );\n};\n","import { Button, PlusCircleIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { useCallback, useEffect, useRef } from 'react';\nimport { FormattedMessage } from 'react-intl';\n\n/**\n * Width of the CTA column\n */\nconst COLUMN_CTA_WIDTH = 180;\n\n/**\n * CSS classes used internally\n */\nconst CLASS_OUT_OF_VIEWPORT = 'is-out-of-viewport';\nconst CLASS_IS_HIDDEN = 'is-hidden';\nconst CLASS_IS_MINIMIZED = 'is-minimized';\n\n/**\n * List all necessary agGrid sub-element classes\n */\nconst AG_GRID_CLS = {\n  ROOT: '.ag-root',\n  LEFT_COLS_CONTAINER: '.ag-pinned-left-cols-container',\n  FULL_WIDTH_ROW: '.ag-full-width-row',\n  COLS_CONTAINER: '.ag-center-cols-container',\n  HEADER: '.ag-header',\n  BODY_VIEWPORT: '.ag-body-viewport',\n};\n\ninterface ExperimentViewRunsTableAddColumnCTAProps {\n  onClick: () => void;\n  gridContainerElement: HTMLElement | null;\n  isInitialized: boolean;\n  visible?: boolean;\n  moreRunsAvailable?: boolean;\n  moreAvailableRunsTableColumnCount?: number;\n}\n\n/**\n * Component displaying dynamic table column with \"add metrics and parameters\" CTA.\n *\n * Sample usage:\n *\n * const [gridInitialized, setGridInitialized] = useState(false);\n *\n * return (\n *   <div ref={containerElement}>\n *     <AgGrid onGridReady={() => setGridInitialized(true)} {...} />\n *     <ExperimentViewRunsTableAddColumnCTA\n *       gridContainerElement={containerElement.current}\n *       isInitialized={gridInitialized}\n *       onAddColumnClicked={onAddColumnClicked}\n *       visible={!isLoading}\n *       moreAvailableRunsTableColumnCount={3}\n *     />\n *   </div>\n * );\n */\nexport const ExperimentViewRunsTableAddColumnCTA = ({\n  onClick,\n  gridContainerElement,\n  isInitialized,\n  visible,\n  moreRunsAvailable,\n  moreAvailableRunsTableColumnCount = 0,\n}: ExperimentViewRunsTableAddColumnCTAProps) => {\n  const ctaRef = useRef<HTMLDivElement>(null);\n\n  const savedContainerRef = useRef<HTMLElement>();\n  const immediateMoreRunsAvailable = useRef<boolean>(Boolean(moreRunsAvailable));\n\n  // Save immediate value of \"moreRunsAvailable\" so the fresh version\n  // will be accessible within the resize observer\n  useEffect(() => {\n    immediateMoreRunsAvailable.current = Boolean(moreRunsAvailable);\n  }, [moreRunsAvailable]);\n\n  const initialize = useCallback((containerElement: HTMLElement) => {\n    if (!ctaRef.current || !window.ResizeObserver || !containerElement) {\n      return undefined;\n    }\n\n    const targetElement = ctaRef.current;\n\n    /**\n     * On initialization, first gather all the agGrid sub-elements\n     */\n    const rootElement = containerElement.querySelector(AG_GRID_CLS.ROOT);\n    const refLeftElem = containerElement.querySelector(AG_GRID_CLS.LEFT_COLS_CONTAINER);\n    const refCenterElem = containerElement.querySelector(AG_GRID_CLS.COLS_CONTAINER);\n    const refHeaderElem = containerElement.querySelector(AG_GRID_CLS.HEADER);\n    const refBodyViewport = containerElement.querySelector(AG_GRID_CLS.BODY_VIEWPORT);\n\n    /**\n     * Initialize variables used for position calculation\n     */\n    let gridAreaWidth = 0;\n    let leftColContainerWidth = 0;\n    let leftColContainerHeight = 0;\n    let centerColContainerWidth = 0;\n    let colContainerHeight = 0;\n    let headerHeight = 0;\n\n    /**\n     * Execute only if all elements are in place\n     */\n    if (refLeftElem && refCenterElem && refHeaderElem && rootElement && refBodyViewport) {\n      /**\n       * Hook up an resize observer\n       */\n      const resizeObserver = new ResizeObserver((entries) => {\n        /**\n         * For every changed element, gather the exact dimensions\n         */\n        for (const entry of entries) {\n          if (entry.target === rootElement) {\n            gridAreaWidth = entry.contentRect.width;\n          }\n          if (entry.target === refLeftElem) {\n            leftColContainerWidth = entry.contentRect.width;\n            leftColContainerHeight = entry.contentRect.height;\n          }\n          if (entry.target === refBodyViewport) {\n            colContainerHeight = entry.contentRect.height;\n          }\n          if (entry.target === refHeaderElem) {\n            headerHeight = entry.contentRect.height;\n          }\n          if (entry.target === refCenterElem) {\n            centerColContainerWidth = entry.contentRect.width;\n          }\n        }\n\n        /**\n         * Our \"left\" position will be offset by column container widths\n         */\n        const calculatedLeft = leftColContainerWidth + centerColContainerWidth;\n\n        /**\n         * Our \"top\"  position will be offset by the header height\n         */\n        const calculatedTop = headerHeight;\n\n        /**\n         * If the column is out of viewport (expanding out of the root element),\n         * add proper CSS class to hide it\n         */\n        const isOutOfViewport = calculatedLeft + COLUMN_CTA_WIDTH >= gridAreaWidth;\n        isOutOfViewport\n          ? savedContainerRef.current?.classList.add(CLASS_OUT_OF_VIEWPORT)\n          : savedContainerRef.current?.classList.remove(CLASS_OUT_OF_VIEWPORT);\n\n        // Check if \"load more\" button is visible\n        const loadMoreRowHeight = immediateMoreRunsAvailable.current ? 32 : 0;\n\n        // If the visible row set takes only portion of the table height-wise (leftColContainerHeight < colContainerHeight),\n        // let's contract our CTA a little so \"load more\" button will fit in. If it takes whole area, do not reduce its height.\n        const calculatedHeight =\n          leftColContainerHeight < colContainerHeight ? leftColContainerHeight - loadMoreRowHeight : colContainerHeight;\n\n        /**\n         * If the available height is too low, add a class that indicates\n         * that we should display minimized version\n         */\n        const shouldBeMinimized = calculatedHeight < 100;\n        shouldBeMinimized\n          ? savedContainerRef.current?.classList.add(CLASS_IS_MINIMIZED)\n          : savedContainerRef.current?.classList.remove(CLASS_IS_MINIMIZED);\n\n        /**\n         * Finally, set proper values as CSS transform property. Use 3d transform\n         * to ensure hardware acceleration.\n         */\n        targetElement.style.transform = `translate3d(${calculatedLeft}px, ${calculatedTop}px, 0)`;\n\n        /**\n         * Set target height and add 1px to accomodate the border.\n         */\n        targetElement.style.height = `${calculatedHeight + 1}px`;\n      });\n\n      /**\n       * Setup observer with all the necessary elements.\n       */\n      resizeObserver.observe(refLeftElem);\n      resizeObserver.observe(refCenterElem);\n      resizeObserver.observe(refHeaderElem);\n      resizeObserver.observe(rootElement);\n      resizeObserver.observe(refBodyViewport);\n\n      /**\n       * After cleanup, disconnect the observer.\n       */\n      return () => resizeObserver.disconnect();\n    }\n    return undefined;\n  }, []);\n\n  useEffect(() => {\n    if (isInitialized && gridContainerElement) {\n      savedContainerRef.current = gridContainerElement;\n      initialize(gridContainerElement);\n    }\n  }, [initialize, isInitialized, gridContainerElement]);\n\n  /**\n   * This component works only if ResizeObserver is supported by the browser.\n   * If it's not supported, return nothing.\n   */\n  if (!window.ResizeObserver) {\n    return null;\n  }\n\n  return (\n    <div ref={ctaRef} css={styles.columnContainer} className={visible ? '' : CLASS_IS_HIDDEN}>\n      {visible && (\n        <div css={styles.buttonContainer}>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunstableaddcolumncta.tsx_218\"\n            css={styles.button}\n            type=\"link\"\n            onClick={onClick}\n          >\n            <PlusCircleIcon css={styles.buttonIcon} />\n            <div css={styles.caption}>\n              <FormattedMessage\n                defaultMessage=\"Show more columns {count, select, 0 {} other {({count} total)}}\"\n                description=\"Label for a CTA button in experiment runs table which invokes column management dropdown\"\n                values={{\n                  count: moreAvailableRunsTableColumnCount,\n                }}\n              />\n            </div>\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst styles = {\n  columnContainer: (theme: Theme) => ({\n    width: COLUMN_CTA_WIDTH,\n    height: 0,\n    position: 'absolute' as const,\n    border: `1px solid ${theme.colors.borderDecorative}`,\n    borderTop: 0,\n    top: 0,\n    left: 0,\n    willChange: 'transform' as const,\n    transform: 'translate3d(0, 0, 0)',\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      display: 'flex',\n      alignItems: 'center' as const,\n    },\n    [`&.${CLASS_IS_HIDDEN}, .${CLASS_OUT_OF_VIEWPORT} &`]: {\n      display: 'none',\n    },\n    pointerEvents: 'none' as const,\n    display: 'flex',\n    alignItems: 'center',\n  }),\n  buttonContainer: (theme: Theme) => ({\n    top: 0,\n    paddingLeft: theme.spacing.lg,\n    paddingRight: theme.spacing.lg,\n    width: '100%',\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      paddingTop: theme.spacing.xs,\n    },\n    pointerEvents: 'all' as const,\n  }),\n  button: { whiteSpace: 'pre-wrap' as const, width: '100%' },\n  buttonIcon: (theme: Theme) => ({ color: theme.colors.textSecondary }),\n  caption: (theme: Theme) => ({\n    color: theme.colors.textSecondary,\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      display: 'none',\n    },\n  }),\n};\n","import { Spinner, Typography } from '@databricks/design-system';\nimport type { Theme } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\n\ninterface ExperimentViewRunsTableStatusBarProps {\n  isLoading: boolean;\n  allRunsCount: number;\n}\n\n// Strongifies the i18n string, used in <FormattedMessage> below\nconst strong = (text: string) => <strong>{text}</strong>;\n\nexport const ExperimentViewRunsTableStatusBar = ({\n  isLoading,\n  allRunsCount,\n}: ExperimentViewRunsTableStatusBarProps) => (\n  <div css={styles.statusBar}>\n    <Typography.Text size=\"sm\" color={isLoading ? 'secondary' : undefined}>\n      <FormattedMessage\n        // eslint-disable-next-line max-len\n        defaultMessage=\"<strong>{length}</strong> matching {length, plural, =0 {runs} =1 {run} other {runs}}\"\n        // eslint-disable-next-line max-len\n        description=\"Message for displaying how many runs match search criteria on experiment page\"\n        values={{\n          strong,\n          length: allRunsCount,\n        }}\n      />\n    </Typography.Text>\n    {isLoading && <Spinner size=\"small\" />}\n  </div>\n);\n\nconst styles = {\n  statusBar: (theme: Theme) => ({\n    height: 28,\n    display: 'flex',\n    gap: 8,\n    marginTop: -1,\n    position: 'relative' as const,\n    alignItems: 'center',\n    borderTop: `1px solid ${theme.colors.border}`,\n  }),\n};\n","import React from 'react';\nimport { Button, CloseIcon, CopyIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { CopyButton } from '../../shared/building_blocks/CopyButton';\n\nconst PREVIEW_SIDEBAR_WIDTH = 300;\n\n/**\n * Displays a sidebar helpful in expanding textual data in table components.\n * Will be replaced by DuBois standardized component in the future.\n */\nexport const PreviewSidebar = ({\n  content,\n  copyText,\n  headerText,\n  empty,\n  onClose,\n}: {\n  content?: React.ReactNode;\n  copyText?: string;\n  headerText?: string;\n  empty?: React.ReactNode;\n  onClose?: () => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      css={{\n        width: PREVIEW_SIDEBAR_WIDTH,\n        padding: theme.spacing.sm,\n        paddingRight: 0,\n        borderLeft: `1px solid ${theme.colors.borderDecorative}`,\n        overflow: 'hidden',\n        display: 'flex',\n        flexDirection: 'column',\n        height: '100%',\n      }}\n      data-testid=\"preview-sidebar-content\"\n    >\n      {content ? (\n        <>\n          <div\n            css={{\n              display: 'grid',\n              gridTemplateColumns: '1fr auto auto',\n              rowGap: theme.spacing.sm,\n              alignItems: 'flex-start',\n              flex: '0 0 auto',\n            }}\n          >\n            {headerText && (\n              <Typography.Title\n                level={4}\n                css={{\n                  overflowX: 'hidden',\n                  overflowY: 'auto',\n                  marginTop: theme.spacing.sm,\n                  marginRight: theme.spacing.xs,\n\n                  // Escape hatch if for some reason title is so long it would consume entire sidebar\n                  maxHeight: 200,\n                }}\n              >\n                {headerText}\n              </Typography.Title>\n            )}\n            {copyText && <CopyButton copyText={copyText} showLabel={false} icon={<CopyIcon />} />}\n            {onClose && (\n              <Button\n                componentId=\"codegen_mlflow_app_src_common_components_previewsidebar.tsx_67\"\n                type=\"primary\"\n                icon={<CloseIcon />}\n                onClick={onClose}\n              />\n            )}\n          </div>\n          <div\n            css={{\n              // Preserve original line breaks\n              whiteSpace: 'pre-wrap',\n              overflowY: 'auto',\n              flex: 1,\n            }}\n          >\n            {content}\n          </div>\n        </>\n      ) : (\n        <div css={{ marginTop: theme.spacing.md }}>{empty}</div>\n      )}\n    </div>\n  );\n};\n","import { GridApi, RowSelectedEvent, SelectionChangedEvent } from '@ag-grid-community/core';\nimport { useCallback, useRef } from 'react';\nimport { ExperimentPageViewState } from '../models/ExperimentPageViewState';\nimport { RunRowType } from '../utils/experimentPage.row-types';\nimport { uniqBy } from 'lodash';\n\n/**\n * Helper function that select particular run rows in the ag-grid.\n */\nconst agGridSelectRunRows = (runUuids: string[], isSelected: boolean, gridApi: GridApi) => {\n  gridApi.forEachNode((node) => {\n    if (node.data?.isLoadMoreRow) {\n      return;\n    }\n    const { runInfo, runDateAndNestInfo: childRunDateInfo } = node.data as RunRowType;\n\n    if (!runInfo) {\n      return;\n    }\n\n    const childrenRunUuid = runInfo.runUuid;\n    if (runUuids.includes(childrenRunUuid)) {\n      // If we found children being parents, mark their children\n      // to be selected as well.\n      if (childRunDateInfo?.childrenIds) {\n        runUuids.push(...childRunDateInfo.childrenIds);\n      }\n\n      node.setSelected(isSelected, false, true);\n    }\n  });\n};\n\n/**\n * Helper function that select particular group rows in the ag-grid.\n */\nconst agGridSelectGroupRows = (rowData: RunRowType[], gridApi: GridApi) => {\n  gridApi.forEachNode((node) => {\n    const data: RunRowType = node.data;\n    if (!data.groupParentInfo) {\n      return;\n    }\n\n    // If all runs belonging to the group are selected, select the group\n    if (data.groupParentInfo.runUuids.every((runUuid) => rowData.some((row) => row.runUuid === runUuid))) {\n      node.setSelected(true, false, true);\n    }\n\n    // If none of the runs belonging to the group are selected, deselect the group\n    if (!data.groupParentInfo.runUuids.some((runUuid) => rowData.some((row) => row.runUuid === runUuid))) {\n      node.setSelected(false, false, true);\n    }\n  });\n};\n\n/**\n * Returns handlers for row selection in the experiment runs table.\n * Supports groups, nested runs and regular flat hierarchy.\n */\nexport const useExperimentTableSelectRowHandler = (\n  updateViewState: (newPartialViewState: Partial<ExperimentPageViewState>) => void,\n) => {\n  const onSelectionChange = useCallback(\n    ({ api }: SelectionChangedEvent) => {\n      const selectedUUIDs: string[] = api\n        .getSelectedRows()\n        // Filter out \"load more\" and group rows\n        .filter((row) => row.runInfo)\n        .map(({ runInfo }) => runInfo.runUuid);\n      updateViewState({\n        runsSelected: selectedUUIDs.reduce((aggregate, curr) => ({ ...aggregate, [curr]: true }), {}),\n      });\n    },\n    [updateViewState],\n  );\n\n  const handleRowSelected = useCallback((event: RowSelectedEvent) => {\n    // Let's check if the actual number of selected rows have changed\n    // to avoid empty runs\n    const isSelected = Boolean(event.node.isSelected());\n\n    // We will continue only if the selected row has properly set runDateInfo\n    const { runDateAndNestInfo, runInfo, groupParentInfo } = event.data as RunRowType;\n\n    if (groupParentInfo) {\n      agGridSelectRunRows(groupParentInfo.runUuids, isSelected, event.api);\n    }\n\n    if (!runDateAndNestInfo) {\n      return;\n    }\n    const { isParent, expanderOpen, childrenIds } = runDateAndNestInfo;\n\n    // We will continue only if the selected row is a parent containing\n    // children and is actually expanded\n    if (isParent && expanderOpen && childrenIds) {\n      const childrenIdsToSelect = childrenIds;\n      agGridSelectRunRows(childrenIdsToSelect, isSelected, event.api);\n    } else if (runInfo) {\n      // If we are selecting a run row, we need to select other runs with the same UUID\n      agGridSelectRunRows([runInfo.runUuid], isSelected, event.api);\n\n      // Next, we need to (de)select the group row if all runs belonging to the group are (de)selected\n      const selectedRunRows = uniqBy(\n        event.api.getSelectedRows().filter((row) => Boolean(row.runUuid)),\n        'runUuid',\n      );\n      agGridSelectGroupRows(selectedRunRows, event.api);\n    }\n  }, []);\n\n  return { handleRowSelected, onSelectionChange };\n};\n","import { useCallback, useRef } from 'react';\nimport { useUpdateExperimentViewUIState } from '../contexts/ExperimentPageUIStateContext';\nimport { RUNS_VISIBILITY_MODE } from '../models/ExperimentPageUIState';\nimport type { RunRowType } from '../utils/experimentPage.row-types';\n\nexport const useToggleRowVisibilityCallback = (tableRows: RunRowType[]) => {\n  const updateUIState = useUpdateExperimentViewUIState();\n\n  // We're going to use current state of the table rows to determine which rows are hidden.\n  // Since we're interested only in the latest data, we avoid using state here to avoid unnecessary re-renders.\n  const immediateTableRows = useRef(tableRows);\n  immediateTableRows.current = tableRows;\n\n  const toggleRowVisibility = useCallback(\n    (mode: RUNS_VISIBILITY_MODE, groupOrRunUuid?: string) => {\n      updateUIState((currentUIState) => {\n        if (mode === RUNS_VISIBILITY_MODE.SHOWALL) {\n          // Case #1: Showing all runs\n          return {\n            ...currentUIState,\n            runsHiddenMode: RUNS_VISIBILITY_MODE.SHOWALL,\n            runsHidden: [],\n          };\n        } else if (mode === RUNS_VISIBILITY_MODE.HIDEALL) {\n          // Case #2: Hiding all runs\n          return {\n            ...currentUIState,\n            runsHiddenMode: RUNS_VISIBILITY_MODE.HIDEALL,\n            runsHidden: [],\n          };\n        } else if (mode === RUNS_VISIBILITY_MODE.FIRST_10_RUNS) {\n          // Case #3: Showing only first 10 runs\n          return {\n            ...currentUIState,\n            runsHiddenMode: RUNS_VISIBILITY_MODE.FIRST_10_RUNS,\n            runsHidden: [],\n          };\n        } else if (mode === RUNS_VISIBILITY_MODE.FIRST_20_RUNS) {\n          // Case #4: Showing only first 20 runs\n          return {\n            ...currentUIState,\n            runsHiddenMode: RUNS_VISIBILITY_MODE.FIRST_20_RUNS,\n            runsHidden: [],\n          };\n        }\n\n        // Case #5: Custom visibility mode enabled by manually toggling visibility of a run or a group\n        if (groupOrRunUuid) {\n          // Determine which runs are hidden at the moment\n          const currentlyHiddenRows = immediateTableRows.current\n            .filter(({ hidden }) => hidden)\n            .map(({ groupParentInfo, rowUuid, runUuid }) => (groupParentInfo ? rowUuid : runUuid));\n\n          // Toggle visibility of a run/group by either adding or removing from the array\n          const newHiddenRows = currentlyHiddenRows.includes(groupOrRunUuid)\n            ? currentlyHiddenRows.filter((currentGroupOrRunUuid) => currentGroupOrRunUuid !== groupOrRunUuid)\n            : [...currentlyHiddenRows, groupOrRunUuid];\n\n          return {\n            ...currentUIState,\n            // Set mode to \"custom\"\n            runsHiddenMode: RUNS_VISIBILITY_MODE.CUSTOM,\n            runsHidden: newHiddenRows,\n          };\n        }\n\n        return currentUIState;\n      });\n    },\n    [updateUIState],\n  );\n\n  return toggleRowVisibility;\n};\n","import type {\n  CellClickedEvent,\n  ColumnApi,\n  GridApi,\n  GridReadyEvent,\n  RowSelectedEvent,\n  SelectionChangedEvent,\n} from '@ag-grid-community/core';\nimport { Interpolation, Theme } from '@emotion/react';\nimport cx from 'classnames';\nimport React, { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { MLFlowAgGridLoader } from '../../../../../common/components/ag-grid/AgGridLoader';\nimport Utils from '../../../../../common/utils/Utils';\nimport {\n  ExperimentEntity,\n  UpdateExperimentViewStateFn,\n  RunDatasetWithTags,\n  ExperimentViewRunsCompareMode,\n} from '../../../../types';\n\nimport { isSearchFacetsFilterUsed } from '../../utils/experimentPage.fetch-utils';\nimport { ExperimentPageViewState } from '../../models/ExperimentPageViewState';\nimport {\n  EXPERIMENTS_DEFAULT_COLUMN_SETUP,\n  getFrameworkComponents,\n  getRowIsLoadMore,\n  getRowId,\n  useRunsColumnDefinitions,\n  getAdjustableAttributeColumns,\n} from '../../utils/experimentPage.column-utils';\nimport { makeCanonicalSortKey } from '../../utils/experimentPage.common-utils';\nimport { EXPERIMENT_RUNS_TABLE_ROW_HEIGHT } from '../../utils/experimentPage.common-utils';\nimport { RUNS_VISIBILITY_MODE } from '../../models/ExperimentPageUIState';\nimport { RunRowType } from '../../utils/experimentPage.row-types';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { createLoadMoreRow } from './cells/LoadMoreRowRenderer';\nimport { ExperimentViewRunsEmptyTable } from './ExperimentViewRunsEmptyTable';\nimport { ExperimentViewRunsTableCollapse } from './ExperimentViewRunsTableCollapse';\nimport { ExperimentViewRunsTableAddColumnCTA } from './ExperimentViewRunsTableAddColumnCTA';\nimport { ExperimentViewRunsTableStatusBar } from './ExperimentViewRunsTableStatusBar';\nimport {\n  shouldEnableRunsTableRunNameColumnResize,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { getDatasetsCellHeight } from './cells/DatasetsCellRenderer';\nimport { PreviewSidebar } from '../../../../../common/components/PreviewSidebar';\nimport { ATTRIBUTE_COLUMN_LABELS, COLUMN_TYPES } from '../../../../constants';\nimport { Empty, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { useExperimentPageViewMode } from '../../hooks/useExperimentPageViewMode';\nimport { ExperimentPageUIState } from '../../models/ExperimentPageUIState';\nimport { useUpdateExperimentViewUIState } from '../../contexts/ExperimentPageUIStateContext';\nimport { useUpdateExperimentPageSearchFacets } from '../../hooks/useExperimentPageSearchFacets';\nimport {\n  createExperimentPageSearchFacetsState,\n  ExperimentPageSearchFacetsState,\n} from '../../models/ExperimentPageSearchFacetsState';\nimport { useExperimentTableSelectRowHandler } from '../../hooks/useExperimentTableSelectRowHandler';\nimport { useToggleRowVisibilityCallback } from '../../hooks/useToggleRowVisibilityCallback';\nimport { ExperimentViewRunsTableHeaderContextProvider } from './ExperimentViewRunsTableHeaderContext';\n\nconst ROW_HEIGHT = 32;\nconst ROW_BUFFER = 101; // How many rows to keep rendered, even ones not visible\n\nexport interface ExperimentViewRunsTableProps {\n  /**\n   * Actual set of prepared row data to be rendered\n   */\n  rowsData: RunRowType[];\n\n  /**\n   * Helper data set with metric, param and tag keys\n   */\n  runsData: ExperimentRunsSelectorResult;\n\n  experiments: ExperimentEntity[];\n  searchFacetsState: ExperimentPageSearchFacetsState;\n  viewState: ExperimentPageViewState;\n  updateViewState: UpdateExperimentViewStateFn;\n  isLoading: boolean;\n  moreRunsAvailable: boolean;\n  onAddColumnClicked: () => void;\n  loadMoreRunsFunc: () => void;\n  onDatasetSelected?: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n  expandRows: boolean;\n  uiState: ExperimentPageUIState;\n  compareRunsMode: ExperimentViewRunsCompareMode;\n}\n\nexport const ExperimentViewRunsTable = React.memo(\n  // eslint-disable-next-line complexity\n  ({\n    experiments,\n    searchFacetsState,\n    runsData,\n    isLoading,\n    moreRunsAvailable,\n    updateViewState,\n    onAddColumnClicked,\n    rowsData,\n    loadMoreRunsFunc,\n    onDatasetSelected,\n    expandRows,\n    viewState,\n    uiState,\n    compareRunsMode,\n  }: ExperimentViewRunsTableProps) => {\n    const { theme } = useDesignSystemTheme();\n    const updateUIState = useUpdateExperimentViewUIState();\n    const setUrlSearchFacets = useUpdateExperimentPageSearchFacets();\n\n    const { orderByKey, orderByAsc } = searchFacetsState;\n\n    // If using new view state model, get column and run info from `uiState` instead of `searchFacetsState`\n    const { selectedColumns, runsPinned, runsHidden, runListHidden } = uiState;\n\n    const updateRunListHidden = useCallback(\n      (value: boolean) => {\n        updateUIState((state) => ({ ...state, runListHidden: value }));\n      },\n      [updateUIState],\n    );\n\n    const isComparingRuns = compareRunsMode !== 'TABLE';\n\n    const { paramKeyList, metricKeyList, tagsList } = runsData;\n\n    const [gridApi, setGridApi] = useState<GridApi>();\n    const [columnApi, setColumnApi] = useState<ColumnApi>();\n    const prevSelectRunUuids = useRef<string[]>([]);\n\n    const filteredTagKeys = useMemo(() => Utils.getVisibleTagKeyList(tagsList), [tagsList]);\n\n    const containerElement = useRef<HTMLDivElement>(null);\n    // Flag indicating if there are any rows that can be expanded\n    const expandersVisible = useMemo(() => rowsData.some((row) => row.runDateAndNestInfo?.hasExpander), [rowsData]);\n\n    const toggleRowExpanded = useCallback(\n      (parentId: string) =>\n        updateUIState(({ runsExpanded: currentRunsExpanded, ...state }: ExperimentPageUIState) => ({\n          ...state,\n          runsExpanded: { ...currentRunsExpanded, [parentId]: !currentRunsExpanded[parentId] },\n        })),\n      [updateUIState],\n    );\n\n    const togglePinnedRow = useCallback(\n      (uuid: string) => {\n        updateUIState((existingFacets: ExperimentPageUIState) => ({\n          ...existingFacets,\n          runsPinned: !existingFacets.runsPinned.includes(uuid)\n            ? [...existingFacets.runsPinned, uuid]\n            : existingFacets.runsPinned.filter((r) => r !== uuid),\n        }));\n      },\n      [updateUIState],\n    );\n\n    // A modern version of row visibility toggle function, supports \"show all\", \"show first n runs\" options\n    const toggleRowVisibilityV2 = useToggleRowVisibilityCallback(rowsData);\n\n    // This callback toggles visibility of runs: either all of them or a particular one\n    // TODO: remove after new run row visibility model is rolled out completely\n    const toggleRowVisibilityV1 = useCallback(\n      // `runUuidOrToggle` param can be a run ID or a keyword value indicating that all/none should be hidden\n      (runUuidOrToggle: string) => {\n        updateUIState((existingFacets: ExperimentPageUIState) => {\n          if (runUuidOrToggle === RUNS_VISIBILITY_MODE.SHOWALL) {\n            // Case #1: Showing all runs by clearing `runsHidden` array\n            return {\n              ...existingFacets,\n              runsHidden: [],\n            };\n          } else if (runUuidOrToggle === RUNS_VISIBILITY_MODE.HIDEALL) {\n            // Case #2: Hiding all runs by fully populating `runsHidden` array\n            return {\n              ...existingFacets,\n              runsHidden: runsData.runInfos.map(({ runUuid }) => runUuid),\n            };\n          }\n\n          // Case #3: toggling particular run\n          const uuid = runUuidOrToggle;\n          return {\n            ...existingFacets,\n            runsHidden: !existingFacets.runsHidden.includes(uuid)\n              ? [...existingFacets.runsHidden, uuid]\n              : existingFacets.runsHidden.filter((r) => r !== uuid),\n          };\n        });\n      },\n      [updateUIState, runsData],\n    );\n\n    // Determine toggle version to use based on the feature flag\n    const toggleRowVisibility = shouldUseNewRunRowsVisibilityModel() ? toggleRowVisibilityV2 : toggleRowVisibilityV1;\n\n    const gridReadyHandler = useCallback((params: GridReadyEvent) => {\n      setGridApi(params.api);\n      setColumnApi(params.columnApi);\n    }, []);\n\n    const { handleRowSelected, onSelectionChange } = useExperimentTableSelectRowHandler(updateViewState);\n\n    const allRunsHidden = runsData.runInfos.every(({ runUuid }) => runsHidden.includes(runUuid));\n\n    const columnDefs = useRunsColumnDefinitions({\n      selectedColumns,\n      onExpand: toggleRowExpanded,\n      compareExperiments: experiments.length > 1,\n      onTogglePin: togglePinnedRow,\n      onToggleVisibility: toggleRowVisibility,\n      metricKeyList,\n      paramKeyList,\n      tagKeyList: filteredTagKeys,\n      columnApi,\n      isComparingRuns,\n      onDatasetSelected,\n      expandRows,\n      allRunsHidden,\n      runsHiddenMode: uiState.runsHiddenMode,\n    });\n\n    const gridSizeHandler = useCallback(\n      (api: GridApi) => {\n        if (!shouldEnableRunsTableRunNameColumnResize()) {\n          return;\n        }\n        if (api && isComparingRuns) {\n          api.sizeColumnsToFit();\n        }\n      },\n      [isComparingRuns],\n    );\n\n    useEffect(() => {\n      if (!gridApi) {\n        return;\n      }\n\n      if (isLoading) {\n        gridApi.showLoadingOverlay();\n      } else {\n        gridApi.hideOverlay();\n\n        // If there are more runs available in the API, append\n        // additional special row that will display \"Load more\" button\n        if (rowsData.length && moreRunsAvailable) {\n          gridApi.setRowData([...rowsData, createLoadMoreRow()]);\n          gridSizeHandler(gridApi);\n          return;\n        }\n\n        gridApi.setRowData(rowsData);\n        gridSizeHandler(gridApi);\n      }\n    }, [gridApi, rowsData, isLoading, moreRunsAvailable, loadMoreRunsFunc, gridSizeHandler]);\n\n    // Count all columns available for selection\n    const allAvailableColumnsCount = useMemo(() => {\n      const attributeColumnCount = getAdjustableAttributeColumns(experiments.length > 1).length;\n\n      const valuesColumnCount = metricKeyList.length + paramKeyList.length + filteredTagKeys.length;\n\n      return attributeColumnCount + valuesColumnCount;\n    }, [experiments.length, filteredTagKeys.length, metricKeyList.length, paramKeyList.length]);\n\n    const hasSelectedAllColumns = selectedColumns.length >= allAvailableColumnsCount;\n\n    const moreAvailableRunsTableColumnCount = Math.max(0, allAvailableColumnsCount - selectedColumns.length);\n\n    const allRunsCount = useMemo(\n      () =>\n        runsData.runInfos.filter(\n          (r) => runsPinned.includes(r.runUuid) || runsData.runUuidsMatchingFilter.includes(r.runUuid),\n        ).length,\n      [runsData, runsPinned],\n    );\n\n    useLayoutEffect(() => {\n      if (!gridApi) {\n        return;\n      }\n      // Each time we switch to \"compare runs\" mode, we should\n      // maximize columns so \"run name\" column will take up all remaining space\n      if (isComparingRuns) {\n        // Selection feature is not supported in compare runs mode so we should deselect all\n        gridApi.deselectAll();\n        gridApi.sizeColumnsToFit();\n      }\n      gridApi.resetRowHeights();\n    }, [gridApi, isComparingRuns]);\n\n    /**\n     * Function used by ag-grid to calculate each row's height.\n     * In this case, it's based on a datasets cell size.\n     */\n\n    const rowHeightGetterFn = useCallback(\n      // if is comparing runs, use the default row height\n      (row: { data: RunRowType }) => {\n        if (isComparingRuns || !expandRows) {\n          return EXPERIMENT_RUNS_TABLE_ROW_HEIGHT;\n        }\n        const datasetColumnId = makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.DATASET);\n        const datasetColumnShown = selectedColumns.includes(datasetColumnId);\n        // if not comparing runs, use the datasets cell height\n        return getDatasetsCellHeight(datasetColumnShown, row);\n      },\n      [selectedColumns, isComparingRuns, expandRows],\n    );\n\n    useEffect(() => {\n      // Enabling certain columns (datasets) will change our row height calculation,\n      // let's recalculate them\n      gridApi?.resetRowHeights();\n    }, [gridApi, selectedColumns, expandRows]);\n\n    const [sidebarPreviewData, setSidebarPreviewData] = useState<{\n      value: string;\n      header: string;\n    } | null>(null);\n\n    const handleCellClicked = useCallback(\n      ({ column, data, value }: CellClickedEvent) => {\n        const columnGroupId = column.getParent()?.getGroupId();\n        const shouldInvokePreviewSidebar =\n          columnGroupId === COLUMN_TYPES.METRICS || columnGroupId === COLUMN_TYPES.PARAMS;\n\n        if (shouldInvokePreviewSidebar) {\n          setSidebarPreviewData({\n            value,\n            header: `Run name: ${data.runName}, Column name: ${column.getColId()}`,\n          });\n          updateViewState({ previewPaneVisible: true });\n        }\n      },\n      [updateViewState],\n    );\n\n    const displayAddColumnsCTA = !hasSelectedAllColumns && !isComparingRuns && rowsData.length > 0;\n    const displayPreviewSidebar = !isComparingRuns && viewState.previewPaneVisible;\n    const displayRunsTable = !runListHidden || !isComparingRuns;\n    const displayStatusBar = !runListHidden;\n    const displayRunListCollapse = isComparingRuns && !shouldEnableRunsTableRunNameColumnResize();\n    const displayEmptyState = rowsData.length < 1 && !isLoading && !runListHidden;\n\n    const tableContext = useMemo(() => ({ orderByAsc, orderByKey }), [orderByAsc, orderByKey]);\n\n    return (\n      <div\n        css={(theme) => ({\n          display: 'grid',\n          flex: 1,\n          gridTemplateColumns: displayPreviewSidebar ? '1fr auto' : '1fr',\n          borderTop: `1px solid ${theme.colors.border}`,\n        })}\n        className={isComparingRuns && shouldUseNewRunRowsVisibilityModel() ? 'is-table-comparing-runs-mode' : undefined}\n      >\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            position: 'relative',\n          }}\n        >\n          <div\n            ref={containerElement}\n            className={cx('ag-theme-balham ag-grid-sticky', {\n              'ag-grid-expanders-visible': expandersVisible,\n              'is-table-comparing-runs-mode': isComparingRuns && shouldUseNewRunRowsVisibilityModel(),\n            })}\n            css={[styles.agGridOverrides(theme), { display: displayRunsTable ? 'block' : 'hidden', height: '100%' }]}\n            aria-hidden={!displayRunsTable}\n          >\n            <ExperimentViewRunsTableHeaderContextProvider runsHiddenMode={uiState.runsHiddenMode}>\n              <MLFlowAgGridLoader\n                context={tableContext}\n                defaultColDef={EXPERIMENTS_DEFAULT_COLUMN_SETUP}\n                columnDefs={columnDefs}\n                rowSelection=\"multiple\"\n                onGridReady={gridReadyHandler}\n                onSelectionChanged={onSelectionChange}\n                getRowHeight={rowHeightGetterFn}\n                headerHeight={EXPERIMENT_RUNS_TABLE_ROW_HEIGHT}\n                onRowSelected={handleRowSelected}\n                suppressRowClickSelection\n                suppressColumnMoveAnimation\n                suppressScrollOnNewData\n                isFullWidthRow={getRowIsLoadMore}\n                fullWidthCellRenderer=\"LoadMoreRowRenderer\"\n                fullWidthCellRendererParams={{ loadMoreRunsFunc }}\n                suppressFieldDotNotation\n                enableCellTextSelection\n                components={getFrameworkComponents()}\n                suppressNoRowsOverlay\n                loadingOverlayComponent=\"loadingOverlayComponent\"\n                loadingOverlayComponentParams={{ showImmediately: true }}\n                getRowId={getRowId}\n                rowBuffer={ROW_BUFFER}\n                onCellClicked={handleCellClicked}\n                onGridSizeChanged={({ api }) => gridSizeHandler(api)}\n              />\n            </ExperimentViewRunsTableHeaderContextProvider>\n            {displayAddColumnsCTA && (\n              <ExperimentViewRunsTableAddColumnCTA\n                gridContainerElement={containerElement.current}\n                isInitialized={Boolean(gridApi)}\n                onClick={onAddColumnClicked}\n                visible={!isLoading}\n                moreRunsAvailable={moreRunsAvailable}\n                moreAvailableRunsTableColumnCount={moreAvailableRunsTableColumnCount}\n              />\n            )}\n          </div>\n          {displayEmptyState && (\n            <ExperimentViewRunsEmptyTable\n              onClearFilters={() => {\n                setUrlSearchFacets(createExperimentPageSearchFacetsState());\n              }}\n              isFiltered={isSearchFacetsFilterUsed(searchFacetsState)}\n            />\n          )}\n          {displayStatusBar && <ExperimentViewRunsTableStatusBar allRunsCount={allRunsCount} isLoading={isLoading} />}\n          {displayRunListCollapse && (\n            <ExperimentViewRunsTableCollapse runListHidden={runListHidden} updateRunListHidden={updateRunListHidden} />\n          )}\n        </div>\n        {displayPreviewSidebar && (\n          <PreviewSidebar\n            content={sidebarPreviewData?.value}\n            copyText={sidebarPreviewData?.value}\n            headerText={sidebarPreviewData?.header}\n            onClose={() => updateViewState({ previewPaneVisible: false })}\n            empty={\n              <Empty\n                description={\n                  <FormattedMessage\n                    defaultMessage=\"Select a cell to display preview\"\n                    description=\"Experiment page > table view > preview sidebar > nothing selected\"\n                  />\n                }\n              />\n            }\n          />\n        )}\n      </div>\n    );\n  },\n);\n\n/**\n * Concrete named definitions for colors used in this agGrid\n */\nconst getGridColors = (theme: Theme) => ({\n  rowForeground: theme.colors.textPrimary, // regular row background\n  rowBackground: theme.colors.backgroundPrimary, // regular row background\n  rowBackgroundHover: `${theme.colors.backgroundSecondary}0A`, // hovered row (4% opacity)\n  rowBackgroundSelected: `${theme.colors.backgroundSecondary}14`, // selected row (8% opacity)\n  rowBackgroundHoverSelected: `${theme.colors.backgroundSecondary}1F`, // selected and hovered row (12% opacity)\n  columnSortedBy: `${theme.colors.blue400}1F`,\n  headerBackground: theme.colors.backgroundSecondary,\n  headerTextColor: theme.colors.textSecondary, // directly from Figma design\n  headerGroupTextColor: theme.colors.textSecondary, // directly from Figma design\n  borderColor: theme.colors.borderDecorative, // border between header and content and scrollable areas\n  headerBorderColor: 'transparent', // borders inside the header\n  checkboxBorderColor: theme.colors.actionDefaultBorderDefault,\n  checkboxBorderColorChecked: theme.colors.backgroundPrimary,\n  checkboxBackgroundColorChecked: theme.colors.actionPrimaryBackgroundDefault,\n  overlayBackground: `${theme.colors.backgroundSecondary}99`, // color for the loading overlay\n});\n\nconst styles = {\n  agGridOverrides: (theme: Theme): Interpolation<Theme> => {\n    const gridColors = getGridColors(theme);\n    return {\n      height: '100%',\n      position: 'relative',\n      '&.ag-theme-balham': {\n        // Set up internal variable values\n        '--ag-border-color': gridColors.borderColor,\n        '--ag-row-border-color': gridColors.borderColor,\n        '--ag-foreground-color': gridColors.rowForeground,\n        '--ag-background-color': gridColors.rowBackground,\n        '--ag-odd-row-background-color': gridColors.rowBackground,\n        '--ag-row-hover-color': gridColors.rowBackgroundHover,\n        '--ag-selected-row-background-color': gridColors.rowBackgroundSelected,\n        '--ag-header-foreground-color': gridColors.headerTextColor,\n        '--ag-header-background-color': gridColors.headerBackground,\n        '--ag-modal-overlay-background-color': gridColors.overlayBackground,\n\n        // Makes row header sticky\n        '&.ag-grid-sticky .ag-header': {\n          position: 'sticky',\n          top: 0,\n          zIndex: 1,\n        },\n        '&.ag-grid-sticky .ag-root': {\n          overflow: 'visible',\n        },\n        '&.ag-grid-sticky .ag-root-wrapper': {\n          border: '0',\n          borderRadius: '4px',\n          overflow: 'visible',\n        },\n\n        // Adds a static line between column group header row and column headers\n        '.ag-header::after': {\n          content: '\"\"',\n          position: 'absolute',\n          top: EXPERIMENT_RUNS_TABLE_ROW_HEIGHT,\n          left: 0,\n          right: 0,\n          height: 1,\n          backgroundColor: gridColors.borderColor,\n        },\n\n        // Line height for cell contents is the row height minus the border\n        '.ag-cell': {\n          // lineHeight: `min(var(--ag-line-height, ${ROW_HEIGHT - 2}px), ${ROW_HEIGHT - 2}px)`,\n          display: 'flex',\n          overflow: 'hidden',\n          '& > .ag-cell-wrapper': {\n            overflow: 'hidden',\n          },\n        },\n\n        // Padding fixes for the header (we use custom component)\n        '.ag-header-cell': {\n          padding: 0,\n        },\n        '.ag-header-cell .ag-checkbox': {\n          padding: '0 7px',\n          borderLeft: '1px solid transparent', // to match it with the cell sizing\n        },\n\n        '.ag-cell.is-ordered-by, .ag-header-cell > .is-ordered-by': {\n          backgroundColor: gridColors.columnSortedBy,\n        },\n        '.ag-header-row': {\n          '--ag-border-color': gridColors.headerBorderColor,\n        },\n        '.ag-header-row.ag-header-row-column-group': {\n          '--ag-header-foreground-color': gridColors.headerGroupTextColor,\n        },\n        '.ag-row.ag-row-selected.ag-row-hover': {\n          backgroundColor: gridColors.rowBackgroundHoverSelected,\n        },\n\n        // Hides resize guidelines when header is not hovered\n        '.ag-header:not(:hover) .ag-header-cell::after, .ag-header:not(:hover) .ag-header-group-cell::after': {\n          opacity: 0,\n        },\n        '.ag-pinned-left-header': {\n          borderRight: 'none',\n        },\n\n        // Fixed for loading overlay, should be above \"load more\" button\n        '.ag-overlay-loading-wrapper': {\n          paddingTop: theme.spacing.md * 4,\n          alignItems: 'center',\n          zIndex: 2,\n        },\n        '.ag-overlay-loading-wrapper .ag-react-container': {\n          flex: 1,\n        },\n\n        // Adds border after the last column to separate contents from \"Add columns\" CTA\n        '.ag-center-cols-container': {\n          minHeight: 0,\n        },\n\n        '.ag-full-width-row': {\n          borderBottom: 0,\n          backgroundColor: 'transparent',\n          zIndex: 1,\n          '&.ag-row-hover': {\n            backgroundColor: 'transparent',\n          },\n        },\n\n        // Centers vertically and styles the checkbox cell\n        '.is-checkbox-cell': {\n          display: 'flex',\n          alignItems: 'center',\n          paddingLeft: 7, // will end up in 8px due to 1px of transparent border on the left\n          '.is-multiline-cell .ag-cell-value': {\n            height: '100%',\n          },\n        },\n\n        // Change appearance of the previewable cells\n        '.is-previewable-cell': {\n          cursor: 'pointer',\n        },\n\n        // Header checkbox cell will get the same background as header only if it's unchecked\n        '.ag-header-cell .ag-checkbox .ag-input-wrapper:not(.ag-indeterminate):not(.ag-checked)': {\n          '--ag-checkbox-background-color': gridColors.headerBackground,\n        },\n\n        // Distance from the checkbox to other icons (pin, visibility etc.)\n        '.ag-cell-wrapper .ag-selection-checkbox': {\n          marginRight: 20,\n        },\n\n        // Header and cell checkboxes will get same colors from the palette\n        '.is-checkbox-cell, .ag-header-cell .ag-checkbox': {\n          '.ag-checkbox-input-wrapper::after': {\n            color: gridColors.checkboxBorderColor,\n          },\n          '.ag-checkbox-input-wrapper.ag-checked': {\n            '--ag-checkbox-background-color': gridColors.checkboxBackgroundColorChecked,\n            '--ag-checkbox-checked-color': gridColors.checkboxBorderColorChecked,\n            '&::after': {\n              color: gridColors.checkboxBorderColorChecked,\n            },\n          },\n        },\n      },\n    };\n  },\n};\n","/**\n * Defines non-persistable, local state that\n * controls visibility of various UI elements in the\n * runs table and controls\n */\nexport class ExperimentPageViewState {\n  /**\n   * Currently selected runs\n   */\n  runsSelected: Record<string, boolean> = {};\n\n  /**\n   * Currently hidden, selected child runs\n   */\n  hiddenChildRunsSelected: Record<string, boolean> = {};\n\n  /**\n   * Display \"select columns\" dropdown\n   */\n  columnSelectorVisible = false;\n\n  /**\n   * Display \"select columns\" dropdown\n   */\n  previewPaneVisible = false;\n\n  /**\n   * Persists controls state in the evaluation artifact compare mode\n   */\n  artifactViewState: {\n    selectedTables?: string[];\n    groupByCols?: string[];\n    outputColumn?: string;\n    intersectingOnly?: boolean;\n  } = {\n    selectedTables: [],\n    groupByCols: [],\n    outputColumn: '',\n    intersectingOnly: false,\n  };\n}\n","import type { NotificationInstance } from '@databricks/design-system';\nimport { useCallback } from 'react';\nimport { useIntl } from 'react-intl';\nimport type { RunEntity, RunInfoEntity } from '../../../types';\nimport { EXPERIMENT_PARENT_ID_TAG } from '../utils/experimentPage.common-utils';\n\nconst FETCHED_RUN_NOTIFICATION_DURATION = 3; // Seconds\nconst FETCHED_RUN_NOTIFICATION_KEY = 'FETCHED_RUN_NOTIFICATION_KEY';\n\nconst countFetchedRuns = (fetchedRuns: RunEntity[], existingRunInfos: RunInfoEntity[] = []) => {\n  // Extract only runs that are not loaded yet\n  const newRuns = fetchedRuns.filter((r) => !existingRunInfos.some((x) => x.runUuid === r.info.runUuid));\n\n  // Next, extract runs containing non-empty \"parentRunId\" tag\n  const runsWithParent = newRuns.filter((run: any) => {\n    const runTagsList = run?.data?.tags;\n    return (\n      Array.isArray(runTagsList) &&\n      runTagsList.some((tag) => tag.key === EXPERIMENT_PARENT_ID_TAG && Boolean(tag.value))\n    );\n  });\n\n  // Return counts of both all runs and those with parent\n  return {\n    allRuns: newRuns.length,\n    childRuns: runsWithParent.length,\n  };\n};\n\nexport const useFetchedRunsNotification = (notification: NotificationInstance) => {\n  const { formatMessage } = useIntl();\n\n  // Creates the localized message based on the returned run count\n  const getMessage = useCallback(\n    (allRuns: number, childRuns: number) => {\n      // Returned when only child runs are loaded\n      if (allRuns === childRuns) {\n        return formatMessage(\n          {\n            defaultMessage: 'Loaded {childRuns} child {childRuns, plural, =1 {run} other {runs}}',\n            description: 'Experiment page > loaded more runs notification > loaded only child runs',\n          },\n          { childRuns: childRuns },\n        );\n      }\n\n      // Returned when we fetch both regular (parent) and child runs\n      return formatMessage(\n        {\n          defaultMessage:\n            // eslint-disable-next-line formatjs/no-multiple-plurals\n            'Loaded {allRuns} {allRuns, plural, =1 {run} other {runs}}, including {childRuns} child {childRuns, plural, =1 {run} other {runs}}',\n          description: 'Experiment page > loaded more runs notification > loaded both parent and child runs',\n        },\n        { allRuns, childRuns: childRuns },\n      );\n    },\n    [formatMessage],\n  );\n\n  return useCallback(\n    (fetchedRuns: RunEntity[], existingRunInfos: RunInfoEntity[]) => {\n      if (Array.isArray(fetchedRuns)) {\n        // Get counted runs\n        const { allRuns, childRuns } = countFetchedRuns(fetchedRuns, existingRunInfos);\n\n        // Display notification only if there are any new child runs\n        if (childRuns < 1) {\n          return;\n        }\n\n        // If there is a similar notification visible already, close it first\n        // to avoid confusion due to multiple displayed notification elements\n        notification.close(FETCHED_RUN_NOTIFICATION_KEY);\n\n        // Display the notification\n        notification.info({\n          message: getMessage(allRuns, childRuns),\n          duration: FETCHED_RUN_NOTIFICATION_DURATION,\n          placement: 'bottomRight',\n          key: FETCHED_RUN_NOTIFICATION_KEY,\n        });\n      }\n    },\n    [notification, getMessage],\n  );\n};\n","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { UseEvaluationArtifactTableDataResult } from './useEvaluationArtifactTableData';\nimport { useDispatch } from 'react-redux';\nimport { ThunkDispatch } from '../../../../redux-types';\nimport {\n  compilePromptInputText,\n  extractEvaluationPrerequisitesForRun,\n  extractPromptInputVariables,\n} from '../../prompt-engineering/PromptEngineering.utils';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport { evaluatePromptTableValue } from '../../../actions/PromptEngineeringActions';\nimport Utils from '../../../../common/utils/Utils';\nimport { getPromptEngineeringErrorMessage } from '../utils/PromptEngineeringErrorUtils';\n\n/**\n * Local utilility function, confirms if all param values\n * are provided for a particular evaluation table data row.\n */\nconst containsAllParamValuesForRow = (row: UseEvaluationArtifactTableDataResult[0], requiredInputs: string[]) => {\n  const missingInputParams = requiredInputs.filter((requiredInput) => !row.groupByCellValues[requiredInput]);\n\n  return missingInputParams.length === 0;\n};\n\n/**\n * A hook containing complete toolset supporting \"Evaluate all\" button\n */\nexport const useEvaluateAllRows = (evaluationTableData: UseEvaluationArtifactTableDataResult, outputColumn: string) => {\n  const currentTableData = useRef<UseEvaluationArtifactTableDataResult>(evaluationTableData);\n  const currentRunsBeingEvaluated = useRef<string[]>([]);\n  const intl = useIntl();\n\n  useEffect(() => {\n    currentTableData.current = evaluationTableData;\n  }, [evaluationTableData]);\n\n  const [runColumnsBeingEvaluated, setEvaluatedRuns] = useState<string[]>([]);\n\n  useEffect(() => {\n    currentRunsBeingEvaluated.current = runColumnsBeingEvaluated;\n  }, [runColumnsBeingEvaluated]);\n\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  // Processes single run's evaluation queue.\n  const processQueueForRun = useCallback(\n    (run: RunRowType) => {\n      const tableData = currentTableData.current;\n      const { parameters, promptTemplate, routeName, routeType } = extractEvaluationPrerequisitesForRun(run);\n\n      if (!promptTemplate) {\n        return;\n      }\n\n      const requiredInputs = extractPromptInputVariables(promptTemplate);\n\n      // Try to find the next row in the table that can be evaluated for a particular table\n      const nextEvaluableRow = tableData.find(\n        (tableRow) => !tableRow.cellValues[run.runUuid] && containsAllParamValuesForRow(tableRow, requiredInputs),\n      );\n\n      // If there's no row, close the queue and return\n      if (!nextEvaluableRow) {\n        setEvaluatedRuns((runs) => runs.filter((existingRunUuid) => existingRunUuid !== run.runUuid));\n        return;\n      }\n      const rowKey = nextEvaluableRow.key;\n      const inputValues = nextEvaluableRow.groupByCellValues;\n\n      if (!promptTemplate) {\n        return;\n      }\n\n      const compiledPrompt = compilePromptInputText(promptTemplate, inputValues);\n\n      if (routeName) {\n        dispatch(\n          evaluatePromptTableValue({\n            routeName,\n            routeType,\n            compiledPrompt,\n            inputValues,\n            outputColumn,\n            rowKey,\n            parameters,\n            run,\n          }),\n        )\n          .then(() => {\n            // If the current queue for the run is still active, continue with processing\n            if (currentRunsBeingEvaluated.current.includes(run.runUuid)) {\n              processQueueForRun(run);\n            }\n          })\n          .catch((e) => {\n            const errorMessage = getPromptEngineeringErrorMessage(e);\n\n            // In case of error, notify the user and close the queue\n            const wrappedMessage = intl.formatMessage(\n              {\n                defaultMessage: 'Gateway returned the following error: \"{errorMessage}\"',\n                description: 'Experiment page > gateway error message',\n              },\n              {\n                errorMessage,\n              },\n            );\n            Utils.logErrorAndNotifyUser(wrappedMessage);\n            setEvaluatedRuns((runs) => runs.filter((existingRunUuid) => existingRunUuid !== run.runUuid));\n          });\n      }\n    },\n    [dispatch, outputColumn, intl],\n  );\n\n  // Enables run's evaluation queue and starts its processing\n  const startEvaluatingRunColumn = useCallback(\n    (run: RunRowType) => {\n      setEvaluatedRuns((runs) => [...runs, run.runUuid]);\n      processQueueForRun(run);\n    },\n    [processQueueForRun],\n  );\n\n  // Removes the run from evaluation queue so it will gracefully stop after currently pending evaluation\n  const stopEvaluatingRunColumn = useCallback((run: RunRowType) => {\n    setEvaluatedRuns((runs) => runs.filter((existingRunUuid) => existingRunUuid !== run.runUuid));\n  }, []);\n\n  return { runColumnsBeingEvaluated, startEvaluatingRunColumn, stopEvaluatingRunColumn };\n};\n","import React, { useCallback, useContext, useMemo, useState } from 'react';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport { UseEvaluationArtifactTableDataResult } from '../hooks/useEvaluationArtifactTableData';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ReduxState, ThunkDispatch } from '../../../../redux-types';\nimport { EvaluationDataReduxState } from '../../../reducers/EvaluationDataReducer';\nimport { evaluatePromptTableValue } from '../../../actions/PromptEngineeringActions';\nimport {\n  DEFAULT_PROMPTLAB_OUTPUT_COLUMN,\n  canEvaluateOnRun,\n  compilePromptInputText,\n  extractEvaluationPrerequisitesForRun,\n  extractPromptInputVariables,\n} from '../../prompt-engineering/PromptEngineering.utils';\nimport Utils from '../../../../common/utils/Utils';\nimport { useEvaluateAllRows } from '../hooks/useEvaluateAllRows';\nimport { useIntl } from 'react-intl';\nimport { ErrorWrapper } from '../../../../common/utils/ErrorWrapper';\nimport { getPromptEngineeringErrorMessage } from '../utils/PromptEngineeringErrorUtils';\nimport { GatewayErrorWrapper } from '../../../utils/LLMGatewayUtils';\n\nexport interface PromptEngineeringContextType {\n  getMissingParams: (run: RunRowType, rowKey: string) => string[] | null;\n  getEvaluableRowCount: (run: RunRowType) => number;\n  pendingDataLoading: EvaluationDataReduxState['evaluationPendingDataLoadingByRunUuid'];\n  evaluateCell: (run: RunRowType, rowKey: string) => void;\n  evaluateAllClick: (run: RunRowType) => void;\n  runColumnsBeingEvaluated: string[];\n  canEvaluateInRunColumn: (run: RunRowType) => boolean;\n  toggleExpandedHeader: () => void;\n  isHeaderExpanded: boolean;\n}\n\nconst PromptEngineeringContext = React.createContext<PromptEngineeringContextType>({\n  getMissingParams: () => [],\n  pendingDataLoading: {},\n  getEvaluableRowCount: () => 0,\n  evaluateCell: () => {},\n  evaluateAllClick: () => {},\n  runColumnsBeingEvaluated: [],\n  canEvaluateInRunColumn: () => false,\n  toggleExpandedHeader: () => {},\n  isHeaderExpanded: false,\n});\n\nexport const PromptEngineeringContextProvider = ({\n  tableData,\n  outputColumn,\n  children,\n}: React.PropsWithChildren<{\n  tableData: UseEvaluationArtifactTableDataResult;\n  outputColumn: string;\n}>) => {\n  const intl = useIntl();\n\n  const [isHeaderExpanded, setIsHeaderExpanded] = useState(false);\n  const toggleExpandedHeader = useCallback(() => setIsHeaderExpanded((expanded) => !expanded), []);\n\n  const getMissingParams = useCallback(\n    (run: RunRowType, rowKey: string) => {\n      if (!canEvaluateOnRun(run)) {\n        return null;\n      }\n      const row = tableData.find((x) => x.key === rowKey);\n      if (!row) {\n        return null;\n      }\n\n      const { promptTemplate } = extractEvaluationPrerequisitesForRun(run);\n\n      if (!promptTemplate) {\n        return null;\n      }\n\n      const requiredInputs = extractPromptInputVariables(promptTemplate);\n\n      const missingInputParams = requiredInputs.filter((requiredInput) => !row.groupByCellValues[requiredInput]);\n\n      return missingInputParams;\n    },\n    [tableData],\n  );\n\n  const dispatch = useDispatch<ThunkDispatch>();\n  const { startEvaluatingRunColumn, stopEvaluatingRunColumn, runColumnsBeingEvaluated } = useEvaluateAllRows(\n    tableData,\n    outputColumn,\n  );\n\n  const pendingDataLoading = useSelector(\n    ({ evaluationData }: ReduxState) => evaluationData.evaluationPendingDataLoadingByRunUuid,\n  );\n\n  const canEvaluateInRunColumn = useCallback(\n    (run?: RunRowType) => outputColumn === DEFAULT_PROMPTLAB_OUTPUT_COLUMN && canEvaluateOnRun(run),\n    [outputColumn],\n  );\n\n  const getEvaluableRowCount = useCallback(\n    (run: RunRowType) => {\n      const evaluatableRows = tableData.filter((tableRow) => {\n        if (tableRow.cellValues[run.runUuid]) {\n          return false;\n        }\n        const missingParams = getMissingParams(run, tableRow.key);\n        return missingParams?.length === 0;\n      });\n\n      return evaluatableRows.length;\n    },\n    [tableData, getMissingParams],\n  );\n\n  const evaluateAllClick = useCallback(\n    (run: RunRowType) => {\n      if (runColumnsBeingEvaluated.includes(run.runUuid)) {\n        stopEvaluatingRunColumn(run);\n      } else {\n        startEvaluatingRunColumn(run);\n      }\n    },\n    [runColumnsBeingEvaluated, startEvaluatingRunColumn, stopEvaluatingRunColumn],\n  );\n\n  const evaluateCell = useCallback(\n    (run: RunRowType, rowKey: string) => {\n      const row = tableData.find(({ key }) => key === rowKey);\n      if (!row) {\n        return;\n      }\n      const inputValues = row.groupByCellValues;\n\n      const { parameters, promptTemplate, routeName, routeType } = extractEvaluationPrerequisitesForRun(run);\n\n      if (!promptTemplate) {\n        return;\n      }\n\n      const compiledPrompt = compilePromptInputText(promptTemplate, inputValues);\n\n      if (routeName) {\n        const getAction = () => {\n          return evaluatePromptTableValue({\n            routeName,\n            routeType,\n            compiledPrompt,\n            inputValues,\n            outputColumn,\n            rowKey,\n            parameters,\n            run,\n          });\n        };\n\n        dispatch(getAction()).catch((e: Error | ErrorWrapper | GatewayErrorWrapper) => {\n          const errorMessage = getPromptEngineeringErrorMessage(e);\n\n          const wrappedMessage = intl.formatMessage(\n            {\n              defaultMessage: 'MLflow deployment returned the following error: \"{errorMessage}\"',\n              description: 'Experiment page > MLflow deployment error message',\n            },\n            {\n              errorMessage,\n            },\n          );\n          Utils.logErrorAndNotifyUser(wrappedMessage);\n        });\n      }\n    },\n    [tableData, dispatch, outputColumn, intl],\n  );\n  const contextValue = useMemo(\n    () => ({\n      getMissingParams,\n      getEvaluableRowCount,\n      evaluateCell,\n      evaluateAllClick,\n      pendingDataLoading,\n      canEvaluateInRunColumn,\n      runColumnsBeingEvaluated,\n      isHeaderExpanded,\n      toggleExpandedHeader,\n    }),\n    [\n      getMissingParams,\n      getEvaluableRowCount,\n      evaluateAllClick,\n      evaluateCell,\n      pendingDataLoading,\n      canEvaluateInRunColumn,\n      runColumnsBeingEvaluated,\n      isHeaderExpanded,\n      toggleExpandedHeader,\n    ],\n  );\n  return <PromptEngineeringContext.Provider value={contextValue}>{children}</PromptEngineeringContext.Provider>;\n};\n\nexport const usePromptEngineeringContext = () => useContext(PromptEngineeringContext);\n","import { Button, Popover, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { useSelector } from 'react-redux';\nimport { ReduxState } from '../../../../redux-types';\nimport type { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport {\n  canEvaluateOnRun,\n  extractEvaluationPrerequisitesForRun,\n} from '../../prompt-engineering/PromptEngineering.utils';\nimport { usePromptEngineeringContext } from '../contexts/PromptEngineeringContext';\n\ninterface EvaluationRunHeaderModelIndicatorProps {\n  run: RunRowType;\n}\nexport const EvaluationRunHeaderModelIndicator = ({ run }: EvaluationRunHeaderModelIndicatorProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const { isHeaderExpanded } = usePromptEngineeringContext();\n\n  const promptEvaluationDataForRun = extractEvaluationPrerequisitesForRun(run);\n\n  const gatewayRoute = useSelector(({ modelGateway }: ReduxState) => {\n    const gatewayKey = `${promptEvaluationDataForRun.routeType}:${promptEvaluationDataForRun.routeName}`;\n    return promptEvaluationDataForRun.routeName ? modelGateway.modelGatewayRoutes[gatewayKey] : null;\n  });\n\n  if (!canEvaluateOnRun(run) || !promptEvaluationDataForRun) {\n    return null;\n  }\n\n  const { parameters, promptTemplate, routeName } = promptEvaluationDataForRun;\n  const { stop: stopSequences = [] } = parameters;\n\n  return (\n    <div\n      css={{\n        marginTop: theme.spacing.xs,\n        flex: 1,\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.sm,\n        overflowX: 'hidden',\n        width: '100%',\n      }}\n    >\n      {gatewayRoute && 'mlflowDeployment' in gatewayRoute && gatewayRoute.mlflowDeployment && (\n        <Typography.Hint>{gatewayRoute.mlflowDeployment.name}</Typography.Hint>\n      )}\n      {isHeaderExpanded && (\n        <>\n          <Typography.Hint>\n            <FormattedMessage\n              defaultMessage=\"Temperature: {temperature}\"\n              description=\"Experiment page > artifact compare view > run column header prompt metadata > temperature parameter\"\n              values={parameters}\n            />\n          </Typography.Hint>\n          <Typography.Hint>\n            <FormattedMessage\n              defaultMessage=\"Max. tokens: {max_tokens}\"\n              description=\"Experiment page > artifact compare view > run column header prompt metadata > max tokens parameter\"\n              values={parameters}\n            />\n          </Typography.Hint>\n          {stopSequences.length ? (\n            <Typography.Hint css={{ overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>\n              <FormattedMessage\n                defaultMessage=\"Stop sequences: {stopSequences}\"\n                description=\"Experiment page > artifact compare view > run column header prompt metadata > stop sequences parameter\"\n                values={{ stopSequences: stopSequences?.join(', ') }}\n              />\n            </Typography.Hint>\n          ) : null}\n          <div css={{ fontSize: 0 }}>\n            <Popover.Root>\n              <Popover.Trigger asChild>\n                <Button\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadermodelindicator.tsx_115\"\n                  type=\"link\"\n                  size=\"small\"\n                  css={{\n                    fontSize: theme.typography.fontSizeSm,\n                  }}\n                >\n                  <FormattedMessage\n                    defaultMessage=\"View prompt template\"\n                    description='Experiment page > artifact compare view > run column header prompt metadata > \"view prompt template\" button label'\n                  />\n                </Button>\n              </Popover.Trigger>\n              <Popover.Content css={{ maxWidth: 300 }}>\n                <Popover.Arrow />\n                {promptTemplate}\n              </Popover.Content>\n            </Popover.Root>\n          </div>\n        </>\n      )}\n    </div>\n  );\n};\n","import { Button, Popover, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { ExperimentViewDatasetWithContext } from '../../experiment-page/components/runs/ExperimentViewDatasetWithContext';\nimport type { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport type { RunDatasetWithTags } from '../../../types';\nimport { useCallback } from 'react';\n\ninterface EvaluationRunHeaderDatasetIndicatorProps {\n  run: RunRowType;\n  onDatasetSelected: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n}\n\nexport const EvaluationRunHeaderDatasetIndicator = ({\n  run,\n  onDatasetSelected,\n}: EvaluationRunHeaderDatasetIndicatorProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const handleDatasetSelected = useCallback(\n    (datasetWithTags: RunDatasetWithTags) => onDatasetSelected(datasetWithTags, run),\n    [onDatasetSelected, run],\n  );\n\n  if (run.datasets?.length < 1) {\n    return null;\n  }\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'center',\n        gap: theme.spacing.xs,\n        overflow: 'hidden',\n      }}\n    >\n      <div css={{ flexShrink: 1, flexGrow: 1, overflow: 'hidden' }}>\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheaderdatasetindicator.tsx_37\"\n          type=\"link\"\n          onClick={() => handleDatasetSelected(run.datasets[0])}\n        >\n          <ExperimentViewDatasetWithContext\n            datasetWithTags={run.datasets[0]}\n            displayTextAsLink\n            css={{ marginTop: theme.spacing.xs / 2, marginBottom: theme.spacing.xs / 2 }}\n          />\n        </Button>\n      </div>\n      {run.datasets.length > 1 && (\n        <div css={{ flexShrink: 0, flexGrow: 1, display: 'flex', alignItems: 'flex-end' }}>\n          <Popover.Root modal={false}>\n            <Popover.Trigger asChild>\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheaderdatasetindicator.tsx_49\"\n                size=\"small\"\n                style={{ borderRadius: '8px', width: '40px' }}\n              >\n                <Typography.Text color=\"secondary\">+{run.datasets.length - 1}</Typography.Text>\n              </Button>\n            </Popover.Trigger>\n            <Popover.Content align=\"start\">\n              {run.datasets\n                .slice(1)\n                .filter(Boolean)\n                .map((datasetWithTags) => (\n                  <div\n                    css={{\n                      height: theme.general.heightSm,\n                      display: 'flex',\n                      alignItems: 'center',\n                    }}\n                    key={`${datasetWithTags.dataset.name}-${datasetWithTags.dataset.digest}`}\n                  >\n                    <Button\n                      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheaderdatasetindicator.tsx_66\"\n                      type=\"link\"\n                      onClick={() => handleDatasetSelected(datasetWithTags)}\n                    >\n                      <ExperimentViewDatasetWithContext datasetWithTags={datasetWithTags} displayTextAsLink />\n                    </Button>\n                  </div>\n                ))}\n            </Popover.Content>\n          </Popover.Root>\n        </div>\n      )}\n    </div>\n  );\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { PropsWithChildren, ReactNode } from 'react';\n\ninterface Props {\n  className?: string;\n  groupHeaderContent?: ReactNode;\n  isGroupByHeader?: false;\n}\n\nexport const EvaluationTableHeader = ({ children, className, groupHeaderContent = null }: PropsWithChildren<Props>) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    // Header cell wrapper element\n    <div\n      css={{\n        width: '100%',\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column',\n      }}\n    >\n      {/* Spacer element serving as a group header */}\n      <div\n        css={{\n          width: '100%',\n          flexBasis: 40,\n          display: 'flex',\n          alignItems: 'center',\n          padding: theme.spacing.sm,\n          borderBottom: `1px solid ${theme.colors.borderDecorative}`,\n        }}\n        className=\"header-group-cell\"\n      >\n        {groupHeaderContent}\n      </div>\n      {/* Main header cell content */}\n      <div\n        css={{\n          width: '100%',\n          flex: 1,\n          display: 'flex',\n          justifyContent: 'flex-start',\n          alignItems: 'flex-start',\n          padding: theme.spacing.xs,\n          borderRight: `1px solid ${theme.colors.borderDecorative}`,\n        }}\n        className={className}\n      >\n        {children}\n      </div>\n    </div>\n  );\n};\n","import {\n  Button,\n  DropdownMenu,\n  OverflowIcon,\n  PlayIcon,\n  StopIcon,\n  Tooltip,\n  VisibleIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { Link } from '../../../../common/utils/RoutingUtils';\nimport ExperimentRoutes from '../../../routes';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport { EvaluationRunHeaderModelIndicator } from './EvaluationRunHeaderModelIndicator';\nimport { shouldEnablePromptLab } from '../../../../common/utils/FeatureUtils';\nimport { EvaluationRunHeaderDatasetIndicator } from './EvaluationRunHeaderDatasetIndicator';\nimport type { RunDatasetWithTags } from '../../../types';\nimport { usePromptEngineeringContext } from '../contexts/PromptEngineeringContext';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport React, { useMemo } from 'react';\nimport { EvaluationTableHeader } from './EvaluationTableHeader';\nimport { useCreateNewRun } from '../../experiment-page/hooks/useCreateNewRun';\nimport { canEvaluateOnRun } from '../../prompt-engineering/PromptEngineering.utils';\nimport { useGetExperimentRunColor } from '../../experiment-page/hooks/useExperimentRunColor';\nimport { RunColorPill } from '../../experiment-page/components/RunColorPill';\n\ninterface EvaluationRunHeaderCellRendererProps {\n  run: RunRowType;\n  onHideRun: (runUuid: string) => void;\n  onDuplicateRun: (run: RunRowType) => void;\n  onDatasetSelected: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n  groupHeaderContent?: React.ReactNode;\n}\n\n/**\n * Component used as a column header for output (\"run\") columns\n */\nexport const EvaluationRunHeaderCellRenderer = ({\n  run,\n  onHideRun,\n  onDuplicateRun,\n  onDatasetSelected,\n  groupHeaderContent = null,\n}: EvaluationRunHeaderCellRendererProps) => {\n  const { theme } = useDesignSystemTheme();\n  const { getEvaluableRowCount, evaluateAllClick, runColumnsBeingEvaluated, canEvaluateInRunColumn } =\n    usePromptEngineeringContext();\n  const intl = useIntl();\n  const evaluableRowCount = getEvaluableRowCount(run);\n  const getRunColor = useGetExperimentRunColor();\n  const evaluateAllButtonEnabled = evaluableRowCount > 0;\n\n  const evaluatingAllInProgress = runColumnsBeingEvaluated.includes(run.runUuid);\n\n  const evaluateAllTooltipContent = useMemo(() => {\n    if (!evaluateAllButtonEnabled) {\n      return intl.formatMessage({\n        defaultMessage: 'There are no evaluable rows within this column',\n        description:\n          'Experiment page > artifact compare view > run column header > Disabled \"Evaluate all\" button tooltip when no rows are evaluable',\n      });\n    }\n    if (evaluateAllButtonEnabled && !evaluatingAllInProgress) {\n      return intl.formatMessage(\n        {\n          defaultMessage: 'Process {evaluableRowCount} rows without evaluation output',\n          description: 'Experiment page > artifact compare view > run column header > \"Evaluate all\" button tooltip',\n        },\n        {\n          evaluableRowCount,\n        },\n      );\n    }\n\n    return null;\n  }, [evaluableRowCount, evaluateAllButtonEnabled, evaluatingAllInProgress, intl]);\n\n  return (\n    <EvaluationTableHeader\n      css={{\n        justifyContent: 'flex-start',\n        padding: theme.spacing.sm,\n        paddingBottom: 0,\n        paddingTop: theme.spacing.sm,\n        flexDirection: 'column',\n        gap: theme.spacing.xs / 2,\n        overflow: 'hidden',\n      }}\n      groupHeaderContent={groupHeaderContent}\n    >\n      <div\n        css={{\n          width: '100%',\n          display: 'flex',\n        }}\n      >\n        <span css={{ display: 'flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n          <RunColorPill color={getRunColor(run.runUuid)} />\n          <Link to={ExperimentRoutes.getRunPageRoute(run.experimentId || '', run.runUuid)} target=\"_blank\">\n            {run.runName}\n          </Link>\n        </span>\n        <div css={{ flexBasis: theme.spacing.sm, flexShrink: 0 }} />\n\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadercellrenderer.tsx_112\"\n          onClick={() => onHideRun(run.runUuid)}\n          size=\"small\"\n          icon={<VisibleIcon />}\n          css={{ flexShrink: 0 }}\n        />\n        <div css={{ flex: 1 }} />\n        {shouldEnablePromptLab() && canEvaluateInRunColumn(run) && (\n          <>\n            <div css={{ flexBasis: theme.spacing.sm }} />\n            <Tooltip title={evaluateAllTooltipContent}>\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadercellrenderer.tsx_118\"\n                disabled={!evaluateAllButtonEnabled}\n                size=\"small\"\n                onClick={() => evaluateAllClick(run)}\n                icon={evaluatingAllInProgress ? <StopIcon /> : <PlayIcon />}\n              >\n                {evaluatingAllInProgress ? (\n                  <FormattedMessage\n                    defaultMessage=\"Stop evaluating\"\n                    description='Experiment page > artifact compare view > run column header > \"Evaluate all\" button label when the column is being evaluated'\n                  />\n                ) : (\n                  <FormattedMessage\n                    defaultMessage=\"Evaluate all\"\n                    description='Experiment page > artifact compare view > run column header > \"Evaluate all\" button label'\n                  />\n                )}\n              </Button>\n            </Tooltip>\n          </>\n        )}\n        <div css={{ flexBasis: theme.spacing.sm }} />\n        {shouldEnablePromptLab() && canEvaluateOnRun(run) && (\n          <DropdownMenu.Root modal={false}>\n            <DropdownMenu.Trigger asChild>\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadercellrenderer.tsx_143\"\n                size=\"small\"\n                icon={<OverflowIcon />}\n              />\n            </DropdownMenu.Trigger>\n            <DropdownMenu.Content>\n              <DropdownMenu.Item onClick={() => onDuplicateRun(run)}>\n                <FormattedMessage\n                  defaultMessage=\"Duplicate run\"\n                  description='Experiment page > artifact compare view > run column header > \"duplicate run\" button label'\n                />\n              </DropdownMenu.Item>\n            </DropdownMenu.Content>\n          </DropdownMenu.Root>\n        )}\n      </div>\n\n      {shouldEnablePromptLab() && canEvaluateOnRun(run) ? (\n        <EvaluationRunHeaderModelIndicator run={run} />\n      ) : (\n        <EvaluationRunHeaderDatasetIndicator run={run} onDatasetSelected={onDatasetSelected} />\n      )}\n    </EvaluationTableHeader>\n  );\n};\n","import { Button, InfoIcon, PlayIcon, RefreshIcon, Tooltip } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { usePromptEngineeringContext } from '../contexts/PromptEngineeringContext';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport { canEvaluateOnRun } from '../../prompt-engineering/PromptEngineering.utils';\n\n/**\n * Displays multiple variants of \"(re)evaluate\" button within the artifact comparison table\n */\nexport const EvaluationCellEvaluateButton = ({\n  disabled,\n  isLoading,\n  run,\n  rowKey,\n}: {\n  disabled?: boolean;\n  isLoading: boolean;\n  rowKey: string;\n  run: RunRowType;\n}) => {\n  const isRunEvaluable = canEvaluateOnRun(run);\n  const { evaluateCell, getMissingParams } = usePromptEngineeringContext();\n\n  const missingParamsToEvaluate = (run && getMissingParams(run, rowKey)) || null;\n\n  if (missingParamsToEvaluate && missingParamsToEvaluate.length > 0) {\n    return (\n      <Tooltip\n        title={\n          <FormattedMessage\n            description=\"Experiment page > artifact compare view > text cell > missing evaluation parameter values tooltip\"\n            defaultMessage='Evaluation is not possible because values for the following inputs cannot be determined: {missingParamList}. Add input columns to the \"group by\" settings or use \"Add row\" button to define new parameter set.'\n            values={{\n              missingParamList: <code>{missingParamsToEvaluate.join(', ')}</code>,\n            }}\n          />\n        }\n      >\n        <InfoIcon />\n      </Tooltip>\n    );\n  }\n\n  if (!isRunEvaluable) {\n    return (\n      <Tooltip\n        title={\n          <FormattedMessage\n            description=\"Experiment page > artifact compare view > text cell > run not evaluable tooltip\"\n            defaultMessage=\"You cannot evaluate this cell, this run was not created using served LLM model route\"\n          />\n        }\n      >\n        <InfoIcon />\n      </Tooltip>\n    );\n  }\n  return (\n    <Button\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationcellevaluatebutton.tsx_59\"\n      loading={isLoading}\n      disabled={disabled}\n      size=\"small\"\n      onMouseDownCapture={(e) => e.stopPropagation()}\n      onClickCapture={(e) => {\n        e.stopPropagation();\n        evaluateCell(run, rowKey);\n      }}\n      icon={<PlayIcon />}\n    >\n      <>Evaluate</>\n    </Button>\n  );\n};\n","import { TableSkeleton, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport type { ICellRendererParams } from '@ag-grid-community/core';\nimport { FormattedMessage } from 'react-intl';\nimport React from 'react';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport { usePromptEngineeringContext } from '../contexts/PromptEngineeringContext';\nimport { useSelector } from 'react-redux';\nimport { ReduxState } from '../../../../redux-types';\nimport { EvaluationCellEvaluateButton } from './EvaluationCellEvaluateButton';\nimport { shouldEnablePromptLab } from '../../../../common/utils/FeatureUtils';\nimport { UseEvaluationArtifactTableDataResult } from '../hooks/useEvaluationArtifactTableData';\nimport { JsonPreview } from '../../../../common/components/JsonFormatting';\n\n// Truncate the text in the cell, it doesn't make sense to populate\n// more data into the DOM since cells have hidden overflow anyway\nconst MAX_TEXT_LENGTH = 512;\n\ninterface EvaluationTextCellRendererProps extends ICellRendererParams {\n  value: string;\n  isGroupByColumn?: boolean;\n  context: { highlightedText: string };\n\n  data: UseEvaluationArtifactTableDataResult extends (infer U)[] ? U : UseEvaluationArtifactTableDataResult;\n\n  // Valid only for run columns\n  run?: RunRowType;\n}\n\n/**\n * Internal use component - breaks down the rendered text into chunks and highlights\n * particular part found by the provided substring.\n */\nconst HighlightedText = React.memo(({ text, highlight }: { text: string; highlight: string }) => {\n  const { theme } = useDesignSystemTheme();\n  if (!highlight) {\n    return <>{text}</>;\n  }\n\n  const parts = text.split(new RegExp(`(${highlight})`, 'gi'));\n\n  return (\n    <>\n      {parts.map((part, i) => (\n        <React.Fragment key={i}>\n          {part.toLowerCase() === highlight.toLowerCase() ? (\n            <span css={{ backgroundColor: theme.colors.yellow200 }}>{part}</span>\n          ) : (\n            part\n          )}\n        </React.Fragment>\n      ))}\n    </>\n  );\n});\n\n/**\n * Component used to render a single text cell in the evaluation artifacts comparison table.\n */\n/* eslint-disable complexity */\nexport const EvaluationTextCellRenderer = ({\n  value,\n  context,\n  isGroupByColumn,\n  run,\n  data,\n}: EvaluationTextCellRendererProps) => {\n  const { theme } = useDesignSystemTheme();\n  const { pendingDataLoading, canEvaluateInRunColumn } = usePromptEngineeringContext();\n  const isGatewayRoutesLoading = useSelector(\n    ({ modelGateway: { modelGatewayRoutesLoading, modelGatewayRoutesLoadingLegacy } }: ReduxState) => {\n      return modelGatewayRoutesLoading.loading;\n    },\n  );\n\n  const isCellEvaluating = run && pendingDataLoading[run.runUuid]?.[data?.key];\n  const outputMetadata = (run && data.outputMetadataByRunUuid?.[run.runUuid]) || null;\n\n  const backgroundColor =\n    outputMetadata?.isPending || data.isPendingInputRow\n      ? theme.colors.backgroundSecondary\n      : theme.colors.backgroundPrimary;\n\n  const structuredJSONValue = React.useMemo(() => {\n    try {\n      const objectData = JSON.parse(value);\n      return objectData;\n    } catch (e) {\n      return null;\n    }\n  }, [value]);\n\n  return (\n    <div\n      css={{\n        height: '100%',\n        whiteSpace: 'normal',\n        padding: theme.spacing.sm,\n        overflow: 'hidden',\n        position: 'relative',\n        cursor: 'pointer',\n        backgroundColor,\n        '&:hover': {\n          backgroundColor: theme.colors.actionDefaultBackgroundHover,\n        },\n      }}\n    >\n      {isCellEvaluating ? (\n        <TableSkeleton lines={3} />\n      ) : (\n        <>\n          {!value ? (\n            <Typography.Text color=\"info\" css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>\n              <FormattedMessage\n                defaultMessage=\"(empty)\"\n                description=\"Experiment page > artifact compare view > results table > no result (empty cell)\"\n              />\n            </Typography.Text>\n          ) : structuredJSONValue ? (\n            <JsonPreview json={JSON.stringify(structuredJSONValue, null, 2)} />\n          ) : (\n            <span\n              css={{\n                display: '-webkit-box',\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                '-webkit-box-orient': 'vertical',\n                '-webkit-line-clamp': '7',\n              }}\n            >\n              {isGroupByColumn && context.highlightedText ? (\n                <HighlightedText text={value} highlight={context.highlightedText} />\n              ) : typeof value === 'string' ? (\n                value.substring(0, MAX_TEXT_LENGTH)\n              ) : (\n                /**\n                 * There is a transient state when this value is an object used\n                 * for EvaluationImageCellRenderer. This will prevent displaying\n                 * [object Object] in the cell and cause AgGrid errors.\n                 */\n                typeof value !== 'object' && value\n              )}\n            </span>\n          )}\n        </>\n      )}\n      {shouldEnablePromptLab() && run && canEvaluateInRunColumn(run) && (\n        <div\n          css={{\n            position: 'absolute',\n            left: 8,\n            bottom: 8,\n            right: 8,\n            display: 'flex',\n            gap: theme.spacing.sm,\n            alignItems: 'center',\n            justifyContent: 'space-between',\n          }}\n        >\n          <div css={{ display: 'flex', alignItems: 'center', gap: theme.spacing.xs }}>\n            {!value && (\n              <EvaluationCellEvaluateButton\n                disabled={isCellEvaluating}\n                isLoading={isGatewayRoutesLoading}\n                run={run}\n                rowKey={data.key}\n              />\n            )}\n            {(outputMetadata?.isPending || data.isPendingInputRow) && (\n              <Typography.Hint size=\"sm\" css={{ fontStyle: 'italic' }}>\n                <FormattedMessage\n                  defaultMessage=\"Unsaved\"\n                  description=\"Experiment page > artifact compare view > results table > unsaved indicator\"\n                />\n              </Typography.Hint>\n            )}\n          </div>\n          {outputMetadata && !isCellEvaluating && (\n            <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n              {outputMetadata.evaluationTime && (\n                <Typography.Hint size=\"sm\">\n                  {Math.round(outputMetadata.evaluationTime)} ms\n                  {outputMetadata.totalTokens ? ',' : ''}\n                </Typography.Hint>\n              )}\n              {outputMetadata.totalTokens && (\n                <Typography.Hint size=\"sm\">\n                  <FormattedMessage\n                    defaultMessage=\"{totalTokens} total tokens\"\n                    description=\"Experiment page > artifact compare view > results table > total number of evaluated tokens\"\n                    values={{ totalTokens: outputMetadata.totalTokens }}\n                  />\n                </Typography.Hint>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n","export const EVALUATION_ARTIFACTS_TEXT_COLUMN_WIDTH = {\n  // Default width of \"group by\" columns\n  initialWidthGroupBy: 200,\n  // Default width of \"compare\" (output) columns\n  initialWidthOutput: 360,\n  maxWidth: 500,\n  minWidth: 140,\n};\nexport const EVALUATION_ARTIFACTS_RUN_NAME_HEIGHT = 40;\nexport const EVALUATION_ARTIFACTS_TABLE_ROW_HEIGHT = 190;\n\nexport const getEvaluationArtifactsTableHeaderHeight = (isExpanded = false, includePlaceForMetadata = false) => {\n  // If there is no metadata displayed at all, prepare\n  // 40 px for group header plus 40 px for the run name\n  if (!includePlaceForMetadata) {\n    return 80;\n  }\n\n  // If there's a metadata to be displayed, base the resulting height\n  // on the header expansion. Pixel values according to designs.\n  return 40 + (isExpanded ? 175 : 62);\n};\n","import { IHeaderParams } from '@ag-grid-community/core';\nimport { Tooltip, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { truncate } from 'lodash';\nimport { EvaluationTableHeader } from './EvaluationTableHeader';\n\ninterface EvaluationGroupByHeaderCellRendererProps extends IHeaderParams {\n  displayName: string;\n  onAddNewInputs: () => void;\n  displayAddNewInputsButton?: boolean;\n}\n\n/**\n * Component used as a column header for \"group by\" columns\n */\nexport const EvaluationGroupByHeaderCellRenderer = ({ displayName }: EvaluationGroupByHeaderCellRendererProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <EvaluationTableHeader css={{ justifyContent: 'flex-start', padding: theme.spacing.sm }}>\n      <Tooltip title={truncate(displayName, { length: 250 })}>\n        <Typography.Text bold css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>\n          {displayName}\n        </Typography.Text>\n      </Tooltip>\n    </EvaluationTableHeader>\n  );\n};\n","import { Input, Modal, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useCallback, useMemo, useState } from 'react';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport { uniq, compact } from 'lodash';\nimport { canEvaluateOnRun, extractRequiredInputParamsForRun } from '../../prompt-engineering/PromptEngineering.utils';\nimport { FormattedMessage } from 'react-intl';\n\nconst MAX_RUN_NAMES = 5;\n\nexport const useEvaluationAddNewInputsModal = () => {\n  const [modalVisible, setModalVisible] = useState(false);\n  const [requiredInputKeys, setRequiredInputKeys] = useState<\n    {\n      inputName: string;\n      runNames: string[];\n    }[]\n  >([]);\n  const [inputValues, setInputValues] = useState<Record<string, string>>({});\n\n  const allValuesProvided = useMemo(\n    () => requiredInputKeys.every(({ inputName }) => inputValues[inputName]),\n    [inputValues, requiredInputKeys],\n  );\n\n  const [successCallback, setSuccessCallback] = useState<(providedParamValues: Record<string, string>) => void>(\n    async () => {},\n  );\n\n  const setInputValue = useCallback((key: string, value: string) => {\n    setInputValues((values) => ({ ...values, [key]: value }));\n  }, []);\n\n  const showAddNewInputsModal = useCallback(\n    (runs: RunRowType[], onSuccess: (providedParamValues: Record<string, string>) => void) => {\n      const requiredInputsForRuns = runs.filter(canEvaluateOnRun).map((run) => ({\n        runName: run.runName,\n        params: extractRequiredInputParamsForRun(run),\n      }));\n      const inputValuesWithRunNames = uniq(requiredInputsForRuns.map(({ params }) => params).flat()).map(\n        (inputName) => ({\n          inputName,\n          runNames: compact(\n            requiredInputsForRuns.filter((r) => r.params.includes(inputName)).map(({ runName }) => runName),\n          ),\n        }),\n      );\n      setModalVisible(true);\n      setRequiredInputKeys(inputValuesWithRunNames);\n      setInputValues({});\n      setSuccessCallback(() => onSuccess);\n    },\n    [],\n  );\n  const { theme } = useDesignSystemTheme();\n\n  const AddNewInputsModal = (\n    <Modal\n      title={\n        <FormattedMessage\n          defaultMessage=\"Add row\"\n          description='Experiment page > artifact compare view > \"add new row\" modal title'\n        />\n      }\n      okButtonProps={{ disabled: !allValuesProvided }}\n      okText={\n        <FormattedMessage\n          // TODO(ML-32664): Implement \"Submit and evaluate\" that evaluates entire row\n          defaultMessage=\"Submit\"\n          description='Experiment page > artifact compare view > \"add new row\" modal submit button label'\n        />\n      }\n      cancelText={\n        <FormattedMessage\n          defaultMessage=\"Cancel\"\n          description='Experiment page > artifact compare view > \"add new row\" modal cancel button label'\n        />\n      }\n      onOk={() => {\n        successCallback(inputValues);\n        setModalVisible(false);\n      }}\n      visible={modalVisible}\n      onCancel={() => setModalVisible(false)}\n    >\n      {requiredInputKeys.map(({ inputName, runNames }) => (\n        <div key={inputName} css={{ marginBottom: theme.spacing.md }}>\n          <Typography.Text bold>{inputName}</Typography.Text>\n          <Typography.Hint css={{ whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>\n            <FormattedMessage\n              defaultMessage=\"Used by {runNames} {hasMore, select, true {and other runs} other {}}\"\n              description=\"Experiment page > artifact compare view > label indicating which runs are using particular input field\"\n              values={{\n                runNames: runNames.slice(0, MAX_RUN_NAMES).join(', '),\n                hasMore: runNames.length > MAX_RUN_NAMES,\n              }}\n            />\n          </Typography.Hint>\n          <div css={{ marginTop: theme.spacing.sm }}>\n            <Input.TextArea value={inputValues[inputName]} onChange={(e) => setInputValue(inputName, e.target.value)} />\n          </div>\n        </div>\n      ))}\n    </Modal>\n  );\n  return { showAddNewInputsModal, AddNewInputsModal };\n};\n","import { Button, ChevronDownIcon, ChevronRightIcon, Tooltip } from '@databricks/design-system';\nimport { EvaluationTableHeader } from './EvaluationTableHeader';\nimport { usePromptEngineeringContext } from '../contexts/PromptEngineeringContext';\nimport { FormattedMessage } from 'react-intl';\n\nconst enlargedIconStyle = { svg: { width: 20, height: 20 } };\n\nexport const EvaluationTableActionsColumnRenderer = () => {\n  const { toggleExpandedHeader, isHeaderExpanded } = usePromptEngineeringContext();\n\n  return (\n    <EvaluationTableHeader>\n      <Tooltip\n        placement=\"right\"\n        title={\n          <FormattedMessage\n            defaultMessage=\"Toggle detailed view\"\n            description='Experiment page > artifact compare view > table header > label for \"toggle detailed view\" button'\n          />\n        }\n      >\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationtableactionscolumnrenderer.tsx_22\"\n          icon={\n            isHeaderExpanded ? (\n              <ChevronDownIcon css={enlargedIconStyle} />\n            ) : (\n              <ChevronRightIcon css={enlargedIconStyle} />\n            )\n          }\n          onClick={toggleExpandedHeader}\n        />\n      </Tooltip>\n    </EvaluationTableHeader>\n  );\n};\n","import { Button, PlusIcon, Tooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\n\ninterface EvaluationTableActionsCellRendererProps {\n  onAddNewInputs: () => void;\n  displayAddNewInputsButton: boolean;\n}\n\nexport const EvaluationTableActionsCellRenderer = ({\n  onAddNewInputs,\n  displayAddNewInputsButton,\n}: EvaluationTableActionsCellRendererProps) => {\n  const { theme } = useDesignSystemTheme();\n  if (!displayAddNewInputsButton) {\n    return null;\n  }\n\n  return (\n    <div\n      css={{\n        width: '100%',\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column',\n        padding: theme.spacing.xs,\n      }}\n    >\n      <Tooltip\n        placement=\"right\"\n        title={\n          <FormattedMessage\n            defaultMessage=\"Add row\"\n            description=\"Experiment page > artifact compare view > add new row button\"\n          />\n        }\n      >\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationtableactionscellrenderer.tsx_37\"\n          icon={<PlusIcon />}\n          onClick={onAddNewInputs}\n        />\n      </Tooltip>\n    </div>\n  );\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport type { ICellRendererParams } from '@ag-grid-community/core';\nimport { FormattedMessage } from 'react-intl';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport { UseEvaluationArtifactTableDataResult } from '../hooks/useEvaluationArtifactTableData';\nimport { ImagePlot } from 'experiment-tracking/components/runs-charts/components/charts/ImageGridPlot.common';\nimport { EvaluateCellImage } from 'experiment-tracking/types';\n\ninterface EvaluationImageCellRendererProps extends ICellRendererParams {\n  value: EvaluateCellImage;\n  isGroupByColumn?: boolean;\n  context: { highlightedText: string };\n\n  data: UseEvaluationArtifactTableDataResult extends (infer U)[] ? U : UseEvaluationArtifactTableDataResult;\n\n  // Valid only for run columns\n  run?: RunRowType;\n}\n\n/**\n * Component used to render a single text cell in the evaluation artifacts comparison table.\n */\n/* eslint-disable complexity */\nexport const EvaluationImageCellRenderer = ({ value }: EvaluationImageCellRendererProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const backgroundColor = theme.colors.backgroundPrimary;\n\n  return (\n    <div\n      css={{\n        height: '100%',\n        whiteSpace: 'normal',\n        padding: theme.spacing.sm,\n        overflow: 'hidden',\n        position: 'relative',\n        cursor: 'pointer',\n        backgroundColor,\n        '&:hover': {\n          backgroundColor: theme.colors.actionDefaultBackgroundHover,\n        },\n      }}\n    >\n      {!value || !value.url || !value.compressed_url ? (\n        <Typography.Text color=\"info\" css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>\n          <FormattedMessage\n            defaultMessage=\"(empty)\"\n            description=\"Experiment page > artifact compare view > results table > no result (empty cell)\"\n          />\n        </Typography.Text>\n      ) : (\n        <span\n          css={{\n            display: '-webkit-box',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            '-webkit-box-orient': 'vertical',\n            '-webkit-line-clamp': '7',\n            width: '100%',\n            height: '100%',\n          }}\n        >\n          <ImagePlot imageUrl={value.url} compressedImageUrl={value.compressed_url} />\n        </span>\n      )}\n    </div>\n  );\n};\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\nimport { UseEvaluationArtifactTableDataResult } from '../hooks/useEvaluationArtifactTableData';\nimport { CellClickedEvent, ColDef, GridApi } from '@ag-grid-community/core';\nimport { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { MLFlowAgGridLoader } from '../../../../common/components/ag-grid/AgGridLoader';\nimport { EvaluationRunHeaderCellRenderer } from './EvaluationRunHeaderCellRenderer';\nimport { EvaluationTextCellRenderer } from './EvaluationTextCellRenderer';\nimport {\n  EVALUATION_ARTIFACTS_TABLE_ROW_HEIGHT,\n  EVALUATION_ARTIFACTS_TEXT_COLUMN_WIDTH,\n  getEvaluationArtifactsTableHeaderHeight,\n} from '../EvaluationArtifactCompare.utils';\nimport { EvaluationGroupByHeaderCellRenderer } from './EvaluationGroupByHeaderCellRenderer';\nimport type { Theme } from '@emotion/react';\nimport type { RunDatasetWithTags } from '../../../types';\nimport { useEvaluationAddNewInputsModal } from '../hooks/useEvaluationAddNewInputsModal';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ReduxState, ThunkDispatch } from '../../../../redux-types';\nimport { evaluateAddInputValues } from '../../../actions/PromptEngineeringActions';\nimport { canEvaluateOnRun, extractRequiredInputParamsForRun } from '../../prompt-engineering/PromptEngineering.utils';\nimport { useIntl } from 'react-intl';\nimport { usePromptEngineeringContext } from '../contexts/PromptEngineeringContext';\nimport { EvaluationTableHeader } from './EvaluationTableHeader';\nimport { EvaluationTableActionsColumnRenderer } from './EvaluationTableActionsColumnRenderer';\nimport { EvaluationTableActionsCellRenderer } from './EvaluationTableActionsCellRenderer';\nimport { shouldEnablePromptLab } from '../../../../common/utils/FeatureUtils';\nimport { useCreateNewRun } from '../../experiment-page/hooks/useCreateNewRun';\nimport { EvaluationImageCellRenderer } from './EvaluationImageCellRenderer';\n\nexport interface EvaluationArtifactCompareTableProps {\n  resultList: UseEvaluationArtifactTableDataResult;\n  visibleRuns: RunRowType[];\n  groupByColumns: string[];\n  onCellClick?: (value: string, columnHeader: string) => void;\n  onHideRun: (runUuid: string) => void;\n  onDatasetSelected: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n  highlightedText: string;\n  isPreviewPaneVisible?: boolean;\n  outputColumnName: string;\n  isImageColumn: boolean;\n}\n\nexport const EvaluationArtifactCompareTable = ({\n  resultList,\n  visibleRuns,\n  groupByColumns,\n  onCellClick,\n  onHideRun,\n  onDatasetSelected,\n  highlightedText = '',\n  isPreviewPaneVisible,\n  outputColumnName,\n  isImageColumn,\n}: EvaluationArtifactCompareTableProps) => {\n  const [columns, setColumns] = useState<ColDef[]>([]);\n\n  const [gridApi, setGridApi] = useState<GridApi | null>(null);\n  const pendingData = useSelector(({ evaluationData }: ReduxState) => evaluationData.evaluationPendingDataByRunUuid);\n  const gridWrapperRef = useRef<HTMLDivElement>(null);\n\n  const { isHeaderExpanded } = usePromptEngineeringContext();\n  const { createNewRun } = useCreateNewRun();\n\n  // Before hiding or duplicating the run, let's refresh the header to mitigate ag-grid's\n  // bug where it fails to defocus cell after the whole table has been hidden.\n  const handleHideRun = useCallback(\n    (runUuid: string) => {\n      gridApi?.refreshHeader();\n      onHideRun(runUuid);\n    },\n    [gridApi, onHideRun],\n  );\n\n  const handleDuplicateRun = useCallback(\n    (runToDuplicate?: RunRowType) => {\n      gridApi?.refreshHeader();\n      createNewRun(runToDuplicate);\n    },\n    [createNewRun, gridApi],\n  );\n\n  useEffect(() => {\n    if (gridApi && !isPreviewPaneVisible) {\n      gridApi.clearFocusedCell();\n    }\n  }, [gridApi, isPreviewPaneVisible]);\n\n  // Force-refresh visible cells' values when some pending data have changes\n  // either by loading new data or discarding values. This makes sure\n  // that even if the prompt evaluates to the same value, the grid still refreshes.\n  useEffect(() => {\n    if (!gridApi) {\n      return;\n    }\n    const visibleRows = gridApi.getRenderedNodes();\n    gridApi.refreshCells({ force: true, rowNodes: visibleRows });\n  }, [gridApi, pendingData, highlightedText]);\n\n  const { showAddNewInputsModal, AddNewInputsModal } = useEvaluationAddNewInputsModal();\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const scrollGridToTop = useCallback(() => {\n    // Find the scrollable viewport element\n    const gridViewport = gridWrapperRef.current?.querySelector('.ag-body-viewport');\n    if (gridViewport) {\n      gridViewport.scrollTo({ top: 0, behavior: 'smooth' });\n    } else {\n      // If for some reason there's no element, use native jumpy method\n      gridApi?.ensureIndexVisible(0, 'top');\n    }\n  }, [gridApi]);\n\n  const displayAddNewInputsButton = useMemo(\n    // TODO(ML-32969): count prompt-engineered runs based on tags\n    () => visibleRuns.map(extractRequiredInputParamsForRun).flat().length > 0,\n    [visibleRuns],\n  );\n\n  const onAddNewInputs = useCallback(() => {\n    showAddNewInputsModal(visibleRuns, (values) => {\n      dispatch(evaluateAddInputValues(values));\n      // Scroll the grid to the top after adding new row\n      scrollGridToTop();\n    });\n  }, [scrollGridToTop, showAddNewInputsModal, dispatch, visibleRuns]);\n\n  const { theme } = useDesignSystemTheme();\n  const intl = useIntl();\n\n  const handleCellClicked = useCallback(\n    ({ value, colDef, column }: CellClickedEvent) => {\n      const emptyMessage = intl.formatMessage({\n        defaultMessage: '(empty)',\n        description: 'Experiment page > artifact compare view > results table > no result (empty cell)',\n      });\n      return onCellClick?.(value || emptyMessage, colDef.headerName || column.getId());\n    },\n    [intl, onCellClick],\n  );\n\n  const outputColumnIndicator = useMemo(\n    () => <Typography.Text bold>{outputColumnName}</Typography.Text>,\n    [outputColumnName],\n  );\n\n  useEffect(() => {\n    const cols: ColDef[] = [];\n\n    const { initialWidthGroupBy, initialWidthOutput, maxWidth, minWidth } = EVALUATION_ARTIFACTS_TEXT_COLUMN_WIDTH;\n\n    if (shouldEnablePromptLab() && visibleRuns.some((run) => canEvaluateOnRun(run))) {\n      cols.push({\n        resizable: false,\n        pinned: true,\n        width: 40,\n        headerComponent: 'ActionsColumnRenderer',\n        cellRendererSelector: ({ rowIndex }) =>\n          rowIndex === 0\n            ? {\n                component: 'ActionsCellRenderer',\n                params: {\n                  displayAddNewInputsButton,\n                  onAddNewInputs,\n                },\n              }\n            : undefined,\n        cellClass: 'leading-column-cell',\n      });\n    }\n\n    groupByColumns.forEach((col, index) => {\n      const isLastGroupByColumns = index === groupByColumns.length - 1;\n      cols.push({\n        resizable: true,\n        initialWidth: initialWidthGroupBy,\n        minWidth,\n        maxWidth,\n        headerName: col,\n        valueGetter: ({ data }) => data.groupByCellValues[col],\n        suppressMovable: true,\n        cellRenderer: 'TextRendererCellRenderer',\n        headerClass: isLastGroupByColumns ? 'last-group-by-header-cell' : undefined,\n        cellRendererParams: {\n          isGroupByColumn: true,\n        },\n        headerComponent: 'GroupHeaderCellRenderer',\n        headerComponentParams: {\n          displayAddNewInputsButton,\n          onAddNewInputs,\n        },\n        colId: col,\n        onCellClicked: handleCellClicked,\n      });\n    });\n\n    visibleRuns.forEach((run, index) => {\n      const isFirstColumn = index === 0;\n      cols.push({\n        resizable: true,\n        initialWidth: initialWidthOutput,\n        minWidth,\n        maxWidth,\n        headerName: run.runName,\n        colId: run.runUuid,\n        valueGetter: ({ data }) => data.cellValues[run.runUuid],\n        suppressMovable: true,\n        cellRenderer: isImageColumn ? 'ImageRendererCellRenderer' : 'TextRendererCellRenderer',\n        cellRendererParams: {\n          run,\n        },\n        headerComponent: 'RunHeaderCellRenderer',\n        headerComponentParams: {\n          run,\n          onDuplicateRun: handleDuplicateRun,\n          onHideRun: handleHideRun,\n          onDatasetSelected,\n          groupHeaderContent: isFirstColumn ? outputColumnIndicator : null,\n        },\n        onCellClicked: handleCellClicked,\n      });\n    });\n\n    setColumns(cols);\n  }, [\n    visibleRuns,\n    groupByColumns,\n    handleHideRun,\n    handleDuplicateRun,\n    onDatasetSelected,\n    onAddNewInputs,\n    displayAddNewInputsButton,\n    handleCellClicked,\n    outputColumnIndicator,\n    isImageColumn,\n  ]);\n\n  useEffect(() => {\n    if (!gridApi) {\n      return;\n    }\n\n    // Check if we need to have a tall header, i.e. if we have any runs\n    // with datasets or with evaluation metadata\n    const runsContainHeaderMetadata = visibleRuns.some((run) => canEvaluateOnRun(run) || run.datasets?.length > 0);\n\n    // Set header height dynamically\n    gridApi.setHeaderHeight(getEvaluationArtifactsTableHeaderHeight(isHeaderExpanded, runsContainHeaderMetadata));\n  }, [gridApi, isHeaderExpanded, visibleRuns]);\n\n  return (\n    <div css={{ height: '100%', overflow: 'hidden' }} ref={gridWrapperRef}>\n      <MLFlowAgGridLoader\n        css={createTableStyles(theme)}\n        context={{ highlightedText }}\n        rowHeight={EVALUATION_ARTIFACTS_TABLE_ROW_HEIGHT}\n        onGridReady={({ api }) => setGridApi(api)}\n        getRowId={({ data }) => data.key}\n        suppressHorizontalScroll={false}\n        columnDefs={columns}\n        rowData={resultList}\n        components={{\n          TextRendererCellRenderer: EvaluationTextCellRenderer,\n          GroupHeaderCellRenderer: EvaluationGroupByHeaderCellRenderer,\n          RunHeaderCellRenderer: EvaluationRunHeaderCellRenderer,\n          ActionsColumnRenderer: EvaluationTableActionsColumnRenderer,\n          ActionsCellRenderer: EvaluationTableActionsCellRenderer,\n          ImageRendererCellRenderer: EvaluationImageCellRenderer,\n        }}\n      />\n      {AddNewInputsModal}\n    </div>\n  );\n};\n\nconst createTableStyles = (theme: Theme) => ({\n  '.ag-row:not(.ag-row-first), .ag-body-viewport': {\n    borderTop: `1px solid ${theme.colors.borderDecorative}`,\n  },\n  '.ag-row-last': {\n    borderBottom: `1px solid ${theme.colors.borderDecorative}`,\n  },\n  '.ag-cell, .last-group-by-header-cell .header-group-cell': {\n    borderRight: `1px solid ${theme.colors.borderDecorative}`,\n  },\n  '.ag-cell-focus:not(.leading-column-cell)::after': {\n    content: '\"\"',\n    position: 'absolute' as const,\n    inset: 0,\n    boxShadow: `inset 0 0 0px 2px ${theme.colors.blue300}`,\n    pointerEvents: 'none' as const,\n  },\n});\n","import { fromPairs, isNil, isObject, isString, sortBy } from 'lodash';\nimport { useMemo } from 'react';\n\nimport {\n  ArtifactLogTableImageObject,\n  EvaluateCellImage,\n  EvaluationArtifactTableEntry,\n  PendingEvaluationArtifactTableEntry,\n} from '../../../types';\nimport type { EvaluationDataReduxState } from '../../../reducers/EvaluationDataReducer';\nimport { shouldEnablePromptLab } from '../../../../common/utils/FeatureUtils';\nimport {\n  PROMPTLAB_METADATA_COLUMN_LATENCY,\n  PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS,\n} from '../../prompt-engineering/PromptEngineering.utils';\nimport { LOG_TABLE_IMAGE_COLUMN_TYPE } from 'experiment-tracking/constants';\nimport { getArtifactLocationUrl } from 'common/utils/ArtifactUtils';\n\ntype ArtifactsByRun = EvaluationDataReduxState['evaluationArtifactsByRunUuid'];\ntype PendingDataByRun = EvaluationDataReduxState['evaluationPendingDataByRunUuid'];\ntype DraftInputValues = EvaluationDataReduxState['evaluationDraftInputValues'];\n\nexport type UseEvaluationArtifactTableDataResult = {\n  // Unique key for every result row\n  key: string;\n\n  // Values of \"group by\" columns. The column name is the key.\n  groupByCellValues: Record<string, string>;\n\n  // Values of output columns. The run uuid is the key.\n  cellValues: Record<string, string | EvaluateCellImage>;\n\n  // Contains data describing additional metadata for output: evaluation time, total tokens and a flag\n  // indicating if the run was evaluated in this session and is unsynced\n  outputMetadataByRunUuid?: Record<string, { isPending: boolean; evaluationTime: number; totalTokens?: number }>;\n\n  isPendingInputRow?: boolean;\n}[];\n\nconst extractGroupByValuesFromEntry = (entry: EvaluationArtifactTableEntry, groupByCols: string[]) => {\n  const groupByMappings = groupByCols.map<[string, string]>((groupBy) => {\n    const value = entry[groupBy];\n    return [groupBy, isString(value) ? value : JSON.stringify(value)];\n  });\n\n  // Next, let's calculate a unique hash for values of those columns - it will serve as\n  // an identifier of each result row.\n  const groupByHashKey = groupByMappings.map(([, keyValue]) => String(keyValue)).join('.');\n\n  return { key: groupByHashKey, groupByValues: fromPairs(groupByMappings) };\n};\n\n/**\n * Consumes table artifact data and based on provided dimensions,\n * generates the data ready to be displayed in the comparison data grid.\n *\n * @param artifactsByRun artifacts-by-run data (extracted from the redux store)\n * @param comparedRunsUuids UUIDs of runs we want to compare\n * @param tableNames table names we want to include in the comparison\n * @param groupByCols list of columns that will be used to group the results by\n * @param outputColumn selects the column to be displayed in the run\n */\nexport const useEvaluationArtifactTableData = (\n  artifactsByRun: ArtifactsByRun,\n  pendingDataByRun: PendingDataByRun,\n  draftInputValues: DraftInputValues,\n  comparedRunsUuids: string[],\n  tableNames: string[],\n  groupByCols: string[],\n  outputColumn: string,\n): UseEvaluationArtifactTableDataResult =>\n  // eslint-disable-next-line complexity\n  useMemo(() => {\n    /**\n     * End results, i.e. table rows\n     */\n    const results: UseEvaluationArtifactTableDataResult = [];\n\n    /**\n     * An aggregate object containing all output column values.\n     * The first level key is the combined hash of all group by values,\n     * the second level key is the run UUID. A leaf of this tree corresponds to the output cell value.\n     */\n    const outputCellsValueMap: Record<string, Record<string, any>> = {};\n\n    /**\n     * An aggregate object containing values of the \"group by\" columns.\n     * The first level key is the combined hash of all group by values,\n     * the second level key is the \"group by\" column name. A leaf of this tree corresponds to the cell value.\n     */\n    const groupByCellsValueMap: Record<string, Record<string, any>> = {};\n\n    /**\n     * This array contains all \"group by\" keys that were freshly added or evaluated, i.e. they are not found\n     * in the original evaluation data. This helps to identify them, place them on the top and indicate\n     * they're yet to be synchronized.\n     */\n    const pendingRowKeys: string[] = [];\n\n    /**\n     * Start with populating the table with the draft rows created from the draft input sets\n     */\n    for (const draftInputValueSet of draftInputValues) {\n      const visibleGroupByValues = groupByCols.map((colName) => [colName, draftInputValueSet[colName]]);\n\n      const draftInputRowKey = visibleGroupByValues.map(([, value]) => value).join('.');\n\n      // Register new \"group by\" values combination and mark it as an artificial row\n      groupByCellsValueMap[draftInputRowKey] = fromPairs(visibleGroupByValues);\n      pendingRowKeys.push(draftInputRowKey);\n    }\n\n    const outputMetadataByCellsValueMap: Record<\n      string,\n      Record<string, { isPending: boolean; evaluationTime: number; totalTokens?: number }>\n    > = {};\n\n    // Search through artifact tables and get all entries corresponding to a particular run\n    const runsWithEntries = comparedRunsUuids.map<[string, EvaluationArtifactTableEntry[]]>((runUuid) => {\n      const baseEntries = Object.values(artifactsByRun[runUuid] || {})\n        .filter(({ path }) => tableNames.includes(path))\n        .map(({ entries }) => entries)\n        .flat();\n      return [runUuid, baseEntries];\n    });\n\n    // Iterate through all entries and assign them to the corresponding groups.\n    for (const [runUuid, entries] of runsWithEntries) {\n      for (const entry of entries) {\n        const { key, groupByValues } = extractGroupByValuesFromEntry(entry, groupByCols);\n\n        // Do not process the entry that have empty values for all active \"group by\" columns\n        if (Object.values(groupByValues).every((value) => !value)) {\n          continue;\n        }\n\n        // Assign \"group by\" column cell values\n        if (!groupByCellsValueMap[key]) {\n          groupByCellsValueMap[key] = groupByValues;\n        }\n\n        // Check if there are values in promptlab metadata columns\n        if (entry[PROMPTLAB_METADATA_COLUMN_LATENCY] || entry[PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS]) {\n          if (!outputMetadataByCellsValueMap[key]) {\n            outputMetadataByCellsValueMap[key] = {};\n          }\n\n          // If true, save it to the record containing output metadata at the index\n          // corresponding to a current \"group by\" key (row) and the run uuid (column)\n          // Show the metadata of the most recent value\n          if (!outputMetadataByCellsValueMap[key][runUuid]) {\n            outputMetadataByCellsValueMap[key][runUuid] = {\n              isPending: false,\n              evaluationTime: parseFloat(entry[PROMPTLAB_METADATA_COLUMN_LATENCY]),\n              totalTokens: entry[PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS]\n                ? parseInt(entry[PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS], 10)\n                : undefined,\n            };\n          }\n        }\n\n        // Assign output column cell values\n        if (!outputCellsValueMap[key]) {\n          outputCellsValueMap[key] = {};\n        }\n\n        const cellsEntry = outputCellsValueMap[key];\n\n        // Use the data from the other set if present, but only if there\n        // is no value assigned already. This way we will proritize prepended values.\n        cellsEntry[runUuid] = cellsEntry[runUuid] || entry[outputColumn];\n      }\n    }\n\n    for (const [runUuid, pendingEntries] of Object.entries(pendingDataByRun)) {\n      for (const pendingEntry of pendingEntries) {\n        const { entryData, ...metadata } = pendingEntry;\n        const { key, groupByValues } = extractGroupByValuesFromEntry(entryData, groupByCols);\n\n        // Do not process the entry that have empty values for all active \"group by\" columns\n        if (Object.values(groupByValues).every((value) => !value)) {\n          continue;\n        }\n\n        // Assign \"group by\" column cell values\n        if (!groupByCellsValueMap[key]) {\n          groupByCellsValueMap[key] = groupByValues;\n\n          // If the key was not found in the original set, mark entire row as pending\n          pendingRowKeys.push(key);\n        }\n\n        if (!outputMetadataByCellsValueMap[key]) {\n          outputMetadataByCellsValueMap[key] = {};\n        }\n\n        // code pointer for where the metadat is stored\n        outputMetadataByCellsValueMap[key][runUuid] = metadata;\n\n        // Assign output column cell values\n        if (!outputCellsValueMap[key]) {\n          outputCellsValueMap[key] = {};\n        }\n\n        const cellsEntry = outputCellsValueMap[key];\n        // Use pending data to overwrite already existing result\n        cellsEntry[runUuid] = entryData[outputColumn] || cellsEntry[runUuid];\n      }\n    }\n\n    /**\n     * Extract all \"group by\" keys, i.e. effectively row keys.\n     * Hoist all rows that were created during the pending evaluation to the top.\n     */\n    const allRowKeys = sortBy(Object.entries(groupByCellsValueMap), ([key]) => !pendingRowKeys.includes(key));\n\n    // In the final step, iterate through all found combinations of \"group by\" values and\n    // assign the cells\n    for (const [key, groupByCellValues] of allRowKeys) {\n      const existingTableRow = results.find(({ key: existingKey }) => key === existingKey);\n      if (existingTableRow && outputCellsValueMap[key]) {\n        existingTableRow.cellValues = outputCellsValueMap[key];\n        existingTableRow.outputMetadataByRunUuid = outputMetadataByCellsValueMap[key];\n      } else {\n        const cellsEntry = outputCellsValueMap[key];\n        Object.keys(cellsEntry || {}).forEach((runUuid: string) => {\n          if (cellsEntry[runUuid] !== null && typeof cellsEntry[runUuid] === 'object') {\n            try {\n              const { type, filepath, compressed_filepath } = cellsEntry[runUuid] as ArtifactLogTableImageObject;\n              if (type === LOG_TABLE_IMAGE_COLUMN_TYPE) {\n                cellsEntry[runUuid] = {\n                  url: getArtifactLocationUrl(filepath, runUuid),\n                  compressed_url: getArtifactLocationUrl(compressed_filepath, runUuid),\n                };\n              } else {\n                cellsEntry[runUuid] = JSON.stringify(cellsEntry[runUuid]);\n              }\n            } catch {\n              cellsEntry[runUuid] = '';\n            }\n          } else if (!isNil(cellsEntry[runUuid]) && !isString(cellsEntry[runUuid])) {\n            // stringify non-empty values so that the value\n            // doesn't appear as (empty) in the output cell\n            // also don't stringify strings, since they'll have\n            // an extra quote around them\n            cellsEntry[runUuid] = JSON.stringify(cellsEntry[runUuid]);\n          }\n        });\n\n        results.push({\n          key,\n          groupByCellValues,\n          cellValues: outputCellsValueMap[key] || {},\n          outputMetadataByRunUuid: outputMetadataByCellsValueMap[key],\n          isPendingInputRow: pendingRowKeys.includes(key),\n        });\n      }\n    }\n\n    return results;\n  }, [comparedRunsUuids, artifactsByRun, groupByCols, draftInputValues, tableNames, outputColumn, pendingDataByRun]);\n","import userEvent from '@testing-library/user-event';\nimport { useEffect } from 'react';\n\ndeclare interface NavigatorWithUserData extends Navigator {\n  userAgentData: any;\n}\n\nconst isMacKeyboard = () =>\n  // userAgentData should be supported in modern Chromium based browsers\n  /mac/i.test((window.navigator as NavigatorWithUserData).userAgentData?.platform) ||\n  // if not, falls back to navigator.platform\n  /mac/i.test(window.navigator.platform);\n\nconst systemModifierKey: keyof KeyboardEvent = isMacKeyboard() ? 'metaKey' : 'ctrlKey';\n\n/**\n * Triggers certain action when a keyboard combination is pressed\n *\n * @example\n *\n * // Listens to CMD+S action\n * useBrowserKeyShortcutListener('s', { ctrlOrCmdKey: true }, () => { ... })\n */\nexport const useBrowserKeyShortcutListener = (\n  /**\n   * A single key (e.g. \"s\") that will be listened for pressing\n   */\n  key: string,\n  /**\n   * Determines which modifier keys are necessary to trigger the action\n   */\n  modifierKeys: { shiftKey?: boolean; ctrlOrCmdKey?: boolean; altOrOptKey?: boolean } = {},\n  /**\n   * A callback function. If returns true, the default action for the key combination will be prevented.\n   */\n  fn: () => boolean | void,\n) => {\n  const { altOrOptKey = false, ctrlOrCmdKey = false, shiftKey = false } = modifierKeys;\n  useEffect(() => {\n    const handler = (e: KeyboardEvent) => {\n      if (\n        (!ctrlOrCmdKey || e[systemModifierKey]) &&\n        (!altOrOptKey || e.altKey) &&\n        (!shiftKey || e.shiftKey) &&\n        e.key === key\n      ) {\n        const shouldPreventDefault = fn();\n        if (shouldPreventDefault) {\n          e.preventDefault();\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handler);\n    return () => window.removeEventListener('keydown', handler);\n  }, [key, fn, ctrlOrCmdKey, altOrOptKey, shiftKey]);\n\n  return { isMacKeyboard };\n};\n","import React from 'react';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ReduxState, ThunkDispatch } from '../../../../redux-types';\nimport { Button, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport {\n  discardPendingEvaluationData,\n  writeBackEvaluationArtifactsAction,\n} from '../../../actions/PromptEngineeringActions';\nimport { FormattedMessage } from 'react-intl';\nimport Utils from '../../../../common/utils/Utils';\nimport { useBrowserKeyShortcutListener } from '../../../../common/hooks/useBrowserKeyShortcutListener';\n\nexport const useEvaluationArtifactWriteBack = () => {\n  const { evaluationPendingDataByRunUuid, evaluationArtifactsBeingUploaded, evaluationDraftInputValues } = useSelector(\n    ({ evaluationData }: ReduxState) => evaluationData,\n  );\n\n  const [isSyncingArtifacts, setSyncingArtifacts] = useState(false);\n\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const discard = useCallback(() => {\n    dispatch(discardPendingEvaluationData());\n  }, [dispatch]);\n\n  const unsyncedDataEntriesCount = Object.values(evaluationPendingDataByRunUuid).flat().length;\n  const draftInputValuesCount = evaluationDraftInputValues.length;\n  const runsBeingSynchronizedCount = Object.values(evaluationArtifactsBeingUploaded).filter((runArtifacts) =>\n    Object.values(runArtifacts).some((isSynced) => isSynced),\n  ).length;\n\n  useEffect(() => {\n    if (unsyncedDataEntriesCount === 0) {\n      setSyncingArtifacts(false);\n    }\n  }, [unsyncedDataEntriesCount]);\n\n  const synchronizeArtifactData = useCallback(() => {\n    if (unsyncedDataEntriesCount === 0 || isSyncingArtifacts) {\n      return true;\n    }\n    setSyncingArtifacts(true);\n    dispatch(writeBackEvaluationArtifactsAction()).catch((e) => {\n      Utils.logErrorAndNotifyUser(e);\n    });\n    return true;\n  }, [dispatch, unsyncedDataEntriesCount, isSyncingArtifacts]);\n\n  const { isMacKeyboard } = useBrowserKeyShortcutListener('s', { ctrlOrCmdKey: true }, synchronizeArtifactData);\n\n  const { theme } = useDesignSystemTheme();\n\n  // Following flag is true when there are draft input values (draft rows), but\n  // no evaluated values yet\n  const pendingUnevaluatedDraftInputValues = draftInputValuesCount > 0 && unsyncedDataEntriesCount === 0;\n\n  // Display write-back UI only if there are draft rows or unsynced evaluation values\n  const shouldStatusElementBeDisplayed = unsyncedDataEntriesCount > 0 || pendingUnevaluatedDraftInputValues;\n\n  const EvaluationSyncStatusElement = shouldStatusElementBeDisplayed ? (\n    <div\n      css={{\n        backgroundColor: theme.colors.backgroundPrimary,\n        border: `1px solid ${theme.colors.border}`,\n        padding: theme.spacing.md,\n        marginBottom: theme.spacing.sm,\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n      }}\n    >\n      {pendingUnevaluatedDraftInputValues ? (\n        <FormattedMessage\n          defaultMessage=\"You have added rows with new input values, but you still need to evaluate the new data in order to save it.\"\n          description=\"Experiment page > artifact compare view > prompt lab artifact synchronization > unevaluated rows indicator\"\n        />\n      ) : isSyncingArtifacts ? (\n        <Typography.Text>\n          <FormattedMessage\n            defaultMessage=\"Synchronizing artifacts for {runsBeingSynchronizedCount} runs...\"\n            description=\"Experiment page > artifact compare view > prompt lab artifact synchronization > loading state\"\n            values={{\n              runsBeingSynchronizedCount: <strong>{runsBeingSynchronizedCount}</strong>,\n            }}\n          />\n        </Typography.Text>\n      ) : (\n        <Typography.Text>\n          <FormattedMessage\n            defaultMessage={`You have <strong>{unsyncedDataEntriesCount}</strong> unsaved evaluated {unsyncedDataEntriesCount, plural, =1 {value} other {values}}. Click \"Save\" button or press {keyCombination} keys to synchronize the artifact data.`}\n            description=\"Experiment page > artifact compare view > prompt lab artifact synchronization > pending changes indicator\"\n            values={{\n              strong: (value) => <strong>{value}</strong>,\n              unsyncedDataEntriesCount,\n              keyCombination: isMacKeyboard() ? 'CMD+S' : 'CTRL+S',\n            }}\n          />\n        </Typography.Text>\n      )}\n      <div css={{ display: 'flex', gap: theme.spacing.sm }}>\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_hooks_useevaluationartifactwriteback.tsx_102\"\n          disabled={isSyncingArtifacts}\n          onClick={discard}\n        >\n          <FormattedMessage\n            defaultMessage=\"Discard\"\n            description=\"Experiment page > artifact compare view > prompt lab artifact synchronization > submit button label\"\n          />\n        </Button>{' '}\n        {/* Display \"Save\" button only if there are actual evaluated data to sync (don't allow to sync empty draft rows) */}\n        {unsyncedDataEntriesCount > 0 && (\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_hooks_useevaluationartifactwriteback.tsx_110\"\n            loading={isSyncingArtifacts}\n            type=\"primary\"\n            onClick={synchronizeArtifactData}\n          >\n            <FormattedMessage\n              defaultMessage=\"Save\"\n              description=\"Experiment page > artifact compare view > prompt lab artifact synchronization > cancel button label\"\n            />\n          </Button>\n        )}\n      </div>\n    </div>\n  ) : null;\n\n  return { isSyncingArtifacts, EvaluationSyncStatusElement };\n};\n","import { Empty, Typography } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\n\nexport const shouldDisplayEvaluationArtifactEmptyState = ({\n  noEvalTablesLogged,\n  userDeselectedAllColumns,\n  areRunsSelected,\n  areTablesSelected,\n}: EvaluationArtifactViewEmptyStateProps) =>\n  !areTablesSelected || !areRunsSelected || userDeselectedAllColumns || noEvalTablesLogged;\n\ninterface EvaluationArtifactViewEmptyStateProps {\n  noEvalTablesLogged: boolean;\n  userDeselectedAllColumns: boolean;\n  areRunsSelected: boolean;\n  areTablesSelected: boolean;\n}\n\nexport const EvaluationArtifactViewEmptyState = ({\n  noEvalTablesLogged,\n  userDeselectedAllColumns,\n  areRunsSelected,\n}: EvaluationArtifactViewEmptyStateProps) => {\n  const getEmptyContent = () => {\n    if (!areRunsSelected) {\n      return [\n        <FormattedMessage\n          defaultMessage=\"No runs selected\"\n          description=\"Experiment page > artifact compare view > empty state for no runs selected > title\"\n        />,\n        <FormattedMessage\n          defaultMessage=\"Make sure that at least one experiment run is visible and available to compare\"\n          description=\"Experiment page > artifact compare view > empty state for no runs selected > subtitle with the hint\"\n        />,\n      ];\n    }\n    if (noEvalTablesLogged) {\n      return [\n        <FormattedMessage\n          defaultMessage=\"No evaluation tables logged\"\n          description=\"Experiment page > artifact compare view > empty state for no evaluation tables logged > title\"\n        />,\n        <FormattedMessage\n          defaultMessage=\"Please log at least one table artifact containing evaluation data. <link>Learn more</link>.\"\n          description=\"Experiment page > artifact compare view > empty state for no evaluation tables logged > subtitle\"\n          values={{\n            link: (chunks) => (\n              <Typography.Link\n                openInNewTab\n                href=\"https://mlflow.org/docs/latest/python_api/mlflow.html?highlight=log_table#mlflow.log_table\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {chunks}\n              </Typography.Link>\n            ),\n          }}\n        />,\n      ];\n    }\n    if (userDeselectedAllColumns) {\n      return [\n        <FormattedMessage\n          defaultMessage=\"No group by columns selected\"\n          description=\"Experiment page > artifact compare view > empty state for no group by columns selected > title\"\n        />,\n        <FormattedMessage\n          defaultMessage='Using controls above, select at least one \"group by\" column.'\n          description=\"Experiment page > artifact compare view > empty state for no group by columns selected > title\"\n        />,\n      ];\n    }\n    return [\n      <FormattedMessage\n        defaultMessage=\"No tables selected\"\n        description=\"Experiment page > artifact compare view > empty state for no tables selected > title\"\n      />,\n      <FormattedMessage\n        defaultMessage=\"Using controls above, select at least one artifact containing table.\"\n        description=\"Experiment page > artifact compare view > empty state for no tables selected > subtitle with the hint\"\n      />,\n    ];\n  };\n  const [title, description] = getEmptyContent();\n  return <Empty title={title} description={description} />;\n};\n","import {\n  CopyIcon,\n  DialogCombobox,\n  DialogComboboxContent,\n  DialogComboboxOptionList,\n  DialogComboboxOptionListCheckboxItem,\n  DialogComboboxOptionListSelectItem,\n  DialogComboboxTrigger,\n  Empty,\n  InfoIcon,\n  Input,\n  SearchIcon,\n  LegacySkeleton,\n  Spinner,\n  ToggleButton,\n  Tooltip,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport type { EvaluationDataReduxState } from '../../reducers/EvaluationDataReducer';\nimport { ExperimentPageViewState } from '../experiment-page/models/ExperimentPageViewState';\nimport { RunRowType } from '../experiment-page/utils/experimentPage.row-types';\nimport { EvaluationArtifactCompareTable } from './components/EvaluationArtifactCompareTable';\nimport { useEvaluationArtifactColumns } from './hooks/useEvaluationArtifactColumns';\nimport { useEvaluationArtifactTableData } from './hooks/useEvaluationArtifactTableData';\nimport { useEvaluationArtifactTables } from './hooks/useEvaluationArtifactTables';\nimport type { RunDatasetWithTags, UpdateExperimentViewStateFn } from '../../types';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { PreviewSidebar } from '../../../common/components/PreviewSidebar';\nimport { useEvaluationArtifactViewState } from './hooks/useEvaluationArtifactViewState';\nimport { useEvaluationArtifactWriteBack } from './hooks/useEvaluationArtifactWriteBack';\nimport { PromptEngineeringContextProvider } from './contexts/PromptEngineeringContext';\nimport { ReduxState, ThunkDispatch } from '../../../redux-types';\nimport { getEvaluationTableArtifact } from '../../actions';\nimport Utils from '../../../common/utils/Utils';\nimport {\n  DEFAULT_PROMPTLAB_OUTPUT_COLUMN,\n  canEvaluateOnRun,\n  extractRequiredInputParamsForRun,\n} from '../prompt-engineering/PromptEngineering.utils';\nimport { searchAllPromptLabAvailableEndpoints } from '../../actions/PromptEngineeringActions';\nimport { shouldEnablePromptLab } from 'common/utils/FeatureUtils';\nimport {\n  EvaluationArtifactViewEmptyState,\n  shouldDisplayEvaluationArtifactEmptyState,\n} from './EvaluationArtifactViewEmptyState';\nimport { useUpdateExperimentViewUIState } from '../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { useToggleRowVisibilityCallback } from '../experiment-page/hooks/useToggleRowVisibilityCallback';\nimport { RUNS_VISIBILITY_MODE } from '../experiment-page/models/ExperimentPageUIState';\nimport { FormattedJsonDisplay } from 'common/components/JsonFormatting';\n\nconst MAX_RUNS_TO_COMPARE = 10;\n\ninterface EvaluationArtifactCompareViewProps {\n  comparedRuns: RunRowType[];\n  viewState: ExperimentPageViewState;\n  updateViewState: UpdateExperimentViewStateFn;\n  onDatasetSelected: (dataset: RunDatasetWithTags, run: RunRowType) => void;\n}\n\n/**\n * Compares the table data contained in experiment run artifacts.\n */\nexport const EvaluationArtifactCompareViewImpl = ({\n  comparedRuns,\n  onDatasetSelected,\n  viewState,\n  updateViewState,\n}: EvaluationArtifactCompareViewProps) => {\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n  const updateUIState = useUpdateExperimentViewUIState();\n\n  const visibleRuns = useMemo(\n    () => comparedRuns.filter(({ hidden }) => !hidden).slice(0, MAX_RUNS_TO_COMPARE),\n    [comparedRuns],\n  );\n\n  const { selectedTables, groupByCols, outputColumn, setSelectedTables, setGroupByCols, setOutputColumn } =\n    useEvaluationArtifactViewState(viewState, updateViewState);\n\n  const [showSearchSpinner, setShowSearchSpinner] = useState(false);\n  const [filter, setFilter] = useState('');\n  const [debouncedFilter, setDebouncedFilter] = useState('');\n  const [userDeselectedAllColumns, setUserDeselectedAllColumns] = useState(false);\n\n  const { isSyncingArtifacts, EvaluationSyncStatusElement } = useEvaluationArtifactWriteBack();\n\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  useEffect(() => {\n    if (shouldEnablePromptLab()) {\n      dispatch(searchAllPromptLabAvailableEndpoints()).catch((e) => {\n        Utils.logErrorAndNotifyUser(e?.message || e);\n      });\n    }\n  }, [dispatch]);\n\n  const handleTableToggle = useCallback(\n    (value: string) =>\n      setSelectedTables((currentValue) => {\n        if (currentValue.includes(value)) {\n          return currentValue.filter((item) => item !== value);\n        } else {\n          return [...currentValue, value];\n        }\n      }),\n    [setSelectedTables],\n  );\n\n  const handleGroupByToggle = useCallback(\n    (value: string) =>\n      setGroupByCols((currentValue) => {\n        const newValues = currentValue.includes(value)\n          ? currentValue.filter((item) => item !== value)\n          : [...currentValue, value];\n        setUserDeselectedAllColumns(newValues.length === 0);\n        return newValues;\n      }),\n    [setGroupByCols],\n  );\n\n  const visibleRunsUuids = useMemo(() => visibleRuns.map(({ runUuid }) => runUuid), [visibleRuns]);\n\n  const { evaluationArtifactsByRunUuid, evaluationPendingDataByRunUuid, evaluationDraftInputValues } = useSelector(\n    ({ evaluationData }: ReduxState) => evaluationData,\n  );\n\n  const { tables, tablesByRun, noEvalTablesLogged } = useEvaluationArtifactTables(visibleRuns);\n\n  // Select the first table by default\n  useEffect(() => {\n    if (tables.length > 0 && selectedTables.length === 0) {\n      setSelectedTables([tables[0]]);\n    }\n  }, [tables, setSelectedTables, selectedTables.length]);\n\n  const isLoading = useSelector(({ evaluationData, modelGateway }: ReduxState) => {\n    const gatewayRoutesLoading = modelGateway.modelGatewayRoutesLoading.loading;\n    return (\n      gatewayRoutesLoading ||\n      visibleRunsUuids.some((uuid) =>\n        selectedTables.some((table) => evaluationData.evaluationArtifactsLoadingByRunUuid[uuid]?.[table]),\n      )\n    );\n  });\n\n  const { columns, imageColumns } = useEvaluationArtifactColumns(\n    evaluationArtifactsByRunUuid,\n    visibleRunsUuids,\n    selectedTables,\n  );\n\n  const isImageColumn = imageColumns.includes(outputColumn);\n\n  const tableRows = useEvaluationArtifactTableData(\n    evaluationArtifactsByRunUuid,\n    evaluationPendingDataByRunUuid,\n    evaluationDraftInputValues,\n    visibleRunsUuids,\n    selectedTables,\n    groupByCols,\n    outputColumn,\n  );\n\n  // Try to extract all existing prompt input fields from prompt engineering runs, if there are any.\n  // Return \"null\" otherwise.\n  const promptLabInputVariableNames = useMemo(() => {\n    const promptEngineeringRuns = visibleRuns.filter(canEvaluateOnRun);\n    const allInputNames = promptEngineeringRuns.map(extractRequiredInputParamsForRun).flat();\n    if (!allInputNames.length) {\n      return null;\n    }\n\n    // Remove duplicates\n    const distinctInputNames = Array.from(new Set(allInputNames));\n\n    // Ensure that detected input names are included in the available columns\n    return distinctInputNames.filter((inputName) => columns.includes(inputName));\n  }, [visibleRuns, columns]);\n\n  // If we've changed the visible run set and all of them originate from prompt engineering,\n  // reset the columns so they will be recalculated again\n  useEffect(() => {\n    if (visibleRuns.every(canEvaluateOnRun)) {\n      setGroupByCols([]);\n    }\n  }, [setGroupByCols, visibleRuns]);\n\n  // For every run, load its selected tables\n  useEffect(() => {\n    if (!selectedTables.length) {\n      return;\n    }\n    for (const run of visibleRuns) {\n      if (!run) {\n        continue;\n      }\n      const tablesToFetch = (tablesByRun[run.runUuid] || []).filter((table) => selectedTables.includes(table));\n      for (const table of tablesToFetch) {\n        dispatch(getEvaluationTableArtifact(run.runUuid, table, false)).catch((e) => {\n          Utils.logErrorAndNotifyUser(e.message || e);\n        });\n      }\n    }\n  }, [visibleRuns, dispatch, selectedTables, tablesByRun]);\n\n  // Table is ready to use if it's loaded, at least one table and at least one run is selected\n  const areTablesSelected = selectedTables.length > 0;\n  const areRunsSelected = visibleRuns.length > 0;\n  const isViewConfigured = !isLoading && areTablesSelected && areRunsSelected;\n\n  const filteredRows = useMemo(() => {\n    if (!debouncedFilter.trim()) {\n      return tableRows;\n    }\n    const regexp = new RegExp(debouncedFilter, 'i');\n    return tableRows.filter(({ groupByCellValues }) =>\n      Object.values(groupByCellValues).some((groupByValue) => groupByValue?.match(regexp)),\n    );\n  }, [tableRows, debouncedFilter]);\n\n  const toggleRowVisibility = useToggleRowVisibilityCallback(comparedRuns);\n\n  const handleHideRun = useCallback(\n    (runUuid: string) => {\n      toggleRowVisibility(RUNS_VISIBILITY_MODE.CUSTOM, runUuid);\n    },\n    [toggleRowVisibility],\n  );\n\n  // Make sure that there's at least one \"group by\" column selected\n  useEffect(() => {\n    if (isLoading || userDeselectedAllColumns) {\n      return;\n    }\n    const noColumnsSelected = groupByCols.length < 1;\n    const columnNotAvailableAnymore = groupByCols.some((column) => !columns.includes(column));\n    const firstColumn = columns[0];\n\n    // If prompt engineering prompt inputs are detected, take them as a candidate for initial \"group by\" columns.\n    // If not, use the first valid column found.\n    const groupByColumnCandidates = promptLabInputVariableNames || (firstColumn ? [firstColumn] : null);\n\n    if ((noColumnsSelected || columnNotAvailableAnymore) && groupByColumnCandidates) {\n      setGroupByCols(groupByColumnCandidates);\n    }\n  }, [\n    isLoading,\n    userDeselectedAllColumns,\n    groupByCols,\n    outputColumn,\n    columns,\n    setGroupByCols,\n    promptLabInputVariableNames,\n  ]);\n\n  // Remove MLFLOW_ columns from the list of groupby columns since they are for metadata only\n  const availableGroupByColumns = useMemo(() => columns.filter((col) => !col.startsWith('MLFLOW_')), [columns]);\n\n  // All columns that are not used for grouping can be used as output (compare) column\n  // Remove MLFLOW_ columns from the list of output columns\n  const availableOutputColumns = useMemo(\n    () => [...columns, ...imageColumns].filter((col) => !groupByCols.includes(col) && !col.startsWith('MLFLOW_')),\n    [columns, imageColumns, groupByCols],\n  );\n\n  // If the current output column have been selected as \"group by\", change it to the other available one\n  useEffect(() => {\n    if (groupByCols.includes(outputColumn) || !outputColumn) {\n      const nextColumnCandidate = availableOutputColumns.includes(DEFAULT_PROMPTLAB_OUTPUT_COLUMN)\n        ? DEFAULT_PROMPTLAB_OUTPUT_COLUMN\n        : availableOutputColumns[0];\n      setOutputColumn(nextColumnCandidate || '');\n    }\n  }, [groupByCols, outputColumn, availableOutputColumns, setOutputColumn]);\n\n  // On every change of \"filter\" input, debounce the value and show the spinner\n  useEffect(() => {\n    setShowSearchSpinner(true);\n    const handler = setTimeout(() => setDebouncedFilter(filter), 250);\n    return () => clearTimeout(handler);\n  }, [filter]);\n\n  // After debounced filter value settles in, remove the search spinner\n  useEffect(() => {\n    setShowSearchSpinner(false);\n  }, [debouncedFilter]);\n\n  // If the current output column is not available anymore, change it to the other available one\n  useEffect(() => {\n    if (!availableOutputColumns.includes(outputColumn)) {\n      const nextColumnCandidate = availableOutputColumns.includes(DEFAULT_PROMPTLAB_OUTPUT_COLUMN)\n        ? DEFAULT_PROMPTLAB_OUTPUT_COLUMN\n        : availableOutputColumns[0];\n      setOutputColumn(nextColumnCandidate || '');\n    }\n  }, [outputColumn, availableOutputColumns, setOutputColumn]);\n\n  // If any currently selected table is not available anymore, deselect it\n  useEffect(() => {\n    if (selectedTables.some((table) => !tables.includes(table))) {\n      setSelectedTables([]);\n    }\n  }, [selectedTables, tables, setSelectedTables]);\n\n  const [sidebarPreviewData, setSidebarPreviewData] = useState<{\n    value: string;\n    header: string;\n  } | null>(null);\n\n  const handleCellClicked = useCallback(\n    (value: string, header: string) => {\n      setSidebarPreviewData({ value, header });\n      updateViewState({ previewPaneVisible: true });\n    },\n    [updateViewState],\n  );\n\n  return (\n    <div\n      css={{\n        flex: 1,\n        borderTop: `1px solid ${theme.colors.border}`,\n        borderLeft: `1px solid ${theme.colors.border}`,\n        // Let's cover 1 pixel of the grid's border for the sleek look\n        marginLeft: -1,\n        zIndex: 1,\n        height: '100%',\n        display: 'grid',\n        gridTemplateColumns: viewState.previewPaneVisible ? '1fr auto' : '1fr',\n        overflow: 'hidden',\n      }}\n    >\n      <div\n        css={{\n          paddingLeft: theme.spacing.sm,\n          paddingTop: theme.spacing.sm,\n          height: '100%',\n          display: 'grid',\n          gridTemplateRows: 'auto auto 1fr',\n          overflow: 'hidden',\n          rowGap: theme.spacing.sm,\n          backgroundColor: theme.colors.backgroundSecondary,\n        }}\n      >\n        <div\n          css={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: theme.spacing.sm,\n            overflow: 'hidden',\n            height: theme.general.heightSm,\n          }}\n        >\n          <DialogCombobox\n            label={\n              <FormattedMessage\n                defaultMessage=\"Table\"\n                description=\"Experiment page > artifact compare view > table select dropdown label\"\n              />\n            }\n            multiSelect\n            value={selectedTables}\n          >\n            <DialogComboboxTrigger\n              css={{ maxWidth: 300, backgroundColor: theme.colors.backgroundPrimary }}\n              data-testid=\"dropdown-tables\"\n              onClear={() => setSelectedTables([])}\n              disabled={isSyncingArtifacts || !areRunsSelected || noEvalTablesLogged}\n            />\n            <DialogComboboxContent css={{ maxWidth: 300 }}>\n              <DialogComboboxOptionList>\n                {tables.map((artifactPath) => (\n                  <DialogComboboxOptionListCheckboxItem\n                    value={artifactPath}\n                    key={artifactPath}\n                    onChange={handleTableToggle}\n                    checked={selectedTables.includes(artifactPath)}\n                    data-testid=\"dropdown-tables-option\"\n                  >\n                    {artifactPath}\n                  </DialogComboboxOptionListCheckboxItem>\n                ))}\n              </DialogComboboxOptionList>\n            </DialogComboboxContent>\n          </DialogCombobox>\n          <Tooltip\n            title={\n              <FormattedMessage\n                defaultMessage=\"Using the list of logged table artifacts, select at least one to start comparing results.\"\n                description=\"Experiment page > artifact compare view > table select dropdown tooltip\"\n              />\n            }\n          >\n            <InfoIcon />\n          </Tooltip>\n        </div>\n        {isLoading ? (\n          <LegacySkeleton />\n        ) : (\n          <>\n            <div\n              css={{\n                display: 'flex',\n                columnGap: theme.spacing.sm,\n                alignItems: 'center',\n                overflow: 'hidden',\n                height: theme.general.heightSm,\n              }}\n            >\n              <Input\n                prefix={<SearchIcon />}\n                suffix={showSearchSpinner && <Spinner size=\"small\" />}\n                css={{ width: 300, minWidth: 300 }}\n                onChange={(e) => setFilter(e.target.value)}\n                value={filter}\n                placeholder={intl.formatMessage(\n                  {\n                    defaultMessage: 'Filter by {columnNames}',\n                    description: 'Experiment page > artifact compare view > search input placeholder',\n                  },\n                  {\n                    columnNames: groupByCols.join(', '),\n                  },\n                )}\n                allowClear\n                disabled={!isViewConfigured || isSyncingArtifacts}\n              />\n              <DialogCombobox\n                value={groupByCols}\n                multiSelect\n                label={\n                  <FormattedMessage\n                    defaultMessage=\"Group by\"\n                    description='Experiment page > artifact compare view > \"group by column\" select dropdown label'\n                  />\n                }\n              >\n                <DialogComboboxTrigger\n                  disabled={!isViewConfigured || isSyncingArtifacts}\n                  allowClear={false}\n                  showTagAfterValueCount={1}\n                  css={{ maxWidth: 300, backgroundColor: theme.colors.backgroundPrimary }}\n                  aria-label='Select \"group by\" columns'\n                />\n                <DialogComboboxContent css={{ maxWidth: 300 }}>\n                  <DialogComboboxOptionList>\n                    {availableGroupByColumns.map((columnName) => (\n                      <DialogComboboxOptionListCheckboxItem\n                        value={columnName}\n                        key={columnName}\n                        onChange={handleGroupByToggle}\n                        checked={groupByCols.includes(columnName)}\n                      >\n                        {columnName}\n                      </DialogComboboxOptionListCheckboxItem>\n                    ))}\n                  </DialogComboboxOptionList>\n                </DialogComboboxContent>\n              </DialogCombobox>\n              <DialogCombobox\n                value={[outputColumn]}\n                label={\n                  <FormattedMessage\n                    defaultMessage=\"Compare\"\n                    description='Experiment page > artifact compare view > \"compare\" select dropdown label'\n                  />\n                }\n              >\n                <DialogComboboxTrigger\n                  disabled={!isViewConfigured || isSyncingArtifacts}\n                  allowClear={false}\n                  css={{ maxWidth: 300, backgroundColor: theme.colors.backgroundPrimary }}\n                />\n                <DialogComboboxContent css={{ maxWidth: 300 }}>\n                  <DialogComboboxOptionList>\n                    {availableOutputColumns.map((columnName) => (\n                      <DialogComboboxOptionListSelectItem\n                        value={columnName}\n                        key={columnName}\n                        onChange={() => setOutputColumn(columnName)}\n                        checked={outputColumn === columnName}\n                      >\n                        {columnName}\n                      </DialogComboboxOptionListSelectItem>\n                    ))}\n                  </DialogComboboxOptionList>\n                </DialogComboboxContent>\n              </DialogCombobox>\n            </div>\n\n            {shouldDisplayEvaluationArtifactEmptyState({\n              areRunsSelected,\n              areTablesSelected,\n              noEvalTablesLogged,\n              userDeselectedAllColumns,\n            }) ? (\n              <div\n                css={{\n                  height: '100%',\n                  display: 'flex',\n                  justifyContent: 'center',\n                  alignItems: 'center',\n                }}\n              >\n                <EvaluationArtifactViewEmptyState\n                  areRunsSelected={areRunsSelected}\n                  areTablesSelected={areTablesSelected}\n                  noEvalTablesLogged={noEvalTablesLogged}\n                  userDeselectedAllColumns={userDeselectedAllColumns}\n                />\n              </div>\n            ) : (\n              <div\n                css={{\n                  position: 'relative' as const,\n                  zIndex: 1,\n                  overflowY: 'hidden' as const,\n                  height: '100%',\n                  backgroundColor: theme.colors.backgroundPrimary,\n                }}\n              >\n                <PromptEngineeringContextProvider tableData={tableRows} outputColumn={outputColumn}>\n                  <EvaluationArtifactCompareTable\n                    visibleRuns={visibleRuns}\n                    groupByColumns={groupByCols}\n                    resultList={filteredRows}\n                    onCellClick={isImageColumn ? undefined : handleCellClicked}\n                    onHideRun={handleHideRun}\n                    onDatasetSelected={onDatasetSelected}\n                    highlightedText={debouncedFilter.trim()}\n                    isPreviewPaneVisible={viewState.previewPaneVisible}\n                    outputColumnName={outputColumn}\n                    isImageColumn={isImageColumn}\n                  />\n                </PromptEngineeringContextProvider>\n              </div>\n            )}\n            {EvaluationSyncStatusElement}\n          </>\n        )}\n      </div>\n      {viewState.previewPaneVisible && (\n        <PreviewSidebar\n          content={sidebarPreviewData?.value ? <FormattedJsonDisplay json={sidebarPreviewData.value} /> : null}\n          copyText={sidebarPreviewData?.value || ''}\n          headerText={sidebarPreviewData?.header}\n          onClose={() => updateViewState({ previewPaneVisible: false })}\n          empty={\n            <Empty\n              description={\n                <FormattedMessage\n                  defaultMessage=\"Select a cell to display preview\"\n                  description=\"Experiment page > artifact compare view > preview sidebar > nothing selected\"\n                />\n              }\n            />\n          }\n        />\n      )}\n    </div>\n  );\n};\n\nexport const EvaluationArtifactCompareView = (props: EvaluationArtifactCompareViewProps & { disabled?: boolean }) => {\n  const { theme } = useDesignSystemTheme();\n  if (props.disabled) {\n    return (\n      <div\n        css={{\n          flex: 1,\n          backgroundColor: theme.colors.backgroundSecondary,\n          height: '100%',\n          borderTop: `1px solid ${theme.colors.border}`,\n          borderLeft: `1px solid ${theme.colors.border}`,\n          paddingTop: theme.spacing.lg,\n          marginLeft: -1,\n          zIndex: 1,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n        }}\n      >\n        <Empty\n          title={\n            <FormattedMessage\n              defaultMessage=\"Evaluation not available when grouping is enabled\"\n              description=\"Experiment page > artifact compare view > disabled due to run grouping > title\"\n            />\n          }\n          description={\n            <FormattedMessage\n              defaultMessage=\"Disable run grouping in order to access the evaluation view\"\n              description=\"Experiment page > artifact compare view > disabled due to run grouping > description\"\n            />\n          }\n          image={<div />}\n        />\n      </div>\n    );\n  }\n  return <EvaluationArtifactCompareViewImpl {...props} />;\n};\n","import { useEffect, useState } from 'react';\nimport { ExperimentPageViewState } from '../../experiment-page/models/ExperimentPageViewState';\nimport { UpdateExperimentViewStateFn } from '../../../types';\n\nexport const useEvaluationArtifactViewState = (\n  viewState: ExperimentPageViewState,\n  updateViewState: UpdateExperimentViewStateFn,\n) => {\n  const { artifactViewState = {} } = viewState;\n  const [selectedTables, setSelectedTables] = useState<string[]>(artifactViewState.selectedTables || []);\n  const [groupByCols, setGroupByCols] = useState<string[]>(artifactViewState.groupByCols || []);\n  const [outputColumn, setOutputColumn] = useState(artifactViewState.outputColumn || '');\n\n  useEffect(\n    () =>\n      updateViewState({\n        artifactViewState: {\n          selectedTables,\n          groupByCols,\n          outputColumn,\n        },\n      }),\n    [updateViewState, selectedTables, groupByCols, outputColumn],\n  );\n\n  return {\n    selectedTables,\n    groupByCols,\n    outputColumn,\n    setSelectedTables,\n    setGroupByCols,\n    setOutputColumn,\n  };\n};\n","import { fromPairs } from 'lodash';\nimport { useMemo } from 'react';\nimport { RunLoggedArtifactType, RunLoggedArtifactsDeclaration } from '../../../types';\nimport { MLFLOW_LOGGED_ARTIFACTS_TAG } from '../../../constants';\nimport { RunRowType } from '../../experiment-page/utils/experimentPage.row-types';\n\n/**\n * Consumes an array of experiment run entities and extracts names of\n * all table artifacts defined by their tags.\n */\nexport const useEvaluationArtifactTables = (comparedRunRows: RunRowType[]) =>\n  useMemo(() => {\n    const tablesByRun = fromPairs(\n      comparedRunRows\n        .map<[string, string[]]>((run) => {\n          const rawLoggedArtifactsDeclaration = run.tags?.[MLFLOW_LOGGED_ARTIFACTS_TAG]?.value;\n          const tablesInRun: Set<string> = new Set();\n          if (rawLoggedArtifactsDeclaration) {\n            try {\n              const loggedArtifacts: RunLoggedArtifactsDeclaration = JSON.parse(rawLoggedArtifactsDeclaration);\n\n              loggedArtifacts\n                .filter(({ type }) => type === RunLoggedArtifactType.TABLE)\n                .forEach(({ path }) => {\n                  tablesInRun.add(path);\n                });\n            } catch (error) {\n              if (error instanceof SyntaxError) {\n                throw new SyntaxError(`The \"${MLFLOW_LOGGED_ARTIFACTS_TAG}\" tag in \"${run.runName}\" run is malformed!`);\n              }\n              throw error;\n            }\n          }\n          return [run.runUuid, Array.from(tablesInRun)];\n        })\n        // Filter entries with no tables reported\n        .filter(([, tables]) => tables.length > 0),\n    );\n\n    const allUniqueTables = Array.from(new Set(Object.values(tablesByRun).flat()));\n\n    const tablesIntersection = allUniqueTables.filter((tableName) =>\n      comparedRunRows.every(({ runUuid }) => tablesByRun[runUuid]?.includes(tableName)),\n    );\n\n    const noEvalTablesLogged = allUniqueTables.length === 0;\n\n    return {\n      tables: allUniqueTables,\n      tablesByRun,\n      tablesIntersection,\n      noEvalTablesLogged,\n    };\n  }, [comparedRunRows]);\n","import { useMemo } from 'react';\nimport type { EvaluationDataReduxState } from '../../../reducers/EvaluationDataReducer';\nimport { ArtifactLogTableImageObject } from 'experiment-tracking/types';\n\ntype ArtifactsByRun = EvaluationDataReduxState['evaluationArtifactsByRunUuid'];\n\n/**\n * Consumes artifacts data (extracted from the redux store) and based on the\n * provided list of tables and run UUIDs, returns:\n * - list of all columns found in the tables data\n * - list of columns that are present in every matching table\n */\nexport const useEvaluationArtifactColumns = (\n  artifactsByRun: ArtifactsByRun,\n  comparedRunUuids: string[],\n  tableNames: string[],\n) =>\n  useMemo(() => {\n    // Do not proceed if there are no tables or runs selected\n    if (tableNames.length === 0 || comparedRunUuids.length === 0) {\n      return { columns: [], columnsIntersection: [], imageColumns: [] };\n    }\n\n    // Extract all matching table objects from the store data\n    const allTableEntries = comparedRunUuids\n      .map((runUuid) => Object.values(artifactsByRun[runUuid] || {}).filter(({ path }) => tableNames.includes(path)))\n      .flat();\n\n    // Extract all valid column names\n    const allColumnsForAllTables = allTableEntries\n      .filter(({ path }) => tableNames.includes(path))\n      .map(({ columns, entries }) => {\n        return columns.map((column) => {\n          const column_string = String(column);\n          if (entries.length > 0) {\n            const entry = entries[0][column];\n            if (typeof entry === 'object' && (entry as ArtifactLogTableImageObject)?.type === 'image') {\n              return { name: column_string, type: 'image' };\n            } else {\n              return { name: column_string, type: 'text' };\n            }\n          } else {\n            return { name: column_string, type: 'text' };\n          }\n        });\n      })\n      .flat();\n\n    // Remove duplicates\n    const columns = Array.from(\n      new Set(allColumnsForAllTables.filter((col) => col.type === 'text').map((col) => col.name)),\n    );\n    const imageColumns = Array.from(\n      new Set(allColumnsForAllTables.filter((col) => col.type === 'image').map((col) => col.name)),\n    );\n    // Find the intersection\n    const columnsIntersection = columns.filter((column) =>\n      allTableEntries.every(({ columns: tableColumns }) => tableColumns.includes(column)),\n    );\n\n    return {\n      columns,\n      columnsIntersection,\n      imageColumns,\n    };\n  }, [comparedRunUuids, artifactsByRun, tableNames]);\n","import { LegacySkeleton, useDesignSystemTheme } from '@databricks/design-system';\nimport { ReactNode, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport type { KeyValueEntity, MetricEntitiesByName, ChartSectionConfig, ImageEntity } from '../../types';\nimport { RunsChartsCardConfig } from '../runs-charts/runs-charts.types';\nimport type { RunsChartType, SerializedRunsChartsCardConfigCard } from '../runs-charts/runs-charts.types';\nimport { RunsChartsConfigureModal } from '../runs-charts/components/RunsChartsConfigureModal';\nimport { getUUID } from '../../../common/utils/ActionUtils';\nimport type { RunsChartsRunData } from '../runs-charts/components/RunsCharts.common';\nimport {\n  AUTOML_EVALUATION_METRIC_TAG,\n  LOG_IMAGE_TAG_INDICATOR,\n  MLFLOW_EXPERIMENT_PRIMARY_METRIC_NAME,\n  MLFLOW_LOGGED_IMAGE_ARTIFACTS_PATH,\n} from '../../constants';\nimport { RunsChartsTooltipBody } from '../runs-charts/components/RunsChartsTooltipBody';\nimport { RunsChartsTooltipWrapper } from '../runs-charts/hooks/useRunsChartsTooltip';\nimport { useUpdateExperimentViewUIState } from '../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { ExperimentPageUIState, RUNS_VISIBILITY_MODE } from '../experiment-page/models/ExperimentPageUIState';\nimport { RunRowType } from '../experiment-page/utils/experimentPage.row-types';\nimport { RunsChartsSectionAccordion } from '../runs-charts/components/sections/RunsChartsSectionAccordion';\nimport { ReduxState, ThunkDispatch } from 'redux-types';\nimport { SearchIcon } from '@databricks/design-system';\nimport { Input } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { shouldEnableImageGridCharts, shouldUseNewRunRowsVisibilityModel } from '../../../common/utils/FeatureUtils';\nimport {\n  type RunsGroupByConfig,\n  getRunGroupDisplayName,\n  isRemainingRunsGroup,\n  normalizeRunsGroupByKey,\n} from '../experiment-page/utils/experimentPage.group-row-utils';\nimport { filter, isString, keyBy, values } from 'lodash';\nimport {\n  type RunsChartsUIConfigurationSetter,\n  RunsChartsUIConfigurationContextProvider,\n  useUpdateRunsChartsUIConfiguration,\n  useReorderRunsChartsFn,\n  useInsertRunsChartsFn,\n  useRemoveRunsChartFn,\n  useConfirmChartCardConfigurationFn,\n} from '../runs-charts/hooks/useRunsChartsUIConfiguration';\nimport { useToggleRowVisibilityCallback } from '../experiment-page/hooks/useToggleRowVisibilityCallback';\nimport { RunsChartsFullScreenModal } from '../runs-charts/components/RunsChartsFullScreenModal';\nimport { usePopulateImagesByRunUuid } from '../experiment-page/hooks/usePopulateImagesByRunUuid';\nimport { useGetExperimentRunColor } from '../experiment-page/hooks/useExperimentRunColor';\nimport { DragAndDropProvider } from '../../../common/hooks/useDragAndDropElement';\n\nexport interface RunsCompareProps {\n  comparedRuns: RunRowType[];\n  isLoading: boolean;\n  metricKeyList: string[];\n  paramKeyList: string[];\n  experimentTags: Record<string, KeyValueEntity>;\n  compareRunCharts?: SerializedRunsChartsCardConfigCard[];\n  compareRunSections?: ChartSectionConfig[];\n  groupBy: null | string | RunsGroupByConfig;\n  autoRefreshEnabled?: boolean;\n}\n\n/**\n * Utility function: based on a run row coming from runs table, creates run data trace to be used in charts\n */\nconst createRunDataTrace = (\n  run: RunRowType,\n  latestMetricsByRunUuid: Record<string, MetricEntitiesByName>,\n  paramsByRunUuid: Record<string, Record<string, KeyValueEntity>>,\n  tagsByRunUuid: Record<string, Record<string, KeyValueEntity>>,\n  imagesByRunUuid: Record<string, Record<string, Record<string, ImageEntity>>>,\n  color: string,\n) => ({\n  uuid: run.runUuid,\n  displayName: run.runInfo?.runName || run.runUuid,\n  runInfo: run.runInfo,\n  metrics: latestMetricsByRunUuid[run.runUuid] || {},\n  params: paramsByRunUuid[run.runUuid] || {},\n  tags: tagsByRunUuid[run.runUuid] || {},\n  images: imagesByRunUuid[run.runUuid] || {},\n  color,\n  pinned: run.pinned,\n  pinnable: run.pinnable,\n  metricsHistory: {},\n  belongsToGroup: run.runDateAndNestInfo?.belongsToGroup,\n  hidden: run.hidden,\n});\n\n/**\n * Utility function: based on a group row coming from runs table, creates run group data trace to be used in charts\n */\nconst createGroupDataTrace = (run: RunRowType, color: string) => {\n  // Latest aggregated metrics in groups does not contain step or timestamps.\n  // For step, we're using maxStep which will help determine the chart type.\n  // For timestamp, we use 0 as a placeholder.\n  const metricsData = run.groupParentInfo?.aggregatedMetricData\n    ? keyBy(\n        values(run.groupParentInfo?.aggregatedMetricData).map(({ key, value, maxStep }) => ({\n          key,\n          value,\n          step: maxStep,\n          timestamp: 0,\n        })),\n        'key',\n      )\n    : {};\n  return {\n    uuid: run.rowUuid,\n    displayName: getRunGroupDisplayName(run.groupParentInfo),\n    groupParentInfo: run.groupParentInfo,\n    metrics: metricsData,\n    params: run.groupParentInfo?.aggregatedParamData || {},\n    // TODO: add tags for groups\n    tags: {},\n    images: {},\n    color,\n    pinned: run.pinned,\n    pinnable: run.pinnable,\n    metricsHistory: {},\n    hidden: run.hidden,\n  };\n};\n\n/**\n * Component displaying comparison charts and differences (and in future artifacts) between experiment runs.\n * Intended to be mounted next to runs table.\n *\n * This component extracts params/metrics from redux store by itself for quicker access. However,\n * it needs a provided list of compared run entries using same model as runs table.\n */\nexport const RunsCompareImpl = ({\n  isLoading,\n  comparedRuns,\n  metricKeyList,\n  paramKeyList,\n  experimentTags,\n  compareRunCharts,\n  compareRunSections,\n  groupBy,\n  autoRefreshEnabled,\n}: RunsCompareProps) => {\n  // Updater function for the general experiment view UI state\n  const updateUIState = useUpdateExperimentViewUIState();\n  const getRunColor = useGetExperimentRunColor();\n\n  // Updater function for charts UI state\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  const { paramsByRunUuid, latestMetricsByRunUuid, tagsByRunUuid, imagesByRunUuid } = useSelector(\n    (state: ReduxState) => ({\n      paramsByRunUuid: state.entities.paramsByRunUuid,\n      latestMetricsByRunUuid: state.entities.latestMetricsByRunUuid,\n      tagsByRunUuid: state.entities.tagsByRunUuid,\n      imagesByRunUuid: state.entities.imagesByRunUuid,\n    }),\n  );\n\n  const { theme } = useDesignSystemTheme();\n  const [initiallyLoaded, setInitiallyLoaded] = useState(false);\n  const [configuredCardConfig, setConfiguredCardConfig] = useState<RunsChartsCardConfig | null>(null);\n  const [search, setSearch] = useState('');\n  const { formatMessage } = useIntl();\n\n  const groupByNormalized = useMemo(\n    () =>\n      // In case we encounter deprecated string-based group by descriptor\n      normalizeRunsGroupByKey(groupBy),\n    [groupBy],\n  );\n\n  const [fullScreenChart, setFullScreenChart] = useState<\n    { config: RunsChartsCardConfig; title: string; subtitle: ReactNode } | undefined\n  >(undefined);\n\n  const addNewChartCard = (metricSectionId: string) => {\n    return (type: RunsChartType) => {\n      // TODO: pass existing runs data and get pre-configured initial setup for every chart type\n      setConfiguredCardConfig(RunsChartsCardConfig.getEmptyChartCardByType(type, false, undefined, metricSectionId));\n    };\n  };\n\n  const startEditChart = useCallback((chartCard: RunsChartsCardConfig) => {\n    setConfiguredCardConfig(chartCard);\n  }, []);\n\n  useEffect(() => {\n    if (!initiallyLoaded && !isLoading) {\n      setInitiallyLoaded(true);\n    }\n  }, [initiallyLoaded, isLoading]);\n\n  const primaryMetricKey = useMemo(() => {\n    const automlEntry = experimentTags[AUTOML_EVALUATION_METRIC_TAG];\n    const mlflowPrimaryEntry = experimentTags[MLFLOW_EXPERIMENT_PRIMARY_METRIC_NAME];\n    return automlEntry?.value || mlflowPrimaryEntry?.value || metricKeyList[0] || '';\n  }, [experimentTags, metricKeyList]);\n\n  /**\n   * Dataset generated for all charts in a single place\n   */\n  const chartData: RunsChartsRunData[] = useMemo(() => {\n    if (!groupBy) {\n      return comparedRuns\n        .filter((run) => run.runInfo)\n        .filter((run) => shouldUseNewRunRowsVisibilityModel() || !run.hidden)\n        .map<RunsChartsRunData>((run) =>\n          createRunDataTrace(\n            run,\n            latestMetricsByRunUuid,\n            paramsByRunUuid,\n            tagsByRunUuid,\n            imagesByRunUuid,\n            getRunColor(run.runUuid),\n          ),\n        );\n    }\n\n    const groupChartDataEntries = comparedRuns\n      .filter((run) => shouldUseNewRunRowsVisibilityModel() || !run.hidden)\n      .filter((run) => run.groupParentInfo && !isRemainingRunsGroup(run.groupParentInfo))\n      .map<RunsChartsRunData>((group) => createGroupDataTrace(group, getRunColor(group.groupParentInfo?.groupId)));\n\n    const remainingRuns = comparedRuns\n      .filter((run) => shouldUseNewRunRowsVisibilityModel() || !run.hidden)\n      .filter((run) => !run.groupParentInfo && !run.runDateAndNestInfo?.belongsToGroup)\n      .map((run) =>\n        createRunDataTrace(\n          run,\n          latestMetricsByRunUuid,\n          paramsByRunUuid,\n          tagsByRunUuid,\n          imagesByRunUuid,\n          getRunColor(run.runUuid),\n        ),\n      );\n\n    return [...groupChartDataEntries, ...remainingRuns];\n  }, [groupBy, comparedRuns, latestMetricsByRunUuid, paramsByRunUuid, tagsByRunUuid, imagesByRunUuid, getRunColor]);\n\n  const filteredImageData = chartData.filter((run) => !run.hidden && run.tags[LOG_IMAGE_TAG_INDICATOR]);\n  usePopulateImagesByRunUuid({\n    runUuids: filteredImageData.map((run) => run.uuid),\n    runUuidsIsActive: filteredImageData.map((run) => run.runInfo?.status === 'RUNNING'),\n    enabled: shouldEnableImageGridCharts(),\n    autoRefreshEnabled,\n  });\n\n  // Set chart cards to the user-facing base config if there is no other information.\n  useEffect(() => {\n    if ((!compareRunSections || !compareRunCharts) && chartData.length > 0) {\n      const { resultChartSet, resultSectionSet } = RunsChartsCardConfig.getBaseChartAndSectionConfigs({\n        primaryMetricKey,\n        runsData: chartData,\n        useParallelCoordinatesChart: true,\n      });\n      updateChartsUIState((current) => ({\n        ...current,\n        compareRunCharts: resultChartSet,\n        compareRunSections: resultSectionSet,\n      }));\n    }\n  }, [compareRunCharts, compareRunSections, primaryMetricKey, chartData, updateChartsUIState]);\n\n  /**\n   * When chartData changes, we need to update the RunCharts with the latest charts\n   */\n  useEffect(() => {\n    updateChartsUIState((current) => {\n      if (!current.compareRunCharts || !current.compareRunSections) {\n        return current;\n      }\n\n      const { resultChartSet, resultSectionSet, isResultUpdated } = RunsChartsCardConfig.updateChartAndSectionConfigs({\n        compareRunCharts: current.compareRunCharts,\n        compareRunSections: current.compareRunSections,\n        runsData: chartData,\n        isAccordionReordered: current.isAccordionReordered,\n      });\n\n      if (!isResultUpdated) {\n        return current;\n      }\n      return {\n        ...current,\n        compareRunCharts: resultChartSet,\n        compareRunSections: resultSectionSet,\n      };\n    });\n  }, [chartData, updateChartsUIState]);\n\n  const onTogglePin = useCallback(\n    (runUuid: string) => {\n      updateUIState((existingFacets: ExperimentPageUIState) => ({\n        ...existingFacets,\n        runsPinned: !existingFacets.runsPinned.includes(runUuid)\n          ? [...existingFacets.runsPinned, runUuid]\n          : existingFacets.runsPinned.filter((r) => r !== runUuid),\n      }));\n    },\n    [updateUIState],\n  );\n\n  const toggleRunVisibility = useToggleRowVisibilityCallback(comparedRuns);\n\n  const onHideRun = useCallback(\n    (runUuid: string) => {\n      if (shouldUseNewRunRowsVisibilityModel()) {\n        toggleRunVisibility(RUNS_VISIBILITY_MODE.CUSTOM, runUuid);\n        return;\n      }\n      updateUIState((existingFacets: ExperimentPageUIState) => ({\n        ...existingFacets,\n        runsHidden: [...existingFacets.runsHidden, runUuid],\n      }));\n    },\n    [updateUIState, toggleRunVisibility],\n  );\n\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n\n  const submitForm = (configuredCard: Partial<RunsChartsCardConfig>) => {\n    confirmChartCardConfiguration(configuredCard);\n\n    // Hide the modal\n    setConfiguredCardConfig(null);\n  };\n\n  /**\n   * Removes the chart from the compare run view.\n   */\n  const removeChart = useRemoveRunsChartFn();\n\n  /**\n   * Reorders the charts in the compare run view.\n   */\n  const reorderCharts = useReorderRunsChartsFn();\n\n  /*\n   * Inserts the source chart into the target group\n   */\n  const insertCharts = useInsertRunsChartsFn();\n\n  /**\n   * Data utilized by the tooltip system:\n   * runs data and toggle pin callback\n   */\n  const tooltipContextValue = useMemo(\n    () => ({ runs: chartData, onTogglePin, onHideRun }),\n    [chartData, onHideRun, onTogglePin],\n  );\n\n  if (!initiallyLoaded) {\n    return (\n      <div\n        css={{\n          flex: 1,\n          borderTop: `1px solid ${theme.colors.border}`,\n          borderLeft: `1px solid ${theme.colors.border}`,\n\n          // Let's cover 1 pixel of the grid's border for the sleek look\n          marginLeft: -1,\n\n          position: 'relative' as const,\n          backgroundColor: theme.colors.backgroundSecondary,\n          paddingLeft: theme.spacing.md,\n          paddingRight: theme.spacing.md,\n          paddingBottom: theme.spacing.md,\n          zIndex: 1,\n          overflowY: 'auto' as const,\n        }}\n      >\n        <LegacySkeleton />\n      </div>\n    );\n  }\n\n  return (\n    <div\n      css={{\n        flex: 1,\n        borderTop: `1px solid ${theme.colors.border}`,\n        borderLeft: `1px solid ${theme.colors.border}`,\n\n        // Let's cover 1 pixel of the grid's border for the sleek look\n        marginLeft: -1,\n\n        position: 'relative' as const,\n        backgroundColor: theme.colors.backgroundSecondary,\n        paddingLeft: theme.spacing.md,\n        paddingRight: theme.spacing.md,\n        paddingBottom: theme.spacing.md,\n        zIndex: 1,\n        overflowY: 'auto' as const,\n\n        // Make sure charts are visible even on small screens\n        minWidth: 320,\n      }}\n      data-testid=\"experiment-view-compare-runs-chart-area\"\n    >\n      <div\n        css={{\n          paddingTop: theme.spacing.sm,\n          paddingBottom: theme.spacing.sm,\n        }}\n      >\n        <Input\n          role=\"searchbox\"\n          prefix={<SearchIcon />}\n          value={search}\n          allowClear\n          onChange={(e) => setSearch(e.target.value)}\n          placeholder={formatMessage({\n            defaultMessage: 'Search metric charts',\n            description: 'Run page > Charts tab > Filter metric charts input > placeholder',\n          })}\n        />\n      </div>\n      <RunsChartsTooltipWrapper contextData={tooltipContextValue} component={RunsChartsTooltipBody}>\n        <DragAndDropProvider>\n          <RunsChartsSectionAccordion\n            compareRunSections={compareRunSections}\n            compareRunCharts={compareRunCharts}\n            reorderCharts={reorderCharts}\n            insertCharts={insertCharts}\n            chartData={chartData}\n            startEditChart={startEditChart}\n            removeChart={removeChart}\n            addNewChartCard={addNewChartCard}\n            search={search}\n            groupBy={groupByNormalized}\n            setFullScreenChart={setFullScreenChart}\n            autoRefreshEnabled={autoRefreshEnabled}\n          />\n        </DragAndDropProvider>\n      </RunsChartsTooltipWrapper>\n      {configuredCardConfig && (\n        <RunsChartsConfigureModal\n          chartRunData={chartData}\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          config={configuredCardConfig}\n          onSubmit={submitForm}\n          onCancel={() => setConfiguredCardConfig(null)}\n          groupBy={groupByNormalized}\n        />\n      )}\n      <RunsChartsFullScreenModal\n        fullScreenChart={fullScreenChart}\n        onCancel={() => setFullScreenChart(undefined)}\n        chartData={chartData}\n        groupBy={groupByNormalized}\n        tooltipContextValue={tooltipContextValue}\n        tooltipComponent={RunsChartsTooltipBody}\n        autoRefreshEnabled={autoRefreshEnabled}\n      />\n    </div>\n  );\n};\n\nexport const RunsCompare = (props: RunsCompareProps) => {\n  // Updater function for the general experiment view UI state\n  const updateUIState = useUpdateExperimentViewUIState();\n\n  // An extracted partial updater function, responsible for setting charts UI state\n  const updateChartsUIState = useCallback<(stateSetter: RunsChartsUIConfigurationSetter) => void>(\n    (setter) => {\n      updateUIState((state) => ({\n        ...state,\n        ...setter(state),\n      }));\n    },\n    [updateUIState],\n  );\n\n  return (\n    <RunsChartsUIConfigurationContextProvider updateChartsUIState={updateChartsUIState}>\n      <RunsCompareImpl {...props} />\n    </RunsChartsUIConfigurationContextProvider>\n  );\n};\n","import { Button, ChevronLeftIcon, ChevronRightIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useState } from 'react';\nimport { ResizableBox } from 'react-resizable';\nimport { useUpdateExperimentViewUIState } from '../../contexts/ExperimentPageUIStateContext';\nimport { Global } from '@emotion/react';\n\nconst RESIZE_BAR_WIDTH = 3;\n\n/**\n * A component wrapping experiment runs table and providing a resizer\n * to adjust its width when displayed in a split view.\n */\nexport const ExperimentViewRunsTableResizer = ({\n  runListHidden,\n  width,\n  onResize,\n  children,\n}: React.PropsWithChildren<{\n  runListHidden: boolean;\n  width: number;\n  onResize: React.Dispatch<React.SetStateAction<number>>;\n}>) => {\n  const updateUIState = useUpdateExperimentViewUIState();\n  const [dragging, setDragging] = useState(false);\n\n  return (\n    <>\n      <ResizableBox\n        css={{ display: 'flex', position: 'relative' }}\n        style={{ flex: `0 0 ${runListHidden ? 0 : width}px` }}\n        width={width}\n        axis=\"x\"\n        resizeHandles={['e']}\n        minConstraints={[250, 0]}\n        handle={\n          <ExperimentViewRunsTableResizerHandle\n            runListHidden={runListHidden}\n            updateRunListHidden={(value) => {\n              updateUIState((state) => ({ ...state, runListHidden: value }));\n            }}\n          />\n        }\n        onResize={(event, { size }) => {\n          if (runListHidden) {\n            return;\n          }\n          onResize(size.width);\n        }}\n        onResizeStart={() => !runListHidden && setDragging(true)}\n        onResizeStop={() => setDragging(false)}\n      >\n        {children}\n      </ResizableBox>\n      {dragging && (\n        <Global\n          styles={{\n            'body, :host': {\n              userSelect: 'none',\n            },\n          }}\n        />\n      )}\n    </>\n  );\n};\n\n/**\n * Internal use component: resizer handle for the runs table resizer\n */\nconst ExperimentViewRunsTableResizerHandle = React.forwardRef<\n  HTMLDivElement,\n  {\n    updateRunListHidden: (newValue: boolean) => void;\n    runListHidden: boolean;\n  }\n>(({ updateRunListHidden, runListHidden, ...props }, ref) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      ref={ref}\n      {...props}\n      css={{\n        transition: 'opacity 0.2s',\n        width: 0,\n        overflow: 'visible',\n        height: '100%',\n        position: 'relative',\n        zIndex: 10,\n        display: 'flex',\n        opacity: runListHidden ? 1 : 0,\n        '&:hover': {\n          opacity: 1,\n          '.bar': { opacity: 1 },\n          '.button': {\n            border: `2px solid ${theme.colors.actionDefaultBorderHover}`,\n          },\n        },\n      }}\n    >\n      <div\n        css={{\n          position: 'absolute',\n          // For the resizing area, use the icon size which is\n          // the same as \"collapse\" button\n          left: -theme.general.iconSize / 2,\n          width: theme.general.iconSize,\n          cursor: runListHidden ? undefined : 'ew-resize',\n          height: '100%',\n          top: 0,\n          bottom: 0,\n        }}\n      >\n        <div\n          className=\"button\"\n          css={{\n            top: '50%',\n            transition: 'border-color 0.2s',\n            position: 'absolute',\n            width: theme.general.iconSize,\n            height: theme.general.iconSize,\n            backgroundColor: theme.colors.backgroundPrimary,\n            borderRadius: theme.general.iconSize,\n            overflow: 'hidden',\n            border: `1px solid ${theme.colors.border}`,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            zIndex: 11,\n          }}\n        >\n          <Button\n            componentId=\"mlflow.experiment_page.table_resizer.collapse\"\n            onClick={() => updateRunListHidden(!runListHidden)}\n            icon={runListHidden ? <ChevronRightIcon /> : <ChevronLeftIcon />}\n            size=\"small\"\n          />\n        </div>\n      </div>\n      <div\n        className=\"bar\"\n        css={{\n          position: 'absolute',\n          opacity: 0,\n          left: -RESIZE_BAR_WIDTH / 2,\n          width: RESIZE_BAR_WIDTH,\n          height: '100%',\n          top: 0,\n          bottom: 0,\n          backgroundColor: theme.colors.actionPrimaryBackgroundDefault,\n        }}\n      ></div>\n    </div>\n  );\n});\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useLegacyNotification } from '@databricks/design-system';\nimport {\n  DatasetSummary,\n  ExperimentEntity,\n  LIFECYCLE_FILTER,\n  MODEL_VERSION_FILTER,\n  RunDatasetWithTags,\n  UpdateExperimentViewStateFn,\n} from '../../../../types';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRunsControls } from './ExperimentViewRunsControls';\nimport { ExperimentViewRunsTable } from './ExperimentViewRunsTable';\nimport { ExperimentPageViewState } from '../../models/ExperimentPageViewState';\nimport Utils from '../../../../../common/utils/Utils';\nimport { ATTRIBUTE_COLUMN_SORT_KEY, MLFLOW_LOGGED_IMAGE_ARTIFACTS_PATH } from '../../../../constants';\nimport { RunRowType } from '../../utils/experimentPage.row-types';\nimport { useExperimentRunRows } from '../../utils/experimentPage.row-utils';\nimport { useFetchedRunsNotification } from '../../hooks/useFetchedRunsNotification';\nimport { DatasetWithRunType, ExperimentViewDatasetDrawer } from './ExperimentViewDatasetDrawer';\nimport { useExperimentViewLocalStore } from '../../hooks/useExperimentViewLocalStore';\nimport { EvaluationArtifactCompareView } from '../../../evaluation-artifacts-compare/EvaluationArtifactCompareView';\nimport {\n  shouldEnableExperimentPageAutoRefresh,\n  shouldEnableRunsTableRunNameColumnResize,\n} from '../../../../../common/utils/FeatureUtils';\nimport { CreateNewRunContextProvider } from '../../hooks/useCreateNewRun';\nimport { useExperimentPageViewMode } from '../../hooks/useExperimentPageViewMode';\nimport { ExperimentPageUIState } from '../../models/ExperimentPageUIState';\nimport { RunsCompare } from '../../../runs-compare/RunsCompare';\nimport { ErrorWrapper } from '../../../../../common/utils/ErrorWrapper';\nimport { ReduxState, ThunkDispatch } from '../../../../../redux-types';\nimport { ExperimentPageSearchFacetsState } from '../../models/ExperimentPageSearchFacetsState';\nimport { useIsTabActive } from '../../../../../common/hooks/useIsTabActive';\nimport { ExperimentViewRunsTableResizer } from './ExperimentViewRunsTableResizer';\n\nexport interface ExperimentViewRunsOwnProps {\n  isLoading: boolean;\n  experiments: ExperimentEntity[];\n  modelVersionFilter?: MODEL_VERSION_FILTER;\n  lifecycleFilter?: LIFECYCLE_FILTER;\n  datasetsFilter?: DatasetSummary[];\n  onMaximizedChange?: (newIsMaximized: boolean) => void;\n\n  searchFacetsState: ExperimentPageSearchFacetsState;\n  uiState: ExperimentPageUIState;\n}\n\nexport interface ExperimentViewRunsProps extends ExperimentViewRunsOwnProps {\n  runsData: ExperimentRunsSelectorResult;\n  isLoadingRuns: boolean;\n  loadMoreRuns: () => Promise<any>;\n  moreRunsAvailable: boolean;\n  requestError: ErrorWrapper | null;\n  refreshRuns: () => void;\n}\n\n/**\n * Creates time with milliseconds set to zero, usable in calculating\n * relative time\n */\nconst createCurrentTime = () => {\n  const mountTime = new Date();\n  mountTime.setMilliseconds(0);\n  return mountTime;\n};\n\nexport const INITIAL_RUN_COLUMN_SIZE = 295;\n\nconst getTableLayoutStyles = (isComparingRuns = false, runListHidden = false) =>\n  shouldEnableRunsTableRunNameColumnResize()\n    ? {\n        display: 'flex',\n      }\n    : {\n        display: 'grid',\n        gridTemplateColumns: isComparingRuns\n          ? runListHidden\n            ? '10px 1fr'\n            : `${INITIAL_RUN_COLUMN_SIZE}px 1fr`\n          : '1fr',\n      };\n\nexport const ExperimentViewRuns = React.memo((props: ExperimentViewRunsProps) => {\n  const [compareRunsMode] = useExperimentPageViewMode();\n  const {\n    experiments,\n    runsData,\n    uiState,\n    searchFacetsState,\n    isLoadingRuns,\n    loadMoreRuns,\n    moreRunsAvailable,\n    requestError,\n    refreshRuns,\n  } = props;\n\n  // Non-persistable view model state is being created locally\n  const [viewState, setViewState] = useState(new ExperimentPageViewState());\n\n  const { experimentId } = experiments[0];\n  const expandRowsStore = useExperimentViewLocalStore(experimentId);\n  const [expandRows, updateExpandRows] = useState<boolean>(expandRowsStore.getItem('expandRows') === 'true');\n\n  useEffect(() => {\n    expandRowsStore.setItem('expandRows', expandRows);\n  }, [expandRows, expandRowsStore]);\n\n  const {\n    paramKeyList,\n    metricKeyList,\n    tagsList,\n    paramsList,\n    metricsList,\n    runInfos,\n    runUuidsMatchingFilter,\n    datasetsList,\n  } = runsData;\n\n  const modelVersionsByRunUuid = useSelector(({ entities }: ReduxState) => entities.modelVersionsByRunUuid);\n\n  /**\n   * Create a list of run infos with assigned metrics, params and tags\n   */\n  const runData = useMemo(\n    () =>\n      runInfos.map((runInfo, index) => ({\n        runInfo,\n        params: paramsList[index],\n        metrics: metricsList[index],\n        tags: tagsList[index],\n        datasets: datasetsList[index],\n      })),\n    [datasetsList, metricsList, paramsList, runInfos, tagsList],\n  );\n\n  const { orderByKey, searchFilter } = searchFacetsState;\n  // In new view state model, runs state is in the uiState instead of the searchFacetsState.\n  const { runsPinned, runsExpanded, runsHidden, runListHidden } = uiState;\n\n  const isComparingRuns = compareRunsMode !== 'TABLE';\n\n  const updateViewState = useCallback<UpdateExperimentViewStateFn>(\n    (newPartialViewState) => setViewState((currentViewState) => ({ ...currentViewState, ...newPartialViewState })),\n    [],\n  );\n\n  const addColumnClicked = useCallback(() => {\n    updateViewState({ columnSelectorVisible: true });\n  }, [updateViewState]);\n\n  const shouldNestChildrenAndFetchParents = useMemo(\n    () => (!orderByKey && !searchFilter) || orderByKey === ATTRIBUTE_COLUMN_SORT_KEY.DATE,\n    [orderByKey, searchFilter],\n  );\n\n  // Value used a reference for the \"date\" column\n  const [referenceTime, setReferenceTime] = useState(createCurrentTime);\n\n  // We're setting new reference date only when new runs data package has arrived\n  useEffect(() => {\n    setReferenceTime(createCurrentTime);\n  }, [runInfos]);\n\n  const filteredTagKeys = useMemo(() => Utils.getVisibleTagKeyList(tagsList), [tagsList]);\n\n  const [isDrawerOpen, setIsDrawerOpen] = useState<boolean>(false);\n  const [selectedDatasetWithRun, setSelectedDatasetWithRun] = useState<DatasetWithRunType>();\n\n  // Use new, memoized version of the row creation function.\n  // Internally disabled if the flag is not set.\n  const visibleRuns = useExperimentRunRows({\n    experiments,\n    paramKeyList,\n    metricKeyList,\n    modelVersionsByRunUuid,\n    runsExpanded,\n    tagKeyList: filteredTagKeys,\n    nestChildren: shouldNestChildrenAndFetchParents,\n    referenceTime,\n    runData,\n    runUuidsMatchingFilter,\n    runsPinned,\n    runsHidden,\n    groupBy: uiState.groupBy,\n    groupsExpanded: uiState.groupsExpanded,\n    runsHiddenMode: uiState.runsHiddenMode,\n  });\n\n  const [notificationsFn, notificationContainer] = useLegacyNotification();\n  const showFetchedRunsNotifications = useFetchedRunsNotification(notificationsFn);\n\n  const [tableAreaWidth, setTableAreaWidth] = useState(INITIAL_RUN_COLUMN_SIZE);\n\n  const loadMoreRunsCallback = useCallback(() => {\n    if (moreRunsAvailable && !isLoadingRuns) {\n      // Don't do this if we're loading runs\n      // to prevent too many requests from being\n      // sent out\n      loadMoreRuns().then((runs) => {\n        // Display notification about freshly loaded runs\n        showFetchedRunsNotifications(runs, runInfos);\n      });\n    }\n  }, [moreRunsAvailable, isLoadingRuns, loadMoreRuns, runInfos, showFetchedRunsNotifications]);\n\n  const datasetSelected = useCallback((dataset: RunDatasetWithTags, run: RunRowType) => {\n    setSelectedDatasetWithRun({ datasetWithTags: dataset, runData: run });\n    setIsDrawerOpen(true);\n  }, []);\n\n  const isTabActive = useIsTabActive();\n  const autoRefreshEnabled = uiState.autoRefreshEnabled && shouldEnableExperimentPageAutoRefresh() && isTabActive;\n\n  const tableElement = (\n    <ExperimentViewRunsTable\n      experiments={experiments}\n      runsData={runsData}\n      searchFacetsState={searchFacetsState}\n      viewState={viewState}\n      isLoading={isLoadingRuns}\n      updateViewState={updateViewState}\n      onAddColumnClicked={addColumnClicked}\n      rowsData={visibleRuns}\n      loadMoreRunsFunc={loadMoreRunsCallback}\n      moreRunsAvailable={moreRunsAvailable}\n      onDatasetSelected={datasetSelected}\n      expandRows={expandRows}\n      uiState={uiState}\n      compareRunsMode={compareRunsMode}\n    />\n  );\n\n  return (\n    <CreateNewRunContextProvider visibleRuns={visibleRuns} refreshRuns={refreshRuns}>\n      <ExperimentViewRunsControls\n        viewState={viewState}\n        updateViewState={updateViewState}\n        runsData={runsData}\n        searchFacetsState={searchFacetsState}\n        experimentId={experimentId}\n        requestError={requestError}\n        expandRows={expandRows}\n        updateExpandRows={updateExpandRows}\n        refreshRuns={refreshRuns}\n        uiState={uiState}\n        isLoading={isLoadingRuns}\n      />\n      <div\n        css={[\n          {\n            minHeight: 225, // This is the exact height for displaying a minimum five rows and table header\n            height: '100%',\n            position: 'relative',\n          },\n          getTableLayoutStyles(isComparingRuns, runListHidden),\n        ]}\n      >\n        {isComparingRuns && shouldEnableRunsTableRunNameColumnResize() ? (\n          <ExperimentViewRunsTableResizer\n            onResize={setTableAreaWidth}\n            runListHidden={runListHidden}\n            width={tableAreaWidth}\n          >\n            {tableElement}\n          </ExperimentViewRunsTableResizer>\n        ) : (\n          tableElement\n        )}\n        {compareRunsMode === 'CHART' && (\n          <RunsCompare\n            isLoading={isLoadingRuns}\n            comparedRuns={visibleRuns}\n            metricKeyList={runsData.metricKeyList}\n            paramKeyList={runsData.paramKeyList}\n            experimentTags={runsData.experimentTags}\n            compareRunCharts={uiState.compareRunCharts}\n            compareRunSections={uiState.compareRunSections}\n            groupBy={uiState.groupBy}\n            autoRefreshEnabled={autoRefreshEnabled}\n          />\n        )}\n        {compareRunsMode === 'ARTIFACT' && (\n          <EvaluationArtifactCompareView\n            comparedRuns={visibleRuns}\n            viewState={viewState}\n            updateViewState={updateViewState}\n            onDatasetSelected={datasetSelected}\n            disabled={Boolean(uiState.groupBy)}\n          />\n        )}\n        {notificationContainer}\n        {selectedDatasetWithRun && (\n          <ExperimentViewDatasetDrawer\n            isOpen={isDrawerOpen}\n            setIsOpen={setIsDrawerOpen}\n            selectedDatasetWithRun={selectedDatasetWithRun}\n            setSelectedDatasetWithRun={setSelectedDatasetWithRun}\n          />\n        )}\n      </div>\n    </CreateNewRunContextProvider>\n  );\n});\n","import { useContext } from 'react';\n\nimport { GetExperimentsContext } from '../contexts/GetExperimentsContext';\n\nexport const useFetchExperiments = () => {\n  const getExperimentsContext = useContext(GetExperimentsContext);\n\n  if (!getExperimentsContext) {\n    throw new Error('Trying to use GetExperimentsContext actions outside of the context!');\n  }\n\n  return getExperimentsContext;\n};\n","import LocalStorageUtils from '../../../../common/utils/LocalStorageUtils';\nimport Utils from '../../../../common/utils/Utils';\n\nimport { ExperimentPageUIState, createExperimentPageUIState } from '../models/ExperimentPageUIState';\nimport {\n  ExperimentPageSearchFacetsState,\n  createExperimentPageSearchFacetsState,\n} from '../models/ExperimentPageSearchFacetsState';\n\n/**\n * Loads current view state (UI state, view state) in the local storage.\n */\nexport function loadExperimentViewState(idKey: string) {\n  try {\n    const localStorageInstance = LocalStorageUtils.getStoreForComponent('ExperimentPage', idKey);\n    return localStorageInstance.loadComponentState();\n  } catch {\n    Utils.logErrorAndNotifyUser(`Error: malformed persisted search state for experiment(s) ${idKey}`);\n\n    return {\n      ...createExperimentPageUIState(),\n      ...createExperimentPageSearchFacetsState(),\n    };\n  }\n}\n\n/**\n * Persists view state (UI state, view state) in the local storage.\n */\nexport function saveExperimentViewState(data: ExperimentPageUIState & ExperimentPageSearchFacetsState, idKey: string) {\n  const localStorageInstance = LocalStorageUtils.getStoreForComponent('ExperimentPage', idKey);\n  localStorageInstance.saveComponentState(data);\n}\n","import { useEffect, useMemo } from 'react';\n\nimport { pick } from 'lodash';\nimport { createExperimentPageSearchFacetsState } from '../models/ExperimentPageSearchFacetsState';\nimport { ExperimentPageUIState } from '../models/ExperimentPageUIState';\nimport { loadExperimentViewState, saveExperimentViewState } from '../utils/persistSearchFacets';\nimport {\n  EXPERIMENT_PAGE_QUERY_PARAM_KEYS,\n  ExperimentQueryParamsSearchFacets,\n  useUpdateExperimentPageSearchFacets,\n} from './useExperimentPageSearchFacets';\n\n/**\n * Takes care of initializing the search facets from persisted view state and persisting them.\n * Partially replaces GetExperimentRunsContext.\n */\nexport const usePersistExperimentPageViewState = (\n  uiState: ExperimentPageUIState,\n  searchFacets: ExperimentQueryParamsSearchFacets | null,\n  experimentIds: string[],\n  disabled = false,\n) => {\n  const setSearchFacets = useUpdateExperimentPageSearchFacets();\n\n  const persistKey = useMemo(() => (experimentIds ? JSON.stringify(experimentIds.sort()) : null), [experimentIds]);\n\n  // If there are no query params visible in the address bar, either reinstantiate\n  // them from persisted view state or use default values.\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n    if (!searchFacets) {\n      const persistedViewState = persistKey ? loadExperimentViewState(persistKey) : null;\n      const rebuiltViewState = pick(\n        { ...createExperimentPageSearchFacetsState(), ...persistedViewState },\n        EXPERIMENT_PAGE_QUERY_PARAM_KEYS,\n      );\n      setSearchFacets(rebuiltViewState, { replace: true });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchFacets, persistKey, disabled]);\n\n  // Persist complete view state in local storage when either search facets or UI state change\n  useEffect(() => {\n    if (!searchFacets || !persistKey || disabled) {\n      return;\n    }\n    saveExperimentViewState({ ...searchFacets, ...uiState }, persistKey);\n  }, [searchFacets, uiState, persistKey, disabled]);\n};\n","import {\n  ExperimentEntity,\n  ExperimentStoreEntities,\n  KeyValueEntity,\n  LIFECYCLE_FILTER,\n  ModelVersionInfoEntity,\n  MODEL_VERSION_FILTER,\n  DatasetSummary,\n  RunInfoEntity,\n  RunDatasetWithTags,\n  MetricEntity,\n} from '../../../types';\nimport { getLatestMetrics } from '../../../reducers/MetricReducer';\nimport { getExperimentTags, getParams, getRunDatasets, getRunInfo, getRunTags } from '../../../reducers/Reducers';\n\nexport type ExperimentRunsSelectorResult = {\n  /**\n   * Array of run infos\n   */\n  runInfos: RunInfoEntity[];\n\n  /**\n   * List of unique metric keys\n   */\n  runUuidsMatchingFilter: string[];\n\n  /**\n   * List of unique metric keys\n   */\n  metricKeyList: string[];\n\n  /**\n   * List of unique param keys\n   */\n  paramKeyList: string[];\n\n  /**\n   * List of metrics indexed by the respective runs.\n   * Example: metricsList[2] contains list of all\n   * metrics corresponding to the 3rd run in the run list\n   */\n  metricsList: MetricEntity[][];\n\n  /**\n   * List of metrics indexed by the respective runs.\n   * Example: paramsList[2] contains list of all\n   * params corresponding to the 3rd run in the run list\n   */\n  paramsList: KeyValueEntity[][];\n\n  /**\n   * List of tags indexed by the respective runs.\n   * Example: tagsList[2] contains dictionary of all\n   * tags corresponding to the 3rd run in the run list\n   */\n  tagsList: Record<string, KeyValueEntity>[];\n\n  /**\n   * Dictionary containing model information objects indexed by run uuid\n   */\n  modelVersionsByRunUuid: Record<string, ModelVersionInfoEntity[]>;\n\n  /**\n   * Dictionary containing all tags assigned to a experiment\n   * (single experiment only)\n   */\n  experimentTags: Record<string, KeyValueEntity>;\n\n  /**\n   * List of dataset arrays indexed by the respective runs.\n   * E.g. datasetsList[2] yields an array of all\n   * datasets corresponding to the 3rd run in the run list\n   */\n  datasetsList: RunDatasetWithTags[][];\n};\n\nexport type ExperimentRunsSelectorParams = {\n  experiments: ExperimentEntity[];\n  experimentIds?: string[];\n  lifecycleFilter?: LIFECYCLE_FILTER;\n  modelVersionFilter?: MODEL_VERSION_FILTER;\n  datasetsFilter?: DatasetSummary[];\n};\n\n/**\n * Extracts run infos filtered by lifecycle filter and model version filter\n */\nconst extractRunInfos = (\n  runUuids: string[],\n  state: { entities: ExperimentStoreEntities },\n  {\n    lifecycleFilter = LIFECYCLE_FILTER.ACTIVE,\n    modelVersionFilter = MODEL_VERSION_FILTER.ALL_RUNS,\n    datasetsFilter = [],\n  }: ExperimentRunsSelectorParams,\n): RunInfoEntity[] => {\n  const { modelVersionsByRunUuid } = state.entities;\n\n  return (\n    runUuids\n      // Get the basic run info\n      .map((run_id) => [getRunInfo(run_id, state), getRunDatasets(run_id, state)])\n      // Filter out runs by given lifecycle filter\n      .filter(([rInfo, _]) => {\n        if (lifecycleFilter === LIFECYCLE_FILTER.ACTIVE) {\n          return rInfo.lifecycleStage === 'active';\n        } else {\n          return rInfo.lifecycleStage === 'deleted';\n        }\n      })\n      // Filter out runs by given model version filter\n      .filter(([rInfo, _]) => {\n        if (modelVersionFilter === MODEL_VERSION_FILTER.ALL_RUNS) {\n          return true;\n        } else if (modelVersionFilter === MODEL_VERSION_FILTER.WITH_MODEL_VERSIONS) {\n          return rInfo.runUuid in modelVersionsByRunUuid;\n        } else if (modelVersionFilter === MODEL_VERSION_FILTER.WTIHOUT_MODEL_VERSIONS) {\n          return !(rInfo.runUuid in modelVersionsByRunUuid);\n        } else {\n          console.warn('Invalid input to model version filter - defaulting to showing all runs.');\n          return true;\n        }\n      })\n      .filter(([_, datasets]) => {\n        if (!datasetsFilter || datasetsFilter.length === 0) return true;\n        if (!datasets) return false;\n\n        // Returns true if there exists a dataset that is in datasetsFilter\n        return datasets.some((datasetWithTags: RunDatasetWithTags) => {\n          const datasetName = datasetWithTags.dataset.name;\n          const datasetDigest = datasetWithTags.dataset.digest;\n          const datasetTag = datasetWithTags.tags\n            ? datasetWithTags.tags.find((tag) => tag.key === 'mlflow.data.context')\n            : undefined;\n          return datasetsFilter.some(\n            ({ name, digest, context }) =>\n              name === datasetName &&\n              digest === datasetDigest &&\n              (datasetTag ? context === datasetTag.value : context === undefined),\n          );\n        });\n      })\n      .map(([rInfo, _]) => rInfo)\n  );\n};\n\nexport const experimentRunsSelector = (\n  state: { entities: ExperimentStoreEntities },\n  params: ExperimentRunsSelectorParams,\n): ExperimentRunsSelectorResult => {\n  const { experiments } = params;\n  const experimentIds = params.experimentIds || experiments.map((e) => e.experimentId);\n  const comparingExperiments = experimentIds.length > 1;\n\n  /**\n   * Extract run UUIDs relevant to selected experiments\n   */\n  const runUuids = Object.values(state.entities.runInfosByUuid)\n    .filter(({ experimentId }) => experimentIds.includes(experimentId))\n    .map(({ runUuid }) => runUuid);\n\n  /**\n   * Extract model version and runs matching filter directly from the store\n   */\n  const { modelVersionsByRunUuid, runUuidsMatchingFilter } = state.entities;\n\n  /**\n   * Extract run infos\n   */\n  const runInfos = extractRunInfos(runUuids, state, params);\n\n  /**\n   * Set of unique metric keys\n   */\n  const metricKeysSet = new Set<string>();\n\n  /**\n   * Set of unique param keys\n   */\n  const paramKeysSet = new Set<string>();\n\n  const datasetsList = runInfos.map((runInfo) => {\n    return state.entities.runDatasetsByUuid[runInfo.runUuid];\n  });\n\n  /**\n   * Extracting lists of metrics by run index\n   */\n  const metricsList = runInfos.map((runInfo) => {\n    const metricsByRunUuid = getLatestMetrics(runInfo.runUuid, state);\n    const metrics = Object.values(metricsByRunUuid || {}) as any[];\n    metrics.forEach((metric) => {\n      metricKeysSet.add(metric.key);\n    });\n    return metrics;\n  }) as MetricEntity[][];\n\n  /**\n   * Extracting lists of params by run index\n   */\n  const paramsList = runInfos.map((runInfo) => {\n    const paramValues = Object.values(getParams(runInfo.runUuid, state)) as any[];\n    paramValues.forEach((param) => {\n      paramKeysSet.add(param.key);\n    });\n    return paramValues;\n  }) as KeyValueEntity[][];\n\n  /**\n   * Extracting dictionaries of tags by run index\n   */\n  const tagsList = runInfos.map((runInfo) => getRunTags(runInfo.runUuid, state)) as Record<string, KeyValueEntity>[];\n\n  const firstExperimentId = experimentIds[0];\n\n  /**\n   * If there is only one experiment, extract experiment tags as well\n   */\n  const experimentTags = (comparingExperiments ? {} : getExperimentTags(firstExperimentId, state)) as Record<\n    string,\n    KeyValueEntity\n  >;\n\n  return {\n    modelVersionsByRunUuid,\n    experimentTags,\n    runInfos,\n    paramsList,\n    tagsList,\n    metricsList,\n    runUuidsMatchingFilter,\n    datasetsList,\n    metricKeyList: Array.from(metricKeysSet.values()).sort(),\n    paramKeyList: Array.from(paramKeysSet.values()).sort(),\n  };\n};\n","import { useEffect, useRef } from 'react';\nimport { RUNS_SEARCH_MAX_RESULTS } from '../../../actions';\nimport { isArray, isEqual } from 'lodash';\nimport type { ExperimentQueryParamsSearchFacets } from './useExperimentPageSearchFacets';\nimport type { ExperimentRunsSelectorResult } from '../utils/experimentRuns.selector';\nimport { RUNS_AUTO_REFRESH_INTERVAL, createSearchRunsParams } from '../utils/experimentPage.fetch-utils';\nimport type { FetchRunsHookFunction } from './useExperimentRuns';\n\n/**\n * Enables auto-refreshing runs on the experiment page.\n * The hook will schedule a new runs fetch every `RUNS_AUTO_REFRESH_INTERVAL` milliseconds and will be postponed\n * if user is currently loading runs or changes the search facets.\n */\nexport const useExperimentRunsAutoRefresh = ({\n  experimentIds,\n  lastFetchedTime,\n  fetchRuns,\n  searchFacets,\n  enabled,\n  cachedPinnedRuns,\n  runsData,\n  isLoadingRuns,\n}: {\n  cachedPinnedRuns: React.MutableRefObject<string[]>;\n  lastFetchedTime: React.MutableRefObject<number | null>;\n  enabled: boolean;\n  experimentIds: string[];\n  fetchRuns: FetchRunsHookFunction;\n  searchFacets: ExperimentQueryParamsSearchFacets | null;\n  runsData: ExperimentRunsSelectorResult;\n  isLoadingRuns: boolean;\n}) => {\n  const refreshTimeoutRef = useRef<number | undefined>(undefined);\n\n  const isLoadingImmediate = useRef(isLoadingRuns);\n  const autoRefreshEnabledRef = useRef(enabled);\n  const currentResults = useRef(runsData.runInfos);\n\n  currentResults.current = runsData.runInfos;\n  isLoadingImmediate.current = isLoadingRuns;\n  autoRefreshEnabledRef.current = enabled;\n\n  useEffect(() => {\n    // Each time the parameters change, clear the timeout and try to schedule a new one\n    window.clearTimeout(refreshTimeoutRef.current);\n\n    // If auto refresh has been disabled or user is currently loading runs, do not schedule a new refresh\n    if (!enabled || isLoadingRuns) {\n      return;\n    }\n\n    const scheduleRefresh = async () => {\n      const hasBeenInitialized = Boolean(lastFetchedTime.current);\n      const timePassed = lastFetchedTime.current ? Date.now() - lastFetchedTime.current : 0;\n      if (searchFacets && hasBeenInitialized && timePassed >= RUNS_AUTO_REFRESH_INTERVAL) {\n        const requestedPageCount = Math.ceil(currentResults.current.length / RUNS_SEARCH_MAX_RESULTS);\n\n        const requestParams = {\n          ...createSearchRunsParams(\n            experimentIds,\n            { ...searchFacets, runsPinned: cachedPinnedRuns.current },\n            Date.now(),\n          ),\n          requestedFacets: searchFacets,\n          maxResults: requestedPageCount * RUNS_SEARCH_MAX_RESULTS,\n        };\n\n        await fetchRuns(requestParams, {\n          isAutoRefreshing: true,\n          discardResultsFn: (lastRequestedParams) => {\n            const existingPageCount = Math.ceil(currentResults.current.length / RUNS_SEARCH_MAX_RESULTS);\n\n            // At this moment, check if the results from auto-refresh should be considered. If the following\n            // conditions are met, the results from auto-refresh will be discarded.\n            if (\n              // Skip if auto-refresh has been disabled before the results response came back\n              !autoRefreshEnabledRef.current ||\n              // Skip if user has loaded more runs since the last request\n              existingPageCount !== requestedPageCount ||\n              // Skip if the requested facets have changed since the last request\n              !isEqual(lastRequestedParams.requestedFacets, requestParams.requestedFacets)\n            ) {\n              return true;\n            }\n\n            // Otherwise, return \"false\" and consider the results from auto-refresh as valid\n            return false;\n          },\n        });\n      }\n\n      // Clear the timeout before scheduling a new one\n      window.clearTimeout(refreshTimeoutRef.current);\n\n      // If auto refresh has been disabled during last fetch, do not schedule a new one\n      if (!autoRefreshEnabledRef.current) {\n        return;\n      }\n      refreshTimeoutRef.current = window.setTimeout(scheduleRefresh, RUNS_AUTO_REFRESH_INTERVAL);\n    };\n    scheduleRefresh();\n    return () => {\n      clearTimeout(refreshTimeoutRef.current);\n    };\n  }, [experimentIds, fetchRuns, searchFacets, enabled, cachedPinnedRuns, lastFetchedTime, isLoadingRuns]);\n};\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { useDispatch } from 'react-redux';\nimport { ReduxState, ThunkDispatch } from '../../../../redux-types';\nimport { loadMoreRunsApi, searchRunsApi } from '../../../actions';\nimport { ExperimentPageUIState } from '../models/ExperimentPageUIState';\nimport { createSearchRunsParams, fetchModelVersionsForRuns } from '../utils/experimentPage.fetch-utils';\nimport { ExperimentRunsSelectorResult, experimentRunsSelector } from '../utils/experimentRuns.selector';\nimport { ExperimentQueryParamsSearchFacets } from './useExperimentPageSearchFacets';\nimport { ExperimentPageSearchFacetsState } from '../models/ExperimentPageSearchFacetsState';\nimport { ErrorWrapper } from '../../../../common/utils/ErrorWrapper';\nimport { searchModelVersionsApi } from '../../../../model-registry/actions';\nimport { shouldEnableExperimentPageAutoRefresh } from '../../../../common/utils/FeatureUtils';\nimport Utils from '../../../../common/utils/Utils';\nimport { useExperimentRunsAutoRefresh } from './useExperimentRunsAutoRefresh';\nimport { RunEntity } from '../../../types';\n\nexport type FetchRunsHookParams = ReturnType<typeof createSearchRunsParams> & {\n  requestedFacets: ExperimentPageSearchFacetsState;\n};\n\nexport type FetchRunsHookFunction = (\n  params: FetchRunsHookParams,\n  options?: {\n    isAutoRefreshing?: boolean;\n    discardResultsFn?: (lastRequestedParams: FetchRunsHookParams) => boolean;\n  },\n) => Promise<RunEntity[]>;\n\n// Calculate actual params to use for fetching runs\nconst createFetchRunsRequestParams = (\n  searchFacets: ExperimentQueryParamsSearchFacets | null,\n  experimentIds: string[],\n  runsPinned: string[],\n): FetchRunsHookParams | null => {\n  if (!searchFacets || !experimentIds.length) {\n    return null;\n  }\n  const searchParams = createSearchRunsParams(experimentIds, { ...searchFacets, runsPinned }, Date.now());\n  return { ...searchParams, requestedFacets: searchFacets };\n};\n\n/**\n * This hook will request for new runs data based on the current experiment page search facets and UI state.\n * Replaces GetExperimentRunsContext and a substantial portion of <ExperimentRuns> component stack.\n */\nexport const useExperimentRuns = (\n  uiState: ExperimentPageUIState,\n  searchFacets: ExperimentQueryParamsSearchFacets | null,\n  experimentIds: string[],\n  disabled = false,\n) => {\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const [runsData, setRunsData] = useState<ExperimentRunsSelectorResult>(() => createEmptyRunsResult());\n\n  const persistKey = useMemo(() => (experimentIds ? JSON.stringify(experimentIds.sort()) : null), [experimentIds]);\n  const [isLoadingRuns, setIsLoadingRuns] = useState(true);\n  const [isInitialLoadingRuns, setIsInitialLoadingRuns] = useState(true);\n  const [nextPageToken, setNextPageToken] = useState<string | null>(null);\n  const [requestError, setRequestError] = useState<ErrorWrapper | null>(null);\n  const cachedPinnedRuns = useRef<string[]>([]);\n\n  const lastFetchedTime = useRef<number | null>(null);\n  const lastRequestedParams = useRef<FetchRunsHookParams | null>(null);\n\n  // Reset initial loading state when experiment IDs change\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n    setIsInitialLoadingRuns(true);\n    setRunsData(createEmptyRunsResult());\n  }, [persistKey, disabled]);\n\n  const setResultRunsData = useCallback(\n    (store: ReduxState, experimentIds: string[], requestedFacets: ExperimentPageSearchFacetsState) => {\n      setRunsData(\n        experimentRunsSelector(store, {\n          datasetsFilter: requestedFacets.datasetsFilter,\n          lifecycleFilter: requestedFacets.lifecycleFilter,\n          modelVersionFilter: requestedFacets.modelVersionFilter,\n          // In the new version of the view state, experiment IDs are used instead of full experiment entities:\n          experiments: [],\n          experimentIds,\n        }),\n      );\n    },\n    [],\n  );\n\n  useEffect(() => {\n    cachedPinnedRuns.current = uiState.runsPinned;\n  }, [uiState.runsPinned]);\n\n  const loadModelVersions = useCallback(\n    (runs: Parameters<typeof fetchModelVersionsForRuns>[0]) => {\n      fetchModelVersionsForRuns(runs || [], searchModelVersionsApi, dispatch);\n    },\n    [dispatch],\n  );\n\n  // Main function for fetching runs\n  const fetchRuns: FetchRunsHookFunction = useCallback(\n    (fetchParams, options = {}) =>\n      dispatch((thunkDispatch: ThunkDispatch, getStore: () => ReduxState) => {\n        // If we're auto-refreshing, we don't want to show the loading spinner and\n        // we don't want to update the last requested params - they're used to determine\n        // whether to discard results when the automatically fetched data changes.\n        if (!options.isAutoRefreshing) {\n          setIsLoadingRuns(true);\n          lastRequestedParams.current = fetchParams;\n        }\n        return thunkDispatch((fetchParams.pageToken ? loadMoreRunsApi : searchRunsApi)(fetchParams))\n          .then(async ({ value }) => {\n            setNextPageToken(value.next_page_token || null);\n            lastFetchedTime.current = Date.now();\n\n            setIsLoadingRuns(false);\n            setIsInitialLoadingRuns(false);\n\n            if (lastRequestedParams.current && options.discardResultsFn?.(lastRequestedParams.current)) {\n              return value;\n            }\n\n            // We rely on redux reducer to update the state with new runs data,\n            // then we pick it up from the store. This benefits other pages that use same data\n            // from the same store slice (e.g. run details page). Will be changed when moving to graphQL.\n            setResultRunsData(getStore(), fetchParams.experimentIds, fetchParams.requestedFacets);\n\n            // In the end, load model versions for the fetched runs\n            loadModelVersions(value.runs || []);\n            return value;\n          })\n          .catch((e) => {\n            setIsLoadingRuns(false);\n            setIsInitialLoadingRuns(false);\n            setRequestError(e);\n            Utils.logErrorAndNotifyUser(e);\n          });\n      }),\n    [dispatch, setResultRunsData, loadModelVersions],\n  );\n\n  // Fetch runs when new request params are available\n  // (e.g. after search facets change)\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n    const requestParams = createFetchRunsRequestParams(searchFacets, experimentIds, cachedPinnedRuns.current);\n    if (requestParams) {\n      fetchRuns(requestParams);\n    }\n  }, [fetchRuns, dispatch, disabled, searchFacets, experimentIds]);\n\n  const loadMoreRuns = async () => {\n    const requestParams = createFetchRunsRequestParams(searchFacets, experimentIds, cachedPinnedRuns.current);\n    if (!nextPageToken || !requestParams) {\n      return [];\n    }\n    return fetchRuns({ ...requestParams, pageToken: nextPageToken });\n  };\n\n  const refreshRuns = () => {\n    const requestParams = createFetchRunsRequestParams(searchFacets, experimentIds, cachedPinnedRuns.current);\n    if (requestParams) {\n      fetchRuns(requestParams);\n    }\n  };\n\n  useExperimentRunsAutoRefresh({\n    experimentIds,\n    fetchRuns,\n    searchFacets,\n    enabled: uiState.autoRefreshEnabled && shouldEnableExperimentPageAutoRefresh(),\n    cachedPinnedRuns,\n    runsData,\n    isLoadingRuns: isLoadingRuns,\n    lastFetchedTime,\n  });\n\n  return {\n    isLoadingRuns,\n    moreRunsAvailable: Boolean(nextPageToken),\n    refreshRuns,\n    loadMoreRuns,\n    isInitialLoadingRuns,\n    runsData,\n    requestError,\n  };\n};\n\nconst createEmptyRunsResult = () => ({\n  datasetsList: [],\n  experimentTags: {},\n  metricKeyList: [],\n  metricsList: [],\n  modelVersionsByRunUuid: {},\n  paramKeyList: [],\n  paramsList: [],\n  runInfos: [],\n  runUuidsMatchingFilter: [],\n  tagsList: [],\n});\n","import { useCallback, useEffect, useMemo, useReducer, useState } from 'react';\nimport {\n  EXPERIMENT_PAGE_UI_STATE_FIELDS,\n  ExperimentPageUIState,\n  createExperimentPageUIState,\n} from '../models/ExperimentPageUIState';\nimport { loadExperimentViewState } from '../utils/persistSearchFacets';\nimport { keys, pick } from 'lodash';\nimport { ExperimentRunsSelectorResult } from '../utils/experimentRuns.selector';\nimport { UseExperimentsResult } from './useExperiments';\nimport { useUpdateExperimentPageSearchFacets } from './useExperimentPageSearchFacets';\nimport { expandedEvaluationRunRowsUIStateInitializer } from '../utils/expandedRunsViewStateInitializer';\n\n// prettier-ignore\nconst uiStateInitializers = [\n  expandedEvaluationRunRowsUIStateInitializer,\n];\n\ntype UpdateUIStateAction = {\n  type: 'UPDATE_UI_STATE';\n  payload: ExperimentPageUIState | ((current: ExperimentPageUIState) => ExperimentPageUIState);\n};\n\ntype SetupInitUIStateAction = {\n  type: 'INITIAL_UI_STATE_SEEDED';\n};\n\ntype LoadNewExperimentAction = {\n  type: 'LOAD_NEW_EXPERIMENT';\n  payload: { uiState: ExperimentPageUIState; isFirstVisit: boolean; newPersistKey: string };\n};\n\ntype UIStateContainer = {\n  uiState: ExperimentPageUIState;\n  currentPersistKey: string;\n  isFirstVisit: boolean;\n};\n\nconst baseState = createExperimentPageUIState();\n\nexport const useInitializeUIState = (\n  experimentIds: string[],\n): [\n  ExperimentPageUIState,\n  React.Dispatch<React.SetStateAction<ExperimentPageUIState>>,\n  (experiments: UseExperimentsResult, runs: ExperimentRunsSelectorResult) => void,\n] => {\n  const persistKey = useMemo(() => JSON.stringify(experimentIds.sort()), [experimentIds]);\n\n  const updateSearchFacets = useUpdateExperimentPageSearchFacets();\n\n  const [{ uiState, isFirstVisit }, dispatchAction] = useReducer(\n    (state: UIStateContainer, action: UpdateUIStateAction | SetupInitUIStateAction | LoadNewExperimentAction) => {\n      if (action.type === 'UPDATE_UI_STATE') {\n        const newState = typeof action.payload === 'function' ? action.payload(state.uiState) : action.payload;\n        return {\n          ...state,\n          uiState: newState,\n        };\n      }\n      if (action.type === 'INITIAL_UI_STATE_SEEDED') {\n        if (!state.isFirstVisit) {\n          return state;\n        }\n        return {\n          ...state,\n          isFirstVisit: false,\n        };\n      }\n      if (action.type === 'LOAD_NEW_EXPERIMENT') {\n        return {\n          uiState: action.payload.uiState,\n          isFirstVisit: action.payload.isFirstVisit,\n          currentPersistKey: action.payload.newPersistKey,\n        };\n      }\n      return state;\n    },\n    undefined,\n    () => {\n      const persistedViewState = loadExperimentViewState(persistKey);\n      const persistedStateFound = keys(persistedViewState || {}).length;\n      const persistedUIState = persistedStateFound ? pick(persistedViewState, EXPERIMENT_PAGE_UI_STATE_FIELDS) : {};\n      return {\n        uiState: { ...baseState, ...persistedUIState },\n        isFirstVisit: !persistedStateFound,\n        currentPersistKey: persistKey,\n      };\n    },\n  );\n\n  const setUIState = useCallback(\n    (newStateOrSelector: ExperimentPageUIState | ((current: ExperimentPageUIState) => ExperimentPageUIState)) => {\n      dispatchAction({ type: 'UPDATE_UI_STATE', payload: newStateOrSelector });\n    },\n    [],\n  );\n\n  const seedInitialUIState = useCallback(\n    (experiments: UseExperimentsResult, runs: ExperimentRunsSelectorResult) => {\n      // Disable if it's not the first visit or there are no experiments/runs\n      if (!isFirstVisit || experiments.length === 0 || runs.runInfos.length === 0) {\n        return;\n      }\n\n      // Mark the initial state as seeded (effectively set isFirstVisit to false)\n      dispatchAction({ type: 'INITIAL_UI_STATE_SEEDED' });\n\n      // Then, update the UI state using all known UI state initializers\n      setUIState((uiState) => {\n        const newUIState = uiStateInitializers.reduce((state, initializer) => initializer(experiments, state, runs), {\n          ...uiState,\n        });\n\n        return newUIState;\n      });\n    },\n    // prettier-ignore\n    [\n      isFirstVisit,\n      setUIState,\n    ],\n  );\n\n  // Each time persist key (experiment IDs) change, load persisted view state\n  useEffect(() => {\n    const persistedViewState = loadExperimentViewState(persistKey);\n    const persistedUIState = pick(persistedViewState, EXPERIMENT_PAGE_UI_STATE_FIELDS);\n    const isFirstVisit = !keys(persistedViewState || {}).length;\n    dispatchAction({\n      type: 'LOAD_NEW_EXPERIMENT',\n      payload: { uiState: { ...baseState, ...persistedUIState }, isFirstVisit, newPersistKey: persistKey },\n    });\n  }, [persistKey]);\n\n  return [uiState, setUIState, seedInitialUIState];\n};\n","import { compact } from 'lodash';\nimport { MLFLOW_RUN_TYPE_TAG, MLFLOW_RUN_TYPE_VALUE_EVALUATION } from '../../../constants';\nimport { ExperimentEntity } from '../../../types';\nimport { ExperimentPageUIState } from '../models/ExperimentPageUIState';\nimport { EXPERIMENT_PARENT_ID_TAG } from './experimentPage.common-utils';\nimport { ExperimentRunsSelectorResult } from './experimentRuns.selector';\n\nexport const expandedEvaluationRunRowsUIStateInitializer = (\n  experiments: ExperimentEntity[],\n  uiState: ExperimentPageUIState,\n  runsData: ExperimentRunsSelectorResult,\n) => {\n  const evaluationRunIds = runsData.runInfos\n    .filter((run, index) => runsData.tagsList[index]?.[MLFLOW_RUN_TYPE_TAG]?.value === MLFLOW_RUN_TYPE_VALUE_EVALUATION)\n    .map(({ runUuid }) => runUuid);\n\n  const parentIdsOfEvaluationRunIds = compact(\n    runsData.runInfos.map(\n      ({ runUuid }, index) =>\n        evaluationRunIds.includes(runUuid) && runsData.tagsList[index]?.[EXPERIMENT_PARENT_ID_TAG].value,\n    ),\n  );\n\n  if (parentIdsOfEvaluationRunIds.length) {\n    return {\n      ...uiState,\n      runsExpanded: parentIdsOfEvaluationRunIds.reduce(\n        (aggregate, runUuid) => ({ ...aggregate, [runUuid]: true }),\n        uiState.runsExpanded,\n      ),\n    };\n  }\n  return uiState;\n};\n","import { ExperimentEntity, KeyValueEntity } from '../../../types';\nimport {\n  Button,\n  ChevronDownIcon,\n  ChevronUpIcon,\n  Modal,\n  PencilIcon,\n  Tooltip,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { useCallback, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getExperimentTags } from '../../../reducers/Reducers';\nimport { NOTE_CONTENT_TAG } from '../../../utils/NoteUtils';\nimport { useFetchExperiments } from '../hooks/useFetchExperiments';\nimport { ThunkDispatch } from '../../../../redux-types';\nimport React from 'react';\nimport ReactMde, { SvgIcon } from 'react-mde';\nimport { forceAnchorTagNewTab, getConverter, sanitizeConvertedHtml } from '../../../../common/utils/MarkdownUtils';\nimport { FormattedMessage } from 'react-intl';\n\nconst extractNoteFromTags = (tags: Record<string, KeyValueEntity>) =>\n  Object.values(tags).find((t) => t.key === NOTE_CONTENT_TAG)?.value || undefined;\n\nconst toolbarCommands = [\n  ['header', 'bold', 'italic', 'strikethrough'],\n  ['link', 'code', 'image'],\n  ['unordered-list', 'ordered-list'],\n];\n\nconst converter = getConverter();\n\nconst getSanitizedHtmlContent = (markdown: string | undefined) => {\n  if (markdown) {\n    const sanitized = sanitizeConvertedHtml(converter.makeHtml(markdown));\n    return forceAnchorTagNewTab(sanitized);\n  }\n  return null;\n};\n\nexport const ExperimentViewDescriptionNotes = ({\n  experiment,\n  editing,\n  setEditing,\n  setShowAddDescriptionButton,\n}: {\n  experiment: ExperimentEntity;\n  editing: boolean;\n  setEditing: (editing: boolean) => void;\n  setShowAddDescriptionButton: (show: boolean) => void;\n}) => {\n  const storedNote = useSelector((state) => {\n    const tags = getExperimentTags(experiment.experimentId, state);\n    return tags ? extractNoteFromTags(tags) : '';\n  });\n  setShowAddDescriptionButton(!storedNote);\n\n  const [tmpNote, setTmpNote] = useState(storedNote);\n  const [selectedTab, setSelectedTab] = useState<'write' | 'preview' | undefined>('write');\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  const { theme } = useDesignSystemTheme();\n  const PADDING_HORIZONTAL = 12;\n  const DISPLAY_LINE_HEIGHT = 16;\n  const COLLAPSE_MAX_HEIGHT = DISPLAY_LINE_HEIGHT + 2 * theme.spacing.sm;\n  const MIN_EDITOR_HEIGHT = 200;\n  const MAX_EDITOR_HEIGHT = 500;\n  const MIN_PREVIEW_HEIGHT = 20;\n\n  const {\n    actions: { setExperimentTagApi },\n  } = useFetchExperiments();\n\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const handleSubmitEditNote = useCallback(\n    (updatedNote: any) => {\n      setEditing(false);\n      setShowAddDescriptionButton(!updatedNote);\n      const action = setExperimentTagApi(experiment.experimentId, NOTE_CONTENT_TAG, updatedNote);\n      dispatch(action);\n    },\n    [experiment.experimentId, setExperimentTagApi, dispatch, setEditing, setShowAddDescriptionButton],\n  );\n\n  return (\n    <div>\n      {tmpNote && (\n        <div\n          style={{\n            whiteSpace: isExpanded ? 'normal' : 'pre',\n            lineHeight: theme.typography.lineHeightSm,\n            background: theme.colors.backgroundSecondary,\n            display: 'flex',\n            alignItems: 'flex-start',\n            padding: theme.spacing.xs,\n          }}\n        >\n          <div\n            style={{\n              flexGrow: 1,\n              marginRight: PADDING_HORIZONTAL,\n              overflow: 'hidden',\n              overflowWrap: isExpanded ? 'break-word' : undefined,\n              padding: `${theme.spacing.sm}px ${PADDING_HORIZONTAL}px`,\n              maxHeight: isExpanded ? 'none' : COLLAPSE_MAX_HEIGHT + 'px',\n            }}\n          >\n            <div\n              // eslint-disable-next-line react/no-danger\n              dangerouslySetInnerHTML={{ __html: getSanitizedHtmlContent(tmpNote) }}\n            />\n          </div>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_experimentviewdescriptionnotes.tsx_114\"\n            icon={<PencilIcon />}\n            onClick={() => setEditing(true)}\n            style={{ padding: `0px ${theme.spacing.sm}px` }}\n          />\n          {isExpanded ? (\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_experimentviewdescriptionnotes.tsx_120\"\n              icon={<ChevronUpIcon />}\n              onClick={() => setIsExpanded(false)}\n              style={{ padding: `0px ${theme.spacing.sm}px` }}\n            />\n          ) : (\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_experimentviewdescriptionnotes.tsx_126\"\n              icon={<ChevronDownIcon />}\n              onClick={() => setIsExpanded(true)}\n              style={{ padding: `0px ${theme.spacing.sm}px` }}\n            />\n          )}\n        </div>\n      )}\n      <Modal\n        title={\n          <FormattedMessage\n            defaultMessage=\"Add description\"\n            description=\"experiment page > description modal > title\"\n          />\n        }\n        visible={editing}\n        okText={\n          <FormattedMessage defaultMessage=\"Save\" description=\"experiment page > description modal > save button\" />\n        }\n        cancelText={\n          <FormattedMessage defaultMessage=\"Cancel\" description=\"experiment page > description modal > cancel button\" />\n        }\n        onOk={() => {\n          handleSubmitEditNote(tmpNote);\n          setEditing(false);\n        }}\n        onCancel={() => {\n          setTmpNote(storedNote);\n          setEditing(false);\n        }}\n      >\n        <React.Fragment>\n          <ReactMde\n            value={tmpNote}\n            minEditorHeight={MIN_EDITOR_HEIGHT}\n            maxEditorHeight={MAX_EDITOR_HEIGHT}\n            minPreviewHeight={MIN_PREVIEW_HEIGHT}\n            toolbarCommands={toolbarCommands}\n            onChange={(value) => setTmpNote(value)}\n            selectedTab={selectedTab}\n            onTabChange={(newTab) => setSelectedTab(newTab)}\n            generateMarkdownPreview={() => Promise.resolve(getSanitizedHtmlContent(tmpNote))}\n            getIcon={(name) => (\n              <Tooltip title={name}>\n                <span css={{ color: theme.colors.textPrimary }}>\n                  <SvgIcon icon={name} />\n                </span>\n              </Tooltip>\n            )}\n          />\n        </React.Fragment>\n      </Modal>\n    </div>\n  );\n};\n","import { CopyIcon, Typography } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { ExperimentEntity } from '../../../../types';\n\n/**\n * Experiment page header part responsible for copying\n * the title after clicking on the icon\n */\nexport const ExperimentViewCopyTitle = ({\n  experiment,\n  size,\n}: {\n  experiment: ExperimentEntity;\n  size: 'sm' | 'md' | 'lg' | 'xl';\n}) => {\n  const intl = useIntl();\n\n  return (\n    <Typography.Text\n      size={size}\n      dangerouslySetAntdProps={{\n        copyable: {\n          text: experiment.name,\n          icon: <CopyIcon />,\n          tooltips: [\n            intl.formatMessage({\n              defaultMessage: 'Copy path',\n              description: 'Copy tooltip to copy experiment path from experiment runs table header',\n            }),\n            intl.formatMessage({\n              defaultMessage: 'Path copied',\n              description: 'Tooltip displayed after experiment path was successfully copied to clipboard',\n            }),\n          ],\n        },\n      }}\n    />\n  );\n};\n","import React from 'react';\n\nexport interface ExperimentViewArtifactLocationProps {\n  artifactLocation: string;\n}\n\nexport const ExperimentViewArtifactLocation = ({ artifactLocation }: ExperimentViewArtifactLocationProps) => {\n  return <>{artifactLocation}</>;\n};\n","import { CopyIcon, Typography } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { ExperimentEntity } from '../../../../types';\n\n/**\n * Experiment page header part responsible for copying\n * the experimentId after clicking on the icon\n */\nexport const ExperimentViewCopyExperimentId = ({ experiment }: { experiment: ExperimentEntity }) => {\n  const intl = useIntl();\n\n  return (\n    <Typography.Text\n      size=\"md\"\n      dangerouslySetAntdProps={{\n        copyable: {\n          text: experiment.experimentId,\n          icon: <CopyIcon />,\n          tooltips: [\n            intl.formatMessage({\n              defaultMessage: 'Copy experiment id',\n              description: 'Copy tooltip to copy experiment id from experiment runs table header',\n            }),\n            intl.formatMessage({\n              defaultMessage: 'Experiment id copied',\n              description: 'Tooltip displayed after experiment id was successfully copied to clipboard',\n            }),\n          ],\n        },\n      }}\n    />\n  );\n};\n","import { CopyIcon, Typography } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { ExperimentEntity } from '../../../../types';\n\n/**\n * Experiment page header part responsible for copying\n * the artifact location after clicking on the icon\n */\nexport const ExperimentViewCopyArtifactLocation = ({ experiment }: { experiment: ExperimentEntity }) => {\n  const intl = useIntl();\n\n  return (\n    <Typography.Text\n      size=\"md\"\n      dangerouslySetAntdProps={{\n        copyable: {\n          text: experiment.artifactLocation,\n          icon: <CopyIcon />,\n          tooltips: [\n            intl.formatMessage({\n              defaultMessage: 'Copy artifact location',\n              description: 'Copy tooltip to copy experiment artifact location from experiment runs table header',\n            }),\n            intl.formatMessage({\n              defaultMessage: 'Artifact location copied',\n              description: 'Tooltip displayed after experiment artifact location was successfully copied to clipboard',\n            }),\n          ],\n        },\n      }}\n    />\n  );\n};\n","import React, { useMemo } from 'react';\nimport { Button, NewWindowIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { PageHeader } from '../../../../../shared/building_blocks/PageHeader';\nimport { ExperimentViewCopyTitle } from './ExperimentViewCopyTitle';\nimport { ExperimentViewHeaderShareButton } from './ExperimentViewHeaderShareButton';\nimport { ExperimentEntity } from '../../../../types';\nimport { useExperimentPageFeedbackUrl } from '../../hooks/useExperimentPageFeedbackUrl';\nimport { ExperimentPageSearchFacetsState } from '../../models/ExperimentPageSearchFacetsState';\nimport { ExperimentPageUIState } from '../../models/ExperimentPageUIState';\nimport { ExperimentViewArtifactLocation } from '../ExperimentViewArtifactLocation';\nimport { ExperimentViewCopyExperimentId } from './ExperimentViewCopyExperimentId';\nimport { ExperimentViewCopyArtifactLocation } from './ExperimentViewCopyArtifactLocation';\nimport { Tooltip } from '@databricks/design-system';\nimport { InfoIcon } from '@databricks/design-system';\nimport { Popover } from '@databricks/design-system';\n\n/**\n * Header for a single experiment page. Displays title, breadcrumbs and provides\n * controls for renaming, deleting and editing permissions.\n */\nexport const ExperimentViewHeader = React.memo(\n  ({\n    experiment,\n    searchFacetsState,\n    uiState,\n    showAddDescriptionButton,\n    setEditing,\n  }: {\n    experiment: ExperimentEntity;\n    searchFacetsState?: ExperimentPageSearchFacetsState;\n    uiState?: ExperimentPageUIState;\n    showAddDescriptionButton: boolean;\n    setEditing: (editing: boolean) => void;\n  }) => {\n    // eslint-disable-next-line prefer-const\n    let breadcrumbs: React.ReactNode[] = [];\n    const experimentIds = useMemo(() => (experiment ? [experiment?.experimentId] : []), [experiment]);\n\n    const { theme } = useDesignSystemTheme();\n\n    /**\n     * Extract the last part of the experiment name\n     */\n    const normalizedExperimentName = useMemo(() => experiment.name.split('/').pop(), [experiment.name]);\n\n    const feedbackFormUrl = useExperimentPageFeedbackUrl();\n\n    const renderFeedbackForm = () => {\n      const feedbackLink = (\n        <Button\n          href={feedbackFormUrl}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_header_experimentviewheaderv2.tsx_100\"\n          css={{ marginLeft: theme.spacing.sm }}\n          type=\"link\"\n          size=\"small\"\n          endIcon={<NewWindowIcon />}\n        >\n          <FormattedMessage\n            defaultMessage=\"Provide Feedback\"\n            description=\"Link to a survey for users to give feedback\"\n          />\n        </Button>\n      );\n      return feedbackLink;\n    };\n\n    const getShareButton = () => {\n      const shareButtonElement = (\n        <ExperimentViewHeaderShareButton\n          experimentIds={experimentIds}\n          searchFacetsState={searchFacetsState}\n          uiState={uiState}\n        />\n      );\n      return shareButtonElement;\n    };\n\n    const getInfoTooltip = () => {\n      return (\n        <div style={{ display: 'flex' }}>\n          <Tooltip\n            placement=\"bottomLeft\"\n            dangerouslySetAntdProps={{ overlayStyle: { maxWidth: 'none' } }}\n            arrowPointAtCenter\n            title={\n              <div\n                css={{\n                  display: 'flex',\n                  flexDirection: 'column',\n                  flexWrap: 'nowrap',\n                }}\n                data-testid=\"experiment-view-header-info-tooltip-content\"\n              >\n                <div style={{ whiteSpace: 'nowrap' }}>\n                  <FormattedMessage\n                    defaultMessage=\"Path\"\n                    description=\"Label for displaying the current experiment path\"\n                  />\n                  : {experiment.name + ' '}\n                  <ExperimentViewCopyTitle experiment={experiment} size=\"md\" />\n                </div>\n                <div style={{ whiteSpace: 'nowrap' }}>\n                  <FormattedMessage\n                    defaultMessage=\"Experiment ID\"\n                    description=\"Label for displaying the current experiment in view\"\n                  />\n                  : {experiment.experimentId + ' '}\n                  <ExperimentViewCopyExperimentId experiment={experiment} />\n                </div>\n                <div style={{ whiteSpace: 'nowrap' }}>\n                  <FormattedMessage\n                    defaultMessage=\"Artifact Location\"\n                    description=\"Label for displaying the experiment artifact location\"\n                  />\n                  : <ExperimentViewArtifactLocation artifactLocation={experiment.artifactLocation} />{' '}\n                  <ExperimentViewCopyArtifactLocation experiment={experiment} />\n                </div>\n              </div>\n            }\n          >\n            <Button\n              size=\"small\"\n              type=\"link\"\n              componentId=\"mlflow.experiment_page.header.info_tooltip\"\n              icon={<InfoIcon css={{ color: theme.colors.textSecondary }} />}\n              data-testid=\"experiment-view-header-info-tooltip\"\n              aria-label=\"Info\"\n            />\n          </Tooltip>\n        </div>\n      );\n    };\n    const getAddDescriptionButton = () => {\n      return (\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_header_experimentviewheaderv2.tsx_271\"\n          size=\"small\"\n          onClick={() => {\n            setEditing(true);\n          }}\n          css={{\n            marginLeft: theme.spacing.sm,\n            background: `${theme.colors.backgroundSecondary} !important`,\n            border: 'none',\n          }}\n        >\n          <Typography.Text size=\"md\">Add Description</Typography.Text>\n        </Button>\n      );\n    };\n\n    const HEADER_MAX_WIDTH = '70%';\n\n    return (\n      <PageHeader\n        title={\n          <div\n            css={{\n              [theme.responsive.mediaQueries.xs]: {\n                display: 'inline',\n                wordBreak: 'break-all',\n              },\n              [theme.responsive.mediaQueries.sm]: {\n                display: 'inline-block',\n                whiteSpace: 'nowrap',\n                overflow: 'hidden',\n                maxWidth: HEADER_MAX_WIDTH,\n                textOverflow: 'ellipsis',\n                verticalAlign: 'middle',\n              },\n            }}\n          >\n            {normalizedExperimentName}\n          </div>\n        }\n        titleAddOns={\n          <>\n            {getInfoTooltip()}\n            {feedbackFormUrl && renderFeedbackForm()}\n            {showAddDescriptionButton && getAddDescriptionButton()}\n          </>\n        }\n        breadcrumbs={breadcrumbs}\n        spacerSize=\"sm\"\n      >\n        {getShareButton()}\n      </PageHeader>\n    );\n  },\n);\n","import { EXPERIMENT_PAGE_FEEDBACK_URL } from '../../../constants';\n\n// Returns link to the experiment page feedback form.\nexport const useExperimentPageFeedbackUrl = () => {\n  const url = EXPERIMENT_PAGE_FEEDBACK_URL;\n  return url;\n};\n","import { LegacySkeleton } from '@databricks/design-system';\n\nimport { useEffect, useState } from 'react';\nimport { ErrorCodes } from '../../../common/constants';\nimport NotFoundPage from '../NotFoundPage';\nimport { PermissionDeniedView } from '../PermissionDeniedView';\nimport { ExperimentViewHeaderCompare } from './components/header/ExperimentViewHeaderCompare';\nimport { ExperimentViewRuns } from './components/runs/ExperimentViewRuns';\nimport { useExperiments } from './hooks/useExperiments';\nimport { useFetchExperiments } from './hooks/useFetchExperiments';\nimport { useElementHeight } from '../../../common/utils/useElementHeight';\nimport { searchDatasetsApi } from '../../actions';\nimport Utils from '../../../common/utils/Utils';\nimport { ExperimentPageUIStateContextProvider } from './contexts/ExperimentPageUIStateContext';\nimport { first } from 'lodash';\nimport { useExperimentPageSearchFacets } from './hooks/useExperimentPageSearchFacets';\nimport { usePersistExperimentPageViewState } from './hooks/usePersistExperimentPageViewState';\nimport { useDispatch } from 'react-redux';\nimport { ThunkDispatch } from '../../../redux-types';\nimport { useExperimentRuns } from './hooks/useExperimentRuns';\nimport { ExperimentRunsSelectorResult } from './utils/experimentRuns.selector';\nimport { useSharedExperimentViewState } from './hooks/useSharedExperimentViewState';\nimport { useInitializeUIState } from './hooks/useInitializeUIState';\nimport { ExperimentViewDescriptionNotes } from './components/ExperimentViewDescriptionNotes';\nimport { ExperimentViewHeader } from './components/header/ExperimentViewHeader';\nimport invariant from 'invariant';\nimport { useExperimentPageViewMode } from './hooks/useExperimentPageViewMode';\n\nexport const ExperimentView = () => {\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const [searchFacets, experimentIds] = useExperimentPageSearchFacets();\n  const [viewMode] = useExperimentPageViewMode();\n\n  const experiments = useExperiments(experimentIds);\n\n  const [firstExperiment] = experiments;\n\n  const { fetchExperiments, isLoadingExperiment, requestError } = useFetchExperiments();\n\n  const { elementHeight: hideableElementHeight, observeHeight } = useElementHeight();\n\n  const [editing, setEditing] = useState(false);\n\n  const [showAddDescriptionButton, setShowAddDescriptionButton] = useState(true);\n\n  // Create new version of the UI state for the experiment page on this level\n  const [uiState, setUIState, seedInitialUIState] = useInitializeUIState(experimentIds);\n\n  const { isViewStateShared } = useSharedExperimentViewState(setUIState, first(experiments));\n\n  // Get the maximized state from the new view state model if flag is set\n  const isMaximized = uiState.viewMaximized;\n\n  const {\n    isLoadingRuns,\n    loadMoreRuns,\n    runsData,\n    moreRunsAvailable,\n    requestError: runsRequestError,\n    refreshRuns,\n  } = useExperimentRuns(uiState, searchFacets, experimentIds);\n\n  useEffect(() => {\n    fetchExperiments(experimentIds);\n  }, [fetchExperiments, experimentIds]);\n\n  useEffect(() => {\n    // Seed the initial UI state when the experiments and runs are loaded.\n    // Should only run once.\n    seedInitialUIState(experiments, runsData);\n  }, [seedInitialUIState, experiments, runsData]);\n\n  useEffect(() => {\n    const requestAction = searchDatasetsApi(experimentIds);\n    dispatch(requestAction).catch((e) => {\n      Utils.logErrorAndNotifyUser(e);\n    });\n  }, [dispatch, experimentIds]);\n\n  const isComparingExperiments = experimentIds.length > 1;\n\n  usePersistExperimentPageViewState(uiState, searchFacets, experimentIds, isViewStateShared);\n\n  const isViewInitialized = Boolean(!isLoadingExperiment && experiments[0] && runsData && searchFacets);\n\n  if (!isViewInitialized) {\n    // In the new view state model, wait for search facets to initialize\n    return <LegacySkeleton />;\n  }\n\n  if (requestError && requestError.getErrorCode() === ErrorCodes.PERMISSION_DENIED) {\n    return <PermissionDeniedView errorMessage={requestError.getMessageField()} />;\n  }\n\n  if (requestError && requestError.getErrorCode() === ErrorCodes.RESOURCE_DOES_NOT_EXIST) {\n    return <NotFoundPage />;\n  }\n\n  invariant(searchFacets, 'searchFacets should be initialized at this point');\n\n  const isLoading = isLoadingExperiment || !experiments[0];\n\n  const renderExperimentHeader = () => (\n    <>\n      <ExperimentViewHeader\n        experiment={firstExperiment}\n        searchFacetsState={searchFacets || undefined}\n        uiState={uiState}\n        showAddDescriptionButton={showAddDescriptionButton}\n        setEditing={setEditing}\n      />\n      <div\n        style={{\n          maxHeight: isMaximized ? 0 : hideableElementHeight,\n        }}\n        css={{ overflowY: 'hidden', flexShrink: 0, transition: 'max-height .12s' }}\n      >\n        <div ref={observeHeight}>\n          <ExperimentViewDescriptionNotes\n            experiment={firstExperiment}\n            setShowAddDescriptionButton={setShowAddDescriptionButton}\n            editing={editing}\n            setEditing={setEditing}\n          />\n        </div>\n      </div>\n    </>\n  );\n\n  const getRenderedView = () => {\n    return (\n      <ExperimentViewRuns\n        isLoading={false}\n        experiments={experiments}\n        isLoadingRuns={isLoadingRuns}\n        runsData={runsData as ExperimentRunsSelectorResult}\n        searchFacetsState={searchFacets}\n        loadMoreRuns={loadMoreRuns}\n        moreRunsAvailable={moreRunsAvailable}\n        requestError={runsRequestError}\n        refreshRuns={refreshRuns}\n        uiState={uiState}\n      />\n    );\n  };\n\n  return (\n    <ExperimentPageUIStateContextProvider setUIState={setUIState}>\n      <div css={styles.experimentViewWrapper}>\n        {isLoading ? (\n          <LegacySkeleton title paragraph={false} active />\n        ) : (\n          <>\n            {isComparingExperiments ? (\n              <ExperimentViewHeaderCompare experiments={experiments} />\n            ) : (\n              renderExperimentHeader()\n            )}\n          </>\n        )}\n        {getRenderedView()}\n      </div>\n    </ExperimentPageUIStateContextProvider>\n  );\n};\n\nconst styles = {\n  experimentViewWrapper: { height: '100%', display: 'flex', flexDirection: 'column' as const },\n};\n\nexport default ExperimentView;\n","import { isEqual } from 'lodash';\nimport { useSelector } from 'react-redux';\nimport type { ExperimentEntity, ExperimentStoreEntities } from '../../../types';\n\nexport type UseExperimentsResult = ExperimentEntity[];\n\n/**\n * Hook that returns data and functions necessary for rendering\n * experiment(s) details - name, title, tags etc.\n */\nexport const useExperiments = (ids: (number | string)[]): UseExperimentsResult =>\n  useSelector(\n    (state: { entities: ExperimentStoreEntities }) =>\n      ids.map((id) => state.entities.experimentsById[id]).filter(Boolean),\n    (oldExperiments, newExperiments) => isEqual(oldExperiments, newExperiments),\n  );\n","import { useEffect, useState } from 'react';\n\n/**\n * Hook that returns dynamically updated changing element height. Usage example:\n * ```ts\n * const { elementHeight, observeHeight } = useElementHeight();\n * // ...\n * return <div ref={observeHeight}>Element height: {elementHeight}px</div>\n * ```\n */\nexport const useElementHeight = () => {\n  const [hideableElementsContainer, setHideableElementsContainer] = useState<HTMLElement | null>(null);\n\n  const [elementHeight, setElementHeight] = useState<number | undefined>(undefined);\n\n  useEffect(() => {\n    if (!hideableElementsContainer || !window.ResizeObserver) {\n      return undefined;\n    }\n    const resizeObserver = new ResizeObserver(([entry]) => {\n      if (entry.target.scrollHeight) {\n        setElementHeight(entry.target.scrollHeight);\n      }\n    });\n    resizeObserver.observe(hideableElementsContainer);\n    return () => resizeObserver.disconnect();\n  }, [hideableElementsContainer]);\n\n  return { elementHeight, observeHeight: setHideableElementsContainer };\n};\n","import { useEffect, useMemo } from 'react';\nimport { useIntl } from 'react-intl';\nimport { EXPERIMENT_PAGE_QUERY_PARAM_KEYS, useUpdateExperimentPageSearchFacets } from './useExperimentPageSearchFacets';\nimport { pick } from 'lodash';\nimport { EXPERIMENT_PAGE_UI_STATE_FIELDS, ExperimentPageUIState } from '../models/ExperimentPageUIState';\nimport { ExperimentPageSearchFacetsState } from '../models/ExperimentPageSearchFacetsState';\nimport { ExperimentEntity } from '../../../types';\nimport { useNavigate, useSearchParams } from '../../../../common/utils/RoutingUtils';\nimport Utils from '../../../../common/utils/Utils';\nimport {\n  EXPERIMENT_PAGE_VIEW_STATE_SHARE_TAG_PREFIX,\n  EXPERIMENT_PAGE_VIEW_STATE_SHARE_URL_PARAM_KEY,\n} from '../../../constants';\nimport Routes from '../../../routes';\n\n/**\n * Hook that handles loading shared view state from URL and updating the search facets/UI state accordingly\n */\nexport const useSharedExperimentViewState = (\n  uiStateSetter: React.Dispatch<React.SetStateAction<ExperimentPageUIState>>,\n  experiment?: ExperimentEntity,\n  disabled = false,\n) => {\n  const [searchParams] = useSearchParams();\n  const intl = useIntl();\n  const viewStateShareKey = searchParams.get(EXPERIMENT_PAGE_VIEW_STATE_SHARE_URL_PARAM_KEY);\n\n  const isViewStateShared = Boolean(viewStateShareKey);\n\n  const updateSearchFacets = useUpdateExperimentPageSearchFacets();\n\n  const { sharedSearchFacetsState, sharedUiState, sharedStateError, sharedStateErrorMessage } = useMemo(() => {\n    if (!viewStateShareKey || !experiment) {\n      return {\n        sharedSearchFacetsState: null,\n        sharedUiState: null,\n        sharedStateError: null,\n        sharedStateErrorMessage: null,\n      };\n    }\n\n    // Find the tag with the given share key\n    const shareViewTag = experiment.tags.find(\n      ({ key }) => key === `${EXPERIMENT_PAGE_VIEW_STATE_SHARE_TAG_PREFIX}${viewStateShareKey}`,\n    );\n\n    // If the tag exists, parse the view state from the tag value\n    if (shareViewTag) {\n      try {\n        const parsedSharedViewState = JSON.parse(shareViewTag.value);\n\n        // First, extract search facets part of the shared view state\n        const sharedSearchFacetsState = pick(\n          parsedSharedViewState,\n          EXPERIMENT_PAGE_QUERY_PARAM_KEYS,\n        ) as ExperimentPageSearchFacetsState;\n\n        // Then, extract UI state part of the shared view state\n        const sharedUiState = pick(parsedSharedViewState, EXPERIMENT_PAGE_UI_STATE_FIELDS) as ExperimentPageUIState;\n\n        return {\n          sharedSearchFacetsState,\n          sharedUiState,\n          sharedStateError: null,\n          sharedStateErrorMessage: null,\n        };\n      } catch (e) {\n        return {\n          sharedSearchFacetsState: null,\n          sharedUiState: null,\n          sharedStateError: `Error loading shared view state: share key is invalid`,\n          sharedStateErrorMessage: intl.formatMessage({\n            defaultMessage: `Error loading shared view state: share key is invalid`,\n            description: 'Experiment page > share viewstate > error > share key is invalid',\n          }),\n        };\n      }\n    }\n\n    return {\n      sharedSearchFacetsState: null,\n      sharedUiState: null,\n      sharedStateError: `Error loading shared view state: share key ${viewStateShareKey} does not exist`,\n      sharedStateErrorMessage: intl.formatMessage(\n        {\n          defaultMessage: `Error loading shared view state: share key \"{viewStateShareKey}\" does not exist`,\n          description: 'Experiment page > share viewstate > error > share key does not exist',\n        },\n        {\n          viewStateShareKey,\n        },\n      ),\n    };\n  }, [experiment, viewStateShareKey, intl]);\n\n  useEffect(() => {\n    if (!sharedSearchFacetsState || disabled) {\n      return;\n    }\n    updateSearchFacets(sharedSearchFacetsState, { replace: true });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [sharedSearchFacetsState, disabled]);\n\n  useEffect(() => {\n    if (!sharedUiState || disabled) {\n      return;\n    }\n    uiStateSetter(sharedUiState);\n  }, [uiStateSetter, sharedUiState, disabled]);\n\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n    if (sharedStateError && experiment) {\n      // If there's an error with share key, remove it from the URL and notify user\n      Utils.logErrorAndNotifyUser(new Error(sharedStateError));\n      Utils.displayGlobalErrorNotification(sharedStateErrorMessage, 3);\n      navigate(Routes.getExperimentPageRoute(experiment.experimentId), { replace: true });\n    }\n  }, [sharedStateError, sharedStateErrorMessage, experiment, navigate, disabled]);\n\n  return {\n    isViewStateShared,\n    sharedStateError,\n  };\n};\n","var _desc, _g;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgNoExperiments(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"147px\",\n    height: \"90px\",\n    viewBox: \"0 0 147 90\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Empty\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _desc || (_desc = /*#__PURE__*/React.createElement(\"desc\", null, \"Created with Sketch.\")), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Symbols\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"PageComponent/States/NonExistingExperiment\",\n    transform: \"translate(-154.000000, 0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Empty\",\n    transform: \"translate(154.000000, 0.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Rectangle-44-Copy-+-Rectangle-44-Copy-Copy\",\n    transform: \"translate(30.000000, 14.000000)\",\n    stroke: \"#43C8EC\",\n    strokeWidth: 4\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.741609,7 L15.8351259,-0.756037119 C16.3298711,-1.5093991 17.241332,-2 18.1439612,-2 L43.5873821,-2 C44.4210332,-2 45.2931545,-1.58401333 45.8168185,-0.931597206 L52.183142,7 L85.5155434,7 C87.9917944,7 90,9.01519262 90,11.4890789 L90,69.5109211 C90,71.9913496 87.9907454,74 85.5080838,74 L2.49191622,74 C0.012896518,74 -2,71.9861467 -2,69.5109211 L-2,11.4890789 C-2,9.00837311 0.00896797934,7 2.49246368,7 L10.741609,7 Z\",\n    id: \"Rectangle-44-Copy\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M-2,20.6666667 L90,20.6666667 L90,69.5197435 C90,71.9968892 87.9891593,74 85.5080838,74 L2.49191622,74 C0.0159958538,74 -2,71.9863744 -2,69.5197435 L-2,20.6666667 Z\",\n    id: \"Rectangle-44\"\n  })), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M132.953358,7.79357798 C132.953358,6.25072746 131.698196,5 130.149876,5 C128.601555,5 127.346393,6.25072746 127.346393,7.79357798 C127.346393,9.3364285 128.601555,10.587156 130.149876,10.587156 C131.698196,10.587156 132.953358,9.3364285 132.953358,7.79357798 Z M128.147388,7.79357798 C128.147388,6.6915419 129.043932,5.79816514 130.149876,5.79816514 C131.255819,5.79816514 132.152363,6.6915419 132.152363,7.79357798 C132.152363,8.89561406 131.255819,9.78899083 130.149876,9.78899083 C129.043932,9.78899083 128.147388,8.89561406 128.147388,7.79357798 Z\",\n    id: \"Oval-4-Copy\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M139.507463,33.7889908 L139.507463,30.7789335 C139.507463,29.9519393 140.17326,29.2815281 141.007463,29.2815281 C141.83589,29.2815281 142.507463,29.9619278 142.507463,30.7789335 L142.507463,33.7889908 L145.51752,33.7889908 C146.344514,33.7889908 147.014925,34.4547881 147.014925,35.2889908 C147.014925,36.117418 146.334526,36.7889908 145.51752,36.7889908 L142.507463,36.7889908 L142.507463,39.7990482 C142.507463,40.6260423 141.841665,41.2964535 141.007463,41.2964535 C140.179036,41.2964535 139.507463,40.6160538 139.507463,39.7990482 L139.507463,36.7889908 L136.497405,36.7889908 C135.670411,36.7889908 135,36.1231936 135,35.2889908 C135,34.4605637 135.6804,33.7889908 136.497405,33.7889908 L139.507463,33.7889908 Z\",\n    id: \"Combined-Shape\",\n    fill: \"#FF8500\"\n  }), /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Fast_computer_chip\",\n    fillRule: \"nonzero\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M25,3.12 C25,4.84312842 26.3968716,6.24 28.12,6.24 C29.8431284,6.24 31.24,4.84312842 31.24,3.12 C31.24,1.39687158 29.8431284,0 28.12,0 C27.2925246,-3.55271368e-15 26.4989403,0.328713342 25.9138268,0.913826843 C25.3287133,1.49894034 25,2.29252455 25,3.12 Z M29.24,3.12 C29.24,3.73855892 28.7385589,4.24 28.12,4.24 C27.5014411,4.24 27,3.73855892 27,3.12 C27,2.50144108 27.5014411,2 28.12,2 C28.7307345,2.0109077 29.2200974,2.50916813 29.22,3.12 L29.24,3.12 Z\",\n    id: \"Shape\",\n    fill: \"#FF8500\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.12,20.83 L12.12,18.3 C9.70651564,18.3 7.75,16.3434844 7.75,13.93 L5.32,13.93 C5.32,16.3434844 3.36348436,18.3 0.95,18.3 L0.95,20.83 C3.36348436,20.83 5.32,22.7865156 5.32,25.2 L7.75,25.2 C7.75,22.7865156 9.70651564,20.83 12.12,20.83 Z M6.53,22.14 C5.92469267,21.0411659 5.01024881,20.1441069 3.9,19.56 C5.00744891,18.9812516 5.92159416,18.0914372 6.53,17 C7.13530733,18.0988341 8.04975119,18.9958931 9.16,19.58 C8.05255109,20.1587484 7.13840584,21.0485628 6.53,22.14 Z\",\n    id: \"Shape\",\n    fill: \"#10B36B\"\n  })))))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgNoExperiments);\nexport default __webpack_public_path__ + \"static/media/no-experiments.0e4f4a114ef73e7d81c09474aba64b6c.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport noExperiments from '../../common/static/no-experiments.svg';\nimport { ExperimentCliDocUrl } from '../../common/constants';\n\nfunction NoExperimentViewImpl() {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div className=\"center\">\n      <img alt=\"No experiments found.\" style={{ height: '200px', marginTop: '80px' }} src={noExperiments} />\n      <h1 style={{ paddingTop: '10px' }}>No Experiments Exist</h1>\n      <h2 css={{ color: theme.colors.textSecondary }}>\n        To create an experiment use the <a href={ExperimentCliDocUrl}>mlflow experiments</a> CLI.\n      </h2>\n    </div>\n  );\n}\n\nexport const NoExperimentView = NoExperimentViewImpl;\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport { useEffect, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ReduxState, type ThunkDispatch } from '../../redux-types';\nimport { getExperimentApi, searchExperimentsApi, setCompareExperiments, setExperimentTagApi } from '../actions';\nimport { Navigate } from '../../common/utils/RoutingUtils';\nimport { getUUID } from '../../common/utils/ActionUtils';\nimport RequestStateWrapper from '../../common/components/RequestStateWrapper';\nimport ExperimentListView from './ExperimentListView';\nimport { useExperimentIds } from './experiment-page/hooks/useExperimentIds';\nimport { values } from 'lodash';\nimport { Spinner, useDesignSystemTheme } from '@databricks/design-system';\nimport { GetExperimentsContextProvider } from './experiment-page/contexts/GetExperimentsContext';\nimport { ExperimentView } from './experiment-page/ExperimentView';\nimport { NoExperimentView } from './NoExperimentView';\nimport Utils from '../../common/utils/Utils';\nimport { ExperimentEntity } from '../types';\nimport Routes from '../routes';\nimport { ExperimentPage } from './experiment-page/ExperimentPage';\n\nconst getExperimentActions = {\n  setExperimentTagApi,\n  getExperimentApi,\n  setCompareExperiments,\n};\n\nconst getFirstActiveExperiment = (experiments: ExperimentEntity[]) => {\n  const sorted = [...experiments].sort(Utils.compareExperiments);\n  return sorted.find(({ lifecycleStage }) => lifecycleStage === 'active');\n};\n\nconst HomePage = () => {\n  const dispatch = useDispatch<ThunkDispatch>();\n  const { theme } = useDesignSystemTheme();\n  const searchRequestId = useRef(getUUID());\n\n  const experimentIds = useExperimentIds();\n  const experiments = useSelector((state: ReduxState) => values(state.entities.experimentsById));\n\n  const hasExperiments = experiments.length > 0;\n\n  useEffect(() => {\n    dispatch(searchExperimentsApi(searchRequestId.current));\n  }, [dispatch]);\n\n  // If no experiments are currently selected, navigate to the first one\n  if (!experimentIds.length) {\n    const firstExp = getFirstActiveExperiment(experiments);\n    if (firstExp) {\n      return <Navigate to={Routes.getExperimentPageRoute(firstExp.experimentId)} replace />;\n    }\n  }\n\n  const loadingState = (\n    <div css={{ height: '100%', display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n      <Spinner size=\"large\" />\n    </div>\n  );\n\n  return (\n    <RequestStateWrapper requestIds={[searchRequestId.current]} customSpinner={loadingState}>\n      <div css={{ display: 'flex', height: 'calc(100% - 60px)' }}>\n        {/* Left sidebar containing experiment list */}\n        <div css={{ height: '100%', paddingTop: 24, display: 'flex' }}>\n          <ExperimentListView activeExperimentIds={experimentIds || []} experiments={experiments} />\n        </div>\n\n        {/* Main content with the experiment view */}\n        <div css={{ height: '100%', flex: 1, padding: theme.spacing.md, paddingTop: theme.spacing.lg }}>\n          <GetExperimentsContextProvider actions={getExperimentActions}>\n            {hasExperiments ? <ExperimentView /> : <NoExperimentView />}\n          </GetExperimentsContextProvider>\n        </div>\n      </div>\n    </RequestStateWrapper>\n  );\n};\n\nexport default HomePage;\n"],"names":["getExperimentNameValidator","getExistingExperimentNames","rule","value","callback","includes","MlflowService","getExperimentByName","experiment_name","then","res","catch","e","undefined","modelNameValidator","name","ModelRegistryService","getRegisteredModel","truncateToFirstLineWithMaxLength","str","maxLength","truncated","_","length","char","join","middleTruncateStr","maxLen","firstPartLen","Math","floor","lastPartLen","substring","_keyStr","btoaUtf8","input","output","i","result","_utf8_encode","chr1","charCodeAt","chr2","chr3","enc1","enc2","enc3","enc4","isNaN","charAt","atobUtf8","replace","indexOf","String","fromCharCode","_utf8_decode","arguments","utftext","n","c","string","c2","c3","getStringSHA256","crypto","subtle","digest","TextEncoder","encode","arrayBuffer","Array","prototype","map","call","Uint8Array","x","toString","slice","EXP_NAME_FIELD","ARTIFACT_LOCATION","CreateExperimentFormComponent","Component","render","_jsxs","Form","ref","this","props","innerRef","layout","children","_jsx","Item","label","intl","formatMessage","id","defaultMessage","rules","required","message","validator","Input","placeholder","autoFocus","CreateExperimentForm","injectIntl","CreateExperimentModalImpl","constructor","handleCreateExperiment","async","experimentName","values","artifactLocation","response","createExperimentApi","searchExperimentsApi","experiment_id","newExperimentId","navigate","Routes","getExperimentPageRoute","debouncedExperimentNameValidator","debounce","experimentNames","isOpen","GenericInputModal","title","okText","handleSubmit","onClose","mapDispatchToProps","CreateExperimentModal","withRouterNext","connect","state","getExperiments","DeleteExperimentModalImpl","experimentId","activeExperimentIds","deleteExperimentRequestId","getUUID","deleteExperimentApi","rootRoute","experimentIds","filter","eid","route","getCompareExperimentsPageRoute","Utils","logErrorAndNotifyUser","ConfirmModal","helpText","confirmButtonText","DeleteExperimentModal","RenameExperimentModalImpl","handleRenameExperiment","newExperimentName","NEW_NAME_FIELD","updateExperimentApi","getExperimentApi","RenameForm","type","visible","RenameExperimentModal","ExperimentListView","list","checkedKeys","hidden","searchInput","showCreateExperimentModal","showDeleteExperimentModal","showRenameExperimentModal","selectedExperimentId","selectedExperimentName","bindListRef","componentDidUpdate","forceUpdateGrid","filterExperiments","experiments","lowerCasedSearchInput","toLowerCase","_ref","handleSearchInputChange","event","setState","target","updateSelectedExperiment","handleDeleteExperiment","handleCloseCreateExperimentModal","handleCloseDeleteExperimentModal","handleCloseRenameExperimentModal","handleCheck","isChecked","key","prevState","pushExperimentRoute","activeExperimentListItem","classNames","getExperimentListItemContainer","designSystemThemeApi","theme","inactiveExperimentListItem","renderListItem","_ref2","index","style","isScrolling","parent","item","data","isActive","dataTestId","css","List","bordered","prefixCls","experimentListItem","actions","Checkbox","onChange","Link","className","to","onClick","IconButton","icon","PencilIcon","renameExperiment","deleteExperiment","isRowLoaded","_ref3","unHide","hide","CaretDownSquareIcon","rotate","filteredExperiments","experimentListOuterContainer","experimentTitleContainer","Typography","Title","level","margin","PlusCircleIcon","AutoSizer","_ref4","width","height","VList","rowRenderer","rowHeight","overscanRowCount","rowCount","styles","display","justifyContent","alignItems","marginBottom","experimentTitle","experimentSearchContainer","experimentSearchInput","flex","experimentSearchIcon","fontSize","marginLeft","experimentListContainer","marginTop","marginRight","paddingRight","borderLeft","colors","primary","borderLeftWidth","backgroundColor","actionDefaultBackgroundPress","justifySelf","color","actionDefaultTextDefault","general","iconSize","spacing","xs","WithDesignSystemThemeHoc","GetExperimentsContext","createContext","GetExperimentsContextProvider","fetchExperimentsRequestIds","setFetchExperimentsRequestIds","useState","isLoadingExperiment","setIsLoadingExperiment","requestError","setRequestError","dispatch","useDispatch","fetchExperiments","useCallback","fetchFn","newRequestIds","requestAction","meta","requestIds","isEqual","contextValue","useMemo","Provider","RequestStateWrapper","shouldOptimisticallyRender","renderFn","_isLoading","_renderError","requests","some","r","active","forEach","request","error","PermissionDeniedView","errorMessage","useDesignSystemTheme","src","permissionDeniedLock","alt","paddingTop","_css","textSecondary","CopyBox","copyText","readOnly","CopyButton","GetLinkModal","onCancel","link","Modal","FormattedMessage","ExperimentGetShareLinkModal","searchFacetsState","uiState","sharedStateUrl","setSharedStateUrl","linkInProgress","setLinkInProgress","generatedState","setGeneratedState","stateToSerialize","createSerializedState","window","location","href","JSON","stringify","hash","tagName","EXPERIMENT_PAGE_VIEW_STATE_SHARE_TAG_PREFIX","setExperimentTagApi","pageRoute","shareURL","origin","pathname","useEffect","GenericSkeleton","loading","ExperimentViewHeaderShareButton","showGetLinkModal","setShowGetLinkModal","_Fragment","Button","componentId","ExperimentViewHeaderCompare","React","pageTitle","numExperiments","PageHeader","breadcrumbs","RestoreRunModalImpl","super","bind","restorePromises","selectedRunIds","runId","push","restoreRunApi","Promise","all","textJson","error_code","openErrorModal","_this$props$onSuccess","_this$props","onSuccess","number","pluralize","ExperimentViewRunModals","showDeleteRunModal","showRestoreRunModal","showRenameRunModal","runsSelected","onCloseDeleteRunModal","onCloseRestoreRunModal","onCloseRenameRunModal","renamedRunName","refreshRuns","Object","entries","selected","DeleteRunModal","RestoreRunModal","RenameRunModal","runUuid","runName","CompareRunsButtonWrapper","ExperimentViewRunsControlsActions","viewState","runsData","runInfos","lifecycleFilter","useNavigate","setShowDeleteRunModal","setShowRestoreRunModal","setShowRenameRunModal","setRenamedRunName","renameButtonClicked","runsSelectedList","keys","selectedRun","find","info","compareButtonClicked","getCompareRunPageRoute","Set","sort","onDeleteRun","onRestoreRun","selectedRunsCount","Boolean","canRestoreRuns","canRenameRuns","canCompareRuns","controlBar","disabled","LIFECYCLE_FILTER","ACTIVE","danger","DELETED","buttonSeparator","border","gap","sm","ExperimentViewRefreshButtonImpl","useExperimentIds","lastFetchTime","setLastFetchTime","newRunsCount","setNewRunsCount","Date","now","interval","setInterval","searchPayloadData","maxResults","MAX_DETECT_NEW_RUNS_RESULTS","searchRunsPayload","_result$runs","newRuns","runs","POLL_INTERVAL","clearInterval","position","top","right","transform","borderRadius","white","lime","fontWeight","userSelect","zIndex","Tooltip","useAsLabel","SyncIcon","ExperimentViewRefreshButton","entities","runInfosByUuid","areStatesEqual","nextState","useExperimentViewLocalStore","storeIdentifier","LocalStorageUtils","getStoreForComponent","RunsSearchTooltipContent","whereBold","chunks","ExperimentSearchSyntaxDocUrl","rel","ATTRIBUTE_OPTIONS","s","boldedText","wholeText","shouldBeBold","textArray","split","RegExp","match","TOOLTIP_COOKIE_KEY","RunsSearchAutoComplete","searchFilter","onSearchFilterChange","onClear","text","setText","autocompleteEnabled","setAutocompleteEnabled","focused","setFocused","lastSetBySelection","setLastSetBySelection","existingEntityNamesRef","useRef","metricNames","paramNames","tagNames","suggestionLimits","setSuggestionLimits","Metrics","Parameters","Tags","currentEntitiesRef","entityBeingEdited","setEntityBeingEdited","baseOptions","existingEntityNames","current","mergedEntityNames","getEntityNamesFromRunsData","newRunsData","existingNames","mergeDedup","list1","list2","getTagNames","tagsList","flatMap","tagRecord","metricKeyList","paramKeyList","startsWith","options","entityNames","m","p","t","previousEntities","newEntities","re","clauses","results","lastIndex","exec","clause","startIndex","getClausesAndStartIndex","clauseObj","entity","endIndex","getEntitiesAndIndices","currentEntitiesNames","previousEntitiesNames","trim","filteredOptions","getFilteredOptionsFromEntityName","group","newOptions","option","limitForGroup","ellipsized","onSelect","groupName","prevSuggestionLimits","prefix","suffix","localStorageInstance","showTooltipOnError","setShowTooltipOnError","currentTimeSecs","storedItem","getItem","parseInt","tooltipIcon","_tooltipIcon$current","setItem","click","noMatches","o","open","triggerSearch","preventDefault","responsive","mediaQueries","AutoComplete","dropdownMatchSelectWidth","defaultOpen","defaultActiveFirstOption","dropdownRender","menu","SearchIcon","svg","onKeyDown","onFocus","onBlur","CloseIcon","placement","dangerouslySetAntdProps","overlayInnerStyle","trigger","size","InfoIcon","CreateNotebookRunModal","closeModal","classical_ml_text","trimStart","llm_text","snippetHeight","min","onOk","footer","Hint","Tabs","TabPane","tab","CodeSnippet","padding","language","md","showLabel","CopyIcon","GatewayErrorWrapper","ErrorWrapper","getGatewayErrorMessage","_this$textJson","_this$textJson$error","_this$textJson2","_this$textJson3","parseEndpointEvaluationResponse","task","ModelGatewayRouteTask","LLM_V1_COMPLETIONS","_completionsResponse$","_completionsResponse$2","completionsResponse","choices","usage","metadata","total_tokens","output_tokens","completion_tokens","input_tokens","prompt_tokens","LLM_V1_CHAT","_chatResponse$choices","_chatResponse$choices2","_chatResponse$choices3","chatResponse","content","Error","ModelGatewayService","createEvaluationTextPayload","inputText","prompt","messages","role","LLM_V1_EMBEDDINGS","_class","queryMLflowDeploymentEndpointRoute","invariant","mlflowDeployment","processed_data","parameters","gatewayProxyPost","gateway_path","endpoint_url","json_data","queryModelGatewayRoute","payload","parameterDefinitions","defineMessage","helpString","max","step","DEFAULT_PARAMETER_VALUES","temperature","max_tokens","usePromptEvaluationParameters","updateParameters","updateParameter","currentParameters","EvaluationCreatePromptParameters","lg","FormUI","Label","parameterDef","htmlFor","verticalAlign","LineSmoothSlider","defaultValue","LegacySelect","allowClear","mode","suffixIcon","newVariableEndSegment","newDefaultVariableName","usePromptEvaluationPromptTemplateValue","promptTemplate","updatePromptTemplate","DEFAULT_PROMPTLAB_NEW_TEMPLATE_VALUE","promptTemplateRef","handleAddVariableToTemplate","template","newVariableName","alreadyExistingVariableNames","maximumVariableNameIndex","_name$match","getNewVariableName","extractPromptInputVariables","newValue","requestAnimationFrame","textAreaElement","focus","setSelectionRange","savePromptTemplateInputRef","_ref$resizableTextAre","resizableTextArea","textArea","whitespaceViolationMessage","EvaluationCreateRunPromptTemplateErrors","violations","namesWithSpaces","useIntl","Text","invalidNames","nameWithSpace","PROMPT_TEMPLATE_EXAMPLES","variables","TextArea","EvaluationCreatePromptRunModalExamples","closeExamples","updateInputVariableValue","verticalSizing","ArrowLeftIcon","flexDirection","boxSizing","actionDefaultBorderDefault","borders","borderRadiusMd","background","backgroundPrimary","overflow","float","tryPromptTemplate","line","Paragraph","Divider","Spacer","EvaluationCreatePromptRunOutput","evaluationMetadata","isEvaluating","isOutputDirty","evaluationOutput","evaluationError","evaluateButtonTooltip","onEvaluateClick","onCancelClick","metadataOutput","PROMPTLAB_METADATA_COLUMN_LATENCY","round","Number","PROMPTLAB_METADATA_COLUMN_TOTAL_TOKENS","totalTokens","PlayIcon","StopIcon","WarningIcon","TableSkeleton","lines","rows","Message","EXPERIMENT_PAGE_VIEW_MODE_QUERY_PARAM_KEY","getExperimentPageDefaultViewMode","shouldUseExperimentPageChartViewAsDefault","useExperimentPageViewMode","params","setParams","useSearchParams","get","newCompareRunsMode","currentParams","set","evaluatePromptTableValue","_ref6","routeName","routeType","compiledPrompt","inputValues","outputColumn","rowKey","run","getState","modelGateway","modelGatewayRoutesLoading","modelGatewayRoutes","searchAllPromptLabAvailableEndpoints","gatewayRoute","modelGatewayRequestPayload","startTime","performance","evaluatePromptTableValueUnified","gatewayProxyGet","getPromptEngineeringErrorMessage","getMessageField","_ref7","_ref8","_ref9","EvaluationCreatePromptRunModal","runBeingDuplicated","visibleRuns","setViewMode","selectedModel","updateSelectedModel","newRunName","setNewRunName","isCreatingRun","setIsCreatingRun","setIsEvaluating","lastEvaluationError","setLastEvaluationError","setEvaluationOutput","setEvaluationMetadata","outputDirty","setOutputDirty","isViewExamplesModalOpen","setViewExamplesModalOpen","cancelTokenRef","updateInputVariables","inputVariables","inputVariableValues","inputVariableNameViolations","clearInputVariableValues","usePromptEvaluationInputValues","updateInputVariablesDirect","setInputVariableNameViolations","updateInputVariableValues","DEFAULT_PROMPTLAB_INPUT_VALUES","currentInputVariables","newInputVariables","getPromptInputVariableNameViolations","sanitizedInputVariableValues","fromPairs","generateRandomRunName","duplicatedPromptTemplate","duplicatedRouteName","duplicatedParameters","extractEvaluationPrerequisitesForRun","extractRequiredInputParamsForRun","duplicatedRunName","getDuplicatedRunName","compact","modelRoutesUnified","useSelector","supportedModelRouteListUnified","sortBy","modelRoutesLoading","handleEvaluate","modelRoute","cancelToken","random","compilePromptInputText","latency","metadataWithEvaluationTime","prefixedMetadata","reduce","acc","_ref5","metadata_key","metadata_value","wrappedMessage","handleCancel","selectModelLabel","selectModelPlaceholder","promptTemplateProvided","allInputValuesProvided","every","variable","_inputVariableValues$","runNameProvided","evaluateButtonEnabled","createRunButtonEnabled","createRunButtonTooltip","onHandleSubmit","_modelRoutesUnified$s","_modelRoutesUnified$s2","modelRouteName","modelParameters","route_type","modelInput","createPromptLabRunApi","promptParameters","modelOutput","modelOutputParameters","DialogCombobox","modal","selectedRouteName","DialogComboboxTrigger","withInlineLabel","DialogComboboxContent","maxHeight","matchTriggerWidth","DialogComboboxOptionList","DialogComboboxOptionListSearch","DialogComboboxOptionListSelectItem","checked","DialogComboboxHintRow","model","formItem","autoSize","minRows","inputVariable","PlusIcon","inset","overlayOverlay","Spinner","CreateNewRunContext","createNewRun","CreateNewRunContextProvider","setIsOpen","setRunBeingDuplicated","runToDuplicate","shouldEnablePromptLab","useCreateNewRun","useContext","createExperimentPageSearchFacetsState","orderByKey","DEFAULT_ORDER_BY_KEY","orderByAsc","DEFAULT_ORDER_BY_ASC","DEFAULT_START_TIME","DEFAULT_LIFECYCLE_FILTER","datasetsFilter","modelVersionFilter","DEFAULT_MODEL_VERSION_FILTER","flattenString","isArray","persistSearchStateFieldSerializers","deserializeLocalStorage","deserializeQueryString","serializeQueryString","inputs","inputsWithoutExperimentId","context","parsedResult","parse","compareRunCharts","compareRunsMode","serializeLocalStorage","EXPERIMENT_PAGE_QUERY_PARAM_KEYS","useExperimentPageSearchFacets","queryParams","pickedValues","pick","fromEntries","areValuesEmpty","useParams","queryParamsExperimentIds","comparedExperimentIds","getComparedExperimentIds","deserializedFields","resultObject","field","_persistSearchStateFi2","deserializeFn","deserializeFieldsFromQueryString","omitBy","isNil","assign","useUpdateExperimentPageSearchFacets","partialFacets","newParams","_persistSearchStateFi","serializeFn","serializeFieldsToQueryString","ExperimentViewRunsControlsFilters","updateViewState","onDownloadCsv","additionalControls","viewMaximized","autoRefreshEnabled","setUrlSearchFacets","pageViewMode","updateUIState","useUpdateExperimentViewUIState","isComparingExperiments","isCreateRunWithNotebookModalOpen","setCreateRunWithNotebookModalOpenValue","startTimeColumnLabels","getStartTimeColumnDisplayName","currentLifecycleFilterValue","currentStartTimeFilterLabel","displaySidebarToggleButton","datasetSummaries","datasetsByExperimentId","hasDatasets","flexWrap","newSearchFilter","startTimeKey","datasetSummary","multiSelect","showTagAfterValueCount","summary","DialogComboboxOptionListCheckboxItem","datasetSummariesEqual","newDatasetsFilter","updateDatasetsFilter","Tag","textTransform","DropdownMenu","Root","Trigger","asChild","OverflowIcon","Content","IconWrapper","DownloadIcon","shouldEnableExperimentPageAutoRefresh","Separator","CheckboxItem","ItemIndicator","ToggleIconButton","pressed","previewPaneVisible","SidebarIcon","PreviewBadge","ExperimentViewRunsSortSelector","sortOptions","onSortKeyChanged","newOrderBy","newOrderAscending","SORT_DELIMITER_SYMBOL","COLUMN_SORT_BY_ASC","currentUIState","selectedColumns","currentSortSelectValue","COLUMN_SORT_BY_DESC","currentSortSelectLabel","sortOption","sortOptionLabel","extractedKeyName","sortLabelElement","SortAscendingIcon","SortDescendingIcon","handleChange","updatedValue","setOpen","onOpenChange","handleClear","minWidth","order","ArrowUpIcon","ArrowDownIcon","GROUP_KEY","GROUP_KEY_ATTRIBUTES","makeCanonicalSortKey","COLUMN_TYPES","ATTRIBUTES","GROUP_KEY_PARAMS","PARAMS","GROUP_KEY_METRICS","METRICS","GROUP_KEY_TAGS","TAGS","findMatching","filterQuery","v","createHighlightedNode","beforeStr","matchStr","afterStr","ExperimentViewRunsColumnSelector","columnSelectorVisible","onChangeColumnSelectorVisible","setFilter","searchInputRef","scrollableContainerRef","buttonRef","attributeColumnNames","isComparing","ATTRIBUTE_COLUMN_LABELS","USER","SOURCE","VERSION","MODELS","unshift","EXPERIMENT_NAME","DATASET","getAttributeColumns","setCheckedColumns","updateFn","facets","newColumns","uniqueNewColumns","from","tagsKeyList","getVisibleTagKeyList","canonicalKeyNames","treeData","filteredAttributes","filteredParams","filteredMetrics","filteredTags","attributeKey","metricKey","paramKey","tagKey","toggleGroup","keyList","k","toggleSingleKey","_scrollableContainerR","_searchInputRef$curre","scrollTo","preventScroll","scrollIntoView","block","behavior","onCheck","node","isCanonicalSortKeyOfType","columnType","extractCanonicalSortKey","canonicalKeysForGroup","searchInputKeyDown","treeElement","querySelector","dropdownContent","borderColor","_buttonRef$current","overflowY","overflowX","paddingBottom","whiteSpace","textOverflow","Tree","defaultExpandedKeys","Dropdown","overlay","onVisibleChange","ColumnsIcon","ChevronDownIcon","COMPARE_RUNS_TOOLTIP_STORAGE_ITEM","ChartViewButtonTooltip","multipleRunsSelected","isTableMode","seenTooltipStore","isToolTipOpen","setToolTipOpen","hasSeenTooltipBefore","updateIsTooltipOpen","Popover","align","Arrow","ExperimentViewRunsModeSwitch","runsAreGrouped","hideBorder","viewMode","setViewModeInURL","classNamePrefix","activeTab","dangerouslyAppendEmotionCSS","activeKey","tabKey","defineMessages","minimum","maximum","average","attributes","tags","dataset","noParams","noTags","aggregationTooltip","noResults","GroupBySelectorBody","groupBy","attributeElementRef","tagElementRef","paramElementRef","inputElementRef","minimumLabel","maximumLabel","averageLabel","datasetLabel","uniq","runTags","MLFLOW_INTERNAL_PREFIX","aggregateFunction","RunGroupingAggregateFunction","Average","groupByKeys","currentAggregateFunctionLabel","filteredTagNames","tag","filteredParamNames","param","attributesMatchFilter","isEmpty","datasetsList","hasAnyResults","groupByToggle","groupByData","newGroupByKeys","isGroupedBy","stopPropagation","firstItem","GearIcon","side","RadioGroup","onValueChange","aggregateFunctionString","newFunction","newGroupBy","RadioItem","Min","Max","Group","RunGroupingMode","Dataset","onCheckedChange","createRunsGroupByKey","groupByKey","paramName","Param","ExperimentViewRunsGroupBySelector","isLoading","normalizedGroupBy","normalizeRunsGroupByKey","ListBorderIcon","endIcon","XCircleFillIcon","textPlaceholder","typography","fontSizeSm","actionTertiaryTextHover","onPointerDownCapture","ExperimentViewRunsSortSelectorV2Body","onOptionSelected","firstElementRef","filteredSortOptions","setOrder","ascending","_inputElementRef$curr","_firstElementRef$curr","ExperimentViewRunsSortSelectorV2","metricKeys","paramKeys","attributeSortOptions","ATTRIBUTE_COLUMN_SORT_LABEL","sortLabelKey","ATTRIBUTE_COLUMN_SORT_KEY","metricsSortOptions","paramsSortOptions","ExperimentViewRunsControls","expandRows","updateExpandRows","setCompareRunsMode","isComparingRuns","isEvaluationMode","filteredParamKeys","filteredMetricKeys","filteredTagKeys","downloadRunsCsv","useRunSortOptions","ColumnSortByOrder","sortLabel","showActionButtons","showGroupBySelector","changeColumnSelectorVisible","toggleExpandedRows","multipleDatasetsArePresent","datasetsInRun","shouldUseNewExperimentPageSortSelector","ToggleButton","MLFlowAgGridImpl","MLFlowAgGridLoader","fallback","cssTheme","START_TIME_COLUMN_OFFSET","ALL","LAST_HOUR","LAST_24_HOURS","LAST_7_DAYS","LAST_30_DAYS","LAST_YEAR","createSearchRunsParams","referenceTime","pageToken","runViewType","ViewType","ACTIVE_ONLY","DELETED_ONLY","runsPinned","orderBy","createOrderByExpression","startTimeExpression","createStartTimeExpression","offset","datasetsFilterExpression","createDatasetsFilterExpression","createFilterExpression","activeFilters","shouldFetchParents","DATE","shouldNestChildrenAndFetchParents","RUNS_SEARCH_MAX_RESULTS","isSearchFacetsFilterUsed","currentSearchFacetsState","ColumnHeaderCell","enableSorting","canonicalSortKey","displayName","tableContext","updateSearchFacets","handleSortBy","newOrderByAsc","DateCellRenderer","runStatus","cellWrapper","formatTimestamp","RunStatusIcon","status","timeSinceStr","ExperimentNameCellRenderer","basename","ModelLink","isUc","registeredModelName","registeredModelVersion","flavors","artifactPath","RegisteredModelOkIcon","actionPrimaryBackgroundDefault","ModelsIcon","ModelRegistryRoutes","getModelVersionPageRoute","getRunPageRoute","renderModelName","displayFullName","ModelsCellRenderer","registeredModels","loggedModels","models","mergeLoggedAndRegisteredModels","Overflow","SourceCellRenderer","_tags$Utils$sourceTyp","sourceType","sourceTypeTag","sourceLink","renderSource","ExperimentSourceTypeIcon","VersionCellRenderer","version","renderSourceVersion","_path","_circle","source","hasOwnProperty","apply","SvgIconVisibleFill","svgRef","titleId","viewBox","fill","xmlns","d","stroke","cx","cy","strokeWidth","labels","visibility","groups","unhide","pinning","unpin","pin","VisibleIcon","shouldUseNewRunRowsVisibilityModel","Icon","component","VisibleFillIcon","VisibleHollowIcon","MOUSE_DELAYS","mouseEnterDelay","mouseLeaveDelay","RowActionsCellRenderer","_props$data$runDateAn","groupParentInfo","isGroupRow","pinned","rowUuid","runUuidToToggle","visibilityMessageDescriptor","pinningMessageDescriptor","displayVisibilityCheckbox","isRemainingRunsGroup","runDateAndNestInfo","belongsToGroup","actionsContainer","actionCheckbox","showOnlyInCompareMode","visuallyHidden","onToggleVisibility","RUNS_VISIBILITY_MODE","CUSTOM","VisibleOffIcon","iconFontSize","pinnable","uuidToPin","existingState","PinFillIcon","PinIcon","prevProps","nextProps","RowActionsCellRendererSuppressKeyboardEvents","HTMLElement","classList","contains","appearance","cursor","grey500","grey400","ExperimentViewRunsTableHeaderContext","runsHiddenMode","FIRST_10_RUNS","ExperimentViewRunsTableHeaderContextProvider","RowActionsHeaderCellRendererV2","allRunsHidden","actionButton","HIDEALL","FIRST_20_RUNS","SHOWALL","RowActionsHeaderCellRenderer","_props$eGridHeader","selectAllCheckbox","eGridHeader","ariaLabel","GroupParentCellRenderer","getRunColor","useGetExperimentRunColor","saveRunColor","useSaveExperimentRunColor","onExpandToggle","groupId","doOpen","groupsExpanded","getRunGroupDisplayName","expanderOpen","ChevronRightIcon","RunColorPill","onChangeColor","colorValue","groupUuid","runUuids","RunNameCellRenderer","onExpand","hasExpander","childrenIds","renderingAsParent","expanderWrapper","nestLevel","expanderButton","MinusBoxIcon","PlusSquareIcon","runLink","tabIndex","fontSizeBase","minHeight","textDecoration","LoadMoreRowRenderer","loadMoreRunsFunc","SingleDataset","datasetWithTags","onDatasetSelected","appendComma","inPopover","contextTag","MLFLOW_RUN_DATASET_CONTEXT_TAG","flexShrink","TableIcon","Close","DatasetsCellRenderer","datasets","containerElement","datasetsVisible","setDatasetsVisible","ellipsisVisible","setEllipsisVisible","clampedDatasets","datasetsLength","throttle","entry","availableHeight","contentRect","elementsFit","stackedHeight","clientHeight","availableWidth","stackedWidth","clientWidth","partiallyVisibleDatasets","resizeObserver","ResizeObserver","observe","disconnect","moreItemsToShow","datasetsToShow","paddingLeft","heightSm","DatasetsCellRendererSuppressKeyboardEvents","_ref10","HTMLButtonElement","AggregateMetricValueCell","_data$groupParentInfo","cellClassIsOrderedBy","_colDef$headerCompone","colDef","headerComponentParams","getActionsColumnWidth","BASE_RUN_ACTIONS_COLUMN_WIDTH","createParamFieldName","EXPERIMENT_FIELD_PREFIX_PARAM","createMetricFieldName","EXPERIMENT_FIELD_PREFIX_METRIC","createTagFieldName","EXPERIMENT_FIELD_PREFIX_TAG","UntrackedSpinner","defaultKeyboardNavigationSuppressor","TAGS_TO_COLUMNS_MAP","RUN_NAME","getRowId","getRowIsLoadMore","rowNode","isLoadMoreRow","getAdjustableAttributeColumns","useRunsColumnDefinitions","compareExperiments","onTogglePin","tagKeyList","columnApi","cumulativeColumns","cachedMetricKeys","cachedParamKeys","cachedTagKeys","add","tagKeys","useCumulativeColumnKeys","usingCompactViewport","useMediaQuery","breakpoints","columnSet","columns","valueGetter","checkboxSelection","headerComponent","headerCheckboxSelection","headerName","cellClass","cellRenderer","cellRendererParams","maxWidth","resizable","suppressKeyboardEvent","isRunColumnDynamicSized","shouldEnableRunsTableRunNameColumnResize","colId","headerTooltip","sortable","equals","runA","runB","_runA$groupParentInfo","_runB$groupParentInfo","cellClassRules","initialWidth","dateInfo1","dateInfo2","DURATION","experimentName1","experimentName2","initialHide","tags1","tags2","getSourceName","version1","version2","models1","models2","getQualifiedEntityName","tooltipField","cellRendererSelector","is-previewable-cell","canonicalSortKeys","canonicalKey","setColumnVisible","EXPERIMENTS_DEFAULT_COLUMN_SETUP","autoSizePadding","menuIcon","suppressMenu","suppressMovable","ExperimentViewRunsEmptyTable","isFiltered","onClearFilters","noResultsWrapper","Empty","button","description","image","FilterIcon","LoggingRunsDocUrl","BeakerIcon","ExperimentViewRunsTableCollapse","updateRunListHidden","runListHidden","bottom","opacity","transition","left","pointerEvents","ChevronLeftIcon","CLASS_OUT_OF_VIEWPORT","CLASS_IS_HIDDEN","CLASS_IS_MINIMIZED","AG_GRID_CLS","ExperimentViewRunsTableAddColumnCTA","gridContainerElement","isInitialized","moreRunsAvailable","moreAvailableRunsTableColumnCount","ctaRef","savedContainerRef","immediateMoreRunsAvailable","initialize","targetElement","rootElement","refLeftElem","refCenterElem","refHeaderElem","refBodyViewport","gridAreaWidth","leftColContainerWidth","leftColContainerHeight","centerColContainerWidth","colContainerHeight","headerHeight","_savedContainerRef$cu","_savedContainerRef$cu2","_savedContainerRef$cu3","_savedContainerRef$cu4","calculatedLeft","calculatedTop","remove","loadMoreRowHeight","calculatedHeight","columnContainer","buttonContainer","buttonIcon","caption","count","borderDecorative","borderTop","willChange","strong","ExperimentViewRunsTableStatusBar","allRunsCount","statusBar","PreviewSidebar","headerText","empty","gridTemplateColumns","rowGap","agGridSelectRunRows","isSelected","gridApi","forEachNode","_node$data","runInfo","childRunDateInfo","childrenRunUuid","setSelected","useToggleRowVisibilityCallback","tableRows","immediateTableRows","toggleRowVisibility","groupOrRunUuid","runsHidden","currentlyHiddenRows","newHiddenRows","currentGroupOrRunUuid","ExperimentViewRunsTable","onAddColumnClicked","rowsData","setGridApi","setColumnApi","expandersVisible","row","_row$runDateAndNestIn","toggleRowExpanded","parentId","runsExpanded","currentRunsExpanded","togglePinnedRow","uuid","existingFacets","toggleRowVisibilityV2","toggleRowVisibilityV1","runUuidOrToggle","gridReadyHandler","api","handleRowSelected","onSelectionChange","selectedUUIDs","getSelectedRows","aggregate","curr","isParent","selectedRunRows","uniqBy","rowData","agGridSelectGroupRows","useExperimentTableSelectRowHandler","columnDefs","gridSizeHandler","sizeColumnsToFit","showLoadingOverlay","hideOverlay","setRowData","uniqueId","allAvailableColumnsCount","hasSelectedAllColumns","runUuidsMatchingFilter","useLayoutEffect","deselectAll","resetRowHeights","rowHeightGetterFn","EXPERIMENT_RUNS_TABLE_ROW_HEIGHT","datasetColumnId","getDatasetsCellHeight","datasetColumnShown","_data$datasets","datasetsCount","sidebarPreviewData","setSidebarPreviewData","handleCellClicked","_column$getParent","column","columnGroupId","getParent","getGroupId","header","getColId","displayAddColumnsCTA","displayPreviewSidebar","displayRunsTable","displayStatusBar","displayRunListCollapse","displayEmptyState","agGridOverrides","defaultColDef","rowSelection","onGridReady","onSelectionChanged","getRowHeight","onRowSelected","suppressRowClickSelection","suppressColumnMoveAnimation","suppressScrollOnNewData","isFullWidthRow","fullWidthCellRenderer","fullWidthCellRendererParams","suppressFieldDotNotation","enableCellTextSelection","components","agColumnHeader","loadingOverlayComponent","suppressNoRowsOverlay","loadingOverlayComponentParams","showImmediately","rowBuffer","onCellClicked","onGridSizeChanged","gridColors","rowForeground","textPrimary","rowBackground","rowBackgroundHover","backgroundSecondary","rowBackgroundSelected","rowBackgroundHoverSelected","columnSortedBy","blue400","headerBackground","headerTextColor","headerGroupTextColor","headerBorderColor","checkboxBorderColor","checkboxBorderColorChecked","checkboxBackgroundColorChecked","overlayBackground","getGridColors","borderRight","borderBottom","ExperimentPageViewState","hiddenChildRunsSelected","artifactViewState","selectedTables","groupByCols","intersectingOnly","FETCHED_RUN_NOTIFICATION_KEY","useFetchedRunsNotification","notification","getMessage","allRuns","childRuns","fetchedRuns","existingRunInfos","runsWithParent","_run$data","runTagsList","EXPERIMENT_PARENT_ID_TAG","countFetchedRuns","close","duration","PromptEngineeringContext","getMissingParams","pendingDataLoading","getEvaluableRowCount","evaluateCell","evaluateAllClick","runColumnsBeingEvaluated","canEvaluateInRunColumn","toggleExpandedHeader","isHeaderExpanded","PromptEngineeringContextProvider","tableData","setIsHeaderExpanded","expanded","canEvaluateOnRun","requiredInput","groupByCellValues","startEvaluatingRunColumn","stopEvaluatingRunColumn","useEvaluateAllRows","evaluationTableData","currentTableData","currentRunsBeingEvaluated","setEvaluatedRuns","processQueueForRun","requiredInputs","nextEvaluableRow","tableRow","cellValues","containsAllParamValuesForRow","existingRunUuid","evaluationData","evaluationPendingDataLoadingByRunUuid","DEFAULT_PROMPTLAB_OUTPUT_COLUMN","missingParams","getAction","usePromptEngineeringContext","EvaluationRunHeaderModelIndicator","promptEvaluationDataForRun","gatewayKey","stop","stopSequences","EvaluationRunHeaderDatasetIndicator","_run$datasets","handleDatasetSelected","ExperimentViewDatasetWithContext","displayTextAsLink","EvaluationTableHeader","groupHeaderContent","flexBasis","EvaluationRunHeaderCellRenderer","onHideRun","onDuplicateRun","evaluableRowCount","evaluateAllButtonEnabled","evaluatingAllInProgress","evaluateAllTooltipContent","ExperimentRoutes","EvaluationCellEvaluateButton","isRunEvaluable","missingParamsToEvaluate","missingParamList","onMouseDownCapture","onClickCapture","HighlightedText","highlight","parts","part","yellow200","EvaluationTextCellRenderer","_pendingDataLoading$r","_data$outputMetadataB","isGroupByColumn","isGatewayRoutesLoading","modelGatewayRoutesLoadingLegacy","isCellEvaluating","outputMetadata","outputMetadataByRunUuid","isPending","isPendingInputRow","structuredJSONValue","actionDefaultBackgroundHover","JsonPreview","json","highlightedText","evaluationTime","EVALUATION_ARTIFACTS_TEXT_COLUMN_WIDTH","initialWidthGroupBy","initialWidthOutput","EvaluationGroupByHeaderCellRenderer","truncate","bold","enlargedIconStyle","EvaluationTableActionsColumnRenderer","EvaluationTableActionsCellRenderer","onAddNewInputs","displayAddNewInputsButton","EvaluationImageCellRenderer","url","compressed_url","ImagePlot","imageUrl","compressedImageUrl","EvaluationArtifactCompareTable","resultList","groupByColumns","onCellClick","isPreviewPaneVisible","outputColumnName","isImageColumn","setColumns","pendingData","evaluationPendingDataByRunUuid","gridWrapperRef","handleHideRun","refreshHeader","handleDuplicateRun","clearFocusedCell","visibleRows","getRenderedNodes","refreshCells","force","rowNodes","showAddNewInputsModal","AddNewInputsModal","useEvaluationAddNewInputsModal","modalVisible","setModalVisible","requiredInputKeys","setRequiredInputKeys","setInputValues","allValuesProvided","inputName","successCallback","setSuccessCallback","setInputValue","requiredInputsForRuns","inputValuesWithRunNames","flat","runNames","okButtonProps","cancelText","hasMore","scrollGridToTop","_gridWrapperRef$curre","gridViewport","ensureIndexVisible","emptyMessage","getId","outputColumnIndicator","cols","rowIndex","col","isLastGroupByColumns","headerClass","isFirstColumn","runsContainHeaderMetadata","setHeaderHeight","getEvaluationArtifactsTableHeaderHeight","createTableStyles","suppressHorizontalScroll","TextRendererCellRenderer","GroupHeaderCellRenderer","RunHeaderCellRenderer","ActionsColumnRenderer","ActionsCellRenderer","ImageRendererCellRenderer","boxShadow","blue300","extractGroupByValuesFromEntry","groupByMappings","isString","groupByHashKey","keyValue","groupByValues","isMacKeyboard","_userAgentData","test","navigator","userAgentData","platform","systemModifierKey","useBrowserKeyShortcutListener","modifierKeys","fn","altOrOptKey","ctrlOrCmdKey","shiftKey","handler","altKey","addEventListener","removeEventListener","useEvaluationArtifactWriteBack","evaluationArtifactsBeingUploaded","evaluationDraftInputValues","isSyncingArtifacts","setSyncingArtifacts","discard","unsyncedDataEntriesCount","draftInputValuesCount","runsBeingSynchronizedCount","runArtifacts","isSynced","synchronizeArtifactData","evaluationArtifactsByRunUuid","runUuidsToUpdate","originalRunArtifacts","artifactTableRecords","MLFLOW_PROMPT_ENGINEERING_ARTIFACT_NAME","updatedArtifactFiles","originalTableRecord","transformedEntries","entryData","columnName","updatedArtifactFile","cloneDeep","rawArtifactFile","promises","uploadArtifactApi","newEvaluationTable","parseEvaluationTableArtifact","pendingUnevaluatedDraftInputValues","EvaluationSyncStatusElement","keyCombination","shouldDisplayEvaluationArtifactEmptyState","noEvalTablesLogged","userDeselectedAllColumns","areRunsSelected","areTablesSelected","EvaluationArtifactViewEmptyState","openInNewTab","_ref11","EvaluationArtifactCompareViewImpl","comparedRuns","setSelectedTables","setGroupByCols","setOutputColumn","useEvaluationArtifactViewState","showSearchSpinner","setShowSearchSpinner","debouncedFilter","setDebouncedFilter","setUserDeselectedAllColumns","handleTableToggle","currentValue","handleGroupByToggle","newValues","visibleRunsUuids","tables","tablesByRun","comparedRunRows","_run$tags","_run$tags$MLFLOW_LOGG","rawLoggedArtifactsDeclaration","MLFLOW_LOGGED_ARTIFACTS_TAG","tablesInRun","RunLoggedArtifactType","TABLE","path","SyntaxError","allUniqueTables","tablesIntersection","tableName","_tablesByRun$runUuid","table","_evaluationData$evalu","evaluationArtifactsLoadingByRunUuid","imageColumns","artifactsByRun","comparedRunUuids","tableNames","columnsIntersection","allTableEntries","allColumnsForAllTables","column_string","tableColumns","useEvaluationArtifactColumns","useEvaluationArtifactTableData","pendingDataByRun","draftInputValues","comparedRunsUuids","outputCellsValueMap","groupByCellsValueMap","pendingRowKeys","draftInputValueSet","visibleGroupByValues","colName","draftInputRowKey","outputMetadataByCellsValueMap","runsWithEntries","baseEntries","parseFloat","cellsEntry","pendingEntries","pendingEntry","allRowKeys","existingTableRow","existingKey","filepath","compressed_filepath","LOG_TABLE_IMAGE_COLUMN_TYPE","getArtifactLocationUrl","promptLabInputVariableNames","allInputNames","tablesToFetch","getEvaluationTableArtifact","isViewConfigured","filteredRows","regexp","groupByValue","noColumnsSelected","columnNotAvailableAnymore","firstColumn","groupByColumnCandidates","availableGroupByColumns","availableOutputColumns","nextColumnCandidate","setTimeout","clearTimeout","gridTemplateRows","LegacySkeleton","columnGap","columnNames","FormattedJsonDisplay","EvaluationArtifactCompareView","createRunDataTrace","latestMetricsByRunUuid","paramsByRunUuid","tagsByRunUuid","imagesByRunUuid","_run$runInfo","_run$runDateAndNestIn","metrics","images","metricsHistory","RunsCompareImpl","experimentTags","compareRunSections","updateChartsUIState","useUpdateRunsChartsUIConfiguration","initiallyLoaded","setInitiallyLoaded","configuredCardConfig","setConfiguredCardConfig","search","setSearch","groupByNormalized","fullScreenChart","setFullScreenChart","startEditChart","chartCard","primaryMetricKey","automlEntry","AUTOML_EVALUATION_METRIC_TAG","mlflowPrimaryEntry","MLFLOW_EXPERIMENT_PRIMARY_METRIC_NAME","chartData","groupChartDataEntries","_group$groupParentInf","createGroupDataTrace","_run$groupParentInfo","_run$groupParentInfo2","_run$groupParentInfo3","metricsData","aggregatedMetricData","keyBy","maxStep","timestamp","aggregatedParamData","_run$runDateAndNestIn2","filteredImageData","LOG_IMAGE_TAG_INDICATOR","usePopulateImagesByRunUuid","runUuidsIsActive","_run$runInfo2","enabled","shouldEnableImageGridCharts","resultChartSet","resultSectionSet","RunsChartsCardConfig","getBaseChartAndSectionConfigs","useParallelCoordinatesChart","isResultUpdated","updateChartAndSectionConfigs","isAccordionReordered","toggleRunVisibility","confirmChartCardConfiguration","useConfirmChartCardConfigurationFn","removeChart","useRemoveRunsChartFn","reorderCharts","useReorderRunsChartsFn","insertCharts","useInsertRunsChartsFn","tooltipContextValue","RunsChartsTooltipWrapper","contextData","RunsChartsTooltipBody","DragAndDropProvider","RunsChartsSectionAccordion","addNewChartCard","metricSectionId","getEmptyChartCardByType","RunsChartsConfigureModal","chartRunData","config","onSubmit","configuredCard","RunsChartsFullScreenModal","tooltipComponent","RunsCompare","setter","RunsChartsUIConfigurationContextProvider","ExperimentViewRunsTableResizer","onResize","dragging","setDragging","ResizableBox","axis","resizeHandles","minConstraints","handle","ExperimentViewRunsTableResizerHandle","onResizeStart","onResizeStop","Global","actionDefaultBorderHover","createCurrentTime","mountTime","setMilliseconds","getTableLayoutStyles","ExperimentViewRuns","isLoadingRuns","loadMoreRuns","setViewState","expandRowsStore","paramsList","metricsList","modelVersionsByRunUuid","runData","newPartialViewState","currentViewState","addColumnClicked","setReferenceTime","isDrawerOpen","setIsDrawerOpen","selectedDatasetWithRun","setSelectedDatasetWithRun","useExperimentRunRows","nestChildren","notificationsFn","notificationContainer","useLegacyNotification","showFetchedRunsNotifications","tableAreaWidth","setTableAreaWidth","loadMoreRunsCallback","datasetSelected","isTabActive","useIsTabActive","tableElement","ExperimentViewDatasetDrawer","useFetchExperiments","getExperimentsContext","loadExperimentViewState","idKey","loadComponentState","createExperimentPageUIState","usePersistExperimentPageViewState","searchFacets","setSearchFacets","persistKey","persistedViewState","rebuiltViewState","saveComponentState","experimentRunsSelector","comparingExperiments","extractRunInfos","MODEL_VERSION_FILTER","ALL_RUNS","run_id","getRunInfo","getRunDatasets","rInfo","lifecycleStage","WITH_MODEL_VERSIONS","WTIHOUT_MODEL_VERSIONS","console","warn","datasetName","datasetDigest","datasetTag","metricKeysSet","paramKeysSet","runDatasetsByUuid","metricsByRunUuid","getLatestMetrics","metric","paramValues","getParams","getRunTags","firstExperimentId","getExperimentTags","createFetchRunsRequestParams","requestedFacets","useExperimentRuns","setRunsData","createEmptyRunsResult","setIsLoadingRuns","isInitialLoadingRuns","setIsInitialLoadingRuns","nextPageToken","setNextPageToken","cachedPinnedRuns","lastFetchedTime","lastRequestedParams","setResultRunsData","store","loadModelVersions","fetchModelVersionsForRuns","runsPayload","actionCreator","runsWithLogModelHistory","EXPERIMENT_LOG_MODEL_HISTORY_TAG","chunk","MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER","runsChunk","action","searchModelVersionsApi","fetchRuns","fetchParams","thunkDispatch","getStore","isAutoRefreshing","loadMoreRunsApi","searchRunsApi","_options$discardResul","next_page_token","discardResultsFn","requestParams","refreshTimeoutRef","isLoadingImmediate","autoRefreshEnabledRef","currentResults","scheduleRefresh","hasBeenInitialized","timePassed","requestedPageCount","ceil","existingPageCount","useExperimentRunsAutoRefresh","uiStateInitializers","expandedEvaluationRunRowsUIStateInitializer","evaluationRunIds","_runsData$tagsList$in","_runsData$tagsList$in2","MLFLOW_RUN_TYPE_TAG","MLFLOW_RUN_TYPE_VALUE_EVALUATION","parentIdsOfEvaluationRunIds","_runsData$tagsList$in3","baseState","toolbarCommands","converter","getConverter","getSanitizedHtmlContent","markdown","sanitized","sanitizeConvertedHtml","makeHtml","forceAnchorTagNewTab","ExperimentViewDescriptionNotes","experiment","editing","setEditing","setShowAddDescriptionButton","storedNote","_Object$values$find","NOTE_CONTENT_TAG","extractNoteFromTags","tmpNote","setTmpNote","selectedTab","setSelectedTab","isExpanded","setIsExpanded","COLLAPSE_MAX_HEIGHT","handleSubmitEditNote","updatedNote","lineHeight","lineHeightSm","flexGrow","overflowWrap","dangerouslySetInnerHTML","__html","ChevronUpIcon","ReactMde","minEditorHeight","maxEditorHeight","minPreviewHeight","onTabChange","newTab","generateMarkdownPreview","resolve","getIcon","SvgIcon","ExperimentViewCopyTitle","copyable","tooltips","ExperimentViewArtifactLocation","ExperimentViewCopyExperimentId","ExperimentViewCopyArtifactLocation","ExperimentViewHeader","showAddDescriptionButton","normalizedExperimentName","pop","feedbackFormUrl","EXPERIMENT_PAGE_FEEDBACK_URL","wordBreak","titleAddOns","overlayStyle","arrowPointAtCenter","NewWindowIcon","spacerSize","ExperimentView","ids","experimentsById","oldExperiments","newExperiments","firstExperiment","elementHeight","hideableElementHeight","observeHeight","useElementHeight","hideableElementsContainer","setHideableElementsContainer","setElementHeight","scrollHeight","setUIState","seedInitialUIState","isFirstVisit","dispatchAction","useReducer","newState","currentPersistKey","newPersistKey","persistedStateFound","persistedUIState","EXPERIMENT_PAGE_UI_STATE_FIELDS","newStateOrSelector","initializer","useInitializeUIState","isViewStateShared","uiStateSetter","searchParams","viewStateShareKey","EXPERIMENT_PAGE_VIEW_STATE_SHARE_URL_PARAM_KEY","sharedSearchFacetsState","sharedUiState","sharedStateError","sharedStateErrorMessage","shareViewTag","parsedSharedViewState","displayGlobalErrorNotification","useSharedExperimentViewState","first","isMaximized","runsRequestError","searchDatasetsApi","getErrorCode","ErrorCodes","PERMISSION_DENIED","RESOURCE_DOES_NOT_EXIST","NotFoundPage","ExperimentPageUIStateContextProvider","experimentViewWrapper","paragraph","NoExperimentView","noExperiments","ExperimentCliDocUrl","getExperimentActions","setCompareExperiments","HomePage","searchRequestId","hasExperiments","firstExp","getFirstActiveExperiment","Navigate","loadingState","customSpinner"],"sourceRoot":""}